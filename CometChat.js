!function(t,e){if("object"==typeof exports&&"object"==typeof module)module.exports=e(require("@react-native-async-storage/async-storage"),require("react-native"),require("react"));else if("function"==typeof define&&define.amd)define(["@react-native-async-storage/async-storage","react-native","react"],e);else{var n="object"==typeof exports?e(require("@react-native-async-storage/async-storage"),require("react-native"),require("react")):e(t["@react-native-async-storage/async-storage"],t["react-native"],t.react);for(var o in n)("object"==typeof exports?exports:t)[o]=n[o]}}(window,function(n,o,s){return function(n){var o={};function s(t){if(o[t])return o[t].exports;var e=o[t]={i:t,l:!1,exports:{}};return n[t].call(e.exports,e,e.exports,s),e.l=!0,e.exports}return s.m=n,s.c=o,s.d=function(t,e,n){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},s.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(s.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)s.d(n,o,function(t){return e[t]}.bind(null,o));return n},s.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="",s(s.s=30)}([function(t,W,r){"use strict";(function(K){W.__esModule=!0,W.updatePropertiesWithDynamicValue=W.getCallSettings=W.isCallingComponentInstalled=W.getKeyprefix=W.validateConversationType=W.validateUpdateUser=W.validateCreateUser=W.validateMessage=W.validateChatType=W.validateMsgId=W.validateArray=W.validateHideMessagesFromBlockedUsers=W.validateId=W.validateCreateGroup=W.validateJoinGroup=W.validateUpdateGroup=W.validateScope=W.isAudio=W.isVideo=W.isImage=W.getUpdatedSettings=W.getAppSettings=W.getCurrentTime=W.Logger=W.createUidFromJid=W.format=W.getOrdinalSuffix=W.isFalsy=W.isTruthy=W.isObject=W.getJidHost=W.getChatHost=void 0;var o=r(14),B=r(1),t=r(6),b=r(2),i=r(17),a=r(18),E=r(20),F=r(5),e=r(13),x=r(34),V=r(43),J=r(15);function k(t){return null!=t&&("string"==typeof t&&(t=t.trim()),"object"==typeof t&&0===Object.keys(t).length&&(t=void 0)),["",0,"0",!1,null,"null",void 0,"undefined"].includes(t)}function c(t){for(var o=[],e=1;e<arguments.length;e++)o[e-1]=arguments[e];return t.split("%s").reduce(function(t,e,n){return t+e+(o[n]||"")},"")}W.getChatHost=function(t){return t[B.APP_SETTINGS.KEYS.CHAT_HOST_OVERRIDE]?t[B.APP_SETTINGS.KEYS.CHAT_HOST_OVERRIDE]:t[B.APP_SETTINGS.KEYS.CHAT_HOST_APP_SPECIFIC]?t[B.APP_SETTINGS.KEYS.CHAT_HOST_APP_SPECIFIC]:t[B.APP_SETTINGS.KEYS.CHAT_HOST]},W.getJidHost=function(t){return t[B.APP_SETTINGS.KEYS.JID_HOST_OVERRIDE]?t[B.APP_SETTINGS.KEYS.JID_HOST_OVERRIDE]:t[B.APP_SETTINGS.KEYS.CHAT_HOST]},W.isObject=function(t){return t instanceof Object&&t.constructor===Object},W.isTruthy=function(t){return[!0,1,"1","true","TRUE"].includes(t)},W.isFalsy=k,W.getOrdinalSuffix=function(t){var e=t%10,n=t%100;return 1==e&&11!=n?t+"st":2==e&&12!=n?t+"nd":3==e&&13!=n?t+"rd":t+"th"},W.format=c,W.createUidFromJid=function(t){return t.substring(t.lastIndexOf("]")+1,t.lastIndexOf("@"))};var n=function(){function t(){}return t.log=function(t,e){},t.error=function(t,e){},t.info=function(t,e){},t}();function H(){return new Promise(function(e,n){o.LocalStorage.getInstance().get(B.LOCAL_STORE.KEY_APP_SETTINGS).then(function(t){k(t)?s().then(function(t){e(t)},function(t){n(t)}):e(t)},function(t){n(t)})})}function s(){return new Promise(function(e,n){t.makeApiCall("appSettings").then(function(t){o.LocalStorage.getInstance().set(B.LOCAL_STORE.KEY_APP_SETTINGS,t.data),t.data.MODE&&F.CometChat.setMode(t.data.MODE),e(t.data)},function(t){n(new b.CometChatException(t.error))})})}W.Logger=n,W.getCurrentTime=function(){return(new Date).getTime()},W.getAppSettings=H,W.getUpdatedSettings=s,W.isImage=function(t){var e;return t.type&&t.type.toLowerCase().includes("image")&&(e=!0),e},W.isVideo=function(t){var e;return t.type&&t.type.toLowerCase().includes("video")&&(e=!0),e},W.isAudio=function(t){var e;return t.type&&t.type.toLowerCase().includes("audio")&&(e=!0),e},W.validateScope=function(t){return typeof t!==B.COMMON_UTILITY_CONSTANTS.TYPE_CONSTANTS.STRING?new b.CometChatException(JSON.parse(c(JSON.stringify(B.GENERAL_ERROR.MUST_BE_A_STRING),"SCOPE","SCOPE","Scope"))):k(t)?new b.CometChatException(JSON.parse(c(JSON.stringify(B.GENERAL_ERROR.INVALID),"SCOPE","SCOPE","scope","scope"))):t!=F.CometChat.GROUP_MEMBER_SCOPE.ADMIN&&t!=F.CometChat.GROUP_MEMBER_SCOPE.MODERATOR&&t!=F.CometChat.GROUP_MEMBER_SCOPE.PARTICIPANT?new b.CometChatException(B.GroupErrors.INVALID_SCOPE):void 0},W.validateUpdateGroup=function(t){return t.hasOwnProperty(B.GroupConstants.KEYS.GUID)?typeof t[B.GroupConstants.KEYS.GUID]!==B.COMMON_UTILITY_CONSTANTS.TYPE_CONSTANTS.STRING?new b.CometChatException(JSON.parse(c(JSON.stringify(B.GENERAL_ERROR.MUST_BE_A_STRING),"GUID","GUID","GUID"))):k(t[B.GroupConstants.KEYS.GUID])?new b.CometChatException(JSON.parse(c(JSON.stringify(B.GENERAL_ERROR.INVALID_GROUP_PROPERTY),"GUID","GUID","GUID","GUID"))):t.hasOwnProperty(B.GroupConstants.KEYS.NAME)&&""===t[B.GroupConstants.KEYS.NAME]?new b.CometChatException(JSON.parse(c(JSON.stringify(B.GENERAL_ERROR.EMPTY_STRING),"GROUP_NAME","GROUP_NAME","Group name"))):void 0:new b.CometChatException(JSON.parse(c(JSON.stringify(B.GENERAL_ERROR.PARAMETER_COMPULSORY),"GUID","GUID","GUID","GUID")))},W.validateJoinGroup=function(t,e,n){if(typeof t==B.COMMON_UTILITY_CONSTANTS.TYPE_CONSTANTS.OBJECT){if(!t.hasOwnProperty(B.GroupConstants.KEYS.GUID))return new b.CometChatException(JSON.parse(c(JSON.stringify(B.GENERAL_ERROR.PARAMETER_COMPULSORY),"GUID","GUID","GUID","GUID")));if(typeof t[B.GroupConstants.KEYS.GUID]!==B.COMMON_UTILITY_CONSTANTS.TYPE_CONSTANTS.STRING)return new b.CometChatException(JSON.parse(c(JSON.stringify(B.GENERAL_ERROR.MUST_BE_A_STRING),"GUID","GUID","GUID")));if(k(t[B.GroupConstants.KEYS.GUID]))return new b.CometChatException(JSON.parse(c(JSON.stringify(B.GENERAL_ERROR.INVALID_GROUP_PROPERTY),"GUID","GUID","GUID","GUID")));if(!t.hasOwnProperty(B.GroupConstants.KEYS.TYPE))return new b.CometChatException(JSON.parse(c(JSON.stringify(B.GENERAL_ERROR.PARAMETER_COMPULSORY),"GROUP_TYPE","GROUP_TYPE","Group type","Group type")));if(typeof t[B.GroupConstants.KEYS.TYPE]!==B.COMMON_UTILITY_CONSTANTS.TYPE_CONSTANTS.STRING)return new b.CometChatException(JSON.parse(c(JSON.stringify(B.GENERAL_ERROR.MUST_BE_A_STRING),"GROUP_TYPE","GROUP_TYPE","Group type")));if(k(t[B.GroupConstants.KEYS.TYPE]))return new b.CometChatException(JSON.parse(c(JSON.stringify(B.GENERAL_ERROR.INVALID_GROUP_PROPERTY),"GROUP_TYPE","GROUP_TYPE","type","type")));if(t[B.GroupConstants.KEYS.TYPE].toLowerCase()!=F.CometChat.GROUP_TYPE.PUBLIC&&t[B.GroupConstants.KEYS.TYPE].toLowerCase()!=F.CometChat.GROUP_TYPE.PASSWORD&&t[B.GroupConstants.KEYS.TYPE].toLowerCase()!=F.CometChat.GROUP_TYPE.PROTECTED&&t[B.GroupConstants.KEYS.TYPE].toLowerCase()!=F.CometChat.GROUP_TYPE.PRIVATE)return new b.CometChatException(B.GroupErrors.INVALID_GROUP_TYPE);if(t[B.GroupConstants.KEYS.TYPE].toLowerCase()==F.CometChat.GROUP_TYPE.PASSWORD){if(!t.hasOwnProperty(B.GroupConstants.KEYS.PASSWORD))return new b.CometChatException(JSON.parse(c(JSON.stringify(B.GENERAL_ERROR.PASSWORD_COMPULSORY),"PASSWORD","PASSWORD")));if(typeof t[B.GroupConstants.KEYS.PASSWORD]!==B.COMMON_UTILITY_CONSTANTS.TYPE_CONSTANTS.STRING)return new b.CometChatException(JSON.parse(c(JSON.stringify(B.GENERAL_ERROR.MUST_BE_A_STRING),"PASSWORD","PASSWORD","Password")));if(k(t[B.GroupConstants.KEYS.PASSWORD]))return new b.CometChatException(JSON.parse(c(JSON.stringify(B.GENERAL_ERROR.INVALID_GROUP_PROPERTY),"PASSWORD","PASSWORD","password","password")))}}else{if(void 0!==t){if(typeof t!==B.COMMON_UTILITY_CONSTANTS.TYPE_CONSTANTS.STRING)return new b.CometChatException(JSON.parse(c(JSON.stringify(B.GENERAL_ERROR.MUST_BE_A_STRING),"GUID","GUID","GUID")));if(k(t))return new b.CometChatException(JSON.parse(c(JSON.stringify(B.GENERAL_ERROR.INVALID_GROUP_PROPERTY),"GUID","GUID","GUID","GUID")))}if(void 0!==e){if(typeof e!==B.COMMON_UTILITY_CONSTANTS.TYPE_CONSTANTS.STRING)return new b.CometChatException(JSON.parse(c(JSON.stringify(B.GENERAL_ERROR.MUST_BE_A_STRING),"GROUP_TYPE","GROUP_TYPE","Group type")));if(k(e))return new b.CometChatException(JSON.parse(c(JSON.stringify(B.GENERAL_ERROR.INVALID_GROUP_PROPERTY),"GROUP_TYPE","GROUP_TYPE","type","type")));if(e.toLowerCase()!=F.CometChat.GROUP_TYPE.PUBLIC&&e.toLowerCase()!=F.CometChat.GROUP_TYPE.PASSWORD&&e.toLowerCase()!=F.CometChat.GROUP_TYPE.PROTECTED&&e.toLowerCase()!=F.CometChat.GROUP_TYPE.PRIVATE)return new b.CometChatException(B.GroupErrors.INVALID_GROUP_TYPE);if(e.toLowerCase()==F.CometChat.GROUP_TYPE.PASSWORD){if(typeof n!==B.COMMON_UTILITY_CONSTANTS.TYPE_CONSTANTS.STRING)return new b.CometChatException(JSON.parse(c(JSON.stringify(B.GENERAL_ERROR.MUST_BE_A_STRING),"PASSWORD","PASSWORD","Password")));if(k(n))return new b.CometChatException(JSON.parse(c(JSON.stringify(B.GENERAL_ERROR.INVALID_GROUP_PROPERTY),"PASSWORD","PASSWORD","password","password")))}}}},W.validateCreateGroup=function(t){if(!t.hasOwnProperty(B.GroupConstants.KEYS.GUID))return new b.CometChatException(JSON.parse(c(JSON.stringify(B.GENERAL_ERROR.PARAMETER_COMPULSORY),"GUID","GUID","GUID","GUID")));if(typeof t[B.GroupConstants.KEYS.GUID]!==B.COMMON_UTILITY_CONSTANTS.TYPE_CONSTANTS.STRING)return new b.CometChatException(JSON.parse(c(JSON.stringify(B.GENERAL_ERROR.MUST_BE_A_STRING),"GUID","GUID","GUID")));if(k(t[B.GroupConstants.KEYS.GUID]))return new b.CometChatException(JSON.parse(c(JSON.stringify(B.GENERAL_ERROR.INVALID_GROUP_PROPERTY),"GUID","GUID","GUID","GUID")));if(!t.hasOwnProperty(B.GroupConstants.KEYS.NAME))return new b.CometChatException(JSON.parse(c(JSON.stringify(B.GENERAL_ERROR.PARAMETER_COMPULSORY),"GROUP_NAME","GROUP_NAME","Group name","Group name")));if(typeof t[B.GroupConstants.KEYS.NAME]!==B.COMMON_UTILITY_CONSTANTS.TYPE_CONSTANTS.STRING)return new b.CometChatException(JSON.parse(c(JSON.stringify(B.GENERAL_ERROR.MUST_BE_A_STRING),"GROUP_NAME","GROUP_NAME","Group name")));if(k(t[B.GroupConstants.KEYS.NAME]))return new b.CometChatException(JSON.parse(c(JSON.stringify(B.GENERAL_ERROR.INVALID_GROUP_PROPERTY),"GROUP_NAME","GROUP_NAME","name","name")));if(!t.hasOwnProperty(B.GroupConstants.KEYS.TYPE))return new b.CometChatException(JSON.parse(c(JSON.stringify(B.GENERAL_ERROR.PARAMETER_COMPULSORY),"GROUP_TYPE","GROUP_TYPE","Group type","Group type")));if(typeof t[B.GroupConstants.KEYS.TYPE]!==B.COMMON_UTILITY_CONSTANTS.TYPE_CONSTANTS.STRING)return new b.CometChatException(JSON.parse(c(JSON.stringify(B.GENERAL_ERROR.MUST_BE_A_STRING),"GROUP_TYPE","GROUP_TYPE","Group type")));if(k(t[B.GroupConstants.KEYS.TYPE]))return new b.CometChatException(JSON.parse(c(JSON.stringify(B.GENERAL_ERROR.INVALID_GROUP_PROPERTY),"GROUP_TYPE","GROUP_TYPE","type","type")));if(t[B.GroupConstants.KEYS.TYPE].toLowerCase()!=F.CometChat.GROUP_TYPE.PUBLIC&&t[B.GroupConstants.KEYS.TYPE].toLowerCase()!=F.CometChat.GROUP_TYPE.PASSWORD&&t[B.GroupConstants.KEYS.TYPE].toLowerCase()!=F.CometChat.GROUP_TYPE.PROTECTED&&t[B.GroupConstants.KEYS.TYPE].toLowerCase()!=F.CometChat.GROUP_TYPE.PRIVATE)return new b.CometChatException(B.GroupErrors.INVALID_GROUP_TYPE);if(t[B.GroupConstants.KEYS.TYPE].toLowerCase()==F.CometChat.GROUP_TYPE.PASSWORD){if(!t.hasOwnProperty(B.GroupConstants.KEYS.PASSWORD))return new b.CometChatException(JSON.parse(c(JSON.stringify(B.GENERAL_ERROR.PASSWORD_COMPULSORY),"PASSWORD","PASSWORD")));if(typeof t[B.GroupConstants.KEYS.PASSWORD]!==B.COMMON_UTILITY_CONSTANTS.TYPE_CONSTANTS.STRING)return new b.CometChatException(JSON.parse(c(JSON.stringify(B.GENERAL_ERROR.MUST_BE_A_STRING),"PASSWORD","PASSWORD","Password")));if(k(t[B.GroupConstants.KEYS.PASSWORD]))return new b.CometChatException(JSON.parse(c(JSON.stringify(B.GENERAL_ERROR.INVALID_GROUP_PROPERTY),"PASSWORD","PASSWORD","password","password")))}if(t.hasOwnProperty(B.GroupConstants.KEYS.TAGS)){if(!Array.isArray(t[B.GroupConstants.KEYS.TAGS]))return new b.CometChatException(JSON.parse(c(JSON.stringify(B.GENERAL_ERROR.MUST_BE_AN_ARRAY),"GROUP_TAGS","GROUP_TAGS","Group tags")));if(0===t[B.GroupConstants.KEYS.TAGS].length)return new b.CometChatException(JSON.parse(c(JSON.stringify(B.GENERAL_ERROR.EMPTY_ARRAY),"GROUP_TAGS","GROUP_TAGS","Group tags")))}},W.validateId=function(t,e){if("user"===e){if(typeof t!==B.COMMON_UTILITY_CONSTANTS.TYPE_CONSTANTS.STRING)return new b.CometChatException(JSON.parse(c(JSON.stringify(B.GENERAL_ERROR.MUST_BE_A_STRING),"UID","UID","UID")));if(k(t))return new b.CometChatException(JSON.parse(c(JSON.stringify(B.GENERAL_ERROR.INVALID),"UID","UID","UID","UID")))}if("group"===e){if(typeof t!==B.COMMON_UTILITY_CONSTANTS.TYPE_CONSTANTS.STRING)return new b.CometChatException(JSON.parse(c(JSON.stringify(B.GENERAL_ERROR.MUST_BE_A_STRING),"GUID","GUID","GUID")));if(k(t))return new b.CometChatException(JSON.parse(c(JSON.stringify(B.GENERAL_ERROR.INVALID),"GUID","GUID","GUID","GUID")))}},W.validateHideMessagesFromBlockedUsers=function(t){if(typeof t!==B.COMMON_UTILITY_CONSTANTS.TYPE_CONSTANTS.BOOLEAN)return new b.CometChatException(JSON.parse(c(JSON.stringify(B.GENERAL_ERROR.MUST_BE_A_BOOLEAN),"HIDE_MESSAGES_FROM_BLOCKED_USERS","HIDE_MESSAGES_FROM_BLOCKED_USERS","hideMessagesFromBlockedUsers")))},W.validateArray=function(t,e){var n="List should be an array.";return n="blockUsers"===e?"blockUsers() method accepts an array of users.":"unblockUsers"===e?"unblockUsers() method accepts an array of users.":"groupMembers"===e?"addMembersToGroup() method accepts members list as an array of users.":"addMembersToGroup() method accepts bannedMembers list as an array of users.",typeof t!=B.COMMON_UTILITY_CONSTANTS.TYPE_CONSTANTS.OBJECT?new b.CometChatException(JSON.parse(c(JSON.stringify(B.GENERAL_ERROR.INVALID_ARRAY),"USER_LIST","USER_LIST",n))):Array.isArray(t)?void 0:new b.CometChatException(JSON.parse(c(JSON.stringify(B.GENERAL_ERROR.INVALID_ARRAY),"USER_LIST","USER_LIST",n)))},W.validateMsgId=function(t){return isNaN(t)?new b.CometChatException(JSON.parse(c(JSON.stringify(B.GENERAL_ERROR.MUST_BE_A_NUMBER),"MESSAGE_ID","MESSAGE_ID","Message Id"))):k(t)?new b.CometChatException(e.ERRORS.PARAMETER_MISSING):void 0},W.validateChatType=function(t){return typeof t!==B.COMMON_UTILITY_CONSTANTS.TYPE_CONSTANTS.STRING?new b.CometChatException(JSON.parse(c(JSON.stringify(B.GENERAL_ERROR.MUST_BE_A_STRING),"RECEIVER_TYPE","RECEIVER_TYPE","Receiver type"))):k(t)?new b.CometChatException(JSON.parse(c(JSON.stringify(B.GENERAL_ERROR.INVALID),"RECEIVER_TYPE","RECEIVER_TYPE","receiver type","receiver type"))):t!=B.MessageConstatnts.RECEIVER_TYPE.GROUP&&t!=B.MessageConstatnts.RECEIVER_TYPE.USER?new b.CometChatException(B.MessageErrors.INVALID_RECEIVER_TYPE):void 0},W.validateMessage=function(t){var e=t;if(typeof e.getReceiverId()!==B.COMMON_UTILITY_CONSTANTS.TYPE_CONSTANTS.STRING)return new b.CometChatException(JSON.parse(c(JSON.stringify(B.GENERAL_ERROR.MUST_BE_A_STRING),"RECEIVER_ID","RECEIVER_ID","Receiver Id")));if(k(e.getReceiverId()))return new b.CometChatException(JSON.parse(c(JSON.stringify(B.GENERAL_ERROR.INVALID),"RECEIVER_ID","RECEIVER_ID","receiver id","receiver id")));if(typeof e.getReceiverType()!==B.COMMON_UTILITY_CONSTANTS.TYPE_CONSTANTS.STRING)return new b.CometChatException(JSON.parse(c(JSON.stringify(B.GENERAL_ERROR.MUST_BE_A_STRING),"RECEIVER_TYPE","RECEIVER_TYPE","Receiver Type")));if(k(e.getReceiverType()))return new b.CometChatException(JSON.parse(c(JSON.stringify(B.GENERAL_ERROR.INVALID),"RECEIVER_TYPE","RECEIVER_TYPE","receiver type","receiver type")));if(e.getReceiverType()!=B.MessageConstatnts.RECEIVER_TYPE.GROUP&&e.getReceiverType()!=B.MessageConstatnts.RECEIVER_TYPE.USER)return new b.CometChatException(B.MessageErrors.INVALID_RECEIVER_TYPE);if(t instanceof i.TextMessage){var n=t;if(typeof n.getText()!==B.COMMON_UTILITY_CONSTANTS.TYPE_CONSTANTS.STRING)return new b.CometChatException(JSON.parse(c(JSON.stringify(B.GENERAL_ERROR.MUST_BE_A_STRING),"MESSAGE_TEXT","MESSAGE_TEXT","Message text")));if(""===n.getText().trim())return new b.CometChatException(JSON.parse(c(JSON.stringify(B.GENERAL_ERROR.EMPTY_STRING),"MESSAGE_TEXT","MESSAGE_TEXT","Message text")))}if(t instanceof a.MediaMessage){var o=t;if(o.getData()&&o.getData().hasOwnProperty("attachments"))for(var s=o.getAttachments(),r=0;r<s.length;r++){if(!s[r].getExtension())return new b.CometChatException(JSON.parse(c(JSON.stringify(B.GENERAL_ERROR.MISSING_KEY),"extension","Attachment")));if(!s[r].getMimeType())return new b.CometChatException(JSON.parse(c(JSON.stringify(B.GENERAL_ERROR.MISSING_KEY),"mimeType","Attachment")));if(!s[r].getName())return new b.CometChatException(JSON.parse(c(JSON.stringify(B.GENERAL_ERROR.MISSING_KEY),"name","Attachment")));if(!s[r].getUrl())return new b.CometChatException(JSON.parse(c(JSON.stringify(B.GENERAL_ERROR.MISSING_KEY),"url","Attachment")))}if(o.hasOwnProperty("files"))for(r=0;r<o.files.length;r++){if(typeof o.files[r]!==B.COMMON_UTILITY_CONSTANTS.TYPE_CONSTANTS.OBJECT)return new b.CometChatException(JSON.parse(c(JSON.stringify(B.GENERAL_ERROR.MUST_BE_A_OBJECT),"MEDIA_OBJECT","MEDIA_OBJECT","Media object")));if(k(o.files[r])&&!(o.files[r]instanceof Blob))return new b.CometChatException(JSON.parse(c(JSON.stringify(B.GENERAL_ERROR.INVALID),"MEDIA_OBJECT","MEDIA_OBJECT","Media object","Media object")))}}if(t instanceof E.CustomMessage&&k(t.getCustomData()))return new b.CometChatException(JSON.parse(c(JSON.stringify(B.GENERAL_ERROR.INVALID),"CUSTOM_DATA","CUSTOM_DATA","custom data","custom data")))},W.validateCreateUser=function(t){if(!t.hasOwnProperty(B.UserConstants.UID))return new b.CometChatException(JSON.parse(c(JSON.stringify(B.GENERAL_ERROR.PARAMETER_COMPULSORY),"UID","UID","UID","UID")));if(typeof t[B.UserConstants.UID]!==B.COMMON_UTILITY_CONSTANTS.TYPE_CONSTANTS.STRING)return new b.CometChatException(JSON.parse(c(JSON.stringify(B.GENERAL_ERROR.MUST_BE_A_STRING),"UID","UID","UID")));if(k(t[B.UserConstants.UID]))return new b.CometChatException(JSON.parse(c(JSON.stringify(B.GENERAL_ERROR.INVALID_USER_PROPERTY),"UID","UID","UID","UID")));if(!t.hasOwnProperty(B.UserConstants.NAME))return new b.CometChatException(JSON.parse(c(JSON.stringify(B.GENERAL_ERROR.PARAMETER_COMPULSORY),"USER_NAME","USER_NAME","User name","User name")));if(typeof t[B.UserConstants.NAME]!==B.COMMON_UTILITY_CONSTANTS.TYPE_CONSTANTS.STRING)return new b.CometChatException(JSON.parse(c(JSON.stringify(B.GENERAL_ERROR.MUST_BE_A_STRING),"USER_NAME","USER_NAME","User name")));if(k(t[B.UserConstants.NAME]))return new b.CometChatException(JSON.parse(c(JSON.stringify(B.GENERAL_ERROR.INVALID_USER_PROPERTY),"USER_NAME","USER_NAME","name","name")));if(t.hasOwnProperty(B.UserConstants.AVATAR)&&""===t[B.UserConstants.AVATAR])return new b.CometChatException(JSON.parse(c(JSON.stringify(B.GENERAL_ERROR.EMPTY_STRING),"USER_AVATAR","USER_AVATAR","User avatar")));if(t.hasOwnProperty(B.UserConstants.META_DATA)&&""===t[B.UserConstants.META_DATA])return new b.CometChatException(JSON.parse(c(JSON.stringify(B.GENERAL_ERROR.EMPTY_STRING),"USER_METADATA","USER_METADATA","User metadata")));if(t.hasOwnProperty(B.UserConstants.LINK)&&""===t[B.UserConstants.LINK])return new b.CometChatException(JSON.parse(c(JSON.stringify(B.GENERAL_ERROR.EMPTY_STRING),"USER_LINK","USER_LINK","User link")));if(t.hasOwnProperty(B.UserConstants.STATUS_MESSAGE)&&""===t[B.UserConstants.STATUS_MESSAGE])return new b.CometChatException(JSON.parse(c(JSON.stringify(B.GENERAL_ERROR.EMPTY_STRING),"USER_STATUS_MESSAGE","USER_STATUS_MESSAGE","User status message")));if(t.hasOwnProperty(B.UserConstants.ROLE)&&""===t[B.UserConstants.ROLE])return new b.CometChatException(JSON.parse(c(JSON.stringify(B.GENERAL_ERROR.EMPTY_STRING),"USER_ROLE","USER_ROLE","User role")));if(t.hasOwnProperty(B.UserConstants.TAGS)){if(!Array.isArray(t[B.UserConstants.TAGS]))return new b.CometChatException(JSON.parse(c(JSON.stringify(B.GENERAL_ERROR.MUST_BE_AN_ARRAY),"USER_TAGS","USER_TAGS","User tags")));if(0===t[B.UserConstants.TAGS].length)return new b.CometChatException(JSON.parse(c(JSON.stringify(B.GENERAL_ERROR.EMPTY_ARRAY),"USER_TAGS","USER_TAGS","User tags")))}},W.validateUpdateUser=function(t){return t.hasOwnProperty(B.UserConstants.UID)?typeof t[B.UserConstants.UID]!==B.COMMON_UTILITY_CONSTANTS.TYPE_CONSTANTS.STRING?new b.CometChatException(JSON.parse(c(JSON.stringify(B.GENERAL_ERROR.MUST_BE_A_STRING),"UID","UID","UID"))):k(t[B.UserConstants.UID])?new b.CometChatException(JSON.parse(c(JSON.stringify(B.GENERAL_ERROR.INVALID_USER_PROPERTY),"UID","UID","UID","UID"))):t.hasOwnProperty(B.UserConstants.NAME)&&""===t[B.UserConstants.NAME]?new b.CometChatException(JSON.parse(c(JSON.stringify(B.GENERAL_ERROR.EMPTY_STRING),"USER_NAME","USER_NAME","User name"))):void 0:new b.CometChatException(JSON.parse(c(JSON.stringify(B.GENERAL_ERROR.PARAMETER_COMPULSORY),"UID","UID","UID","UID")))},W.validateConversationType=function(t){return typeof t!==B.COMMON_UTILITY_CONSTANTS.TYPE_CONSTANTS.STRING?new b.CometChatException(JSON.parse(c(JSON.stringify(B.GENERAL_ERROR.MUST_BE_A_STRING),"CONVERSATION_TYPE","CONVERSATION_TYPE","Conversation type"))):k(t)?new b.CometChatException(JSON.parse(c(JSON.stringify(B.GENERAL_ERROR.INVALID),"CONVERSATION_TYPE","CONVERSATION_TYPE","conversation type","conversation type"))):(t=t.toLowerCase())!=F.CometChat.RECEIVER_TYPE.USER&&t!=F.CometChat.RECEIVER_TYPE.GROUP?new b.CometChatException(B.ConversationErrors.INVALID_CONVERSATION_TYPE):void 0},W.getKeyprefix=function(t,e){switch(t){case B.LOCAL_STORE.COMMON_STORE:return c(B.LOCAL_STORE.KEY_STRING,c(B.LOCAL_STORE.STORE_STRING,F.CometChat.getAppId(),B.LOCAL_STORE.COMMON_STORE),e);case B.LOCAL_STORE.KEYS_STORE:return c(B.LOCAL_STORE.KEY_STRING,c(B.LOCAL_STORE.STORE_STRING,F.CometChat.getAppId(),B.LOCAL_STORE.KEYS_STORE),e);case B.LOCAL_STORE.MESSAGES_STORE:return c(B.LOCAL_STORE.KEY_STRING,c(B.LOCAL_STORE.STORE_STRING,F.CometChat.getAppId(),B.LOCAL_STORE.MESSAGES_STORE),e);case B.LOCAL_STORE.MESSAGE_LISTENERS_LIST:return c(B.LOCAL_STORE.KEY_STRING,c(B.LOCAL_STORE.STORE_STRING,F.CometChat.getAppId(),B.LOCAL_STORE.MESSAGE_LISTENERS_LIST),e);case B.LOCAL_STORE.USERS_STORE:return c(B.LOCAL_STORE.KEY_STRING,c(B.LOCAL_STORE.STORE_STRING,F.CometChat.getAppId(),B.LOCAL_STORE.USERS_STORE),e)}},W.isCallingComponentInstalled=function(){return!!(K.hasOwnProperty("CometChatCalling")&&K.CometChatCalling&&K.CometChatCalling.hasOwnProperty("isCallingComponentInstalled")&&K.CometChatCalling.isCallingComponentInstalled)},W.getCallSettings=function(w){return new Promise(function(o,t){var s,r,i,a,E,c,u,S,p,C,l,T={};i=F.CometChat.getActiveCall(),E=F.CometChat.user;var g,d,_,h,R,A,I,f,O,N,m,y,L,M,P,v,U,D,Y,G=!0;H().then(function(t){if(u=t[B.APP_SETTINGS.KEYS.WEBRTC_HOST],T[B.APP_SETTINGS.KEYS.ANALYTICS_HOST]=t[B.APP_SETTINGS.KEYS.ANALYTICS_HOST],T[B.APP_SETTINGS.KEYS.ANALYTICS_VERSION]=t[B.APP_SETTINGS.KEYS.ANALYTICS_VERSION],T[B.APP_SETTINGS.KEYS.ANALYTICS_PING_DISABLED]=t[B.APP_SETTINGS.KEYS.ANALYTICS_PING_DISABLED],T[B.APP_SETTINGS.KEYS.ANALYTICS_USE_SSL]=t[B.APP_SETTINGS.KEYS.ANALYTICS_USE_SSL],s=t[B.APP_SETTINGS.KEYS.REGION],w.getCallEventListener()&&J.CallController.getInstance().setCallListner(w.getCallEventListener()),W.isCallingComponentInstalled())if(S=K.CometChatCalling.CometChatCalls,p=K.CometChatCalling.CallEventListener,C=K.CometChatCalling.CallScreen,l=K.CometChatCalling.CometChatRTC,k(F.CometChat.appSettings))J.CallController.getInstance().getCallListner()&&J.CallController.getInstance().getCallListner()._eventListener.onError(new b.CometChatException(B.CALL_ERROR.NOT_INITIALIZED));else{if(!s)return G=!1,void(J.CallController.getInstance().getCallListner()&&J.CallController.getInstance().getCallListner()._eventListener.onError(new b.CometChatException(B.CALL_ERROR.NOT_INITIALIZED)));if(F.CometChat.getAppId()){if(r=F.CometChat.getAppId(),!E)return G=!1,void(J.CallController.getInstance().getCallListner()&&J.CallController.getInstance().getCallListner()._eventListener.onError(new b.CometChatException(B.CALL_ERROR.NOT_LOGGED_IN)));if(i){var e=i.getType();g=e===B.CallConstants.CALL_TYPE.AUDIO,d=i.getSessionId()}else{if(g=w.isAudioOnlyCall(),k(w.getSessionId()))return void(J.CallController.getInstance().getCallListner()&&J.CallController.getInstance().getCallListner()._eventListener.onError(new b.CometChatException(B.CALL_ERROR.SESSION_ID_REQUIRED)));d=("v1."+s+"."+F.CometChat.getAppId()+"."+w.getSessionId()).toLowerCase()}if(!d)return G=!1,void(J.CallController.getInstance().getCallListner()&&J.CallController.getInstance().getCallListner()._eventListener.onError(new b.CometChatException(B.CALL_ERROR.SESSION_ID_REQUIRED)));if(_=w.isDefaultLayoutEnabled(),h=w.isAudioModeButtonEnabled(),R=w.isPauseVideoButtonEnabled(),A=w.isMuteAudioButtonEnabled(),I=w.isSwitchCameraButtonEnabled(),f=w.isEndCallButtonEnabled(),O=w.getMode(),N=w.getStartWithAudioMuted(),m=w.getStartWithVideoMuted(),y=w.getDefaultAudioMode(),L=!!g&&w.isAudioToVideoButtonEnabled(),M=w.getAvatarMode(),P=w.isRecordingButtonEnabled(),v=w.shouldStartRecordingOnCallStart(),U=w.getMainVideoContainerSetting(),D=w.isVideoTileClickEnabled(),Y=w.isVideoTileDragEnabled(),G){var n={uid:E.getUid(),sessionId:d};F.CometChat.getInstance().getJWT(n).then(function(t){t.hasOwnProperty("token")?((c=new V.RTCUser(E.getUid())).setName(E.getName()),c.setAvatar(E.getAvatar()),c.setResource(F.CometChat.getSessionId()),c.setJWT(t.token),a=(new x.CallSettingsBuilder).setSessionID(d).enableDefaultLayout(_).setIsAudioOnlyCall(g).setUser(c).setRegion(s).setAppId(r).setDomain(u).showAudioModeButton(h).showEndCallButton(f).showMuteAudioButton(A).showPauseVideoButton(R).showSwitchCameraButton(I).setMode(O).setAnalyticsSettings(T).startWithAudioMuted(N).startWithVideoMuted(m).setDefaultAudioMode(y).showSwitchToVideoCallButton(L).setAvatarMode(M).showRecordingButton(P).startRecordingOnCallStart(v).setMainVideoContainerSetting(U).enableVideoTileClick(D).enableVideoTileDrag(Y).build(),J.CallController.getInstance().callStarted(),o({callSettingsNew:a,call:i,CometChatCalls:S,CallEventListener:p,CallScreen:C,CometChatRTC:l})):J.CallController.getInstance().getCallListner()&&J.CallController.getInstance().getCallListner()._eventListener.onError(new b.CometChatException(B.CALL_ERROR.JWT_NOT_FOUND))},function(t){J.CallController.getInstance().getCallListner()&&J.CallController.getInstance().getCallListner()._eventListener.onError(new b.CometChatException(t))})}}else J.CallController.getInstance().getCallListner()&&J.CallController.getInstance().getCallListner()._eventListener.onError(new b.CometChatException(B.CALL_ERROR.NOT_INITIALIZED))}else J.CallController.getInstance().getCallListner()&&J.CallController.getInstance().getCallListner()._eventListener.onError(new b.CometChatException(B.CALL_ERROR.MODULE_NOT_INSTALLED))})})},W.updatePropertiesWithDynamicValue=function(n,o,s){return new Promise(function(t,e){!function t(e){for(var n in e)e.hasOwnProperty(n)&&("object"==typeof e[n]?t(e[n]):"string"==typeof e[n]&&e[n].includes(o)&&!e[n].includes(B.ADDITIONAL_CONSTANTS.SECURE_URL_PROPERTY)&&(e[n]+=s))}(n),t(n)})}}).call(this,r(32))},function(t,e,n){"use strict";e.__esModule=!0,e.ADDITIONAL_CONSTANTS=e.ONLINE_MEMBER_COUNT_API=e.JWT_API=e.ProsodyApiErrors=e.PROSODY_API=e.API_ERROR_CODES=e.CONNECTION_STATUS=e.COMMON_UTILITY_CONSTANTS=e.APP_SETTINGS=e.PresenceConstatnts=e.FeatureRestrictionErrors=e.MessageErrors=e.ExtensionErrors=e.AIErrors=e.ConversationErrors=e.GroupErrors=e.UserErrors=e.ReceiptErrors=e.GENERAL_ERROR=e.PARAMETER_ERROR=e.CALL_ERROR=e.Errors=e.UserConstants=e.GroupMemersConstans=e.GroupConstants=e.CallConstants=e.BlockedUsersConstants=e.ActionConstatnts=e.TYPING_NOTIFICATION=e.MessageCategory=e.ATTACHMENTS_CONSTANTS=e.MessageConstatnts=e.READ_RECEIPTS=e.DELIVERY_RECEIPTS=e.ResponseConstants=e.LOCAL_STORE=e.ANALYTICS=e.WS=e.SDKHeader=e.APPINFO=e.GROUP_MEMBER_SCOPE=e.GroupMemberScope=e.GROUP_TYPE=e.GroupType=e.DEFAULT_VALUES=e.constants=void 0;var o,s,r,i=n(2);e.constants={DEFAULT_STORE:"cometchat",MSG_VER_PRE:"store-ver-pre",MSG_VER_POST:"store-ver-post"},e.DEFAULT_VALUES={ZERO:0,MSGS_LIMIT:30,MSGS_MAX_LIMIT:100,USERS_LIMIT:30,USERS_MAX_LIMIT:100,GROUPS_LIMIT:30,GROUPS_MAX_LIMIT:100,CONVERSATION_MAX_LIMIT:50,CALL_TIMEOUT:45,DEFAULT_MSG_ID:0,DEFAULT_MAX_TYPING_INDICATOR_LIMIT:5,REGION_DEFAULT:"eu",REGION_DEFAULT_EU:"eu",REGION_DEFAULT_US:"us",REGION_DEFAULT_IN:"in",REGION_DEFAULT_PRIVATE:"private"},(o=e.GroupType||(e.GroupType={})).Public="public",o.Private="private",o.Protected="protected",o.Password="password",e.GROUP_TYPE={PUBLIC:"public",PRIVATE:"private",PROTECTED:"password",PASSWORD:"password"},(s=e.GroupMemberScope||(e.GroupMemberScope={})).Admin="admin",s.Moderator="moderator",s.Member="member",e.GROUP_MEMBER_SCOPE={ADMIN:"admin",MODERATOR:"moderator",PARTICIPANT:"participant"},e.APPINFO={platform:"REACT_NATIVE",sdkVersion:"v4.0.0",apiVersion:"v3.0",sdkVersionWithUnderScore:"4_0_0",userAgent:"cc_react_native_sdk"},e.SDKHeader={platform:"react-native",sdkVersion:"4.0.0",sdk:"%s@%s"},e.WS={CONVERSATION:{TYPE:{CHAT:"chat",GROUP_CHAT:"groupchat"}}},e.ANALYTICS={analyticsHost:"metrics-%s.cometchat.io",analyticsVersion:"v1"},e.LOCAL_STORE={COMMON_STORE:"common_store",MESSAGE_LISTENERS_LIST:"message_listeners_list",USERS_STORE:"users_store",MESSAGES_STORE:"messages_store",KEYS_STORE:"keys_store",STORE_STRING:"%s:%s",KEY_STRING:"%s/%s",KEY_USER:"user",KEY_APP_SETTINGS:"app_settings",KEY_APP_ID:"appId",KEY_DEVICE_ID:"deviceId",KEY_MESSAGE_LISTENER_LIST:"all"},e.ResponseConstants={RESPONSE_KEYS:{KEY_DATA:"data",KEY_META:"meta",KEY_CURSOR:"cursor",KEY_ACTION:"action",KEY_MESSAGE:"message",KEY_ERROR:"error",KEY_ERROR_DETAILS:"details",KEY_ERROR_CODE:"code",KEY_ERROR_MESSAGE:"message",KEY_AUTH_TOKEN:"authToken",KEY_WS_CHANNEL:"wsChannel",KEY_IDENTITY:"identity",KEY_SERVICE:"identity",KEY_ENTITIES:"entities",KEY_ENTITITY:"entity",KEY_ENTITYTYPE:"entityType",KEY_ATTACHMENTS:"attachments",CODE_REQUEST_OK:200,CODE_BAD_REQUEST:401,UNREAD_UNDELIVERED_KEYS:{ENTITY:"entity",ENTITY_TYPE:"entityType",ENTITY_Id:"entityId",COUNT:"count"},GROUP_MEMBERS_RESPONSE:{SUCCESS:"success",ERROR:"error",MESSAGE:"message"},KEY_ENTITY_TYPE:{USER:"user",GROUP:"group"},KEY_CONVERSATION_STARTER:"conversation-starters",KEY_SMART_REPLIES:"smart-replies"}},e.DELIVERY_RECEIPTS={RECEIVER_ID:"receiverId",RECEIVER_TYPE:"type",RECIPIENT:"recipient",MESSAGE_ID:"messageId",RECEIVED:"delivered",DELIVERED_AT:"deliveredAt",ID:"id",TIME:"time",DELIVERED_TO_ME_AT:"deliveredToMeAt"},e.READ_RECEIPTS={RECEIVER_ID:"receiverId",RECEIVER_TYPE:"type",RECIPIENT:"recipient",MESSAGE_ID:"messageId",READ:"read",READ_AT:"readAt",ID:"id",TIME:"time",READ_BY_ME_AT:"readByMeAt"},e.MessageConstatnts={TYPE:{TEXT:"text",MEDIA:"media",IMAGE:"image",VIDEO:"video",AUDIO:"audio",FILE:"file",CUSTOM:"custom"},CATEGORY:{MESSAGE:"message",ACTION:"action",CALL:"call",CUSTOM:"custom"},RECEIVER_TYPE:{USER:"user",GROUP:"group"},KEYS:{ATTATCHMENT:"attatchment",ATTATCHMENTS:"attachments",ACTION:"action",TYPE:"type",DATA:"data",ID:"id",MUID:"muid",SENDER:"sender",RECEIVER:"receiver",RECEIVER_ID:"receiverId",CATEGORY:"category",RECEIVER_TYPE:"receiverType",SENT_AT:"sentAt",STATUS:"status",TEXT:"text",URL:"url",METADATA:"metadata",RECEIPTS:"receipts",MY_RECEIPTS:"myReceipt",CUSTOM_DATA:"customData",CUSTOM_SUB_TYPE:"subType",RESOURCE:"resource"},KNOWN_MEDIA_TYPE:{IMAGE:[],VIDEO:[],AUDIO:[],FILE:[]},PAGINATION:{AFFIX:{APPEND:"append",PREPEND:"prepend"},CURSOR_FILEDS:{ID:"id",SENT_AT:"sentAt"},CURSOR_AFFIX_DEFAULT:"prepend",CURSOR_FIELD_DEFAULT:"sentAt",KEYS:{PER_PAGE:"per_page",CURSOR_AFFIX:"cursorAffix",AFFIX:"affix",CURSOR_FIELD:"cursorField",CURSOR_VALUE:"cursorValue",UID:"uid",SENT_AT:"sentAt",ID:"id",CURRENT_PAGE:"page",UNREAD:"unread",HIDE_MESSAGES_FROM_BLOCKED_USER:"hideMessagesFromBlockedUsers",SEARCH_KEY:"searchKey",ONLY_UPDATES:"onlyUpdates",UPDATED_AT:"updatedAt",CATEGORY:"category",CATEGORIES:"categories",TYPE:"type",TYPES:"types",HIDE_REPLIES:"hideReplies",HIDE_DELETED_MESSAGES:"hideDeleted",WITH_TAGS:"withTags",TAGS:"tags"}}},e.ATTACHMENTS_CONSTANTS={KEYS:{EXTENSION:"extension",MIME_TYPE:"mimeType",NAME:"name",SIZE:"size",URL:"url"}},(r=e.MessageCategory||(e.MessageCategory={})).ACTION="action",r.MESSAGE="message",r.CALL="call",r.CUSTOM="custom",e.TYPING_NOTIFICATION={RECEIVER_ID:"receiverId",RECEIVER_TYPE:"receiverType",META:"metadata",KEYS:{TYPING_NOTIFICATION:"typingNotification",TIMESTAMP:"timestamp"},ACTIONS:{STARTED:"started",ENDED:"ended"}},e.ActionConstatnts={ACTION_SUBJECTS:{ACTION_ON:"on",ACTION_BY:"by",ACTION_FOR:"for"},ACTION_ENTITY_TYPE:{GROUP_USER:"groupuser",USER:"user",GROUP:"group",MESSAGE:"message"},ACTION_KEYS:{ACTION_CREATED:"created",ACTION_UPDATED:"updated",ACTION_DELETED:"deleted",ENTITIES:"entities",ENTITY:"entity",ENTITY_TYPE:"entityType",TYPE_MEMBER_JOINED:"joined",TYPE_MEMBER_LEFT:"left",TYPE_MEMBER_KICKED:"kicked",TYPE_MEMBER_BANNED:"banned",TYPE_MEMBER_UNBANNED:"unbanned",TYPE_MEMBER_INVITED:"invited",TYPE_MEMBER_ADDED:"added",ACTION_SCOPE_CHANGED:"scopeChanged",ACTION_TYPE_USER:"user",ACTION_TYPE_GROUP:"group",ACTION_TYPE_GROUP_MEMBER:"groupMember",TYPE_MESSAGE_EDITED:"edited",TYPE_MESSAGE_DELETED:"deleted",ACTION_TYPE_CALL:"call",EXTRAS:"extras",SCOPE:"scope",NEW:"new",OLD:"old"},ActionMessages:{ACTION_GROUP_JOINED_MESSAGE:"%s joined",ACTION_GROUP_LEFT_MESSAGE:"%s left",ACTION_MEMBER_KICKED_MESSAGE:"%s kicked %s",ACTION_MEMBER_BANNED_MESSAGE:"%s banned %s",ACTION_MEMBER_UNBANNED_MESSAGE:"%s unbanned %s",ACTION_MEMBER_INVITED_MESSAGE:"%s banned %s",ACTION_MESSAGE_EDITED_MESSAGE:" Message Edited",ACTION_MESSAGE_DELETED_MESSAGE:"Message Deleted",ACTION_MEMBER_SCOPE_CHANGED:"%s made %s %s",ACTION_MEMBER_ADDED_TO_GROUP:"%s added %s"},ACTION_TYPE:{TYPE_MEMBER_JOINED:"joined",TYPE_MEMBER_LEFT:"left",TYPE_MEMBER_KICKED:"kicked",TYPE_MEMBER_BANNED:"banned",TYPE_MEMBER_UNBANNED:"unbanned",TYPE_MEMBER_INVITED:"invited",TYPE_MEMBER_SCOPE_CHANGED:"scopeChanged",TYPE_MESSAGE:"message",TYPE_MESSAGE_EDITED:"edited",TYPE_MESSAGE_DELETED:"deleted",TYPE_MEMBER_ADDED:"added"},ACTIONS:{MEMBER_ADDED:"added",MEMBER_JOINED:"joined",MEMBER_LEFT:"left",MEMBER_KICKED:"kicked",MEMBER_BANNED:"banned",MEMBER_UNBANNED:"unbanned",MEMBER_INVITED:"invited",MEMBER_SCOPE_CHANGED:"scopeChanged",MESSAGE_EDITED:"edited",MESSSAGE_DELETED:"deleted",TYPE_USER:"user",TYPE_GROUP:"group",TYPE_GROUP_MEMBER:"groupMember"}},e.BlockedUsersConstants={REQUEST_KEYS:{DIRECTIONS:{BOTH:"both",HAS_BLOCKED_ME:"hasBlockedMe",BLOCKED_BY_ME:"blockedByMe"}}},e.CallConstants={CALL_MODE:{DEFAULT:"DEFAULT",SPOTLIGHT:"SPOTLIGHT",SINGLE:"SINGLE"},AUDIO_MODE:{SPEAKER:"SPEAKER",EARPIECE:"EARPIECE",BLUETOOTH:"BLUETOOTH",HEADPHONES:"HEADPHONES"},CALL_TYPE:{AUDIO:"audio",VIDEO:"video"},RECEIVER_TYPE_GROUP:"group",RECEIVER_TYPE_USER:"user",CALL_KEYS:{CALL_DATA:"data",CALL_ID:"id",CALL_SESSION_ID:"sessionid",CALL_RECEIVER:"receiver",CALL_SENDER:"sender",CALL_RECEIVER_TYPE:"receiverType",CALL_STATUS:"status",CALL_TYPE:"type",CALL_INITIATED_AT:"initiatedAt",CALL_JOINED_AT:"joinedAt",CALL_LEFT_AT:"leftAt",CALL_METADATA:"metadata",CALL_ENTITIES:"entities",CALL_ENTITY_TYPE:"entityType",CALL_ENTITY:"entity",CALL_ENTITY_USER:"user",CALL_ENTITY_GROUP:"group"},CALL_STATUS:{INITIATED:"initiated",ONGOING:"ongoing",UNANSWERED:"unanswered",REJECTED:"rejected",BUSY:"busy",CANCELLED:"cancelled",ENDED:"ended"},ZOOM_BUTTON_DEFAULT_PARAMS:{position:"bottom-right",visible:!0},FULL_SCREEN_BUTTON_DEFAULT_PARAMS:{position:"bottom-right",visible:!0},USER_LIST_BUTTON_DEFAULT_PARAMS:{position:"bottom-right",visible:!0},NAME_LABEL_DEFAULT_PARAMS:{position:"bottom-left",visible:!0,color:"#333333"},MAIN_VIDEO_CONTAINER_SETTINGS:{KEYS:{POSITION:"position",VISIBILITY:"visibility",COLOR:"color"}}},e.GroupConstants={KEYS:{NAME:"name",GUID:"guid",TYPE:"type",PASSWORD:"password",ICON:"icon",DESCRIPTION:"description",OWNER:"owner",METADATA:"metadata",CREATED_AT:"createdAt",UPDATED_AT:"updatedAt",HAS_JOINED:"hasJoined",WS_CHANNEL:"wsChannel",TAGS:"tags"}},e.GroupMemersConstans={KEYS:{SCOPE:"scope",UID:"uid",GUID:"guid",USER:"user",NAME:"name"}},e.UserConstants={UID:"uid",NAME:"name",AUTH_TOKEN:"authToken",AVATAR:"avatar",LAST_ACTIVE_AT:"lastActiveAt",LINK:"link",META_DATA:"metadata",ROLE:"role",STATUS:"status",STATUS_MESSAGE:"statusMessage",USER_NAME:"user_name",TAGS:"tags",SORT_BY:{NAME:"name",STATUS:"status"},SORT_ORDER:{ASCENDING:"asc",DESCENDING:"desc"}},e.Errors={ERROR_IO_EXCEPTION:"ERROR_IO_EXCEPTION",ERROR_JSON_EXCEPTION:"ERROR_JSON_EXCEPTION",ERROR_PASSWORD_MISSING:"ERROR_PASSWORD_MISSING",ERROR_LIMIT_EXCEEDED:"ERROR_LIMIT_EXCEEDED",ERROR_USER_NOT_LOGGED_IN:"ERROR_USER_NOT_LOGGED_IN",ERROR_INVALID_GUID:"ERROR_INVALID_GUID",ERROR_PASSWORD_MISSING_MESSAGE:"Password is mandatory for a password group",ERROR_LIMIT_EXCEEDED_MESSAGE:"Limit Exceeded Max limit of %s",ERROR_USER_NOT_LOGGED_IN_MESSAGE:"Please log in to CometChat before calling this method",ERROR_INVALID_GUID_MESSAGE:"Please provide a valid GUID",ERROR_DEFAULT_MESSAGE:"Something went wrong",ERR_SETTINGS_HASH_OUTDATED:"ERR_SETTINGS_HASH_OUTDATED",ERR_NO_AUTH:"ERR_NO_AUTH"},e.CALL_ERROR={CALL_ALREADY_INITIATED:{code:"CALL_ALREADY_INITIATED",name:"CALL_ALREADY_INITIATED",message:"There is already call in progress",details:{}},ERROR_IN_CALLING:{code:"CALL_IN_PROGRESS",name:"CALL_ALREADY_INITIATED",message:"There is already call in progress",details:{}},CANNOT_ACCEPT_CALL:{code:"OTHER_CALL_ONGOING",name:"OTHER_CALL_ONGOING",message:"There is already a call in progress",details:{}},NOT_INITIALIZED:{code:"NOT_INITIALIZED",name:"NOT_INITIALIZED",message:"Please call the CometChat.init() method before calling any other methods related to CometChat.",details:{}},NOT_LOGGED_IN:{code:"NOT_LOGGED_IN",name:"NOT_LOGGED_IN",message:"Please login before starting a call.",details:{}},SESSION_ID_REQUIRED:{code:"SESSION_ID_REQUIRED",name:"SESSION_ID_REQUIRED",message:"Please make sure you are passing correct session id.",details:{}},JWT_NOT_FOUND:{code:"JWT_NOT_FOUND",name:"JWT_NOT_FOUND",message:"There was some issue while fetching JWT from API.",details:{}},MODULE_NOT_INSTALLED:{code:"ERROR_CALL_MODULE_NOT_FOUND",name:"ERROR_CALL_MODULE_NOT_FOUND",message:"CometChat Calling module not found. Please add the CometChat Calling dependency and try again.",details:{}}},e.PARAMETER_ERROR={PARAMETER_REQUIRED:{code:"%s_NOT_PROVIDED",name:"%s_NOT_PROVIDED",message:"please provide the %s.",details:{}}},e.GENERAL_ERROR={MUST_BE_A_STRING:{code:"INVALID_%s",name:"INVALID_%s",message:"%s should be a string.",details:{}},MUST_BE_A_NUMBER:{code:"INVALID_%s",name:"INVALID_%s",message:"%s should be a number.",details:{}},MUST_BE_A_OBJECT:{code:"INVALID_%s",name:"INVALID_%s",message:"%s should be a object.",details:{}},MUST_BE_AN_ARRAY:{code:"INVALID_%s",name:"INVALID_%s",message:"%s should be an array.",details:{}},MUST_BE_A_BOOLEAN:{code:"INVALID_%s",name:"INVALID_%s",message:"%s should be a boolean.",details:{}},MUST_BE_A_BLOB:{code:"INVALID_%s",name:"INVALID_%s",message:"%s should be a blob.",details:{}},INVALID:{code:"INVALID_%s",name:"INVALID_%s",message:"Invalid %s. Please provide a valid %s.",details:{}},METHOD_COMPULSORY:{code:"%s_IS_COMPULSORY",name:"%s_IS_COMPULSORY",message:"%s is required.",details:{}},LIMIT_EXCEEDED:{code:"ERROR_%s_EXCEEDED",name:"ERROR_%s_EXCEEDED",message:"Limit exceeded max limit of %s.",details:{}},MUST_BE_A_POSITIVE_NUMBER:{code:"INVALID_%s",name:"INVALID_%s",message:"%s should be a postive integer greater than 0.",details:{}},INVALID_MEDIA_FILE:{code:"INVALID_%s",name:"INVALID_%s",message:"The message type does not match the file's mime type.",details:{}},EMPTY_STRING:{code:"INVALID_%s",name:"INVALID_%s",message:"%s cannot be empty.",details:{}},MISSING_KEY:{code:"MISSING_KEY",name:"MISSING_KEY",message:"The key %s is missing from the %s object.",details:{}},EMPTY_ARRAY:{code:"INVALID_%s",name:"INVALID_%s",message:"The parameter %s should be an array and it cannot be empty.",details:{}},INVALID_SEARCH_KEYWORD:{code:"INVALID_SEARCH_KEYWORD",name:"INVALID_SEARCH_KEYWORD",message:"Invalid search keyword. Please provide a valid search keyword.",details:{}},INVALID_GROUP_PROPERTY:{code:"INVALID_%s",name:"INVALID_%s",message:"Invalid %s provided for the group. Please provide a valid %s.",details:{}},INVALID_USER_PROPERTY:{code:"INVALID_%s",name:"INVALID_%s",message:"Invalid %s provided for a user. Please provide a valid %s.",details:{}},PARAMETER_MUST_BE_A_NUMBER:{code:"INVALID_%s",name:"INVALID_%s",message:"%s method accepts parameter as a number.",details:{}},PARAMETER_MUST_BE_AN_ARRAY:{code:"INVALID_%s",name:"INVALID_%s",message:"%s method accepts parameter as an array.",details:{}},PARAMETER_MUST_BE_A_BOOLEAN:{code:"INVALID_%s",name:"INVALID_%s",message:"%s method accepts parameter as a boolean.",details:{}},PARAMETER_MUST_BE_A_POSITIVE_NUMBER:{code:"INVALID_%s",name:"INVALID_%s",message:"%s method accepts parameter to be a positive number greater than 0.",details:{}},PARAMETER_MUST_BE_A_STRING:{code:"INVALID_%s",name:"INVALID_%s",message:"%s method accepts parameter as a string.",details:{}},PARAMETER_COMPULSORY:{code:"%s_IS_COMPULSORY",name:"%s_IS_COMPULSORY",message:"%s cannot be blank. Please provide a valid %s.",details:{}},PASSWORD_COMPULSORY:{code:"%s_IS_COMPULSORY",name:"%s_IS_COMPULSORY",message:"Password is mandatory for a password group.",details:{}},INVALID_ARRAY:{code:"INVALID_%s",name:"INVALID_%s",message:"%s",details:{}}},e.ReceiptErrors={MISSING_PARAMETERS:{code:"MISSING_PARAMETERS",name:"MISSING_PARAMETERS",message:"Expected 4 parameters received 3",details:{}},INVALID_PARAMETER:{code:"INVALID_%s",name:"INVALID_%s",message:"%s",details:{}},NO_WEBSOCKET_CONNECTION:{code:"NO_WEBSOCKET_CONNECTION",name:"NO_WEBSOCKET_CONNECTION",message:"Connection to our Websockets server is broken. Please retry after some time.",details:{}},RECEIPTS_TEMPORARILY_BLOCKED:{code:"RECEIPTS_TEMPORARILY_BLOCKED",name:"RECEIPTS_TEMPORARILY_BLOCKED",message:"Due to high load. Receipts have been blocked for your app.",details:{}},UNKNOWN_ERROR_OCCURRED:{code:"UNKNOWN_ERROR_OCCURRED",name:"UNKNOWN_ERROR_OCCURRED",message:"Unknown error occurred while marking a message as read.",details:{}}},e.UserErrors={INVALID_STATUS:new i.CometChatException({code:"INVALID_STATUS_VALUE",name:"INVALID_STATUS_VALUE",message:"The `status` parameter accepts only `online` or `offline`.",details:""}),INVALID_DIRECTION:new i.CometChatException({code:"INVALID_DIRECTION_VALUE",name:"INVALID_DIRECTION_VALUE",message:"The `direction` parameter accepts only `both`, `blockeyByMe` or `hasBlockedMe`.",details:""}),USER_NOT_LOGGED_IN:new i.CometChatException({code:"USER_NOT_LOGGED_IN",name:"USER_NOT_LOGGED_IN",message:"Please log in to CometChat before calling this method.",details:""})},e.GroupErrors={NOT_A_GROUP:new i.CometChatException({code:"NOT_A_GROUP",message:"Please use group class to construct a new group."}),INVALID_SCOPE:new i.CometChatException({code:"INVALID_SCOPE_VALUE",name:"INVALID_SCOPE_VALUE",message:"Scope can be `admin`, `moderator` or `participant`.",details:""}),INVALID_GROUP_TYPE:new i.CometChatException({code:"INVALID_GROUP_TYPE",name:"INVALID_GROUP_TYPE",message:"Group type can be `public`, `private`, `protected` or `password`.",details:""})},e.ConversationErrors={INVALID_CONVERSATION_TYPE:{code:"INVALID_CONVERSATION_TYPE",name:"INVALID_CONVERSATION_TYPE",message:"Conversation type can be `user` or `group`.",details:"Please check the value of conversationType."},CONVERSATION_NOT_FOUND:{code:"CONVERSATION_NOT_FOUND",name:"CONVERSATION_NOT_FOUND",message:"Conversation for %s %s not found.",details:"Please check the value of conversationWith and conversationType."}},e.AIErrors={NO_CONVERSATION_STARTER:{code:"NO_CONVERSATION_STARTER",name:"NO_CONVERSATION_STARTER",message:"Unable to get conversation starter for this conversation.",details:""},NO_SMART_REPLY:{code:"NO_SMART_REPLY",name:"NO_SMART_REPLY",message:"Unable to get smart reply for this conversation.",details:""}},e.ExtensionErrors={INVALID_EXTENSION:{code:"ERROR_INVALID_EXTENSION",name:"ERROR_INVALID_EXTENSION",message:"The provided extension cannot be null or empty. Please provide a valid extension.",details:{}},EXTENSION_NOT_FOUND:{code:"ERROR_EXTENSION_NOT_FOUND",name:"ERROR_EXTENSION_NOT_FOUND",message:"The provided extension could not be found.",details:{}}},e.MessageErrors={INVALID_RECEIVER_TYPE:{code:"INVALID_RECEIVER_TYPE",name:"INVALID_RECEIVER_TYPE",message:"Receiver type can be `user` or `group`.",details:"Please check the value of receiverType."}},e.FeatureRestrictionErrors={INVALID_FEATURE:{code:"ERROR_INVALID_FEATURE",name:"ERROR_INVALID_FEATURE",message:"The provided feature cannot be null or empty. Please provide a valid feature.",details:{}},FEATURE_NOT_FOUND:{code:"ERROR_FEATURE_NOT_FOUND",name:"ERROR_FEATURE_NOT_FOUND",message:"The provided feature could not be found.",details:{}}},e.PresenceConstatnts={STATUS:{ONLINE:"online",AVAILABLE:"available",OFFLINE:"offline",JOINED:"JOINED",LEFT:"LEFT"}},e.APP_SETTINGS={APP_SETTINGS:"app_settings",KEYS:{CHAT_HOST:"CHAT_HOST",CHAT_USE_SSL:"CHAT_USE_SSL",GROUP_SERVICE:"GROUP_SERVICE",CALL_SERVICE:"CALL_SERVICE",CHAT_WS_PORT:"CHAT_WS_PORT",CHAT_WSS_PORT:"CHAT_WSS_PORT",CHAT_HTTP_BIND_PORT:"CHAT_HTTP_BIND_PORT",CHAT_HTTPS_BIND_PORT:"CHAT_HTTPS_BIND_PORT",ADMIN_API_HOST:"ADMIN_API_HOST",CLIENT_API_HOST:"CLIENT_API_HOST",WEBRTC_HOST:"WEBRTC_HOST",WEBRTC_USE_SSL:"WEBRTC_USE_SSL",WEBRTC_WS_PORT:"WEBRTC_WS_PORT",WEBRTC_WSS_PORT:"WEBRTC_WSS_PORT",WEBRTC_HTTP_BIND_PORT:"WEBRTC_HTTP_BIND_PORT",WEBRTC_HTTPS_BIND_PORT:"WEBRTC_HTTPS_BIND_PORT",EXTENSION_LIST:"extensions",EXTENSION_KEYS:{ID:"id",NAME:"name"},JID_HOST_OVERRIDE:"JID_HOST_OVERRIDE",CHAT_HOST_OVERRIDE:"CHAT_HOST_OVERRIDE",CHAT_HOST_APP_SPECIFIC:"CHAT_HOST_APP_SPECIFIC",MODE:"MODE",CONNECTION_TYPE:"connection_type",DEFAULT_MODE:"DEFAULT",LIMITED_TRANSIENT:"LIMITED_TRANSIENT",NO_TRANSIENT:"NO_TRANSIENT",POLLING_ENABLED:"POLLING_ENABLED",POLLING_INTERVAL:"POLLING_INTERVAL",ANALYTICS_PING_DISABLED:"ANALYTICS_PING_DISABLED",ANALYTICS_HOST:"ANALYTICS_HOST",ANALYTICS_VERSION:"ANALYTICS_VERSION",ANALYTICS_USE_SSL:"ANALYTICS_USE_SSL",SETTINGS_HASH:"settingsHash",SETTINGS_HASH_RECEIVED_AT:"settingsHashReceivedAt",DENY_FALLBACK_TO_POLLING:"DENY_FALLBACK_TO_POLLING",APP_VERSION:"APP_VERSION",MAIN_DOMAIN:"MAIN_DOMAIN",CHAT_API_VERSION:"CHAT_API_VERSION",WS_API_VERSION:"WS_API_VERSION",REGION:"REGION",EXTENSION_DOMAIN:"EXTENSION_DOMAIN",WEBRTC_API_SUBDOMAIN:"WEBRTC_API_SUBDOMAIN",SECURED_MEDIA_HOST:"SECURED_MEDIA_HOST"}},e.COMMON_UTILITY_CONSTANTS={TYPE_CONSTANTS:{BOOLEAN:"boolean",STRING:"string",OBJECT:"object",NUMBER:"number"}},e.CONNECTION_STATUS={CONNECTED:"connected",CONNECTING:"connecting",DISCONNECTED:"disconnected",FEATURE_THROTTLED:"featureThrottled"},e.API_ERROR_CODES={AUTH_ERR_AUTH_TOKEN_NOT_FOUND:"AUTH_ERR_AUTH_TOKEN_NOT_FOUND"},e.PROSODY_API={DOMAIN_PREFIX:"xmpp",PATH:{ROOM:"room",ROOM_SIZE:"room-size",SESSIONS:"sessions"},RESPONSE:{PARTICIPANTS:"participants"},QUERY_PARAMETERS:{DOMAIN:"domain",ROOM:"room"}},e.ProsodyApiErrors={INVALID_SESSIONID:{code:"ERROR_INVALID_SESSIONID",name:"ERROR_INVALID_SESSIONID",message:"The provided sessionId cannot be null or empty. Please provide a valid sessionId.",details:""},INVALID_TYPE:{code:"ERROR_INVALID_TYPE",name:"ERROR_INVALID_TYPE",message:"The provided type cannot be null or empty. Please provide a valid type.",details:""}},e.JWT_API={KEYS:{PASSTHROUGH:"passthrough",EXPAND:"expand"}},e.ONLINE_MEMBER_COUNT_API={ENDPOINTS:{GET_ONLINE_MEMBER_COUNT:"api/%s/online-members"},RESPONSE:{ONLINE_USERS_COUNT:"onlineUsersCount",GROUPS:"groups"},ERRORS:{INVALID_GROUPLIST:{code:"ERROR_INVALID_GROUPLIST",name:"ERROR_INVALID_GROUPLIST",message:"Grouplist cannot be null or empty.",details:""}}},e.ADDITIONAL_CONSTANTS={SECURE_URL_PROPERTY:"fat"}},function(t,e,n){"use strict";e.__esModule=!0,e.CometChatException=void 0;var o=function(t){null!==t.code&&void 0!==t.code&&""!==t.code&&(this.code=t.code),null!==t.name&&void 0!==t.name&&""!==t.name&&(this.name=t.name),null!==t.message&&void 0!==t.message&&""!==t.message&&(this.message=t.message),null!==t.details&&void 0!==t.details&&""!==t.details&&(this.details=t.details)};e.CometChatException=o},function(t,e,n){"use strict";var o,s=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});e.__esModule=!0,e.Me=e.User=void 0;var r=n(2),i=n(13),a=n(1),E=function(){function t(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(this.hasBlockedMe=!1,this.blockedByMe=!1,this.deactivatedAt=0,1===t.length)typeof t[0]===a.COMMON_UTILITY_CONSTANTS.TYPE_CONSTANTS.STRING?this.uid=t[0]:(this.uid=t[0].uid,this.name=t[0].name,t[0].authToken&&(this.authToken=t[0].authToken),t[0].avatar&&(this.avatar=t[0].avatar),t[0].lastActiveAt&&(this.lastActiveAt=t[0].lastActiveAt),t[0].link&&(this.link=t[0].link),t[0].metadata&&(this.metadata=t[0].metadata),t[0].role&&(this.role=t[0].role),t[0].statusMessage&&(this.statusMessage=t[0].statusMessage),t[0].status&&"offline"!==t[0].status?this.status="online":this.status="offline",t[0].tags&&(this.tags=t[0].tags),t[0].deactivatedAt&&(this.deactivatedAt=t[0].deactivatedAt));else{if(2!==t.length)throw new r.CometChatException(i.ERRORS.PARAMETER_MISSING);this.uid=t[0],this.name=t[1]}}return t.prototype.getUid=function(){return this.uid.toString()},t.prototype.setUid=function(t){this.uid=t},t.prototype.getName=function(){return this.name.toString()},t.prototype.setName=function(t){t&&(this.name=t)},t.prototype.getAuthToken=function(){return this.authToken},t.prototype.setAuthToken=function(t){this.authToken=t},t.prototype.getAvatar=function(){return this.avatar},t.prototype.setAvatar=function(t){this.avatar=t},t.prototype.getLastActiveAt=function(){return this.lastActiveAt},t.prototype.setLastActiveAt=function(t){this.lastActiveAt=t},t.prototype.getLink=function(){return this.link},t.prototype.setLink=function(t){return this.link=t},t.prototype.getMetadata=function(){return this.metadata},t.prototype.setMetadata=function(t){this.metadata=t},t.prototype.getRole=function(){return this.role},t.prototype.setRole=function(t){this.role=t},t.prototype.getStatus=function(){return this.status},t.prototype.setStatus=function(t){this.status=t},t.prototype.getStatusMessage=function(){return this.statusMessage},t.prototype.setStatusMessage=function(t){this.statusMessage=t},t.prototype.setBlockedByMe=function(t){this.blockedByMe=t},t.prototype.getBlockedByMe=function(){return this.blockedByMe},t.prototype.setHasBlockedMe=function(t){this.hasBlockedMe=t},t.prototype.getHasBlockedMe=function(){return this.hasBlockedMe},t.prototype.setTags=function(t){this.tags=t},t.prototype.getTags=function(){return this.tags},t.prototype.setDeactivatedAt=function(t){this.deactivatedAt=t},t.prototype.getDeactivatedAt=function(){return this.deactivatedAt},t}(),c=function(n){function t(t){var e=n.call(this,t)||this;return e.wsChannel=t.wsChannel,t.jwt&&(e.jwt=t.jwt),t.fat&&(e.fat=t.fat),e}return s(t,n),t.prototype.getWsChannel=function(){return this.wsChannel},t.prototype.getJWT=function(){return this.jwt},t.prototype.getFat=function(){return this.fat},t}(e.User=E);e.Me=c},function(t,e,n){"use strict";e.__esModule=!0,e.KEYS=e.AUTH=e.MESSAGE=e.PRESENCE=e.RECEIPTS=e.TRANSIENT_MESSAGE=e.TYPING_INDICATOR=e.LOGOUT_REASON=e.LOGOUT_CODE=e.READY_STATE=e.WS=void 0,e.WS={protocol:"wss://"},e.READY_STATE={CONNECTING:0,OPEN:1,CLOSING:2,CLOSED:3,INVALID_JWT:4},e.LOGOUT_CODE=1e3,e.LOGOUT_REASON="User logged out",e.TYPING_INDICATOR={TYPE:"typing_indicator",ACTION:{STARTED:"started",ENDED:"ended"}},e.TRANSIENT_MESSAGE={TYPE:"transient_message"},e.RECEIPTS={TYPE:"receipts",ACTION:{READ:"read",DELIVERED:"delivered"},RECEIPT_TYPE:{READ_RECEIPT:"read",DELIVERY_RECEIPT:"delivery"}},e.PRESENCE={TYPE:"presence",ACTION:{ONLINE:"online",AVAILABLE:"available",OFFLINE:"offline"}},e.MESSAGE={TYPE:"message"},e.AUTH={TYPE:"auth"},e.KEYS={TYPE:"type",ACTION:"action",APP_ID:"appId",RECEIVER:"receiver",RECEIVER_TYPE:"receiverType",DEVICE_ID:"deviceId",BODY:"body",USER:"user",METADATA:"metadata",MESSAGE_ID:"messageId",TIMESTAMP:"timestamp",STATUS:"status",CODE:"code",SENDER:"sender",MESSAGE_SENDER:"messageSender",PRESENCE_SUBSCRIPTION:"presenceSubscription",AUTH:"auth",PING:"ping",DATA:"data",PARAMS:"params",ACK:"ack",PONG:"pong"}},function(t,e,n){"use strict";var C=this&&this.__assign||function(){return(C=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var s in e=arguments[n])Object.prototype.hasOwnProperty.call(e,s)&&(t[s]=e[s]);return t}).apply(this,arguments)},E=this&&this.__awaiter||function(t,i,a,E){return new(a||(a=Promise))(function(n,e){function o(t){try{r(E.next(t))}catch(t){e(t)}}function s(t){try{r(E.throw(t))}catch(t){e(t)}}function r(t){var e;t.done?n(t.value):(e=t.value,e instanceof a?e:new a(function(t){t(e)})).then(o,s)}r((E=E.apply(t,i||[])).next())})},c=this&&this.__generator||function(n,o){var s,r,i,t,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return t={next:e(0),throw:e(1),return:e(2)},"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(s)throw new TypeError("Generator is already executing.");for(;a;)try{if(s=1,r&&(i=2&e[0]?r.return:e[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,e[1])).done)return i;switch(r=0,i&&(e=[2&e[0],i.value]),e[0]){case 0:case 1:i=e;break;case 4:return a.label++,{value:e[1],done:!1};case 5:a.label++,r=e[1],e=[0];continue;case 7:e=a.ops.pop(),a.trys.pop();continue;default:if(!(i=0<(i=a.trys).length&&i[i.length-1])&&(6===e[0]||2===e[0])){a=0;continue}if(3===e[0]&&(!i||e[1]>i[0]&&e[1]<i[3])){a.label=e[1];break}if(6===e[0]&&a.label<i[1]){a.label=i[1],i=e;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(e);break}i[2]&&a.ops.pop(),a.trys.pop();continue}e=o.call(n,a)}catch(t){e=[6,t],r=0}finally{s=i=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}};e.__esModule=!0,e.CometChat=void 0;var u=n(31),g=n(0),d=n(2),_=n(6),l=n(3),h=n(14),S=n(18),p=n(7),R=n(17),A=n(10),I=n(11),f=n(1),a=n(8),O=n(16),r=n(36),o=n(21),s=n(24),N=n(15),m=n(13),i=n(23),y=n(46),L=n(47),M=n(48),P=n(49),v=n(51),U=n(52),D=n(27),Y=n(28),G=n(40),w=n(20),K=n(38),B=n(54),b=n(55),F=n(56),x=n(39),V=n(26),J=n(19),k=n(34),H=n(35),T=n(57),W=n(41),j=n(4),X=n(65),q=n(33),Q=n(29),Z=n(22),z=n(42),$=n(66),tt=n(70),et=T.WSConnectionHelper.getInstance(),nt=W.ListenerHandlers.getInstance(),ot=function(){function T(t){var n=this;try{T.appId=t,T.localStorage=h.LocalStorage.getInstance(),T.keyStore=r.KeyStore.getInstance(),Z.AppState.addEventListener("change",function(t){var e;T.appSettings.shouldAutoEstablishSocketConnection()?"active"===t?(T.isAppInactive=!1,T.connect(),T.callWaitTimer&&n.clearCallWaitTimer()):(T.isAppInactive=!0,(null===(e=null==T?void 0:T.getActiveCall())||void 0===e?void 0:e.getStatus())===f.CallConstants.CALL_STATUS.INITIATED?n.startCallWaitTimer():T.disconnectInternally()):"active"===t?(T.isAppInactive=!1,!z.checkConnection(et.connection)&&T.disconnectedByUser||T.startAnalyticsPingTimer()):(T.isAppInactive=!0,T.clearAnalyticsPingTimer())})}catch(t){g.Logger.error("CometChat: constructor",t)}}return T.ping=function(t){var e=t||{},n=e.onError,o=e.onSuccess;this.currentConnectionStatus===f.CONNECTION_STATUS.CONNECTED?T.user?et.pingWS({onError:n,onSuccess:o}):n&&n(new d.CometChatException({code:f.Errors.ERROR_USER_NOT_LOGGED_IN,message:f.Errors.ERROR_USER_NOT_LOGGED_IN_MESSAGE})):n&&n(new d.CometChatException(f.ReceiptErrors.NO_WEBSOCKET_CONNECTION))},T.prototype.startCallWaitTimer=function(){var t=this;T.callWaitTimer=setInterval(function(){try{1<T.callWaitTime?T.callWaitTime=T.callWaitTime-1:1===T.callWaitTime&&(T.disconnectInternally(),t.clearCallWaitTimer())}catch(t){g.Logger.error("CometChat: startCallWaitTimer",t)}},1e3)},T.prototype.clearCallWaitTimer=function(){try{clearInterval(T.callWaitTimer),T.callWaitTime=30}catch(t){g.Logger.error("CometChat: clearCallWaitTimer",t)}},T.setAuthToken=function(t){try{T.authToken=t}catch(t){g.Logger.error("CometChat: setAuthToken",t)}},T.prototype.getAuthToken=function(){try{return T.authToken}catch(t){g.Logger.error("CometChat: getAuthToken",t)}},T.getAppId=function(){try{return T.appId}catch(t){g.Logger.error("CometChat: getAppId",t)}},T.prototype.getApiKey=function(){try{return T.apiKey}catch(t){g.Logger.error("CometChat: getApiKey",t)}},T.getMode=function(){try{return T.mode}catch(t){g.Logger.error("CometChat: getMode",t)}},T.setMode=function(t){try{T.mode=t}catch(t){g.Logger.error("CometChat: getMode",t)}},T.getSessionId=function(){try{return T.sessionId}catch(t){g.Logger.error("CometChat: getSessionId",t)}},T.didAnalyticsPingStart=function(){try{return T.isAnalyticsPingStarted}catch(t){g.Logger.error("CometChat: didAnalyticsPingStart",t)}},T.init=function(s,t){var o=this;return void 0===s&&(s=""),new Promise(function(n,e){try{"object"==typeof s&&(s.hasOwnProperty("appId")&&(s=s.appId),s.hasOwnProperty("appSettings")&&(t=s.appSettings)),g.isFalsy(t)?t=(new b.AppSettingsBuilder).setRegion(b.AppSettings.REGION_EU).build():t.getRegion()==b.AppSettings.REGION_PRIVATE&&(t.region=s),o.appSettings=t,g.isFalsy(s)?e(new d.CometChatException(m.INIT_ERROR.NO_APP_ID)):(o.initialzed=!0,T.appId=s,T.getInstance(s),T.sessionId=f.APPINFO.platform+"-"+f.APPINFO.sdkVersionWithUnderScore+"-"+tt()+"-"+(new Date).getTime(),h.LocalStorage.getInstance().get(f.LOCAL_STORE.KEY_APP_ID).then(function(t){if(null==t||null==t)T.appId=s,T.getInstance(s),h.LocalStorage.getInstance().set(f.LOCAL_STORE.KEY_APP_ID,s),n(!0);else{var e=t.toLocaleString();e===s?(T.appId=e,T.getInstance(e),h.LocalStorage.getInstance().get(f.LOCAL_STORE.KEY_USER).then(function(t){t?(T.isLoggedOut=!1,T.user=new l.Me(t),T.setAuthToken(T.user.getAuthToken()),t.jwt&&(T.jwt=t.jwt),n(!0),h.LocalStorage.getInstance().get(f.LOCAL_STORE.KEY_APP_SETTINGS).then(function(t){if(t){if(t.hasOwnProperty(f.APP_SETTINGS.KEYS.APP_VERSION)){var e=parseInt(f.APPINFO.sdkVersion.charAt(1));t[f.APP_SETTINGS.KEYS.APP_VERSION]<e&&3!==t[f.APP_SETTINGS.KEYS.APP_VERSION]&&(o.appSettings.shouldAutoEstablishSocketConnection()||(T.shouldConnectToWS=!1),T.getInstance().internalRestart(T.user.getAuthToken()))}else o.appSettings.shouldAutoEstablishSocketConnection()||(T.shouldConnectToWS=!1),T.getInstance().internalRestart(T.user.getAuthToken());t[f.APP_SETTINGS.KEYS.SECURED_MEDIA_HOST]&&(T.SECURED_MEDIA_HOST=t[f.APP_SETTINGS.KEYS.SECURED_MEDIA_HOST]),t[f.APP_SETTINGS.KEYS.MODE]&&(T.mode=t[f.APP_SETTINGS.KEYS.MODE]),t[f.APP_SETTINGS.KEYS.SETTINGS_HASH]&&(T.settingsHash=t[f.APP_SETTINGS.KEYS.SETTINGS_HASH]),t[f.APP_SETTINGS.KEYS.SETTINGS_HASH_RECEIVED_AT]&&(T.settingsHashReceivedAt=t[f.APP_SETTINGS.KEYS.SETTINGS_HASH_RECEIVED_AT]),T.isAnalyticsDisabled=!!t[f.APP_SETTINGS.KEYS.ANALYTICS_PING_DISABLED],T.didAnalyticsPingStart()||T.isAnalyticsDisabled||!o.appSettings.shouldAutoEstablishSocketConnection()||(T.pingAnalytics(),T.startAnalyticsPingTimer()),et&&!et.connection&&o.appSettings.shouldAutoEstablishSocketConnection()&&(T.isConnectingFromInit=!0,T.WSLogin(T.user))}})):n(!0)})):o.clearCache().then(function(){T.apiKey=void 0,T.user=void 0,T.authToken=void 0,T.cometChat=void 0,T.mode=void 0,et.WSLogout(),T.appId=s,h.LocalStorage.getInstance().set(f.LOCAL_STORE.KEY_APP_ID,s),T.getInstance(s),n(!0)})}r.KeyStore.getInstance().get(f.LOCAL_STORE.KEY_DEVICE_ID).then(function(t){if(null==t){var e=tt(),n=(new Date).getTime(),o=s+"_"+e+"_"+n;r.KeyStore.getInstance().set(f.LOCAL_STORE.KEY_DEVICE_ID,o)}})}))}catch(t){e(new d.CometChatException(t))}})},T.isInitialized=function(){try{return this.initialzed}catch(t){g.Logger.error("CometChat: isInitialized",t)}},T.getInstance=function(t){try{return this.cometChat||(this.cometChat=new T(t)),this.cometChat}catch(t){g.Logger.error("CometChat: getInstance",t)}},T.registerTokenForPushNotification=function(p,C){var l=this;return new Promise(function(u,S){try{T.keyStore.get(f.LOCAL_STORE.KEY_DEVICE_ID).then(function(c){g.getAppSettings().then(function(t){var e="",n=c,o=f.APPINFO.platform,s=f.APPINFO.sdkVersion,r=t[f.APP_SETTINGS.KEYS.CHAT_API_VERSION];if(navigator&&(e=navigator.userAgent),null==n){var i=tt(),a=(new Date).getTime();n=l.appId+"_"+i+"_"+a,T.keyStore.set(f.LOCAL_STORE.KEY_DEVICE_ID,n)}var E={platform:o,deviceId:n,appInfo:{version:s,apiVersion:r,userAgent:e,pushNotification:{fcmDeviceToken:p,settings:C}}};_.makeApiCall("updateMyDetails",{},E,!1).then(function(t){u("Token Registration successful")},function(t){S(new d.CometChatException(t.error))}).catch(function(t){S(new d.CometChatException(t))})},function(t){return S(new d.CometChatException(t))})})}catch(t){S(new d.CometChatException(t))}})},T.pushToLoginListener=function(e,n){nt.loginHandlers.map(function(t){try{if(t._eventListener)switch(n){case"Login_Success":g.isFalsy(t._eventListener.loginSuccess)||t._eventListener.loginSuccess(e);break;case"Login_Failure":g.isFalsy(t._eventListener.loginFailure)||t._eventListener.loginFailure(e);break;case"Logout_Success":g.isFalsy(t._eventListener.logoutSuccess)||t._eventListener.logoutSuccess()}}catch(t){g.Logger.error("ConnectionHandlers: onConnected Status",t)}})},T.login=function(){for(var E=this,c=[],t=0;t<arguments.length;t++)c[t]=arguments[t];return new Promise(function(i,a){try{if(T.loginInProgress){T.isLoggedOut=!0;var e=new d.CometChatException(m.LOGIN_ERROR.REQUEST_IN_PROGRESS);return a(e)}T.loginInProgress=!0,T.isConnectingFromInit=!1,T.localStorage.get(f.LOCAL_STORE.KEY_APP_ID).then(function(t){if(null==t||null==t){var e=new d.CometChatException(m.LOGIN_ERROR.NOT_INITIALIZED);return T.internalRestart||T.pushToLoginListener(e,"Login_Failure"),T.loginInProgress=!1,T.isLoggedOut=!0,a(e)}var n=t.toLocaleString();if(E.getInstance(n),T.appId=n,h.LocalStorage.getInstance().set(f.LOCAL_STORE.KEY_APP_ID,n),"object"==typeof c[0]){var o=c[0];c[0].hasOwnProperty("authToken")?c[0]=o.authToken:c[0].hasOwnProperty("username")&&c[0].hasOwnProperty("apiKey")&&(c[0]=o.username,c[1]=o.apiKey)}if(2==c.length){if(g.isFalsy(c[0])||g.isFalsy(c[1])){e=new d.CometChatException(m.ERRORS.PARAMETER_MISSING);return T.internalRestart||T.pushToLoginListener(e,"Login_Failure"),T.loginInProgress=!1,T.isLoggedOut=!0,a(e)}}else{if(1!=c.length){e=new d.CometChatException(m.ERRORS.PARAMETER_MISSING);return T.internalRestart||T.pushToLoginListener(e,"Login_Failure"),T.loginInProgress=!1,T.isLoggedOut=!0,a(e)}if(g.isFalsy(c[0])){var e=new d.CometChatException(m.ERRORS.PARAMETER_MISSING);return T.internalRestart||T.pushToLoginListener(e,"Login_Failure"),T.loginInProgress=!1,T.isLoggedOut=!0,a(e)}}if(g.isFalsy(E.getAppId())){e=new d.CometChatException(m.LOGIN_ERROR.NOT_INITIALIZED);return T.internalRestart||T.pushToLoginListener(e,"Login_Failure"),T.loginInProgress=!1,T.isLoggedOut=!0,a(e)}return T.localStorage.get(f.LOCAL_STORE.KEY_USER).then(function(r){if(2==c.length){T.apiKey=c[1];var t=c[0];if(null!=r&&r.uid!==c[0])T.localStorage.clearStore().then(function(){et.WSLogout(),T.generateAuthToken(t).then(function(t){T.user=new l.Me(t),T.setAuthToken(T.user.getAuthToken()),T.getLoggedInUser().then(function(t){(T.user=new l.Me(t)).setAuthToken(T.authToken),T.setAuthToken(T.user.getAuthToken());var e=T.user;e.setStatus(f.PresenceConstatnts.STATUS.ONLINE),T.localStorage.set("user",e);var n=new l.User(e);i(n),T.isConnectingFromInit||T.internalRestart||T.pushToLoginListener(n,"Login_Success"),T.loginInProgress=!1,T.didAnalyticsPingStart()||T.isAnalyticsDisabled||!T.appSettings.shouldAutoEstablishSocketConnection()||(T.pingAnalytics(),T.startAnalyticsPingTimer()),T.isLoggedOut=!1,(T.appSettings.shouldAutoEstablishSocketConnection()||T.internalRestart)&&T.shouldConnectToWS&&T.WSLogin(T.user)},function(t){return T.internalRestart||T.pushToLoginListener(t,"Login_Failure"),T.loginInProgress=!1,T.isLoggedOut=!0,a(t)})},function(t){return T.internalRestart||T.pushToLoginListener(t,"Login_Failure"),T.loginInProgress=!1,T.isLoggedOut=!0,a(t)})});else{if(!g.isFalsy(T.authToken)){var e=new l.User(E.user);return T.internalRestart||T.pushToLoginListener(e,"Login_Success"),T.loginInProgress=!1,T.isLoggedOut=!1,i(e)}if(!g.isFalsy(t)){if(g.isFalsy(T.apiKey)){var n=new d.CometChatException(m.LOGIN_ERROR.UNAUTHORISED);return T.internalRestart||T.pushToLoginListener(n,"Login_Failure"),T.loginInProgress=!1,T.isLoggedOut=!0,a(n)}E.generateAuthToken(t).then(function(t){E.user=new l.Me(t),E.setAuthToken(T.user.getAuthToken()),E.getLoggedInUser().then(function(t){E.user=new l.Me(t),E.user.setAuthToken(T.authToken),E.setAuthToken(E.user.getAuthToken()),et.WSLogout();var e=E.user;e.setStatus(f.PresenceConstatnts.STATUS.ONLINE),E.localStorage.set("user",e);var n=new l.User(e);i(n),T.isConnectingFromInit||T.internalRestart||T.pushToLoginListener(n,"Login_Success"),T.loginInProgress=!1,T.didAnalyticsPingStart()||T.isAnalyticsDisabled||!T.appSettings.shouldAutoEstablishSocketConnection()||(T.pingAnalytics(),T.startAnalyticsPingTimer()),T.isLoggedOut=!1,(T.appSettings.shouldAutoEstablishSocketConnection()||T.internalRestart)&&T.shouldConnectToWS&&E.WSLogin(E.user)},function(t){return T.internalRestart||T.pushToLoginListener(t,"Login_Failure"),T.loginInProgress=!1,T.isLoggedOut=!0,a(t)})},function(t){return T.internalRestart||T.pushToLoginListener(t,"Login_Failure"),T.loginInProgress=!1,T.isLoggedOut=!0,a(t)})}}}else T.authToken=c[0],E.getLoggedInUser().then(function(t){if(t.authToken!=c[0]){var o=E;o.localStorage.clearStore().then(function(){et.WSLogout(),o.getLoggedInUser().then(function(t){(T.user=new l.Me(t)).setAuthToken(T.authToken),T.setAuthToken(T.user.getAuthToken());var e=T.user;e.setStatus(f.PresenceConstatnts.STATUS.ONLINE),o.localStorage.set("user",e);var n=new l.User(e);i(n),T.isConnectingFromInit||T.internalRestart||T.pushToLoginListener(n,"Login_Success"),T.loginInProgress=!1,T.didAnalyticsPingStart()||T.isAnalyticsDisabled||!T.appSettings.shouldAutoEstablishSocketConnection()||(T.pingAnalytics(),T.startAnalyticsPingTimer()),T.isLoggedOut=!1,(T.appSettings.shouldAutoEstablishSocketConnection()||T.internalRestart)&&T.shouldConnectToWS&&T.WSLogin(new l.Me(t))},function(t){return T.internalRestart||T.pushToLoginListener(t,"Login_Failure"),T.loginInProgress=!1,T.isLoggedOut=!0,a(t)})})}else{if(r){var e=new l.User(t);return T.internalRestart||T.pushToLoginListener(e,"Login_Success"),T.loginInProgress=!1,T.isLoggedOut=!1,i(e)}(T.user=new l.Me(t)).setAuthToken(T.authToken),T.setAuthToken(T.user.getAuthToken());var n=T.user;n.setStatus(f.PresenceConstatnts.STATUS.ONLINE),T.localStorage.set("user",n);var s=new l.User(n);i(s),T.isConnectingFromInit||T.internalRestart||T.pushToLoginListener(s,"Login_Success"),T.loginInProgress=!1,T.didAnalyticsPingStart()||T.isAnalyticsDisabled||!T.appSettings.shouldAutoEstablishSocketConnection()||(T.pingAnalytics(),T.startAnalyticsPingTimer()),T.isLoggedOut=!1,(T.appSettings.shouldAutoEstablishSocketConnection()||T.internalRestart)&&T.shouldConnectToWS&&T.WSLogin(new l.Me(t))}},function(t){return T.internalRestart||T.pushToLoginListener(t,"Login_Failure"),T.loginInProgress=!1,T.isLoggedOut=!0,a(t)})})})}catch(t){e=new d.CometChatException(t);return T.internalRestart||T.pushToLoginListener(e,"Login_Failure"),T.loginInProgress=!1,T.isLoggedOut=!0,a(e)}})},T.sendMessage=function(a){var t=this;return new Promise(function(r,i){return E(t,void 0,void 0,function(){var e,n,o,s=this;return c(this,function(t){try{return a instanceof R.TextMessage||a instanceof S.MediaMessage||a instanceof w.CustomMessage||(a=a[f.MessageConstatnts.KEYS.ATTATCHMENT]?(e=f.MessageConstatnts.TYPE.FILE,g.isImage(a[f.MessageConstatnts.KEYS.ATTATCHMENT])?e=f.MessageConstatnts.TYPE.IMAGE:g.isAudio(a[f.MessageConstatnts.KEYS.ATTATCHMENT])?e=f.MessageConstatnts.TYPE.AUDIO:g.isVideo(a[f.MessageConstatnts.KEYS.ATTATCHMENT])&&(e=f.MessageConstatnts.TYPE.VIDEO),new S.MediaMessage(a[f.MessageConstatnts.KEYS.RECEIVER_ID],a[f.MessageConstatnts.KEYS.ATTATCHMENT],e,a[f.MessageConstatnts.KEYS.RECEIVER_TYPE])):new R.TextMessage(a[f.MessageConstatnts.KEYS.RECEIVER_ID],a[f.MessageConstatnts.KEYS.TEXT],a[f.MessageConstatnts.KEYS.RECEIVER_TYPE])),(n=g.validateMessage(a))instanceof d.CometChatException?(i(n),[2]):(a.receiver=a.receiverId,delete a.receiverId,o=a.parentMessageId,[2,_.makeApiCall(o?"sendMessageInThread":"sendMessage",o?{parentId:o}:{},a,a instanceof S.MediaMessage).then(function(n){return E(s,void 0,void 0,function(){var e;return c(this,function(t){return e=A.MessageController.trasformJSONMessge(n.data),r(e),[2]})})},function(t){i(new d.CometChatException(t.error))})])}catch(t){i(new d.CometChatException(t))}return[2]})})})},T.sendDirectMessage=function(t){try{return Object.assign(t,{receiverType:f.MessageConstatnts.RECEIVER_TYPE.USER}),this.sendMessage(t)}catch(t){g.Logger.error("CometChat: sendDirectMessage",t)}},T.sendGroupMessage=function(t){try{return Object.assign(t,{receiverType:f.MessageConstatnts.RECEIVER_TYPE.GROUP}),this.sendMessage(t)}catch(t){g.Logger.error("CometChat: sendGroupMessage",t)}},T.sendMediaMessage=function(t){try{return this.sendMessage(t)}catch(t){g.Logger.error("CometChat: sendMediaMessage",t)}},T.sendCustomMessage=function(t){try{return this.sendMessage(t)}catch(t){g.Logger.error("CometChat: sendCustomMessage",t)}},T.getLastDeliveredMessageId=function(){return E(this,void 0,void 0,function(){var e;return c(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,D.MessageListnerMaping.getInstance().get(f.LOCAL_STORE.KEY_MESSAGE_LISTENER_LIST)];case 1:return[2,t.sent()];case 2:return e=t.sent(),g.Logger.error("CometChat: getLastDeliveredMessageId",e),[3,3];case 3:return[2]}})})},T.startTyping=function(t){try{if(g.isFalsy(t))return;var e=void 0,n=this.RECEIVER_TYPE.USER,o={};if(t instanceof Y.TypingIndicator)e=t.getReceiverId(),n=t.getReceiverType(),o=t.getMetadata();else{if(!t.hasOwnProperty(f.TYPING_NOTIFICATION.RECEIVER_ID))return;e=t[f.TYPING_NOTIFICATION.RECEIVER_ID],t.hasOwnProperty(f.TYPING_NOTIFICATION.RECEIVER_TYPE)&&(n=t[f.TYPING_NOTIFICATION.RECEIVER_TYPE]),t.hasOwnProperty(f.TYPING_NOTIFICATION.META)&&(o=t[f.TYPING_NOTIFICATION.META])}if(g.isFalsy(e))return;if(null==G.TypingNotificationController.getTypingStartedMap(e)){var s=T.getMode();return g.isFalsy(s)||s&&s!==f.APP_SETTINGS.KEYS.NO_TRANSIENT&&s!==f.APP_SETTINGS.KEYS.LIMITED_TRANSIENT?(et.startTypingIndicator(e,n,o),G.TypingNotificationController.addTypingStarted(e),void G.TypingNotificationController.removeTypingEnded(e)):void 0}}catch(t){g.Logger.error("CometChat: startTyping",t)}},T.endTyping=function(t){try{if(g.isFalsy(t))return;var e=void 0,n=this.RECEIVER_TYPE.USER,o={};if(t instanceof Y.TypingIndicator)e=t.getReceiverId(),n=t.getReceiverType(),o=t.getMetadata();else{if(!t.hasOwnProperty(f.TYPING_NOTIFICATION.RECEIVER_ID))return;e=t[f.TYPING_NOTIFICATION.RECEIVER_ID],t.hasOwnProperty(f.TYPING_NOTIFICATION.RECEIVER_TYPE)&&(n=t[f.TYPING_NOTIFICATION.RECEIVER_TYPE]),n=n==this.RECEIVER_TYPE.USER?f.WS.CONVERSATION.TYPE.CHAT:f.WS.CONVERSATION.TYPE.GROUP_CHAT,t.hasOwnProperty(f.TYPING_NOTIFICATION.META)&&(o=t[f.TYPING_NOTIFICATION.META])}if(g.isFalsy(e))return;if(null==G.TypingNotificationController.getTypingEndedMap(e)){var s=T.getMode();return g.isFalsy(s)||s&&s!==f.APP_SETTINGS.KEYS.NO_TRANSIENT&&s!==f.APP_SETTINGS.KEYS.LIMITED_TRANSIENT?(et.pauseTypingIndicator(e,n,o),G.TypingNotificationController.addTypingEnded(e),void G.TypingNotificationController.removeTypingStarted(e)):void 0}}catch(t){g.Logger.error("CometChat: endTyping",t)}},T.markAsRead=function(){for(var E=[],t=0;t<arguments.length;t++)E[t]=arguments[t];return new Promise(function(t,e){try{var n=void 0,o=void 0,s=void 0,r=void 0;if(3===E.length)return e(new d.CometChatException(f.ReceiptErrors.MISSING_PARAMETERS));if(4===E.length){if(g.isFalsy(E[0])||"string"!=typeof E[0])return e(new d.CometChatException(JSON.parse(g.format(JSON.stringify(f.ReceiptErrors.INVALID_PARAMETER),"MESSAGE_ID","MESSAGE_ID","Message ID should be a string."))));if(n=E[0],g.isFalsy(E[1])||"string"!=typeof E[1])return e(new d.CometChatException(JSON.parse(g.format(JSON.stringify(f.ReceiptErrors.INVALID_PARAMETER),"RECEIVER_ID","RECEIVER_ID","Receiver ID should be a string."))));if(o=E[1],g.isFalsy(E[2])||"string"!=typeof E[2])return e(new d.CometChatException(JSON.parse(g.format(JSON.stringify(f.ReceiptErrors.INVALID_PARAMETER),"RECEIVER_TYPE","RECEIVER_TYPE","Receiver type should be a string."))));if(s=E[2],g.isFalsy(E[3])||"string"!=typeof E[3])return e(new d.CometChatException(JSON.parse(g.format(JSON.stringify(f.ReceiptErrors.INVALID_PARAMETER),"SENDER_ID","SENDER_ID","Sender ID should be a string."))));r=E[3]}else{if(1!==E.length)return e(new d.CometChatException(JSON.parse(g.format(JSON.stringify(f.ReceiptErrors.INVALID_PARAMETER),"ARGUMENTS","ARGUMENTS","markAsRead() expects either 1 or 4 arguments."))));if(g.isFalsy(E[0])||!(E[0]instanceof p.BaseMessage))return e(new d.CometChatException(JSON.parse(g.format(JSON.stringify(f.ReceiptErrors.INVALID_PARAMETER),"MESSAGE","MESSAGE","Invalid message object received."))));var i=E[0];n=i.getId().toString(),o=(s=i.getReceiverType())===f.MessageConstatnts.RECEIVER_TYPE.USER?i.getSender().getUid()===T.user.getUid()?i.getReceiverId():i.getSender().getUid():i.getReceiverId(),r=i.getSender().getUid()}var a=T.getMode();return g.isFalsy(a)||a&&a!==f.APP_SETTINGS.KEYS.NO_TRANSIENT&&a!==f.APP_SETTINGS.KEYS.LIMITED_TRANSIENT?T.getConnectionStatus()===f.CONNECTION_STATUS.CONNECTED?(et.markAsRead(o,s,n,r),t()):e(new d.CometChatException(f.ReceiptErrors.NO_WEBSOCKET_CONNECTION)):e(new d.CometChatException(f.ReceiptErrors.RECEIPTS_TEMPORARILY_BLOCKED))}catch(t){return g.Logger.error("CometChat: markAsRead",t),e(new d.CometChatException(f.ReceiptErrors.UNKNOWN_ERROR_OCCURRED))}})},T.markAsDelivered=function(){for(var E=[],t=0;t<arguments.length;t++)E[t]=arguments[t];return new Promise(function(t,e){try{var n=void 0,o=void 0,s=void 0,r=void 0;if(3===E.length)return e(new d.CometChatException(f.ReceiptErrors.MISSING_PARAMETERS));if(4===E.length){if(g.isFalsy(E[0])||"string"!=typeof E[0])return e(new d.CometChatException(JSON.parse(g.format(JSON.stringify(f.ReceiptErrors.INVALID_PARAMETER),"MESSAGE_ID","MESSAGE_ID","Message ID should be a string."))));if(n=E[0],g.isFalsy(E[1])||"string"!=typeof E[1])return e(new d.CometChatException(JSON.parse(g.format(JSON.stringify(f.ReceiptErrors.INVALID_PARAMETER),"RECEIVER_ID","RECEIVER_ID","Receiver ID should be a string."))));if(o=E[1],g.isFalsy(E[2])||"string"!=typeof E[2])return e(new d.CometChatException(JSON.parse(g.format(JSON.stringify(f.ReceiptErrors.INVALID_PARAMETER),"RECEIVER_TYPE","RECEIVER_TYPE","Receiver type should be a string."))));if(s=E[2],g.isFalsy(E[3])||"string"!=typeof E[3])return e(new d.CometChatException(JSON.parse(g.format(JSON.stringify(f.ReceiptErrors.INVALID_PARAMETER),"SENDER_ID","SENDER_ID","Sender ID should be a string."))));r=E[3]}else{if(1!==E.length)return e(new d.CometChatException(JSON.parse(g.format(JSON.stringify(f.ReceiptErrors.INVALID_PARAMETER),"ARGUMENTS","ARGUMENTS","markAsDelivered() expects either 1 or 4 arguments."))));if(g.isFalsy(E[0])||!(E[0]instanceof p.BaseMessage))return e(new d.CometChatException(JSON.parse(g.format(JSON.stringify(f.ReceiptErrors.INVALID_PARAMETER),"MESSAGE","MESSAGE","Invalid message object received."))));var i=E[0];n=i.getId().toString(),o=(s=i.getReceiverType())===f.MessageConstatnts.RECEIVER_TYPE.USER?i.getSender().getUid()===T.user.getUid()?i.getReceiverId():i.getSender().getUid():i.getReceiverId(),r=i.getSender().getUid()}var a=T.getMode();return g.isFalsy(a)||a&&a!==f.APP_SETTINGS.KEYS.NO_TRANSIENT&&a!==f.APP_SETTINGS.KEYS.LIMITED_TRANSIENT?T.getConnectionStatus()===f.CONNECTION_STATUS.CONNECTED?(et.markAsDelivered(o,s,n,r),t()):e(new d.CometChatException(f.ReceiptErrors.NO_WEBSOCKET_CONNECTION)):e(new d.CometChatException(f.ReceiptErrors.RECEIPTS_TEMPORARILY_BLOCKED))}catch(t){return g.Logger.error("CometChat: markAsDelivered",t),e(new d.CometChatException(f.ReceiptErrors.UNKNOWN_ERROR_OCCURRED))}})},T.sendTransientMessage=function(t){try{if(g.isFalsy(t))return;var e=void 0,n=void 0,o={};if(!(t instanceof Q.TransientMessage))return;if(e=t.getReceiverId(),n=t.getReceiverType(),o=t.getData(),g.isFalsy(e)||g.isFalsy(n))return;var s=T.getMode();return g.isFalsy(s)||s&&s!==f.APP_SETTINGS.KEYS.NO_TRANSIENT?void et.sendTransientMessage(e,n,o):void 0}catch(t){g.Logger.error("CometChat: startTyping",t)}},T.getMessageDetails=function(t){return new Promise(function(e,n){try{g.isFalsy(t)?n(new d.CometChatException(m.ERRORS.PARAMETER_MISSING)):_.makeApiCall("getMessageDetails",{messageId:t}).then(function(t){e(A.MessageController.trasformJSONMessge(t.data))},function(t){g.Logger.error("CometChat:GetMessageDetails:",t),n(new d.CometChatException(t.error))})}catch(t){n(new d.CometChatException(t))}})},T.getMessageReceipts=function(o){return new Promise(function(e,n){try{var t=g.validateMsgId(o);if(t instanceof d.CometChatException)return void n(t);g.isFalsy(o)?n(new d.CometChatException(m.ERRORS.PARAMETER_MISSING)):_.makeApiCall("getMessageDetails",{messageId:o}).then(function(t){A.MessageController.getReceiptsFromJSON(t.data).then(function(t){e(t)},function(t){n(new d.CometChatException(t))})},function(t){g.Logger.error("CometChat:GetMessageDetails:",t),n(new d.CometChatException(t.error))})}catch(t){n(new d.CometChatException(t))}})},T.getUnreadMessageCount=function(n){void 0===n&&(n=!1);var s=0;return new Promise(function(o,e){try{var t=g.validateHideMessagesFromBlockedUsers(n);if(t instanceof d.CometChatException)return void e(t);n&&(s=1),_.makeApiCall("getMessages",{},{unread:1,count:1,hideMessagesFromBlockedUsers:s}).then(function(t){var e={},n={};t.data.map(function(t){t[f.ResponseConstants.RESPONSE_KEYS.UNREAD_UNDELIVERED_KEYS.ENTITY_TYPE]==f.MessageConstatnts.RECEIVER_TYPE.GROUP?n[t[f.ResponseConstants.RESPONSE_KEYS.UNREAD_UNDELIVERED_KEYS.ENTITY_Id]]=t[f.ResponseConstants.RESPONSE_KEYS.UNREAD_UNDELIVERED_KEYS.COUNT]:e[t[f.ResponseConstants.RESPONSE_KEYS.UNREAD_UNDELIVERED_KEYS.ENTITY_Id]]=t[f.ResponseConstants.RESPONSE_KEYS.UNREAD_UNDELIVERED_KEYS.COUNT]}),o({users:e,groups:n})},function(t){e(new d.CometChatException(t.error))})}catch(t){e(new d.CometChatException(t))}})},T.getUnreadMessageCountForAllUsers=function(o){void 0===o&&(o=!1);var s=0;return new Promise(function(n,e){try{var t=g.validateHideMessagesFromBlockedUsers(o);if(t instanceof d.CometChatException)return void e(t);o&&(s=1),_.makeApiCall("getMessages",{},{hideMessagesFromBlockedUsers:s,receiverType:f.MessageConstatnts.RECEIVER_TYPE.USER,unread:1,count:1}).then(function(t){var e={};t.data.map(function(t){e[t[f.ResponseConstants.RESPONSE_KEYS.UNREAD_UNDELIVERED_KEYS.ENTITY_Id]]=t[f.ResponseConstants.RESPONSE_KEYS.UNREAD_UNDELIVERED_KEYS.COUNT]}),n(C({},e))},function(t){e(new d.CometChatException(t.error))})}catch(t){e(new d.CometChatException(t))}})},T.getUnreadMessageCountForAllGroups=function(o){void 0===o&&(o=!1);var s=0;return new Promise(function(n,e){try{var t=g.validateHideMessagesFromBlockedUsers(o);if(t instanceof d.CometChatException)return void e(t);o&&(s=1),_.makeApiCall("getMessages",{},{hideMessagesFromBlockedUsers:s,receiverType:f.MessageConstatnts.RECEIVER_TYPE.GROUP,unread:1,count:1}).then(function(t){var e={};t.data.map(function(t){t[f.ResponseConstants.RESPONSE_KEYS.UNREAD_UNDELIVERED_KEYS.ENTITY_TYPE]==f.MessageConstatnts.RECEIVER_TYPE.GROUP&&(e[t[f.ResponseConstants.RESPONSE_KEYS.UNREAD_UNDELIVERED_KEYS.ENTITY_Id]]=t[f.ResponseConstants.RESPONSE_KEYS.UNREAD_UNDELIVERED_KEYS.COUNT])}),n(C({},e))},function(t){e(new d.CometChatException(t.error))})}catch(t){e(new d.CometChatException(t))}})},T.getUnreadMessageCountForUser=function(s,r){void 0===r&&(r=!1);var i=0;return new Promise(function(n,e){try{var t=g.validateId(s,"user");if(t instanceof d.CometChatException)return void e(t);var o=g.validateHideMessagesFromBlockedUsers(r);if(o instanceof d.CometChatException)return void e(o);r&&(i=1),_.makeApiCall("getUserMessages",{listId:s},{hideMessagesFromBlockedUsers:i,unread:1,count:1,uid:s}).then(function(t){var e={};t.data.map(function(t){e[t[f.ResponseConstants.RESPONSE_KEYS.UNREAD_UNDELIVERED_KEYS.ENTITY_Id]]=t[f.ResponseConstants.RESPONSE_KEYS.UNREAD_UNDELIVERED_KEYS.COUNT]}),n(C({},e))},function(t){e(new d.CometChatException(t.error))})}catch(t){e(new d.CometChatException(t))}})},T.getUnreadMessageCountForGroup=function(s,r){void 0===r&&(r=!1);var i=0;return new Promise(function(n,e){try{var t=g.validateId(s,"group");if(t instanceof d.CometChatException)return void e(t);var o=g.validateHideMessagesFromBlockedUsers(r);if(o instanceof d.CometChatException)return void e(o);r&&(i=1),_.makeApiCall("getGroupMessages",{listId:s},{hideMessagesFromBlockedUsers:i,unread:1,count:1,guid:s}).then(function(t){var e={};t.data.map(function(t){t[f.ResponseConstants.RESPONSE_KEYS.UNREAD_UNDELIVERED_KEYS.ENTITY_TYPE]==f.MessageConstatnts.RECEIVER_TYPE.GROUP&&(e[t[f.ResponseConstants.RESPONSE_KEYS.UNREAD_UNDELIVERED_KEYS.ENTITY_Id]]=t[f.ResponseConstants.RESPONSE_KEYS.UNREAD_UNDELIVERED_KEYS.COUNT])}),n(C({},e))},function(t){e(new d.CometChatException(t.error))})}catch(t){e(new d.CometChatException(t))}})},T.editMessage=function(o){return new Promise(function(e,n){try{var t=g.validateMsgId(o.getId());if(t instanceof d.CometChatException)return void n(t);_.makeApiCall("updateMessage",{messageId:o.getId()},o).then(function(t){e(A.MessageController.trasformJSONMessge(t.data).getActionOn())},function(t){n(new d.CometChatException(t.error))})}catch(t){n(new d.CometChatException(t))}})},T.deleteMessage=function(o){return new Promise(function(e,n){try{var t=g.validateMsgId(o);if(t instanceof d.CometChatException)return void n(t);_.makeApiCall("deleteMessage",{messageId:o},{id:o}).then(function(t){e(A.MessageController.trasformJSONMessge(t.data).getActionOn())},function(t){n(new d.CometChatException(t.error))})}catch(t){n(new d.CometChatException(t))}})},T.getOnlineUserCount=function(){return new Promise(function(o,s){try{g.getAppSettings().then(function(t){var e=g.format((new u.EndpointFactory).wsApi,g.getChatHost(t),g.format(f.ONLINE_MEMBER_COUNT_API.ENDPOINTS.GET_ONLINE_MEMBER_COUNT,t[f.APP_SETTINGS.KEYS.WS_API_VERSION])),n={appId:T.appId,Authorization:T.jwt,Accept:"application/json","Content-Type":"application/json"};_.postData(e,"POST",{},n,!1).then(function(t){return t.json()}).then(function(t){return t.hasOwnProperty(f.ResponseConstants.RESPONSE_KEYS.KEY_DATA)?o(t[f.ResponseConstants.RESPONSE_KEYS.KEY_DATA][f.ONLINE_MEMBER_COUNT_API.RESPONSE.ONLINE_USERS_COUNT]):s(new d.CometChatException(t.error))}).catch(function(){var t={error:m.FETCH_ERROR.ERROR_IN_API_CALL};return s(t)})},function(t){return s(new d.CometChatException(t))})}catch(t){return s(new d.CometChatException(t))}})},T.getOnlineGroupMemberCount=function(i){return new Promise(function(s,r){try{if(!i||0==i.length)return r(new d.CometChatException(f.ONLINE_MEMBER_COUNT_API.ERRORS.INVALID_GROUPLIST));g.getAppSettings().then(function(t){var e=g.format((new u.EndpointFactory).wsApi,g.getChatHost(t),g.format(f.ONLINE_MEMBER_COUNT_API.ENDPOINTS.GET_ONLINE_MEMBER_COUNT,t[f.APP_SETTINGS.KEYS.WS_API_VERSION])),n={groups:i},o={appId:T.appId,Authorization:T.jwt,Accept:"application/json","Content-Type":"application/json"};_.postData(e,"POST",n,o,!1).then(function(t){return t.json()}).then(function(t){return t.hasOwnProperty(f.ResponseConstants.RESPONSE_KEYS.KEY_DATA)?s(t[f.ResponseConstants.RESPONSE_KEYS.KEY_DATA][f.ONLINE_MEMBER_COUNT_API.RESPONSE.GROUPS]):r(new d.CometChatException(t.error))}).catch(function(){var t={error:m.FETCH_ERROR.ERROR_IN_API_CALL};return r(t)})},function(t){return r(new d.CometChatException(t))})}catch(t){return r(new d.CometChatException(t))}})},T.createUser=function(s,r){return new Promise(function(n,e){try{if(g.isFalsy(r))return void e(new d.CometChatException(JSON.parse(g.format(JSON.stringify(f.GENERAL_ERROR.INVALID),"AUTH_KEY","AUTH_KEY","AUTH_KEY","AUTH_KEY"))));T.apiKey=r;var t=g.validateCreateUser(s);if(t instanceof d.CometChatException)return void e(t);if(!(s instanceof l.User)){var o=void 0;if(!s.hasOwnProperty(f.UserConstants.UID))return void e(new d.CometChatException(m.ERRORS.PARAMETER_MISSING));if(!s.hasOwnProperty(f.UserConstants.NAME))return void e(new d.CometChatException(m.ERRORS.PARAMETER_MISSING));o=new l.User(s[f.UserConstants.UID],s[f.UserConstants.NAME]),s.hasOwnProperty(f.UserConstants.AVATAR)&&o.setAvatar(s[f.UserConstants.AVATAR]),s.hasOwnProperty(f.UserConstants.ROLE)&&o.setRole(s[f.UserConstants.ROLE]),s.hasOwnProperty(f.UserConstants.META_DATA)&&o.setMetadata(s[f.UserConstants.META_DATA]),s.hasOwnProperty(f.UserConstants.LINK)&&o.setLink(s[f.UserConstants.LINK]),s.hasOwnProperty(f.UserConstants.STATUS_MESSAGE)&&o.setStatusMessage(s[f.UserConstants.STATUS_MESSAGE]),s.hasOwnProperty(f.UserConstants.TAGS)&&o.setTags(s[f.UserConstants.TAGS]),s=o}_.makeApiCall("createUser",{},s).then(function(t){var e=I.UsersController.trasformJSONUser(t.data);n(e)},function(t){e(new d.CometChatException(t.error))})}catch(t){e(new d.CometChatException(t))}})},T.updateUser=function(o,i){var a=this;return new Promise(function(s,e){try{if(g.isFalsy(i))return void e(new d.CometChatException(JSON.parse(g.format(JSON.stringify(f.GENERAL_ERROR.INVALID),"AUTH_KEY","AUTH_KEY","AUTH_KEY","AUTH_KEY"))));T.apiKey=i;var t=g.validateUpdateUser(o);if(t instanceof d.CometChatException)return void e(t);if(!(o instanceof l.User)){var n=void 0;if(!o.hasOwnProperty(f.UserConstants.UID))return void e(new d.CometChatException(m.ERRORS.PARAMETER_MISSING));n=new l.User(o[f.UserConstants.UID]),o.hasOwnProperty(f.UserConstants.NAME)&&n.setName(o[f.UserConstants.NAME]),o.hasOwnProperty(f.UserConstants.AVATAR)&&n.setAvatar(o[f.UserConstants.AVATAR]),o.hasOwnProperty(f.UserConstants.ROLE)&&n.setRole(o[f.UserConstants.ROLE]),o.hasOwnProperty(f.UserConstants.META_DATA)&&n.setMetadata(o[f.UserConstants.META_DATA]),o.hasOwnProperty(f.UserConstants.LINK)&&n.setLink(o[f.UserConstants.LINK]),o.hasOwnProperty(f.UserConstants.STATUS_MESSAGE)&&n.setStatusMessage(o[f.UserConstants.STATUS_MESSAGE]),o.hasOwnProperty(f.UserConstants.TAGS)&&n.setTags(o[f.UserConstants.TAGS]),o=n}var r=o.uid;_.makeApiCall("updateUser",{uid:r},o).then(function(o){if(a.user&&r.toLocaleLowerCase()===a.user.getUid().toLocaleLowerCase())h.LocalStorage.getInstance().get("user").then(function(t){if(t){var e=I.UsersController.trasformJSONUser(o.data),n=o.data;n.wsChannel=t.wsChannel,n.authToken=T.authToken,n.status=f.PresenceConstatnts.STATUS.ONLINE,t.jwt&&(n.jwt=t.jwt),T.user=new l.Me(n),a.localStorage.set("user",T.user),s(e)}});else{var t=I.UsersController.trasformJSONUser(o.data);s(t)}},function(t){e(new d.CometChatException(t.error))})}catch(t){e(new d.CometChatException(t))}})},T.updateCurrentUserDetails=function(s){var r=this;return new Promise(function(o,e){try{s.uid=r.user.uid;var t=g.validateUpdateUser(s);if(t instanceof d.CometChatException)return void e(t);if(!(s instanceof l.User)){var n=void 0;s.hasOwnProperty(f.UserConstants.UID)&&(n=new l.User(s[f.UserConstants.UID])),s.hasOwnProperty(f.UserConstants.NAME)&&n.setName(s[f.UserConstants.NAME]),s.hasOwnProperty(f.UserConstants.AVATAR)&&n.setAvatar(s[f.UserConstants.AVATAR]),s.hasOwnProperty(f.UserConstants.ROLE)&&n.setRole(s[f.UserConstants.ROLE]),s.hasOwnProperty(f.UserConstants.META_DATA)&&n.setMetadata(s[f.UserConstants.META_DATA]),s.hasOwnProperty(f.UserConstants.LINK)&&n.setLink(s[f.UserConstants.LINK]),s.hasOwnProperty(f.UserConstants.STATUS_MESSAGE)&&n.setStatusMessage(s[f.UserConstants.STATUS_MESSAGE]),s.hasOwnProperty(f.UserConstants.TAGS)&&n.setTags(s[f.UserConstants.TAGS]),s=n}_.makeApiCall("updateMyDetails",{},s).then(function(t){var e=I.UsersController.trasformJSONUser(t.data),n=T.user=new l.Me(t.data);n.setStatus(f.PresenceConstatnts.STATUS.ONLINE),T.localStorage.set("user",n),o(e)},function(t){e(new d.CometChatException(t.error))})}catch(t){e(new d.CometChatException(t))}})},T.getUser=function(o){return new Promise(function(n,e){try{"object"==typeof o&&o.hasOwnProperty("uid")&&(o=o.uid);var t=g.validateId(o,"user");if(t instanceof d.CometChatException)return void e(t);_.makeApiCall("user",{uid:o}).then(function(t){var e=I.UsersController.trasformJSONUser(t.data);n(e)}).catch(function(t){e(new d.CometChatException(t.error))})}catch(t){e(new d.CometChatException(t))}})},T.getLoggedInUser=function(){var p=this;return new Promise(function(u,S){try{T.localStorage.get(f.LOCAL_STORE.KEY_USER).then(function(t){if(t)T.user=new l.Me(t),u(T.user);else{var r="",i="",a=f.APPINFO.platform,E=f.APPINFO.sdkVersion,c=f.APPINFO.apiVersion;T.keyStore.get(f.LOCAL_STORE.KEY_DEVICE_ID).then(function(t){if(i=t,navigator&&(r=navigator.userAgent),null==i){var e=tt(),n=(new Date).getTime();i=p.appId+"_"+e+"_"+n,T.keyStore.set(f.LOCAL_STORE.KEY_DEVICE_ID,i)}var o={version:E,apiVersion:c,userAgent:r};g.isFalsy(p.platform)||(o.platform=p.platform),g.isFalsy(p.language)||(o.language=p.language),g.isFalsy(p.resource)||(o.resource=p.resource);var s={platform:a,deviceId:i,appInfo:o};_.makeApiCall("updateMyDetails",{},s,!1).then(function(t){t.data.jwt&&(T.jwt=t.data.jwt);var e=t.data.settings;e&&(h.LocalStorage.getInstance().set("app_settings",e),e[f.APP_SETTINGS.KEYS.MODE]&&T.setMode(e[f.APP_SETTINGS.KEYS.MODE]),e[f.APP_SETTINGS.KEYS.SETTINGS_HASH]&&(T.settingsHash=e[f.APP_SETTINGS.KEYS.SETTINGS_HASH]),e[f.APP_SETTINGS.KEYS.SETTINGS_HASH_RECEIVED_AT]&&(T.settingsHashReceivedAt=e[f.APP_SETTINGS.KEYS.SETTINGS_HASH_RECEIVED_AT]),T.isAnalyticsDisabled=!!e[f.APP_SETTINGS.KEYS.ANALYTICS_PING_DISABLED],e[f.APP_SETTINGS.KEYS.SECURED_MEDIA_HOST]&&(T.SECURED_MEDIA_HOST=e[f.APP_SETTINGS.KEYS.SECURED_MEDIA_HOST])),u(new l.Me(t.data))},function(t){S(new d.CometChatException(t.error))}).catch(function(t){S(new d.CometChatException(t))})})}})}catch(t){S(new d.CometChatException(t))}})},T.getLoggedinUser=function(){return new Promise(function(e,n){try{T.localStorage.get(f.LOCAL_STORE.KEY_USER).then(function(t){e(t?new l.User(t):null)},function(t){e(null)})}catch(t){n(new d.CometChatException(t))}})},T.blockUsers=function(o){return new Promise(function(e,n){try{var t=g.validateArray(o,"blockUsers");if(t instanceof d.CometChatException)return void n(t);g.isFalsy(o)?n(new d.CometChatException(m.USERS_REQUEST_ERRORS.EMPTY_USERS_LIST)):_.makeApiCall("blockUsers",{},{blockedUids:o}).then(function(t){e(t.data)},function(t){n(new d.CometChatException(t.error))})}catch(t){n(new d.CometChatException(t))}})},T.unblockUsers=function(o){return new Promise(function(e,n){try{var t=g.validateArray(o,"unblockUsers");if(t instanceof d.CometChatException)return void n(t);g.isFalsy(o)?n(new d.CometChatException(m.USERS_REQUEST_ERRORS.EMPTY_USERS_LIST)):_.makeApiCall("unblockUsers",{},{blockedUids:o}).then(function(t){e(t.data)},function(t){n(new d.CometChatException(t.error))})}catch(t){n(new d.CometChatException(t))}})},T.getConversation=function(i,a){return new Promise(function(n,o){try{var t=g.validateConversationType(a);if(t instanceof d.CometChatException)return void o(t);var e=g.validateId(i,a);if(e instanceof d.CometChatException)return void o(e);a=a.toLowerCase(),i=i.toLowerCase();var s={},r="";a===f.MessageConstatnts.RECEIVER_TYPE.GROUP?(r="getGroupConversation",s.guid=i):(r="getUserConversation",s.uid=i),_.makeApiCall(r,s).then(function(t){if(t.data){var e=t.data;n(V.ConversationController.trasformJSONConversation(e.conversationId,e.conversationType,e.lastMessage,e.conversationWith,parseInt(e.unreadMessageCount),e.tags?e.tags:[]))}else o(new d.CometChatException(JSON.parse(g.format(JSON.stringify(f.ConversationErrors.CONVERSATION_NOT_FOUND),a,i))))},function(t){o(new d.CometChatException(t.error))})}catch(t){o(new d.CometChatException(t))}})},T.tagConversation=function(i,a,E){return void 0===E&&(E=[]),new Promise(function(n,o){try{var t=g.validateConversationType(a);if(t instanceof d.CometChatException)return void o(t);var e=g.validateId(i,a);if(e instanceof d.CometChatException)return void o(e);a=a.toLowerCase(),i=i.toLowerCase();var s={},r="";a===f.MessageConstatnts.RECEIVER_TYPE.GROUP?(r="updateGroupConversation",s.guid=i):(r="updateUserConversation",s.uid=i),_.makeApiCall(r,s,{tags:E}).then(function(t){if(t.data){var e=t.data;n(V.ConversationController.trasformJSONConversation(e.conversationId,e.conversationType,e.lastMessage,e.conversationWith,parseInt(e.unreadMessageCount),e.tags?e.tags:[]))}else o(new d.CometChatException(JSON.parse(g.format(JSON.stringify(f.ConversationErrors.CONVERSATION_NOT_FOUND),a,i))))},function(t){o(new d.CometChatException(t.error))})}catch(t){o(new d.CometChatException(t))}})},T.deleteConversation=function(i,a){return new Promise(function(e,n){try{var t=g.validateConversationType(a);if(t instanceof d.CometChatException)return void n(t);var o=g.validateId(i,a);if(o instanceof d.CometChatException)return void n(o);var s={},r="";a=a.toLowerCase(),i=i.toLowerCase(),a===f.MessageConstatnts.RECEIVER_TYPE.GROUP?(r="deleteGroupConversation",s.guid=i):(r="deleteUserConversation",s.uid=i),_.makeApiCall(r,s).then(function(t){e("Conversation deleted successfully.")},function(t){n(new d.CometChatException(t.error))})}catch(t){n(new d.CometChatException(t))}})},T.createGroup=function(s){return new Promise(function(e,n){try{var t=g.validateCreateGroup(s);if(t instanceof d.CometChatException)return void n(t);if(!(s instanceof a.Group)){var o=void 0;if(!s.hasOwnProperty(f.GroupConstants.KEYS.GUID))return void n(new d.CometChatException(m.ERRORS.PARAMETER_MISSING));if(!s.hasOwnProperty(f.GroupConstants.KEYS.NAME))return void n(new d.CometChatException(m.ERRORS.PARAMETER_MISSING));if(o=new a.Group(s[f.GroupConstants.KEYS.GUID],s[f.GroupConstants.KEYS.NAME],""),s.hasOwnProperty(f.GroupConstants.KEYS.TYPE))if(s[f.GroupConstants.KEYS.TYPE].toLocaleLowerCase()==f.GroupType.Password){if(!s.hasOwnProperty(f.GroupConstants.KEYS.PASSWORD))return void n(new d.CometChatException(m.GROUP_CREATION_ERRORS.EMPTY_PASSWORD));o.setType(f.GROUP_TYPE.PASSWORD),o.setPassword(s[f.GroupConstants.KEYS.PASSWORD])}else o.setType(s[f.GroupConstants.KEYS.TYPE]);else o.setType(f.GROUP_TYPE.PUBLIC);s.hasOwnProperty(f.GroupConstants.KEYS.ICON)&&o.setIcon(s[f.GroupConstants.KEYS.ICON]),s.hasOwnProperty(f.GroupConstants.KEYS.DESCRIPTION)&&o.setDescription(s[f.GroupConstants.KEYS.DESCRIPTION]),s.hasOwnProperty(f.GroupConstants.KEYS.TAGS)&&o.setTags(s[f.GroupConstants.KEYS.TAGS]),s=o}_.makeApiCall("createGroup",{},s).then(function(t){O.GroupsController.trasformJSONGroup(t.data).setHasJoined(!0),e(O.GroupsController.trasformJSONGroup(t.data))},function(t){n(new d.CometChatException(t.error))})}catch(t){n(new d.CometChatException(t))}})},T.getGroup=function(o){return new Promise(function(e,n){try{"object"==typeof o&&o.hasOwnProperty("guid")&&(o=o.guid);var t=g.validateId(o,"group");if(t instanceof d.CometChatException)return void n(t);_.makeApiCall("getGroup",{guid:o}).then(function(t){e(O.GroupsController.trasformJSONGroup(t.data))},function(t){n(new d.CometChatException(t.error))})}catch(t){n(new d.CometChatException(t))}})},T.joinGroup=function(s,r,i){return void 0===r&&(r=f.GroupType.Public),void 0===i&&(i=""),new Promise(function(n,e){try{var t=g.validateJoinGroup(s,r,i);if(t instanceof d.CometChatException)return void e(t);var o=void 0;"object"==typeof s&&(s.hasOwnProperty(f.GroupConstants.KEYS.GUID)?(s.hasOwnProperty(f.GroupConstants.KEYS.TYPE)&&(r=s[f.GroupConstants.KEYS.TYPE],s[f.GroupConstants.KEYS.TYPE].toLocaleLowerCase()===f.GroupType.Password&&s.hasOwnProperty(f.GroupConstants.KEYS.PASSWORD)&&(i=s[f.GroupConstants.KEYS.PASSWORD])),s=s[f.GroupConstants.KEYS.GUID]):e(new d.CometChatException(m.ERRORS.PARAMETER_MISSING))),o=g.isFalsy(i)?new a.Group(s,"name",r):new a.Group(s,"name",r,i),_.makeApiCall("joinGroup",o,o).then(function(t){var e=O.GroupsController.trasformJSONGroup(t.data[f.ResponseConstants.RESPONSE_KEYS.KEY_DATA][f.ActionConstatnts.ACTION_KEYS.ENTITIES][f.ActionConstatnts.ACTION_SUBJECTS.ACTION_FOR][f.ActionConstatnts.ACTION_KEYS.ENTITY]);e.setHasJoined(!0),n(e)},function(t){e(new d.CometChatException(t.error))})}catch(t){e(new d.CometChatException(t))}})},T.updateGroup=function(s){return new Promise(function(e,n){try{var t=g.validateUpdateGroup(s);if(t instanceof d.CometChatException)return void n(t);if(!(s instanceof a.Group)){var o=void 0;if(!s.hasOwnProperty(f.GroupConstants.KEYS.GUID))return void n(new d.CometChatException(m.ERRORS.PARAMETER_MISSING));o=new a.Group(f.GroupConstants.KEYS.GUID,"",""),s.hasOwnProperty(f.GroupConstants.KEYS.TYPE)?o.setType(s[f.GroupConstants.KEYS.TYPE]):(s[f.GroupConstants.KEYS.TYPE]=f.GROUP_TYPE.PUBLIC,o.setType[f.GROUP_TYPE.PUBLIC]),s.hasOwnProperty(f.GroupConstants.KEYS.NAME)&&o.setName(s[f.GroupConstants.KEYS.NAME]),s.hasOwnProperty(f.GroupConstants.KEYS.ICON)&&o.setIcon(s[f.GroupConstants.KEYS.ICON]),s.hasOwnProperty(f.GroupConstants.KEYS.DESCRIPTION)&&o.setDescription(s[f.GroupConstants.KEYS.DESCRIPTION]),s.hasOwnProperty(f.GroupConstants.KEYS.TAGS)&&o.setTags(s[f.GroupConstants.KEYS.TAGS]),s=o}_.makeApiCall("updateGroup",s,s).then(function(t){e(O.GroupsController.trasformJSONGroup(t.data))},function(t){n(new d.CometChatException(t.error))})}catch(t){n(new d.CometChatException(t))}})},T.deleteGroup=function(o){return new Promise(function(e,n){try{var t=g.validateId(o,"group");if(t instanceof d.CometChatException)return void n(t);_.makeApiCall("deleteGroup",{guid:o}).then(function(t){e(!0)},function(t){n(new d.CometChatException(t.error))})}catch(t){n(new d.CometChatException(t))}})},T.leaveGroup=function(o){return new Promise(function(e,n){try{var t=g.validateId(o,"group");if(t instanceof d.CometChatException)return void n(t);_.makeApiCall("leaveGroup",{guid:o}).then(function(t){e(!0)},function(t){n(new d.CometChatException(t.error))})}catch(t){n(new d.CometChatException(t))}})},T.kickGroupMember=function(s,r){return new Promise(function(e,n){try{var t=g.validateId(s,"group");if(t instanceof d.CometChatException)return void n(t);var o=g.validateId(r,"user");if(o instanceof d.CometChatException)return void n(o);_.makeApiCall("kickGroupMembers",{guid:s,uid:r}).then(function(t){e(!0)},function(t){n(new d.CometChatException(t.error))})}catch(t){n(new d.CometChatException(t))}})},T.updateGroupMemberScope=function(r,i,a){return new Promise(function(e,n){try{var t=g.validateId(r,"group");if(t instanceof d.CometChatException)return void n(t);var o=g.validateId(i,"user");if(o instanceof d.CometChatException)return void n(o);var s=g.validateScope(a);if(s instanceof d.CometChatException)return void n(s);_.makeApiCall("changeScopeOfMember",{guid:r,uid:i},{scope:a}).then(function(t){e(!0)},function(t){n(new d.CometChatException(t.error))})}catch(t){n(new d.CometChatException(t))}})},T.banGroupMember=function(s,r){return new Promise(function(e,n){try{var t=g.validateId(s,"group");if(t instanceof d.CometChatException)return void n(t);var o=g.validateId(r,"user");if(o instanceof d.CometChatException)return void n(o);_.makeApiCall("banGroupMember",{guid:s,uid:r}).then(function(t){e(!0)},function(t){n(new d.CometChatException(t.error))})}catch(t){n(new d.CometChatException(t))}})},T.unbanGroupMember=function(s,r){return new Promise(function(e,n){try{var t=g.validateId(s,"group");if(t instanceof d.CometChatException)return void n(t);var o=g.validateId(r,"user");if(o instanceof d.CometChatException)return void n(o);_.makeApiCall("unbanGroupMember",{guid:s,uid:r}).then(function(t){e(!0)},function(t){n(new d.CometChatException(t.error))})}catch(t){n(new d.CometChatException(t))}})},T.addMembersToGroup=function(i,a,E){var c=[],u=[],S=[],p=[];return new Promise(function(t,e){try{var n=g.validateId(i,"group");if(n instanceof d.CometChatException)return void e(n);var o=g.validateArray(a,"groupMembers");if(o instanceof d.CometChatException)return void e(o);if(E){var s=g.validateArray(E,"bannedMembers");if(s instanceof d.CometChatException)return void e(s)}g.isFalsy(a)&&g.isFalsy(E)?e(new d.CometChatException({})):g.isFalsy(a)||g.isFalsy(E)?g.isFalsy(a)?E.map(function(t){p.push(t)}):(a.filter(function(t){if(t.getScope()==f.GROUP_MEMBER_SCOPE.ADMIN)return!0}).map(function(t){c.push(t.getUid())}),a.filter(function(t){if(t.getScope()==f.GROUP_MEMBER_SCOPE.MODERATOR)return!0}).map(function(t){u.push(t.getUid())}),a.filter(function(t){if(t.getScope()==f.GROUP_MEMBER_SCOPE.PARTICIPANT)return!0}).map(function(t){S.push(t.getUid())})):(a.filter(function(t){if(t.getScope()==f.GROUP_MEMBER_SCOPE.ADMIN)return!0}).map(function(t){c.push(t.getUid())}),a.filter(function(t){if(t.getScope()==f.GROUP_MEMBER_SCOPE.MODERATOR)return!0}).map(function(t){u.push(t.getUid())}),a.filter(function(t){if(t.getScope()==f.GROUP_MEMBER_SCOPE.PARTICIPANT)return!0}).map(function(t){S.push(t.getUid())}),E.map(function(t){p.push(t)}));var r={};g.isFalsy(c)||(r=C(C({},r),{admins:c})),g.isFalsy(S)||(r=C(C({},r),{participants:S})),g.isFalsy(u)||(r=C(C({},r),{moderators:u})),g.isFalsy(p)||(r=C(C({},r),{usersToBan:p})),_.makeApiCall("addMemebersToGroup",{guid:i},r).then(function(e){var n={};Object.keys(e.data.admins).map(function(t){e.data.admins[t][f.ResponseConstants.RESPONSE_KEYS.GROUP_MEMBERS_RESPONSE.SUCCESS]?n[t]=f.ResponseConstants.RESPONSE_KEYS.GROUP_MEMBERS_RESPONSE.SUCCESS:n[t]=e.data.admins[t][f.ResponseConstants.RESPONSE_KEYS.GROUP_MEMBERS_RESPONSE.ERROR][f.ResponseConstants.RESPONSE_KEYS.GROUP_MEMBERS_RESPONSE.MESSAGE]}),Object.keys(e.data.participants).map(function(t){e.data.participants[t][f.ResponseConstants.RESPONSE_KEYS.GROUP_MEMBERS_RESPONSE.SUCCESS]?n[t]=f.ResponseConstants.RESPONSE_KEYS.GROUP_MEMBERS_RESPONSE.SUCCESS:n[t]=e.data.participants[t][f.ResponseConstants.RESPONSE_KEYS.GROUP_MEMBERS_RESPONSE.ERROR][f.ResponseConstants.RESPONSE_KEYS.GROUP_MEMBERS_RESPONSE.MESSAGE]}),Object.keys(e.data.moderators).map(function(t){e.data.moderators[t][f.ResponseConstants.RESPONSE_KEYS.GROUP_MEMBERS_RESPONSE.SUCCESS]?n[t]=f.ResponseConstants.RESPONSE_KEYS.GROUP_MEMBERS_RESPONSE.SUCCESS:n[t]=e.data.moderators[t][f.ResponseConstants.RESPONSE_KEYS.GROUP_MEMBERS_RESPONSE.ERROR][f.ResponseConstants.RESPONSE_KEYS.GROUP_MEMBERS_RESPONSE.MESSAGE]}),Object.keys(e.data.usersToBan).map(function(t){e.data.usersToBan[t][f.ResponseConstants.RESPONSE_KEYS.GROUP_MEMBERS_RESPONSE.SUCCESS]?n[t]=f.ResponseConstants.RESPONSE_KEYS.GROUP_MEMBERS_RESPONSE.SUCCESS:n[t]=e.data.usersToBan[t][f.ResponseConstants.RESPONSE_KEYS.GROUP_MEMBERS_RESPONSE.ERROR][f.ResponseConstants.RESPONSE_KEYS.GROUP_MEMBERS_RESPONSE.MESSAGE]}),t(n)},function(t){e(new d.CometChatException(t.error))})}catch(t){e(new d.CometChatException(t))}})},T.transferGroupOwnership=function(s,r){return new Promise(function(n,e){try{var t=g.validateId(s,"group");if(t instanceof d.CometChatException)return void e(t);var o=g.validateId(r,"user");if(o instanceof d.CometChatException)return void e(o);_.makeApiCall("transferOwnership",{guid:s},{owner:r}).then(function(t){var e;e=t&&t.data&&t.data.message?t.data.message:"Ownership transferred to user "+r+" for the group with guid "+s+".",n(e)},function(t){e(new d.CometChatException(t.error))})}catch(t){e(new d.CometChatException(t))}})},T.createGroupWithMembers=function(i,a,E){var c=[],u=[],S=[],p=[];return new Promise(function(r,e){try{var t=g.validateCreateGroup(i);if(t instanceof d.CometChatException)return void e(t);if(a&&0<a.length){var n=g.validateArray(a,"groupMembers");if(n instanceof d.CometChatException)return void e(n);a.map(function(t){t.getScope()===f.GROUP_MEMBER_SCOPE.ADMIN&&c.push(t.getUid()),t.getScope()===f.GROUP_MEMBER_SCOPE.MODERATOR&&u.push(t.getUid()),t.getScope()===f.GROUP_MEMBER_SCOPE.PARTICIPANT&&S.push(t.getUid())})}if(E&&0<E.length){var o=g.validateArray(E,"bannedMembers");if(o instanceof d.CometChatException)return void e(o);E.map(function(t){p.push(t)})}var s={};s=C({},i),g.isFalsy(c)||(s.members=C(C({},s.members),{admins:c})),g.isFalsy(S)||(s.members=C(C({},s.members),{participants:S})),g.isFalsy(u)||(s.members=C(C({},s.members),{moderators:u})),g.isFalsy(p)||(s.members=C(C({},s.members),{usersToBan:p})),_.makeApiCall("createGroup",{},s).then(function(t){var e={members:{}},n=t.data.members.data?t.data.members.data:{admins:{},moderators:{},participants:{},usersToBan:{}};Object.keys(n.admins).map(function(t){n.admins[t][f.ResponseConstants.RESPONSE_KEYS.GROUP_MEMBERS_RESPONSE.SUCCESS]?e.members[t]=f.ResponseConstants.RESPONSE_KEYS.GROUP_MEMBERS_RESPONSE.SUCCESS:e.members[t]=n.admins[t][f.ResponseConstants.RESPONSE_KEYS.GROUP_MEMBERS_RESPONSE.ERROR][f.ResponseConstants.RESPONSE_KEYS.GROUP_MEMBERS_RESPONSE.MESSAGE]}),Object.keys(n.participants).map(function(t){n.participants[t][f.ResponseConstants.RESPONSE_KEYS.GROUP_MEMBERS_RESPONSE.SUCCESS]?e.members[t]=f.ResponseConstants.RESPONSE_KEYS.GROUP_MEMBERS_RESPONSE.SUCCESS:e.members[t]=n.participants[t][f.ResponseConstants.RESPONSE_KEYS.GROUP_MEMBERS_RESPONSE.ERROR][f.ResponseConstants.RESPONSE_KEYS.GROUP_MEMBERS_RESPONSE.MESSAGE]}),Object.keys(n.moderators).map(function(t){n.moderators[t][f.ResponseConstants.RESPONSE_KEYS.GROUP_MEMBERS_RESPONSE.SUCCESS]?e.members[t]=f.ResponseConstants.RESPONSE_KEYS.GROUP_MEMBERS_RESPONSE.SUCCESS:e.members[t]=n.moderators[t][f.ResponseConstants.RESPONSE_KEYS.GROUP_MEMBERS_RESPONSE.ERROR][f.ResponseConstants.RESPONSE_KEYS.GROUP_MEMBERS_RESPONSE.MESSAGE]}),Object.keys(n.usersToBan).map(function(t){n.usersToBan[t][f.ResponseConstants.RESPONSE_KEYS.GROUP_MEMBERS_RESPONSE.SUCCESS]?e.members[t]=f.ResponseConstants.RESPONSE_KEYS.GROUP_MEMBERS_RESPONSE.SUCCESS:e.members[t]=n.usersToBan[t][f.ResponseConstants.RESPONSE_KEYS.GROUP_MEMBERS_RESPONSE.ERROR][f.ResponseConstants.RESPONSE_KEYS.GROUP_MEMBERS_RESPONSE.MESSAGE]}),delete t.data.members;var o=t.data,s=O.GroupsController.trasformJSONGroup(o);s.setHasJoined(!0),e=C(C({},e),{group:s}),r(e)},function(t){e(new d.CometChatException(t.error))})}catch(t){e(new d.CometChatException(t))}})},T.initiateCall=function(e){var t=this;return new Promise(function(n,o){if(g.isCallingComponentInstalled())if(null===t.getActiveCall())try{g.isFalsy(JSON.parse(JSON.stringify(e)).sender)?g.isFalsy(t.getActiveCall())?(e.setStatus(f.CallConstants.CALL_STATUS.INITIATED),e.receiver=e.receiverId.toString(),delete e.receiverId,_.makeApiCall("createCallSession",{},e).then(function(t){var e=A.MessageController.trasformJSONMessge(t[f.ResponseConstants.RESPONSE_KEYS.KEY_DATA]);N.CallController.getInstance().initiateCall(e).then(function(t){n(e)}).catch(function(t){o(new d.CometChatException(t))})},function(t){o(new d.CometChatException(t.error))})):o(new d.CometChatException(f.CALL_ERROR.ERROR_IN_CALLING)):N.CallController.getInstance().initiateCall(e).then(function(t){n(Object.assign(e))}).catch(function(t){o(new d.CometChatException(t))})}catch(t){o(new d.CometChatException(t))}else o(new d.CometChatException(f.CALL_ERROR.CALL_ALREADY_INITIATED));else o(new d.CometChatException(f.CALL_ERROR.MODULE_NOT_INSTALLED))})},T.acceptCall=function(o){var s=this;return new Promise(function(n,e){if(g.isCallingComponentInstalled())if(null===s.getActiveCall())try{var t={};t[f.CallConstants.CALL_KEYS.CALL_STATUS]=f.CallConstants.CALL_STATUS.ONGOING,_.makeApiCall("updateCallSession",{sessionid:o},t).then(function(t){var e=A.MessageController.trasformJSONMessge(t[f.ResponseConstants.RESPONSE_KEYS.KEY_DATA]);N.CallController.getInstance().onCallStarted(e),n(e)},function(t){e(new d.CometChatException(t.error))})}catch(t){e(new d.CometChatException(t))}else e(new d.CometChatException(f.CALL_ERROR.CANNOT_ACCEPT_CALL));else e(new d.CometChatException(f.CALL_ERROR.MODULE_NOT_INSTALLED))})},T.rejectCall=function(t,e){try{switch(e){case f.CallConstants.CALL_STATUS.REJECTED:return this.rejectIncomingCall(t);case f.CallConstants.CALL_STATUS.CANCELLED:return this.cancelCall(t);case f.CallConstants.CALL_STATUS.BUSY:return this.sendBusyResponse(t);default:return this.endCall(t,!0)}}catch(t){g.Logger.error("CometChat: rejectCall",t)}},T.clearActiveCall=function(){N.CallController.getInstance().endCall()},T.endCall=function(s,r){var i=this;return new Promise(function(n,e){if(g.isCallingComponentInstalled()){g.isFalsy(r)&&(r=!1);var o=i.getActiveCall();if(null!==o){if(o.getSessionId()===s)try{var t={};t[f.CallConstants.CALL_KEYS.CALL_STATUS]=f.CallConstants.CALL_STATUS.ENDED,o.getJoinedAt()&&(t[f.CallConstants.CALL_KEYS.CALL_JOINED_AT]=o.getJoinedAt()),_.makeApiCall("updateCallSession",{sessionid:s},t).then(function(t){r||N.CallController.getInstance().endSession();var e=A.MessageController.trasformJSONMessge(t[f.ResponseConstants.RESPONSE_KEYS.KEY_DATA]);n(e),N.CallController.getInstance().getCallListner()&&N.CallController.getInstance().getCallListner()._eventListener.onCallEnded(e),N.CallController.getInstance().endCall()},function(t){g.Logger.log("calling Log",{error:t}),r||N.CallController.getInstance().endSession(),o.setStatus(f.CallConstants.CALL_STATUS.ENDED),n(o),N.CallController.getInstance().getCallListner()&&N.CallController.getInstance().getCallListner()._eventListener.onCallEnded(o),N.CallController.getInstance().endCall()})}catch(t){e(new d.CometChatException(t))}}else r||N.CallController.getInstance().endSession(),N.CallController.getInstance().getCallListner()&&N.CallController.getInstance().getCallListner()._eventListener.onCallEnded(null),n(null)}else e(new d.CometChatException(f.CALL_ERROR.MODULE_NOT_INSTALLED))})},T.getActiveCall=function(){try{return N.CallController.getInstance().getActiveCall()}catch(t){g.Logger.error("CometChat: getActiveCall",t)}},T.getCallParticipantCount=function(E,c){return new Promise(function(i,a){try{g.getAppSettings().then(function(t){if(g.isFalsy(E))return a(new d.CometChatException(f.ProsodyApiErrors.INVALID_SESSIONID));if(g.isFalsy(c))return a(new d.CometChatException(f.ProsodyApiErrors.INVALID_TYPE));var e=t[f.APP_SETTINGS.KEYS.REGION],n={},o=t[f.APP_SETTINGS.KEYS.WEBRTC_HOST],s=t[f.APP_SETTINGS.KEYS.WEBRTC_API_SUBDOMAIN],r=g.format((new u.EndpointFactory).prosodyApi,s,o,f.PROSODY_API.PATH.ROOM_SIZE);"direct"===c.toLowerCase()&&(E=("v1."+e+"."+T.getAppId()+"."+E).toLowerCase()),n[f.PROSODY_API.QUERY_PARAMETERS.DOMAIN]=o,n[f.PROSODY_API.QUERY_PARAMETERS.ROOM]=E,_.postData(r,"GET",n,{},!1).then(function(t){return t.text()}).then(function(t){var e=t?JSON.parse(t):{};return e.hasOwnProperty(f.PROSODY_API.RESPONSE.PARTICIPANTS)?i(e[f.PROSODY_API.RESPONSE.PARTICIPANTS]):i(0)}).catch(function(){var t={error:m.FETCH_ERROR.ERROR_IN_API_CALL};return a(t)})},function(t){return a(new d.CometChatException(t))})}catch(t){return a(new d.CometChatException(t))}})},T.rejectIncomingCall=function(o){return new Promise(function(n,e){try{if(g.isCallingComponentInstalled()){var t={};t[f.CallConstants.CALL_KEYS.CALL_STATUS]=f.CallConstants.CALL_STATUS.REJECTED,_.makeApiCall("updateCallSession",{sessionid:o},t).then(function(t){var e=A.MessageController.trasformJSONMessge(t[f.ResponseConstants.RESPONSE_KEYS.KEY_DATA]);n(e)},function(t){e(new d.CometChatException(t.error))})}else e(new d.CometChatException(f.CALL_ERROR.MODULE_NOT_INSTALLED))}catch(t){e(new d.CometChatException(t))}})},T.cancelCall=function(s){var r=this;return new Promise(function(n,e){if(g.isCallingComponentInstalled()){var t=r.getActiveCall();if(null!==t&&t.getSessionId()===s&&t.getCallInitiator().getUid().toLocaleLowerCase()===T.user.getUid().toLocaleLowerCase())try{var o={};o[f.CallConstants.CALL_KEYS.CALL_STATUS]=f.CallConstants.CALL_STATUS.CANCELLED,_.makeApiCall("updateCallSession",{sessionid:s},o).then(function(t){var e=A.MessageController.trasformJSONMessge(t[f.ResponseConstants.RESPONSE_KEYS.KEY_DATA]);N.CallController.getInstance().endCallSession(),n(e)},function(t){e(new d.CometChatException(t.error))})}catch(t){e(new d.CometChatException(t))}}else e(new d.CometChatException(f.CALL_ERROR.MODULE_NOT_INSTALLED))})},T.sendBusyResponse=function(o){return new Promise(function(n,e){try{if(g.isCallingComponentInstalled()){var t={};t[f.CallConstants.CALL_KEYS.CALL_STATUS]=f.CallConstants.CALL_STATUS.BUSY,_.makeApiCall("updateCallSession",{sessionid:o},t).then(function(t){var e=A.MessageController.trasformJSONMessge(t[f.ResponseConstants.RESPONSE_KEYS.KEY_DATA]);n(e)},function(t){e(new d.CometChatException(t.error))})}else e(new d.CometChatException(f.CALL_ERROR.MODULE_NOT_INSTALLED))}catch(t){e(new d.CometChatException(t))}})},T.sendUnansweredResponse=function(o){return new Promise(function(n,e){try{if(g.isCallingComponentInstalled()){var t={};t[f.CallConstants.CALL_KEYS.CALL_STATUS]=f.CallConstants.CALL_STATUS.UNANSWERED,_.makeApiCall("updateCallSession",{sessionid:o},t).then(function(t){var e=A.MessageController.trasformJSONMessge(t[f.ResponseConstants.RESPONSE_KEYS.KEY_DATA]);et.publishCallMessage(e),n(e)},function(t){e(new d.CometChatException(t.error))})}else e(new d.CometChatException(f.CALL_ERROR.MODULE_NOT_INSTALLED))}catch(t){e(new d.CometChatException(t))}})},T.addConnectionListener=function(t,e){try{nt.addConnectionEventListener(t,e)}catch(t){g.Logger.error("CometChat: addConnectionListener",t)}},T.removeConnectionListener=function(t){try{nt.removeConnectionEventListener(t)}catch(t){g.Logger.error("CometChat: removeConnectionListener",t)}},T.addMessageListener=function(t,e){try{nt.addMessageEventListener(t,e)}catch(t){g.Logger.error("CometChat: addMessageListener",t)}},T.removeMessageListener=function(t){try{nt.removeMessageEventListener(t)}catch(t){g.Logger.error("CometChat: removeMessageListener",t)}},T.addCallListener=function(t,e){try{nt.addCallEventListener(t,e)}catch(t){g.Logger.error("CometChat: addCallListener",t)}},T.removeCallListener=function(t){try{nt.removeCallEventListener(t)}catch(t){g.Logger.error("CometChat: removeCallListener",t)}},T.addUserListener=function(t,e){try{nt.addUserEventListener(t,e)}catch(t){g.Logger.error("CometChat: addUserListener",t)}},T.removeUserListener=function(t){try{nt.removeUserEventListener(t)}catch(t){g.Logger.error("CometChat: removeUserListener",t)}},T.addGroupListener=function(t,e){try{nt.addGroupEventListener(t,e)}catch(t){g.Logger.error("CometChat: addGroupListener",t)}},T.removeGroupListener=function(t){try{nt.removeGroupEventListener(t)}catch(t){g.Logger.error("CometChat: removeGroupListener",t)}},T.addLoginListener=function(t,e){try{nt.addLoginEventListener(t,e)}catch(t){g.Logger.error("CometChat: addLoginListener",t)}},T.removeLoginListener=function(t){try{nt.removeLoginEventListener(t)}catch(t){g.Logger.error("CometChat: removeLoginListener",t)}},T.generateAuthToken=function(S){var p=this;return new Promise(function(o,s){try{var r={},i="",a="",E=f.APPINFO.platform,c=f.APPINFO.sdkVersion,u=f.APPINFO.apiVersion;navigator&&(a=navigator.userAgent),T.keyStore.get(f.LOCAL_STORE.KEY_DEVICE_ID).then(function(t){if(null==(i=t)){var e=tt(),n=(new Date).getTime();i=p.appId+"_"+e+"_"+n,T.keyStore.set(f.LOCAL_STORE.KEY_DEVICE_ID,i)}r={platform:E,deviceId:i,appInfo:{version:c,apiVersion:u,userAgent:a}},_.makeApiCall("authToken",{uid:S},r).then(function(t){o(t.data)}).catch(function(t){s(new d.CometChatException(t.error))})},function(t){g.Logger.error("Got error while fetching data from key store",t)})}catch(t){s(new d.CometChatException(t))}})},T.tryReconnectingToWS=function(){T.WSReconnectionInProgress||T.startWSReconnectionTimer()},T.prototype.makeWSConnection=function(){T.WSLogin(T.user)},T.prototype.accidentallyDisconnected=function(){T.currentConnectionStatus=f.CONNECTION_STATUS.CONNECTING,nt.connectionHandlers.map(function(t){try{t._eventListener&&(g.isFalsy(t._eventListener.inConnecting)||t._eventListener.inConnecting())}catch(t){g.Logger.error("ConnectionHandlers: inConnecting Status",t)}}),T.tryReconnectingToWS()},T.WSLogin=function(t){var o=this;et.connection||et.WSLogin(t.getJWT(),function(t,e){switch(t){case j.READY_STATE.CONNECTING:(n=T.getConnectionStatus())==f.CONNECTION_STATUS.DISCONNECTED&&(o.currentConnectionStatus=f.CONNECTION_STATUS.CONNECTING,nt.connectionHandlers.map(function(t){try{t._eventListener&&(g.isFalsy(t._eventListener.inConnecting)||t._eventListener.inConnecting())}catch(t){g.Logger.error("connectionHandlers: Connecting Status",t)}}));break;case j.READY_STATE.OPEN:(n=T.getConnectionStatus())==f.CONNECTION_STATUS.CONNECTING&&(o.currentConnectionStatus=f.CONNECTION_STATUS.CONNECTED,nt.connectionHandlers.map(function(t){try{t._eventListener&&(g.isFalsy(t._eventListener.onConnected)||t._eventListener.onConnected()),o.onConnectionSuccess&&(o.onConnectionSuccess(),o.onConnectionSuccess=null)}catch(t){g.Logger.error("connectionHandlers: Connected Status",t)}})),T.WSReconnectionInProgress&&T.clearWSReconnectionTimer();break;case j.READY_STATE.CLOSING:break;case j.READY_STATE.CLOSED:var n=T.getConnectionStatus();1e3!==e.code&&(o.onConnectionError&&(o.onConnectionError(new d.CometChatException(f.ReceiptErrors.NO_WEBSOCKET_CONNECTION)),o.onConnectionError=null),nt.connectionHandlers.map(function(t){try{t._eventListener&&(g.isFalsy(t._eventListener.onConnectionError)||t._eventListener.onConnectionError())}catch(t){g.Logger.error("connectionHandlers: ConnectionError Status",t)}})),n!==f.CONNECTION_STATUS.DISCONNECTED&&n!==f.CONNECTION_STATUS.CONNECTING&&(o.currentConnectionStatus=f.CONNECTION_STATUS.DISCONNECTED,nt.connectionHandlers.map(function(t){try{t._eventListener&&(g.isFalsy(t._eventListener.onDisconnected)||t._eventListener.onDisconnected()),T.onDisconnectSuccess&&(T.onDisconnectSuccess(),T.onDisconnectSuccess=null)}catch(t){g.Logger.error("connectionHandlers: Disconnected Status",t)}})),et.connection&&(et.connection=null),T.isLoggedOut||T.disconnectedByUser||T.isAppInactive||o.tryReconnectingToWS()}})},T.pingAnalytics=function(){var c=this;try{T.keyStore.get("deviceId").then(function(E){g.getAppSettings().then(function(t){var e=null;window&&window.location&&window.location.origin&&(e=window.location.origin);var n="",o=E,s={version:f.SDKHeader.sdkVersion,apiVersion:t[f.APP_SETTINGS.KEYS.CHAT_API_VERSION],origin:e,uts:(new Date).getTime()};g.isFalsy(c.resource)||(s.resource=c.resource),g.isFalsy(c.platform)||(s.platform=c.platform),g.isFalsy(c.language)||(s.language=c.language),navigator&&(n=navigator.userAgent);var r={appInfo:s,uid:T.user.getUid(),userAgent:n,deviceId:o,platform:f.SDKHeader.platform};g.isFalsy(T.getSessionId())||(r.wsId=T.getSessionId());var i="https://"+t[f.APP_SETTINGS.KEYS.ANALYTICS_HOST]+"/"+t[f.APP_SETTINGS.KEYS.ANALYTICS_VERSION]+"/ping",a={appId:T.appId,sdk:g.format(f.SDKHeader.sdk,f.SDKHeader.platform,f.SDKHeader.sdkVersion),"Content-Type":"application/json"};T.settingsHash&&(a.settingsHash=T.settingsHash),T.settingsHashReceivedAt&&(a.settingsHashReceivedAt=T.settingsHashReceivedAt),T.jwt&&(a.Authorization="Bearer "+T.jwt),T.authToken&&(a.authToken=T.authToken),_.postData(i,"POST",r,a,!1).then(function(t){return t.json()}).then(function(t){if(t.hasOwnProperty(f.ResponseConstants.RESPONSE_KEYS.KEY_DATA))g.Logger.log("Analytics Ping Request Data",t[f.ResponseConstants.RESPONSE_KEYS.KEY_DATA]);else if(t.hasOwnProperty(f.ResponseConstants.RESPONSE_KEYS.KEY_ERROR)){var e=t[f.ResponseConstants.RESPONSE_KEYS.KEY_ERROR];g.Logger.log("Analytics Ping Request Error",new d.CometChatException(e));var n=e.code;if(n===f.Errors.ERR_SETTINGS_HASH_OUTDATED){var o=T.authToken;T.getInstance().internalRestart(o)}n===f.Errors.ERR_NO_AUTH&&c.updateJWT()}}).catch(function(t){g.Logger.error("CometChat: pingAnalytics Fetch Error",t)})},function(t){g.Logger.error("CometChat: pingAnalytics getSettings Error",t)})},function(t){g.Logger.error("CometChat: pingAnalytics getDeviceId Error",t)})}catch(t){g.Logger.error("CometChat: pingAnalytics",t)}},T.updateJWT=function(){_.makeApiCall("getMyDetails",{},{},!1).then(function(t){var e=t.data,n=e.settings,o=new l.Me(e);if(T.user=o,e.hasOwnProperty("jwt")&&e.jwt&&(T.jwt=e.jwt),h.LocalStorage.getInstance().set("user",o),n&&n[f.APP_SETTINGS.KEYS.SETTINGS_HASH]&&T.settingsHash!==n[f.APP_SETTINGS.KEYS.SETTINGS_HASH]){var s=T.getInstance().getAuthToken();T.getInstance().internalRestart(s)}g.Logger.log("CometChat: updateJWT response",t)},function(t){g.Logger.error("CometChat: updateJWT Fetch Error",t)}).catch(function(t){g.Logger.error("CometChat: updateJWT",t)})},T.startAnalyticsPingTimer=function(){var t=this;T.isAnalyticsPingStarted=!0,T.analyticsPingTimer=setInterval(function(){try{t.pingAnalytics()}catch(t){g.Logger.error("CometChat: startAnalyticsPingTimer",t)}},T.settingsInterval)},T.clearAnalyticsPingTimer=function(){try{T.isAnalyticsPingStarted=!1,clearInterval(T.analyticsPingTimer)}catch(t){g.Logger.error("CometChat: clearAnalyticsPingTimer",t)}},T.startWSReconnectionTimer=function(){T.WSReconnectionInProgress=!0,T.WSReconnectionTimer=setInterval(function(){try{T.WSLogin(T.user)}catch(t){g.Logger.error("CometChat: startWSReconnectionTimer",t)}},T.WSReconnectionTimerInterval)},T.clearWSReconnectionTimer=function(){T.WSReconnectionInProgress=!1,clearInterval(T.WSReconnectionTimer)},T.prototype.getJWT=function(r){return new Promise(function(o,s){try{q.getEndPoint("getJWT").then(function(t){var e={appId:T.appId,Accept:"application/json",authToken:T.authToken,resource:T.getSessionId(),sdk:g.format(f.SDKHeader.sdk,f.SDKHeader.platform,f.SDKHeader.sdkVersion),"Content-Type":"application/json"},n={};n[f.JWT_API.KEYS.PASSTHROUGH]=r,_.postData(t.endpoint,t.method,n,e,!1).then(function(t){return t.json()}).then(function(t){t.hasOwnProperty(f.ResponseConstants.RESPONSE_KEYS.KEY_DATA)?o(t[f.ResponseConstants.RESPONSE_KEYS.KEY_DATA]):s(new d.CometChatException(t.error))}).catch(function(t){var e={error:m.FETCH_ERROR.ERROR_IN_API_CALL};s(new d.CometChatException(e))})},function(t){s(new d.CometChatException(t))})}catch(t){s(new d.CometChatException(t))}})},T.getConnectionStatus=function(){return this.currentConnectionStatus},T.prototype.setConnectionStatus=function(t){T.currentConnectionStatus=t},T.isExtensionEnabled=function(r){return new Promise(function(o,s){try{if(g.isFalsy(r))return s(new d.CometChatException(f.ExtensionErrors.INVALID_EXTENSION));g.getAppSettings().then(function(t){if(t.extensions){var e=t.extensions;if(0<e.length){var n=e.some(function(t){return t.id===r});return o(n)}return o(!1)}return s(new d.CometChatException(f.ExtensionErrors.EXTENSION_NOT_FOUND))},function(t){return s(new d.CometChatException(t))})}catch(t){return s(new d.CometChatException(t))}})},T.getExtensionDetails=function(i){return new Promise(function(s,r){try{if(g.isFalsy(i))return r(new d.CometChatException(f.ExtensionErrors.INVALID_EXTENSION));g.getAppSettings().then(function(t){if(t.extensions){var e=t.extensions;if(0<e.length){var n=e.filter(function(t){return t.id===i});if(0<n.length){var o=new X.CCExtension(n[0]);return s(o)}return r(new d.CometChatException(f.ExtensionErrors.EXTENSION_NOT_FOUND))}return r(new d.CometChatException(f.ExtensionErrors.EXTENSION_NOT_FOUND))}return r(new d.CometChatException(f.ExtensionErrors.EXTENSION_NOT_FOUND))},function(t){return r(new d.CometChatException(t))})}catch(t){return r(new d.CometChatException(t))}})},T.getAppSettings=function(){return new Promise(function(e,n){try{_.makeApiCall("appSettings").then(function(t){h.LocalStorage.getInstance().set(f.LOCAL_STORE.KEY_APP_SETTINGS,t.data),e(t.data)},function(t){n(new d.CometChatException(t.error))})}catch(t){n(new d.CometChatException(t))}})},T.isFeatureEnabled=function(s){return new Promise(function(n,o){try{if(g.isFalsy(s))return o(new d.CometChatException(f.FeatureRestrictionErrors.INVALID_FEATURE));g.getAppSettings().then(function(t){if(t.parameters){var e=t.parameters;return e.hasOwnProperty(s)?n(e[s]):n(!1)}return o(new d.CometChatException(f.FeatureRestrictionErrors.FEATURE_NOT_FOUND))},function(t){return o(new d.CometChatException(t))})}catch(t){return o(new d.CometChatException(t))}})},T.logout=function(){var o=this;return new Promise(function(e,n){try{T.didAnalyticsPingStart()&&T.clearAnalyticsPingTimer(),T.WSReconnectionInProgress&&T.clearWSReconnectionTimer(),T.isLoggedOut=!0,T.WSReconnectionInProgress=!1,T.isAnalyticsDisabled=!1,_.makeApiCall("userLogout").then(function(t){o.clearCache().then(function(){T.apiKey=void 0,T.user=void 0,T.authToken=void 0,T.cometChat=void 0,T.mode=void 0,et.WSLogout(),T.pushToLoginListener("","Logout_Success"),e(t.data)})},function(t){o.clearCache().then(function(){T.apiKey=void 0,T.user=void 0,T.authToken=void 0,T.cometChat=void 0,T.mode=void 0,et.WSLogout(),T.pushToLoginListener("","Logout_Success"),new d.CometChatException(t.error).code==m.SERVER_ERRORS.AUTH_ERR.code?e({}):n(new d.CometChatException(t.error))})})}catch(t){n(new d.CometChatException(t))}})},T.callExtension=function(r,i,a,E){return void 0===E&&(E={}),new Promise(function(o,s){try{g.getAppSettings().then(function(t){var e=g.format((new u.EndpointFactory).extensionApi,r,t[f.APP_SETTINGS.KEYS.REGION],t[f.APP_SETTINGS.KEYS.EXTENSION_DOMAIN],a),n={appId:T.appId,Accept:"application/json",authToken:T.authToken,resource:T.getSessionId(),sdk:g.format(f.SDKHeader.sdk,f.SDKHeader.platform,f.SDKHeader.sdkVersion),chatApiVersion:t[f.APP_SETTINGS.KEYS.CHAT_API_VERSION],"Content-Type":"application/json"};_.postData(e,i,E,n,!1).then(function(t){return t.json()}).then(function(t){t.hasOwnProperty(f.ResponseConstants.RESPONSE_KEYS.KEY_DATA)?o(t[f.ResponseConstants.RESPONSE_KEYS.KEY_DATA]):s(new d.CometChatException(t.error))}).catch(function(t){var e={error:m.FETCH_ERROR.ERROR_IN_API_CALL};s(e)})},function(t){return s(new d.CometChatException(t))})}catch(t){return s(new d.CometChatException(t))}})},T.getConversationStarter=function(a,E){return new Promise(function(e,n){try{a=a.toLowerCase(),E=E.toLowerCase();var t=g.validateChatType(E);if(t instanceof d.CometChatException)return void n(t);var o=g.validateId(a,E);if(o instanceof d.CometChatException)return void n(o);var s={},r="";E===f.MessageConstatnts.RECEIVER_TYPE.GROUP?(r="getGroupConversationStarter",s.guid=a):(r="getUserConversationStarter",s.uid=a);var i={uid:T.user.uid,name:T.user.name};s.onbehalfofuser=new $.Buffer(JSON.stringify(i)).toString("base64"),_.makeApiCall(r,s).then(function(t){return t[f.ResponseConstants.RESPONSE_KEYS.KEY_DATA]&&t[f.ResponseConstants.RESPONSE_KEYS.KEY_DATA][f.ResponseConstants.RESPONSE_KEYS.KEY_CONVERSATION_STARTER]?e(t[f.ResponseConstants.RESPONSE_KEYS.KEY_DATA][f.ResponseConstants.RESPONSE_KEYS.KEY_CONVERSATION_STARTER]):n(new d.CometChatException(f.AIErrors.NO_CONVERSATION_STARTER))},function(t){return n(new d.CometChatException(t.error))})}catch(t){return n(new d.CometChatException(t))}})},T.getSmartReply=function(a,E){return new Promise(function(e,n){try{a=a.toLowerCase(),E=E.toLowerCase();var t=g.validateChatType(E);if(t instanceof d.CometChatException)return void n(t);var o=g.validateId(a,E);if(o instanceof d.CometChatException)return void n(o);var s={},r="";E===f.MessageConstatnts.RECEIVER_TYPE.GROUP?(r="getGroupSmartReply",s.guid=a):(r="getUserSmartReply",s.uid=a);var i={uid:T.user.uid,name:T.user.name};s.onbehalfofuser=new $.Buffer(JSON.stringify(i)).toString("base64"),_.makeApiCall(r,s).then(function(t){return t[f.ResponseConstants.RESPONSE_KEYS.KEY_DATA]&&t[f.ResponseConstants.RESPONSE_KEYS.KEY_DATA][f.ResponseConstants.RESPONSE_KEYS.KEY_SMART_REPLIES]?e(t[f.ResponseConstants.RESPONSE_KEYS.KEY_DATA][f.ResponseConstants.RESPONSE_KEYS.KEY_SMART_REPLIES]):n(new d.CometChatException(f.AIErrors.NO_SMART_REPLY))},function(t){return n(new d.CometChatException(t.error))})}catch(t){return n(new d.CometChatException(t))}})},T.setSource=function(t,e,n){g.isFalsy(t)||(this.resource=t),g.isFalsy(e)||(this.platform=e),g.isFalsy(n)||(this.language=n)},T.clearCache=function(){return new Promise(function(t,e){try{h.LocalStorage.getInstance().clearStore().then(function(){g.Logger.info("CometChat: clearCache => All store cleared successfully","true"),t(!0)})}catch(t){g.Logger.error("CometChat: clearCache",t),e(t)}})},T.connect=function(t){var e=t||{},n=e.onSuccess,o=e.onError;T.user?(et.connection||(T.onConnectionSuccess=n,T.disconnectedByUser=!1,T.WSLogin(T.user)),T.didAnalyticsPingStart()||T.isAnalyticsDisabled||(T.pingAnalytics(),T.startAnalyticsPingTimer())):o&&o(new d.CometChatException({code:f.Errors.ERROR_USER_NOT_LOGGED_IN,message:f.Errors.ERROR_USER_NOT_LOGGED_IN_MESSAGE}))},T.disconnect=function(t){var e=t||{},n=e.onSuccess,o=e.onError;T.user?(T.disconnectedByUser=!0,T.disconnectInternally({onError:o}),et.clearWSResponseTimer(),T.onDisconnectSuccess=n):o&&o(new d.CometChatException({code:f.Errors.ERROR_USER_NOT_LOGGED_IN,message:f.Errors.ERROR_USER_NOT_LOGGED_IN_MESSAGE}))},T.disconnectInternally=function(t){var e=(t||{}).onError;T.user?(et.connection&&et.WSLogout(),T.didAnalyticsPingStart()&&T.clearAnalyticsPingTimer(),T.clearWSReconnectionTimer()):e&&e(new d.CometChatException({code:f.Errors.ERROR_USER_NOT_LOGGED_IN,message:f.Errors.ERROR_USER_NOT_LOGGED_IN_MESSAGE}))},T.prototype.internalRestart=function(t){T.internalRestart||T.getInstance().internalLogout(!1).then(function(){T.internalRestart=!0,T.login(t).then(function(t){T.shouldConnectToWS=!0,T.internalRestart=!1},function(t){g.Logger.error("CometChat: internalRestart :: login",t),T.internalRestart=!1})},function(t){g.Logger.error("CometChat: internalRestart :: internalLogout",t)})},T.prototype.internalLogout=function(n){return void 0===n&&(n=!0),new Promise(function(t,e){try{T.didAnalyticsPingStart()&&T.clearAnalyticsPingTimer(),T.WSReconnectionInProgress&&T.clearWSReconnectionTimer(),T.isLoggedOut=!0,T.WSReconnectionInProgress=!1,T.isAnalyticsDisabled=!1,T.clearCache().then(function(){T.apiKey=void 0,T.user=void 0,T.authToken=void 0,T.cometChat=void 0,T.mode=void 0,et.WSLogout(),n&&T.pushToLoginListener("","Logout_Success"),t(!0)})}catch(t){g.Logger.error("CometChat: internalLogout",t),e(t)}})},T.initialzed=!1,T.CometChatException=d.CometChatException,T.TextMessage=R.TextMessage,T.MediaMessage=S.MediaMessage,T.CustomMessage=w.CustomMessage,T.Action=i.Action,T.Call=s.Call,T.TypingIndicator=Y.TypingIndicator,T.TransientMessage=Q.TransientMessage,T.Group=a.Group,T.User=l.User,T.GroupMember=K.GroupMember,T.Conversation=x.Conversation,T.USER_STATUS={ONLINE:f.PresenceConstatnts.STATUS.ONLINE,OFFLINE:f.PresenceConstatnts.STATUS.OFFLINE},T.MessagesRequest=U.MessagesRequest,T.MessagesRequestBuilder=U.MessagesRequestBuilder,T.UsersRequest=P.UsersRequest,T.UsersRequestBuilder=P.UsersRequestBuilder,T.ConversationsRequest=v.ConversationsRequest,T.ConversationsRequestBuilder=v.ConversationsRequestBuilder,T.BlockedUsersRequest=B.BlockedUsersRequest,T.BlockedUsersRequestBuilder=B.BlockedUsersRequestBuilder,T.GroupsRequest=y.GroupsRequest,T.GroupsRequestBuilder=y.GroupsRequestBuilder,T.GroupMembersRequest=L.GroupMembersRequest,T.GroupMembersRequestBuilder=L.GroupMembersRequestBuilder,T.BannedMembersRequest=M.BannedMembersRequest,T.BannedMembersRequestBuilder=M.BannedMembersRequestBuilder,T.CallSettings=k.CallSettings,T.CallSettingsBuilder=k.CallSettingsBuilder,T.MainVideoContainerSetting=k.MainVideoContainerSetting,T.AppSettings=b.AppSettings,T.AppSettingsBuilder=b.AppSettingsBuilder,T.CallingComponent=H.CallingComponent,T.MessageListener=o.MessageListener,T.UserListener=o.UserListener,T.GroupListener=o.GroupListener,T.OngoingCallListener=o.OngoingCallListener,T.CallListener=o.CallListener,T.ConnectionListener=o.ConnectionListener,T.LoginListener=o.LoginListener,T.CallController=N.CallController,T.CometChatHelper=F.CometChatHelper,T.Attachment=J.Attachment,T.MESSAGE_TYPE=f.MessageConstatnts.TYPE,T.CATEGORY_MESSAGE=f.MessageConstatnts.CATEGORY.MESSAGE,T.CATEGORY_ACTION=f.MessageConstatnts.CATEGORY.ACTION,T.CATEGORY_CALL=f.MessageConstatnts.CATEGORY.CALL,T.CATEGORY_CUSTOM=f.MessageConstatnts.CATEGORY.CUSTOM,T.ACTION_TYPE=f.ActionConstatnts.ACTIONS,T.CALL_TYPE=f.CallConstants.CALL_TYPE,T.RECEIVER_TYPE=f.MessageConstatnts.RECEIVER_TYPE,T.CALL_STATUS=f.CallConstants.CALL_STATUS,T.GROUP_MEMBER_SCOPE=f.GROUP_MEMBER_SCOPE,T.GROUP_TYPE=f.GROUP_TYPE,T.MESSAGE_REQUEST=f.MessageConstatnts.PAGINATION.CURSOR_FILEDS,T.CONNECTION_STATUS=f.CONNECTION_STATUS,T.CALL_MODE=f.CallConstants.CALL_MODE,T.AUDIO_MODE=f.CallConstants.AUDIO_MODE,T.SORT_BY=f.UserConstants.SORT_BY,T.SORT_ORDER=f.UserConstants.SORT_ORDER,T.WSReconnectionInProgress=!1,T.WSReconnectionTimerInterval=5e3,T.currentConnectionStatus=f.CONNECTION_STATUS.DISCONNECTED,T.isConnectingFromInit=!1,T.loginInProgress=!1,T.internalRestart=!1,T.settingsInterval=6e4,T.isAnalyticsPingStarted=!1,T.isLoggedOut=!0,T.isAnalyticsDisabled=!1,T.disconnectedByUser=!1,T.shouldConnectToWS=!0,T.isAppInactive=!1,T.onConnectionSuccess=null,T.onDisconnectSuccess=null,T.onConnectionError=null,T.callWaitTimer=null,T.callWaitTime=30,T}();e.CometChat=ot},function(t,e,n){"use strict";e.__esModule=!0,e.postData=e.makeAdminApiCall=e.makeApiCall=void 0;var c=n(33),u=n(5),S=n(0),p=n(2),C=n(13),l=n(1);function T(n,t,o,e,s){var r;return void 0===n&&(n=""),void 0===t&&(t="GET"),void 0===o&&(o={}),void 0===e&&(e={}),o=S.isFalsy(o)?void 0:("GET"==t&&(n+="?",Object.keys(o).map(function(t,e){n=e===Object.keys(o).length-1?n+t+"="+o[t]:n+t+"="+o[t]+"&"}),o=void 0),s&&(r=new FormData,Object.keys(o).map(function(e){if("data"!=e){if("tags"==e)o[e].forEach(function(t){r.append(e+"[]",t)});else if("metadata"!=e)if("files"===e)for(var t=0;t<o[e].length;t++)r.append(e+"[]",o[e][t]);else"object"==typeof o[e]?r.append(e,JSON.stringify(o[e])):r.append(e,o[e])}else r.append(e,JSON.stringify(o[e]))})),JSON.stringify(o)),fetch(n,{method:t,mode:"cors",cache:"no-cache",headers:e,redirect:"follow",referrer:"no-referrer",body:s?r:o})}e.makeApiCall=function(s,r,i,a){void 0===s&&(s=""),void 0===r&&(r={}),void 0===i&&(i={});var E=u.CometChat.getInstance(u.CometChat.getAppId());return new Promise(function(n,o){try{c.getEndPoint(s,r).then(function(t){var e={resource:u.CometChat.getSessionId(),appId:u.CometChat.getAppId(),Accept:"application/json",sdk:S.format(l.SDKHeader.sdk,l.SDKHeader.platform,l.SDKHeader.sdkVersion)};a||(e["Content-Type"]="application/json"),t.hasOwnProperty("isAIApi")&&t.isAIApi&&(e.onbehalfofuser=r.onbehalfofuser),t.hasOwnProperty("isAdminApi")&&t.isAdminApi?E.getApiKey()?e.apiKey=E.getApiKey():o({error:{code:"API_KEY_NOT_SET",message:"An apiKey is needed to use the "+s+" api.",name:"API_KEY_NOT_SET"}}):E.getAuthToken()?e.authToken=E.getAuthToken():o({error:{code:"USER_NOT_LOGED_IN",message:"An authToken is need to use the "+s+" end-point. PS- We are aware of the spelling mistake, but in order to maintain backward compatibility we cannot change it :(",name:"User not logged-in"}}),T(t.endpoint,t.method,i,e,a).then(function(t){return t.json()}).then(function(t){if(t.hasOwnProperty("data"))t.data.hasOwnProperty("authToken")&&u.CometChat.setAuthToken(t.data.authToken),n(t);else{if(t.hasOwnProperty("error")){var e=t.error;e.hasOwnProperty("code")&&e.code===l.API_ERROR_CODES.AUTH_ERR_AUTH_TOKEN_NOT_FOUND&&u.CometChat.getInstance().internalLogout().then(function(){S.Logger.log("CometChat: makeApiCall","User logged out")})}o(t)}}).catch(function(t){var e={error:C.FETCH_ERROR.ERROR_IN_API_CALL};o(e)})}).catch(function(t){return o})}catch(t){o(new p.CometChatException(t))}})},e.makeAdminApiCall=function(s,t,r,i){void 0===s&&(s=""),void 0===t&&(t={}),void 0===r&&(r={});var a=u.CometChat.getInstance(u.CometChat.getAppId());return new Promise(function(n,o){c.getEndPoint(s,t).then(function(t){var e={appId:u.CometChat.getAppId(),Accept:"application/json",sdk:S.format(l.SDKHeader.sdk,l.SDKHeader.platform,l.SDKHeader.sdkVersion)};i||(e["Content-Type"]="application/json"),t.hasOwnProperty("isAdminApi")&&t.isAdminApi?a.getApiKey()?e.apiKey=a.getApiKey():o({error:"An apiKey is need to use the "+s+" api."}):a.getAuthToken()?e.authToken=a.getAuthToken():o({error:"An authToken is need to use the "+s+" api."}),T(t.endpoint,t.method,r,e,i).then(function(t){return t.json()}).then(function(t){t.hasOwnProperty("data")?(t.data.hasOwnProperty("authToken")&&u.CometChat.setAuthToken(t.data.authToken),n(t)):o(t)}).catch(function(t){var e={error:C.FETCH_ERROR.ERROR_IN_API_CALL};o(e)})}).catch(function(t){return o})})},e.postData=T},function(t,e,n){"use strict";e.__esModule=!0,e.BaseMessage=void 0;var o=function(){function t(t,e,n,o){this.receiverId=t,this.type=e,this.receiverType=n,this.category=o}return t.prototype.getId=function(){return this.id},t.prototype.setId=function(t){this.id=t},t.prototype.getConversationId=function(){return this.conversationId},t.prototype.setConversationId=function(t){this.conversationId=t},t.prototype.getParentMessageId=function(){return this.parentMessageId},t.prototype.setParentMessageId=function(t){this.parentMessageId=t},t.prototype.getMuid=function(){return this.muid},t.prototype.setMuid=function(t){this.muid=t},t.prototype.getSender=function(){return this.sender},t.prototype.setSender=function(t){this.sender=t},t.prototype.getReceiver=function(){return this.receiver},t.prototype.setReceiver=function(t){this.receiver=t},t.prototype.getReceiverId=function(){return this.receiverId},t.prototype.setReceiverId=function(t){this.receiverId=t},t.prototype.getType=function(){return this.type},t.prototype.setType=function(t){this.type=t},t.prototype.getReceiverType=function(){return this.receiverType},t.prototype.setReceiverType=function(t){this.receiverType=t},t.prototype.getSentAt=function(){return this.sentAt},t.prototype.setSentAt=function(t){this.sentAt=t},t.prototype.getStatus=function(){return this.status},t.prototype.setStatus=function(t){this.status=t},t.prototype.getDeliveredAt=function(){return this.deliveredAt},t.prototype.setDeliveredAt=function(t){this.deliveredAt=t},t.prototype.getDeliveredToMeAt=function(){return this.deliveredToMeAt},t.prototype.setDeliveredToMeAt=function(t){this.deliveredToMeAt=t},t.prototype.getReadAt=function(){return this.readAt},t.prototype.setReadAt=function(t){this.readAt=t},t.prototype.getReadByMeAt=function(){return this.readByMeAt},t.prototype.setReadByMeAt=function(t){this.readByMeAt=t},t.prototype.getCategory=function(){return this.category},t.prototype.setCategory=function(t){this.category=t},t.prototype.getEditedAt=function(){return this.editedAt},t.prototype.setEditedAt=function(t){this.editedAt=t},t.prototype.getEditedBy=function(){return this.editedBy},t.prototype.setEditedBy=function(t){this.editedBy=t},t.prototype.getDeletedAt=function(){return this.deletedAt},t.prototype.setDeletedAt=function(t){this.deletedAt=t},t.prototype.getDeletedBy=function(){return this.deletedBy},t.prototype.setDeletedBy=function(t){this.deletedBy=t},t.prototype.getReplyCount=function(){return this.replyCount},t.prototype.setReplyCount=function(t){this.replyCount=t},t.prototype.getRawMessage=function(){return this.rawMessage},t.prototype.setRawMessage=function(t){this.rawMessage=t},t}();e.BaseMessage=o},function(t,e,n){"use strict";e.__esModule=!0,e.Group=void 0;var o=n(1),s=function(){function t(t,e,n,o,s,r,i){this.hasJoined=!1,this.membersCount=0,this.guid=t,e&&(this.name=e),n&&(this.type=n),!o&&""!==o||"password"!=n||(this.password=o),(s||""===s)&&(this.icon=s),(r||""===r)&&(this.description=r),i&&(this.hasJoined=i)}return t.prototype.getGuid=function(){return this.guid},t.prototype.setGuid=function(t){this.guid=t},t.prototype.getName=function(){return this.name},t.prototype.setName=function(t){t&&(this.name=t)},t.prototype.getType=function(){return this.type},t.prototype.setType=function(t){this.type=t},t.prototype.getPassword=function(){return this.password},t.prototype.setPassword=function(t){this.password=t},t.prototype.getIcon=function(){return this.icon},t.prototype.setIcon=function(t){this.icon=t},t.prototype.getDescription=function(){return this.description},t.prototype.setDescription=function(t){this.description=t},t.prototype.getOwner=function(){return this.owner},t.prototype.setOwner=function(t){this.owner=t},t.prototype.getMetadata=function(){return this.metadata},t.prototype.setMetadata=function(t){this.metadata=t},t.prototype.getCreatedAt=function(){return this.createdAt},t.prototype.setCreatedAt=function(t){this.createdAt=t},t.prototype.getUpdatedAt=function(){return this.updatedAt},t.prototype.setUpdatedAt=function(t){this.updatedAt=t},t.prototype.getHasJoined=function(){return this.hasJoined},t.prototype.setHasJoined=function(t){this.hasJoined=t},t.prototype.getWsChannel=function(){return this.wsChannel},t.prototype.setWsChannel=function(t){this.wsChannel=t},t.prototype.setScope=function(t){this.scope=t},t.prototype.getScope=function(){return this.scope},t.prototype.getJoinedAt=function(){return this.joinedAt},t.prototype.setJoinedAt=function(t){this.joinedAt=t},t.prototype.getMembersCount=function(){return this.membersCount},t.prototype.setMembersCount=function(t){this.membersCount=t},t.prototype.setTags=function(t){this.tags=t},t.prototype.getTags=function(){return this.tags},t.TYPE=o.GroupType,t.Type=t.TYPE,t}();e.Group=s},function(t,e,n){"use strict";e.__esModule=!0,e.CometChatEvent=void 0;var i=n(0),o=n(4),s=function(){function t(t,e,n,o,s,r){i.isFalsy(t)||(this.appId=t),i.isFalsy(e)||(this.receiver=e),i.isFalsy(n)||(this.receiverType=n),i.isFalsy(s)||(this.deviceId=s),i.isFalsy(o)||(this.sender=o),i.isFalsy(r)||(this.messageSender=r)}return t.prototype.getAppId=function(){return this.appId},t.prototype.setAppId=function(t){this.appId=t},t.prototype.getReceiver=function(){return this.receiver},t.prototype.setReceiver=function(t){this.receiver=t},t.prototype.getSender=function(){return this.sender},t.prototype.setSender=function(t){this.sender=t},t.prototype.getReceiverType=function(){return this.receiverType},t.prototype.setReceiverType=function(t){this.receiverType=t},t.prototype.getType=function(){return this.type},t.prototype.setType=function(t){this.type=t},t.prototype.getDeviceId=function(){return this.deviceId},t.prototype.setDeviceId=function(t){this.deviceId=t},t.prototype.getMessageSender=function(){return this.messageSender},t.prototype.setMessageSender=function(t){this.messageSender=t},t.prototype.getCometChatEventJSON=function(){var t={};return t[o.KEYS.APP_ID]=this.getAppId(),t[o.KEYS.RECEIVER]=this.getReceiver(),t[o.KEYS.RECEIVER_TYPE]=this.getReceiverType(),t[o.KEYS.DEVICE_ID]=this.getDeviceId(),t[o.KEYS.TYPE]=this.getType(),t[o.KEYS.SENDER]=this.getSender(),i.isFalsy(this.getMessageSender())||(t[o.KEYS.MESSAGE_SENDER]=this.getMessageSender()),t},t}();e.CometChatEvent=s},function(t,e,n){"use strict";e.__esModule=!0,e.MessageController=void 0;var i=n(7),a=n(17),E=n(18),c=n(0),u=n(1),S=n(23),p=n(24),C=n(25),r=n(2),l=n(19),T=n(20),g=n(5),d=n(11),o=function(){function t(){}return t.trasformJSONMessge=function(n){try{var t=null;n.hasOwnProperty("rawMessage")||(t=JSON.parse(JSON.stringify(n)));var e=void 0;switch(n[u.MessageConstatnts.KEYS.CATEGORY]){case u.MessageConstatnts.CATEGORY.ACTION:e=S.Action.actionFromJSON(n);break;case u.MessageConstatnts.CATEGORY.CALL:e=p.Call.callFromJSON(n);break;case u.MessageConstatnts.CATEGORY.MESSAGE:switch(n[u.MessageConstatnts.KEYS.TYPE]){case u.MessageConstatnts.TYPE.TEXT:e=new a.TextMessage(n[u.MessageConstatnts.KEYS.RECEIVER],n[u.MessageConstatnts.KEYS.DATA][u.MessageConstatnts.KEYS.TEXT],n[u.MessageConstatnts.KEYS.RECEIVER_TYPE]);break;case u.MessageConstatnts.TYPE.CUSTOM:e=new T.CustomMessage(n[u.MessageConstatnts.KEYS.RECEIVER],n[u.MessageConstatnts.KEYS.DATA][u.MessageConstatnts.KEYS.CUSTOM_DATA],n[u.MessageConstatnts.KEYS.RECEIVER_TYPE]);break;default:if(e=new E.MediaMessage(n[u.MessageConstatnts.KEYS.RECEIVER],n[u.MessageConstatnts.KEYS.DATA][u.MessageConstatnts.KEYS.URL],n[u.MessageConstatnts.KEYS.TYPE],n[u.MessageConstatnts.KEYS.RECEIVER_TYPE]),n.hasOwnProperty(u.MessageConstatnts.KEYS.DATA)){var o=n[u.MessageConstatnts.KEYS.DATA];if(o.hasOwnProperty(u.MessageConstatnts.KEYS.ATTATCHMENTS)){var s,r=o[u.MessageConstatnts.KEYS.ATTATCHMENTS];new Array;r.map(function(t){s=new l.Attachment(t)}),e.setAttachment(s)}o.hasOwnProperty(u.MessageConstatnts.KEYS.TEXT)&&e.setCaption(o[u.MessageConstatnts.KEYS.TEXT])}e.hasOwnProperty("file")&&delete e.file}break;case u.MessageConstatnts.CATEGORY.CUSTOM:e=new T.CustomMessage(n[u.MessageConstatnts.KEYS.RECEIVER],n[u.MessageConstatnts.KEYS.DATA][u.MessageConstatnts.KEYS.CUSTOM_DATA],n[u.MessageConstatnts.KEYS.RECEIVER_TYPE],n.type)}n[u.MessageConstatnts.KEYS.MY_RECEIPTS]&&(n[u.MessageConstatnts.KEYS.MY_RECEIPTS]=n[u.MessageConstatnts.KEYS.MY_RECEIPTS],Object.keys(n[u.MessageConstatnts.KEYS.MY_RECEIPTS]).map(function(t){var e=new C.MessageReceipt;t==u.DELIVERY_RECEIPTS.DELIVERED_AT&&(e.setReceiptType(e.RECEIPT_TYPE.DELIVERY_RECEIPT),e.setDeliveredAt(n[u.MessageConstatnts.KEYS.MY_RECEIPTS][u.DELIVERY_RECEIPTS.DELIVERED_AT]),c.isFalsy(n[u.MessageConstatnts.KEYS.MY_RECEIPTS][u.DELIVERY_RECEIPTS.RECIPIENT])?n[u.DELIVERY_RECEIPTS.DELIVERED_TO_ME_AT]=n[u.MessageConstatnts.KEYS.MY_RECEIPTS][u.DELIVERY_RECEIPTS.DELIVERED_AT]:e.setSender(n[u.MessageConstatnts.KEYS.MY_RECEIPTS][u.DELIVERY_RECEIPTS.RECIPIENT]),e.setReceiverType(n[u.MessageConstatnts.KEYS.RECEIVER_TYPE]),e.setReceiver(n[u.MessageConstatnts.KEYS.RECEIVER])),n[u.MessageConstatnts.KEYS.MY_RECEIPTS][u.READ_RECEIPTS.READ_AT]&&(e.setReceiptType(e.RECEIPT_TYPE.READ_RECEIPT),e.setReadAt(n[u.MessageConstatnts.KEYS.MY_RECEIPTS][u.READ_RECEIPTS.READ_AT]),c.isFalsy(n[u.MessageConstatnts.KEYS.MY_RECEIPTS][u.READ_RECEIPTS.RECIPIENT])?n[u.READ_RECEIPTS.READ_BY_ME_AT]=n[u.MessageConstatnts.KEYS.MY_RECEIPTS][u.READ_RECEIPTS.READ_AT]:e.setSender(n[u.MessageConstatnts.KEYS.MY_RECEIPTS][u.READ_RECEIPTS.RECIPIENT]),e.setReceiverType(n[u.MessageConstatnts.KEYS.RECEIVER_TYPE]),e.setReceiver(n[u.MessageConstatnts.KEYS.RECEIVER]))}));try{if(Object.assign(e,n),(n=e).parentId&&(n.parentMessageId=n.parentId,delete n.parentId),n instanceof i.BaseMessage&&(c.isFalsy(t)||n.setRawMessage(t)),n instanceof a.TextMessage)n.setSender(n.getSender()),n.setReceiver(n.getReceiver()),n.getData()[u.MessageConstatnts.KEYS.METADATA]&&n.setMetadata(n.getData()[u.MessageConstatnts.KEYS.METADATA]);else if(n instanceof E.MediaMessage)n.getData()[u.MessageConstatnts.KEYS.METADATA]&&n.setMetadata(n.getData()[u.MessageConstatnts.KEYS.METADATA]),n.setSender(n.getSender()),n.setReceiver(n.getReceiver());else if(n instanceof S.Action)n.setSender(n.getSender()),n.setReceiver(n.getActionFor()),n.setActionBy(n.getActionBy()),n.setActionOn(n.getActionOn()),n.setActionFor(n.getActionFor()),n.setMessage(n.getMessage());else if(n instanceof p.Call){try{n.setSender(n.getSender())}catch(t){c.Logger.error("MessageController: trasformJSONMessge: setSender",t)}try{n.setCallInitiator(n.getCallInitiator())}catch(t){c.Logger.error("MessageController: trasformJSONMessge: setCallInitiator",t)}try{n.setReceiver(n.getCallReceiver()),n.setCallReceiver(n.getCallReceiver())}catch(t){c.Logger.error("MessageController: trasformJSONMessge: setCallreceiver",t)}}else n instanceof T.CustomMessage&&(n.getData()[u.MessageConstatnts.KEYS.METADATA]&&n.setMetadata(n.getData()[u.MessageConstatnts.KEYS.METADATA]),n.setCustomData(n.getData()[u.MessageConstatnts.KEYS.CUSTOM_DATA]),n.setSubType(n.getData()[u.MessageConstatnts.KEYS.CUSTOM_SUB_TYPE]),n.setSender(n.getSender()),n.setReceiver(n.getReceiver()))}catch(t){c.Logger.error("MessageController: trasformJSONMessge: Main",t),n=null}return n}catch(t){c.Logger.error("MessageController: trasformJSONMessge",t)}},t.getReceiptsFromJSON=function(s){return new Promise(function(t,e){try{var o=[];g.CometChat.getLoggedInUser().then(function(n){c.isFalsy(s.receipts)?t([]):(s.receipts.data.map(function(t){var e=new C.MessageReceipt;t[u.DELIVERY_RECEIPTS.DELIVERED_AT]&&(e.setReceiptType(e.RECEIPT_TYPE.DELIVERY_RECEIPT),e.setDeliveredAt(t[u.DELIVERY_RECEIPTS.DELIVERED_AT]),e.setTimestamp(t[u.DELIVERY_RECEIPTS.DELIVERED_AT]),c.isFalsy(t[u.DELIVERY_RECEIPTS.RECIPIENT])?e.setSender(n):e.setSender(d.UsersController.trasformJSONUser(t[u.DELIVERY_RECEIPTS.RECIPIENT])),e.setReceiverType(s[u.MessageConstatnts.KEYS.RECEIVER_TYPE]),e.setReceiver(s[u.MessageConstatnts.KEYS.RECEIVER])),t[u.READ_RECEIPTS.READ_AT]&&(e.setReceiptType(e.RECEIPT_TYPE.READ_RECEIPT),e.setReadAt(t[u.READ_RECEIPTS.READ_AT]),e.setTimestamp(t[t[u.READ_RECEIPTS.READ_AT]]),c.isFalsy(t[u.READ_RECEIPTS.RECIPIENT])?e.setSender(n):e.setSender(d.UsersController.trasformJSONUser(t[u.READ_RECEIPTS.RECIPIENT])),e.setReceiverType(s[u.MessageConstatnts.KEYS.RECEIVER_TYPE]),e.setReceiver(s[u.MessageConstatnts.KEYS.RECEIVER])),o.push(e)}),t(o))})}catch(t){e(new r.CometChatException(t))}})},t}();e.MessageController=o},function(t,e,n){"use strict";e.__esModule=!0,e.UsersController=void 0;var o=n(3),s=n(0),r=function(){function t(){}return t.trasformJSONUser=function(t){var e;try{t.uid=t.uid.toString(),t.name=t.name.toString(),t.status&&"offline"!==t.status?t.status="online":t.status="offline",e=new o.User(t),Object.assign(e,t),t=e}catch(t){s.Logger.error("UsersController:transformJSONUser",t)}return t},t}();e.UsersController=r},function(t,e){t.exports=n},function(t,e,n){"use strict";e.__esModule=!0,e.FETCH_ERROR=e.TYPINGNOTIFICATION_CONSTANTS=e.LOGIN_ERROR=e.MESSAGE_ERRORS=e.MESSAGES_REQUEST_ERRORS=e.USERS_REQUEST_ERRORS=e.GROUP_CREATION_ERRORS=e.INIT_ERROR=e.ERRORS=e.SERVER_ERRORS=void 0,e.SERVER_ERRORS={AUTH_ERR:{code:"AUTH_ERR_AUTH_TOKEN_NOT_FOUND",message:"The auth token %s% does not exist. Please make sure you are logged in and have a valid auth token or try login again."}},e.ERRORS={PARAMETER_MISSING:{code:"MISSING_PARAMETERS",name:"Invalid or no parameter passed to the method."}},e.INIT_ERROR={NO_APP_ID:{code:e.ERRORS.PARAMETER_MISSING.code,name:e.ERRORS.PARAMETER_MISSING.name,message:"AppID cannot be empty. Please specify a valid appID.",details:{}}},e.GROUP_CREATION_ERRORS={EMPTY_PASSWORD:{code:"ERR_EMPTY_GROUP_PASS",details:void 0,message:"Password is mandatory to join a group.",name:void 0}},e.USERS_REQUEST_ERRORS={EMPTY_USERS_LIST:{code:"EMPTY_USERS_LIST",name:"EMPTY_USERS_LIST",message:"The users list needs to have atleast one UID.",details:{}}},e.MESSAGES_REQUEST_ERRORS={REQUEST_IN_PROGRESS_ERROR:{code:"REQUEST_IN_PROGRESS",name:"REQUEST_IN_PROGRESS",message:"Request in progress.",details:{}},NOT_ENOUGH_PARAMS:{code:"NOT_ENOUGH_PARAMETERS",name:"NOT_ENOUGH_PARAMETERS",message:"`Timestamp`, `MessageId` or `updatedAfter` is required to use the 'fetchNext()' method.",details:{}}},e.MESSAGE_ERRORS={INVALID_CUSTOM_DATA:{code:"-1",name:"%s_CUSTOM_DATA",message:"",details:{}}},e.LOGIN_ERROR={NOT_INITIALIZED:{code:"-1",name:"COMETCHAT_INITIALIZATION_NOT_DONE",message:"please initialize the cometchat before using login method.",details:{}},UNAUTHORISED:{code:401,name:"USER_NOT_AUTHORISED",message:"The `authToken` of the user is not authorised. Please verify again.",details:{}},WS_CONNECTION_FAIL:{code:-1,name:"WS_CONNECTION_FAIL",message:"WS Connection failed. %s",details:{}},WS_CONNECTION_FAIL_PORT_ERROR:{code:-1,name:"WS_CONNECTION_FAIL",message:"WS Connection failed. Trying to connect with port: %s",details:{}},WS_CONNECTION_FALLBACK_FAIL_PORT_ERROR:{code:-1,name:"WS_CONNECTION_FALLBACK_FAIL",message:"WS Connection fallback failed. Trying to connect with port: %s",details:{}},WS_AUTH_FAIL:{code:-1,name:"WS_AUTH_FAIL",message:"WS username/password not correct.",details:{}},NO_INTERNET:{code:-1,name:"NO_INTERNET_CONNECTION",message:"You do not have internet connection.",details:{}},REQUEST_IN_PROGRESS:{code:-1,name:"LOGIN_IN_PROGRESS",message:"Please wait until the previous login request ends.",details:{}}},e.TYPINGNOTIFICATION_CONSTANTS={TOO_MANY_REQUEST:{code:"TOO_MANY_REQUEST",name:"TOO MANY REQUEST",message:"too many request, wait for `%s` seconds before sending next request.",details:{}}},e.FETCH_ERROR={ERROR_IN_API_CALL:{code:"FAILED_TO_FETCH",name:"FAILED_TO_FETCH",message:"There is an unknown issue with the API request. Please check your internet connection and verify the api call.",details:{}}}},function(t,e,n){"use strict";e.__esModule=!0,e.LocalStorage=void 0;var r=n(0),i=n(1),a=n(2),o=n(12),s=function(){function t(t){this.store=i.constants.DEFAULT_STORE,r.isFalsy(t)||(this.store=t);try{this.localStore=o.default}catch(t){r.Logger.error("store: constructor",{e:t})}}return t.getInstance=function(){return null==t.localStorage&&(t.localStorage=new t),t.localStorage},t.prototype.set=function(t,e){var n=r.getKeyprefix(i.LOCAL_STORE.COMMON_STORE,t);return this.localStore.setItem(n,JSON.stringify(e))},t.prototype.get=function(t){var o=this,s=r.getKeyprefix(i.LOCAL_STORE.COMMON_STORE,t);return new Promise(function(n,e){try{o.localStore.getItem(s).then(function(e){try{n(JSON.parse(e))}catch(t){n(e)}},function(t){e(t)})}catch(t){e(new a.CometChatException(t))}})},t.prototype.clearStore=function(){var s=this;return new Promise(function(n,e){try{var o=[r.getKeyprefix(i.LOCAL_STORE.COMMON_STORE,i.LOCAL_STORE.KEY_USER),r.getKeyprefix(i.LOCAL_STORE.COMMON_STORE,i.LOCAL_STORE.KEY_APP_SETTINGS)];s.localStore.getAllKeys().then(function(t){if(0<t.length)for(var e=0;e<t.length;e++)-1!==o.indexOf(t[e])&&s.localStore.removeItem(t[e]),e===t.length-1&&n(!0);else n(!0)},function(t){e(t)})}catch(t){e(t)}})},t.prototype.clear=function(t){},t.prototype.selectStore=function(t){this.store=t},t.localStorage=null,t}();e.LocalStorage=s},function(t,e,n){"use strict";e.__esModule=!0,e.CallController=void 0;var s=n(1),r=n(0),o=n(5),i=n(2),a=n(21),E=n(35),c=function(){function t(){this.TAG="calling Log",this.callListner=void 0,this.CALL_NO_ANSWER_INTERVAL=45e3}return t.prototype.getCallListner=function(){return this.callListner},t.prototype.setCallListner=function(t){this.callListner=new a.UserCallListener(t)},t.getInstance=function(){try{return null!=this.callController&&null!=this.callController||(this.callController=new t),this.callController}catch(t){r.Logger.error("CallController: getInstance",t)}},t.prototype.getActiveCall=function(){try{return r.isFalsy(this.call)?null:this.call}catch(t){r.Logger.error("CallController: getActiveCall",t)}},t.prototype.initiateCall=function(n){var o=this;return new Promise(function(t,e){try{r.isFalsy(o.call)?null!=n&&null!=n?(o.call=n,o.startCallTimer(),t(n)):e(new i.CometChatException(s.CALL_ERROR.ERROR_IN_CALLING)):e(new i.CometChatException(s.CALL_ERROR.CALL_ALREADY_INITIATED))}catch(t){e(new i.CometChatException(t))}})},t.prototype.endCall=function(t){try{this.endCallSession()}catch(t){r.Logger.error("CallController: endCall",t)}},t.prototype.onCallStarted=function(n){var o=this;return new Promise(function(t,e){try{r.isFalsy(o.call)?null!=n&&null!=n?t(o.call=n):e(new i.CometChatException(s.CALL_ERROR.ERROR_IN_CALLING)):e(new i.CometChatException(s.CALL_ERROR.CALL_ALREADY_INITIATED))}catch(t){e(new i.CometChatException(t))}})},t.prototype.endCallSession=function(){try{this.call=void 0,t.callController=void 0,this.timer&&this.stopCallTimer()}catch(t){r.Logger.error("CallController:EndCallSession",{e:t})}},t.prototype.startCallTimer=function(){var e=this;try{this.timer=setTimeout(function(){e.call?o.CometChat.sendUnansweredResponse(e.call.getSessionId()).then(function(t){e.endCallSession()},function(t){e.endCallSession()}):e.endCallSession()},this.CALL_NO_ANSWER_INTERVAL)}catch(t){r.Logger.error("CallController: startCallTimer",t)}},t.prototype.stopCallTimer=function(){try{clearTimeout(this.timer)}catch(t){r.Logger.error("CallController: stopCallTimer",t)}},t.prototype.callStarted=function(){this.timer&&this.stopCallTimer()},t.prototype.muteAudio=function(t){E.CallingComponent.muteAudio(t)},t.prototype.pauseVideo=function(t){E.CallingComponent.pauseVideo(t)},t.prototype.endSession=function(t,e){void 0===t&&(t=!1),E.CallingComponent.endCall(t,e)},t.prototype.setAudioMode=function(t){E.CallingComponent.setAudioMode(t)},t.prototype.switchCamera=function(){E.CallingComponent.switchCamera()},t.prototype.getAudioOutputModes=function(){return new Promise(function(e,n){E.CallingComponent.getAudioOutputModes().then(function(t){e(t)},function(t){n(t)})})},t.prototype.switchToVideoCall=function(){E.CallingComponent.switchToVideoCall()},t.prototype.startRecording=function(){E.CallingComponent.startCallRecording()},t.prototype.stopRecording=function(){E.CallingComponent.stopCallRecording()},t.callController=void 0,t}();e.CallController=c},function(t,e,n){"use strict";e.__esModule=!0,e.GroupsController=void 0;var o=n(8),s=n(1),r=n(0),i=function(){function t(){}return t.trasformJSONGroup=function(t){var e;try{e=new o.Group(t[s.GroupConstants.KEYS.GUID],t[s.GroupConstants.KEYS.NAME],t[s.GroupConstants.KEYS.TYPE]),t.wsChannel&&delete t.wsChannel,Object.assign(e,t),t=e}catch(t){r.Logger.error("GroupsController:transformJSONGroup",t)}return t},t}();e.GroupsController=i},function(t,e,n){"use strict";var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__assign||function(){return(i=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var s in e=arguments[n])Object.prototype.hasOwnProperty.call(e,s)&&(t[s]=e[s]);return t}).apply(this,arguments)};e.__esModule=!0,e.TextMessage=void 0;var s=n(7),a=n(1),E=n(3),c=n(8),u=n(0),S=function(s){function t(t,e,n){var o=s.call(this,t,"text",n,a.MessageCategory.MESSAGE)||this;return o.type="text",o.data={text:e},o.text=e,o}return r(t,s),t.prototype.getSender=function(){try{return this.getSenderFromData()}catch(t){return this.sender}},t.prototype.getReceiver=function(){try{return this.getReceiverFromData()}catch(t){return this.receiver}},t.prototype.getMetadata=function(){return this.data.metadata&&(this.metadata=this.data.metadata),this.metadata},t.prototype.setMetadata=function(t){this.metadata=t,this.data=i(i({},this.data),{metadata:t})},t.prototype.getData=function(){return this.data},t.prototype.setData=function(t){this.data=t},t.prototype.getText=function(){return this.text},t.prototype.setText=function(t){this.text=t,this.data.text=t},t.prototype.setProcessedText=function(t){this.processedText=t},t.prototype.getProcessedText=function(){return this.processedText},t.prototype.getTags=function(){return this.tags},t.prototype.setTags=function(t){this.tags=t},t.prototype.getSenderFromData=function(){try{var t=this.getData();if(t[a.ResponseConstants.RESPONSE_KEYS.KEY_ENTITIES][a.MessageConstatnts.KEYS.SENDER][a.ResponseConstants.RESPONSE_KEYS.KEY_ENTITITY])return new E.User(t[a.ResponseConstants.RESPONSE_KEYS.KEY_ENTITIES][a.MessageConstatnts.KEYS.SENDER][a.ResponseConstants.RESPONSE_KEYS.KEY_ENTITITY])}catch(t){u.Logger.error("TextMessageModel: getSenderFromData",t)}},t.prototype.getReceiverFromData=function(){try{var t=this.getData(),e=t[a.ResponseConstants.RESPONSE_KEYS.KEY_ENTITIES][a.MessageConstatnts.KEYS.RECEIVER][a.ResponseConstants.RESPONSE_KEYS.KEY_ENTITITY];if(t[a.ResponseConstants.RESPONSE_KEYS.KEY_ENTITIES][a.MessageConstatnts.KEYS.RECEIVER][a.ResponseConstants.RESPONSE_KEYS.KEY_ENTITYTYPE]==[a.ResponseConstants.RESPONSE_KEYS.KEY_ENTITY_TYPE.USER])return new E.User(e);var n=new c.Group(e[a.GroupConstants.KEYS.GUID],e[a.GroupConstants.KEYS.NAME],e[a.MessageConstatnts.KEYS.TYPE]);return Object.assign(n,e)}catch(t){u.Logger.error("TextMessageModel: getReceiverFromData",t)}},t.TYPE=a.MessageConstatnts.TYPE.TEXT,t.RECEIVER_TYPE=a.MessageConstatnts.RECEIVER_TYPE,t.CATEGORY=a.MessageConstatnts.CATEGORY.MESSAGE,t}(s.BaseMessage);e.TextMessage=S},function(t,e,n){"use strict";var o,s=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__assign||function(){return(i=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var s in e=arguments[n])Object.prototype.hasOwnProperty.call(e,s)&&(t[s]=e[s]);return t}).apply(this,arguments)};e.__esModule=!0,e.MediaMessage=void 0;var r=n(7),a=n(1),E=n(3),c=n(19),u=n(8),S=n(0),p=function(r){function t(t,e,n,o){var s=r.call(this,t,n,o,a.MessageCategory.MESSAGE)||this;return s.data={},"object"!=typeof e?s.data={url:e}:S.isFalsy(e)||(0<e.length?s.files=e:s.files=[e]),s}return s(t,r),t.prototype.setCaption=function(t){this.caption=t,this.data[a.MessageConstatnts.KEYS.TEXT]=t},t.prototype.getCaption=function(){return this.data[a.MessageConstatnts.KEYS.TEXT]},t.prototype.getSender=function(){try{return this.getSenderFromData()}catch(t){return this.sender}},t.prototype.getReceiver=function(){try{return this.getReceiverFromData()}catch(t){return this.receiver}},t.prototype.getMetadata=function(){return this.data.metadata&&(this.metadata=this.data.metadata),this.metadata},t.prototype.setMetadata=function(t){this.metadata=t,this.data=i(i({},this.data),{metadata:t})},t.prototype.getData=function(){return this.data},t.prototype.setData=function(t){this.data=t},t.prototype.getAttachment=function(){return new c.Attachment(this.data.attachments[0])},t.prototype.setAttachment=function(t){this.data.attachments=[c.Attachment.toJSON(t)]},t.prototype.getAttachments=function(){var t=[];if(this.data.attachments&&0<this.data.attachments.length)for(var e=0;e<this.data.attachments.length;e++)t.push(new c.Attachment(this.data.attachments[e]));return t},t.prototype.setAttachments=function(t){var e=[];if(t&&0<t.length)for(var n=0;n<t.length;n++)e.push(c.Attachment.toJSON(t[n]));this.data.attachments=e},t.prototype.getURL=function(){try{var t=this.getData();if(t[a.MessageConstatnts.KEYS.URL])return t[a.MessageConstatnts.KEYS.URL]}catch(t){S.Logger.error("MediaMessageModel: getURL",t)}},t.prototype.getTags=function(){return this.tags},t.prototype.setTags=function(t){this.tags=t},t.prototype.getSenderFromData=function(){try{var t=this.getData();if(t[a.ResponseConstants.RESPONSE_KEYS.KEY_ENTITIES][a.MessageConstatnts.KEYS.SENDER][a.ResponseConstants.RESPONSE_KEYS.KEY_ENTITITY])return new E.User(t[a.ResponseConstants.RESPONSE_KEYS.KEY_ENTITIES][a.MessageConstatnts.KEYS.SENDER][a.ResponseConstants.RESPONSE_KEYS.KEY_ENTITITY])}catch(t){S.Logger.error("MediaMessageModel: getSenderFromData",t)}},t.prototype.getReceiverFromData=function(){try{var t=this.getData(),e=t[a.ResponseConstants.RESPONSE_KEYS.KEY_ENTITIES][a.MessageConstatnts.KEYS.RECEIVER][a.ResponseConstants.RESPONSE_KEYS.KEY_ENTITITY];if(t[a.ResponseConstants.RESPONSE_KEYS.KEY_ENTITIES][a.MessageConstatnts.KEYS.RECEIVER][a.ResponseConstants.RESPONSE_KEYS.KEY_ENTITYTYPE]==[a.ResponseConstants.RESPONSE_KEYS.KEY_ENTITY_TYPE.USER])return new E.User(e);var n=new u.Group(e[a.GroupConstants.KEYS.GUID],e[a.GroupConstants.KEYS.NAME],e[a.MessageConstatnts.KEYS.TYPE]);return Object.assign(n,e)}catch(t){S.Logger.error("MediaMessageModel: getReceiverFromData",t)}},t.TYPE=a.MessageConstatnts.TYPE,t.RECEIVER_TYPE=a.MessageConstatnts.RECEIVER_TYPE,t.CATEGORY=a.MessageConstatnts.CATEGORY,t}(r.BaseMessage);e.MediaMessage=p},function(t,e,n){"use strict";e.__esModule=!0,e.Attachment=void 0;var o=n(1),s=function(){function e(t){t.hasOwnProperty(o.ATTACHMENTS_CONSTANTS.KEYS.EXTENSION)&&(this.extension=t[o.ATTACHMENTS_CONSTANTS.KEYS.EXTENSION]),t.hasOwnProperty(o.ATTACHMENTS_CONSTANTS.KEYS.MIME_TYPE)&&(this.mimeType=t[o.ATTACHMENTS_CONSTANTS.KEYS.MIME_TYPE]),t.hasOwnProperty(o.ATTACHMENTS_CONSTANTS.KEYS.NAME)&&(this.name=t[o.ATTACHMENTS_CONSTANTS.KEYS.NAME]),t.hasOwnProperty(o.ATTACHMENTS_CONSTANTS.KEYS.SIZE)&&(this.size=t[o.ATTACHMENTS_CONSTANTS.KEYS.SIZE]),t.hasOwnProperty(o.ATTACHMENTS_CONSTANTS.KEYS.URL)&&(this.url=t[o.ATTACHMENTS_CONSTANTS.KEYS.URL])}return e.prototype.createFileFromJSON=function(t){return new e(t)},e.toJSON=function(t){return{extension:t.getExtension(),mimeType:t.getMimeType(),name:t.getName(),url:t.getUrl(),size:t.getSize()}},e.prototype.getExtension=function(){return this.extension},e.prototype.setExtension=function(t){this.extension=t},e.prototype.getMimeType=function(){return this.mimeType},e.prototype.setMimeType=function(t){this.mimeType=t},e.prototype.getName=function(){return this.name},e.prototype.setName=function(t){this.name=t},e.prototype.getSize=function(){return this.size},e.prototype.setSize=function(t){this.size=t},e.prototype.getUrl=function(){return this.url},e.prototype.setUrl=function(t){this.url=t},e}();e.Attachment=s},function(t,e,n){"use strict";var o,s=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),r=this&&this.__assign||function(){return(r=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var s in e=arguments[n])Object.prototype.hasOwnProperty.call(e,s)&&(t[s]=e[s]);return t}).apply(this,arguments)};e.__esModule=!0,e.CustomMessage=void 0;var i=n(7),E=n(1),c=n(3),u=n(0),S=n(8),a=function(a){function t(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=this;if(3==t.length){var o=t[0],s=t[1],r=t[2];n=a.call(this,o,E.MessageConstatnts.TYPE.CUSTOM,s,E.MessageCategory.MESSAGE)||this,("object"!=typeof r||Array.isArray(r))&&(r={}),n.customData=r,u.isFalsy(n.data)&&(n.data={}),n.data[E.MessageConstatnts.KEYS.CUSTOM_DATA]=r}if(4==t.length){o=t[0],s=t[1];var i=t[2];r=t[3];n=a.call(this,o,i,s,E.MessageCategory.CUSTOM)||this,("object"!=typeof r||Array.isArray(r))&&(r={}),n.customData=r,u.isFalsy(n.data)&&(n.data={}),n.data[E.MessageConstatnts.KEYS.CUSTOM_DATA]=r}return n}return s(t,a),t.prototype.getCustomData=function(){return this.customData},t.prototype.setCustomData=function(t){this.customData=t,this.data[E.MessageConstatnts.KEYS.CUSTOM_DATA]=t},t.prototype.getSender=function(){try{return this.getSenderFromData()}catch(t){return this.sender}},t.prototype.getReceiver=function(){try{return this.getReceiverFromData()}catch(t){return this.receiver}},t.prototype.getSubType=function(){return this.subType},t.prototype.setSubType=function(t){this.subType=t,this.data=r(r({},this.data),{subType:t})},t.prototype.getMetadata=function(){return this.metadata},t.prototype.setMetadata=function(t){this.metadata=t,this.data=r(r({},this.data),{metadata:t})},t.prototype.getData=function(){return this.data},t.prototype.getTags=function(){return this.tags},t.prototype.setTags=function(t){this.tags=t},t.prototype.getSenderFromData=function(){try{var t=this.getData();if(t[E.ResponseConstants.RESPONSE_KEYS.KEY_ENTITIES][E.MessageConstatnts.KEYS.SENDER][E.ResponseConstants.RESPONSE_KEYS.KEY_ENTITITY])return new c.User(t[E.ResponseConstants.RESPONSE_KEYS.KEY_ENTITIES][E.MessageConstatnts.KEYS.SENDER][E.ResponseConstants.RESPONSE_KEYS.KEY_ENTITITY])}catch(t){u.Logger.error("CustomMessageModel: getSenderFromData",t)}},t.prototype.getReceiverFromData=function(){try{var t=this.getData(),e=t[E.ResponseConstants.RESPONSE_KEYS.KEY_ENTITIES][E.MessageConstatnts.KEYS.RECEIVER][E.ResponseConstants.RESPONSE_KEYS.KEY_ENTITITY];if(t[E.ResponseConstants.RESPONSE_KEYS.KEY_ENTITIES][E.MessageConstatnts.KEYS.RECEIVER][E.ResponseConstants.RESPONSE_KEYS.KEY_ENTITYTYPE]==[E.ResponseConstants.RESPONSE_KEYS.KEY_ENTITY_TYPE.USER])return new c.User(e);var n=new S.Group(e[E.GroupConstants.KEYS.GUID],e[E.GroupConstants.KEYS.NAME],e[E.MessageConstatnts.KEYS.TYPE]);return Object.assign(n,e)}catch(t){u.Logger.error("CustomMessageModel: getReceiverFromData",t)}},t}(i.BaseMessage);e.CustomMessage=a},function(t,e,n){"use strict";var o,i=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});e.__esModule=!0,e.WSConnectionListener=e.UserLoginListener=e.CallsListener=e.UserCallListener=e.GroupsListener=e.UsersListener=e.MessagesListener=e.Listener=e.ConnectionListener=e.LoginListener=e.OngoingCallListener=e.GroupListener=e.UserListener=e.CallListener=e.MessageListener=void 0;var s=n(0),r=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.onTextMessageReceived=void 0,this.onMediaMessageReceived=void 0,this.onCustomMessageReceived=void 0,this.onTypingStarted=void 0,this.onTypingEnded=void 0,this.onMessagesDelivered=void 0,this.onMessagesRead=void 0,this.onMessageEdited=void 0,this.onMessageDeleted=void 0,this.onTransientMessageReceived=void 0,s.isFalsy(t[0].onTextMessageReceived)||(this.onTextMessageReceived=t[0].onTextMessageReceived),s.isFalsy(t[0].onMediaMessageReceived)||(this.onMediaMessageReceived=t[0].onMediaMessageReceived),s.isFalsy(t[0].onTypingStarted)||(this.onTypingStarted=t[0].onTypingStarted),s.isFalsy(t[0].onTypingEnded)||(this.onTypingEnded=t[0].onTypingEnded),s.isFalsy(t[0].onMessagesDelivered)||(this.onMessagesDelivered=t[0].onMessagesDelivered),s.isFalsy(t[0].onMessagesRead)||(this.onMessagesRead=t[0].onMessagesRead),s.isFalsy(t[0].onCustomMessageReceived)||(this.onCustomMessageReceived=t[0].onCustomMessageReceived),s.isFalsy(t[0].onMessageEdited)||(this.onMessageEdited=t[0].onMessageEdited),s.isFalsy(t[0].onMessageDeleted)||(this.onMessageDeleted=t[0].onMessageDeleted),s.isFalsy(t[0].onTransientMessageReceived)||(this.onTransientMessageReceived=t[0].onTransientMessageReceived)};e.MessageListener=r;var a=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.onIncomingCallReceived=void 0,this.onOutgoingCallAccepted=void 0,this.onOutgoingCallRejected=void 0,this.onIncomingCallCancelled=void 0,this.onCallEndedMessageReceived=void 0,s.isFalsy(t[0].onIncomingCallReceived)||(this.onIncomingCallReceived=t[0].onIncomingCallReceived),s.isFalsy(t[0].onOutgoingCallAccepted)||(this.onOutgoingCallAccepted=t[0].onOutgoingCallAccepted),s.isFalsy(t[0].onOutgoingCallRejected)||(this.onOutgoingCallRejected=t[0].onOutgoingCallRejected),s.isFalsy(t[0].onIncomingCallCancelled)||(this.onIncomingCallCancelled=t[0].onIncomingCallCancelled),s.isFalsy(t[0].onCallEndedMessageReceived)||(this.onCallEndedMessageReceived=t[0].onCallEndedMessageReceived)};e.CallListener=a;var E=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];s.isFalsy(t[0].onUserOnline)||(this.onUserOnline=t[0].onUserOnline),s.isFalsy(t[0].onUserOffline)||(this.onUserOffline=t[0].onUserOffline)};e.UserListener=E;var c=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];s.isFalsy(t[0].onGroupMemberJoined)||(this.onGroupMemberJoined=t[0].onGroupMemberJoined),s.isFalsy(t[0].onGroupMemberLeft)||(this.onGroupMemberLeft=t[0].onGroupMemberLeft),s.isFalsy(t[0].onGroupMemberKicked)||(this.onGroupMemberKicked=t[0].onGroupMemberKicked),s.isFalsy(t[0].onGroupMemberBanned)||(this.onGroupMemberBanned=t[0].onGroupMemberBanned),s.isFalsy(t[0].onGroupMemberUnbanned)||(this.onGroupMemberUnbanned=t[0].onGroupMemberUnbanned),s.isFalsy(t[0].onGroupMemberScopeChanged)||(this.onGroupMemberScopeChanged=t[0].onGroupMemberScopeChanged),s.isFalsy(t[0].onMemberAddedToGroup)||(this.onGroupMemberAddedToGroup=t[0].onMemberAddedToGroup)};e.GroupListener=c;var u=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];s.isFalsy(t[0].onYouLeft)||(this.onYouLeft=t[0].onYouLeft),s.isFalsy(t[0].onYouJoined)||(this.onYouJoined=t[0].onYouJoined),s.isFalsy(t[0].onUserJoined)||(this.onUserJoined=t[0].onUserJoined),s.isFalsy(t[0].onUserLeft)||(this.onUserLeft=t[0].onUserLeft),s.isFalsy(t[0].onUserListUpdated)||(this.onUserListUpdated=t[0].onUserListUpdated),s.isFalsy(t[0].onAudioModesUpdated)||(this.onAudioModesUpdated=t[0].onAudioModesUpdated),s.isFalsy(t[0].onCallEnded)||(this.onCallEnded=t[0].onCallEnded),s.isFalsy(t[0].onError)||(this.onError=t[0].onError),s.isFalsy(t[0].onRecordingStarted)||(this.onRecordingStarted=t[0].onRecordingStarted),s.isFalsy(t[0].onRecordingStopped)||(this.onRecordingStopped=t[0].onRecordingStopped),s.isFalsy(t[0].onUserMuted)||(this.onUserMuted=t[0].onUserMuted),s.isFalsy(t[0].onCallSwitchedToVideo)||(this.onCallSwitchedToVideo=t[0].onCallSwitchedToVideo)};e.OngoingCallListener=u;var S=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];s.isFalsy(t[0].loginSuccess)||(this.loginSuccess=t[0].loginSuccess),s.isFalsy(t[0].loginFailure)||(this.loginFailure=t[0].loginFailure),s.isFalsy(t[0].logoutSuccess)||(this.logoutSuccess=t[0].logoutSuccess),s.isFalsy(t[0].logoutFailure)||(this.logoutFailure=t[0].logoutFailure)};e.LoginListener=S;var p=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.onConnected=void 0,this.inConnecting=void 0,this.onDisconnected=void 0,this.onConnectionError=void 0,this.onFeatureThrottled=void 0,s.isFalsy(t[0].onConnected)||(this.onConnected=t[0].onConnected),s.isFalsy(t[0].inConnecting)||(this.inConnecting=t[0].inConnecting),s.isFalsy(t[0].onDisconnected)||(this.onDisconnected=t[0].onDisconnected),s.isFalsy(t[0].onConnectionError)||(this.onConnectionError=t[0].onConnectionError),s.isFalsy(t[0].onFeatureThrottled)||(this.onFeatureThrottled=t[0].onFeatureThrottled)};e.ConnectionListener=p;var C=function(t,e){this._name=t,this._callback=e},l=function(r){function t(t,e,n,o){var s=r.call(this,t,o)||this;return s._eventListener=e,n&&(s._cursor=n),s}return i(t,r),t}(e.Listener=C);e.MessagesListener=l;var T=function(r){function t(t,e,n,o){var s=r.call(this,t,o)||this;return s._eventListener=e,n&&(s._cursor=n),s}return i(t,r),t}(C);e.UsersListener=T;var g=function(r){function t(t,e,n,o){var s=r.call(this,t,o)||this;return s._eventListener=e,n&&(s._cursor=n),s}return i(t,r),t}(C);e.GroupsListener=g;var d=function(s){function t(t,e,n){var o=s.call(this,"callListner",n)||this;return o._eventListener=t,o}return i(t,s),t}(C);e.UserCallListener=d;var _=function(r){function t(t,e,n,o){var s=r.call(this,t,o)||this;return s._eventListener=e,s}return i(t,r),t}(C);e.CallsListener=_;var h=function(r){function t(t,e,n,o){var s=r.call(this,t,o)||this;return s._eventListener=e,n&&(s._cursor=n),s}return i(t,r),t}(C);e.UserLoginListener=h;var R=function(r){function t(t,e,n,o){var s=r.call(this,t,o)||this;return s._eventListener=e,n&&(s._cursor=n),s}return i(t,r),t}(C);e.WSConnectionListener=R},function(t,e){t.exports=o},function(t,e,n){"use strict";var o,s=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),r=this&&this.__assign||function(){return(r=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var s in e=arguments[n])Object.prototype.hasOwnProperty.call(e,s)&&(t[s]=e[s]);return t}).apply(this,arguments)};e.__esModule=!0,e.Action=void 0;var i=n(7),c=n(8),u=n(3),S=n(1),a=n(0),p=n(10),E=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e.actionFromJSON=function(t){var e=new this(t[S.MessageConstatnts.KEYS.RECEIVER],t[S.MessageConstatnts.KEYS.TYPE],t[S.MessageConstatnts.KEYS.RECEIVER_TYPE],S.MessageCategory.ACTION),n=t[S.MessageConstatnts.KEYS.DATA];if(e.data=n,e.setAction(n[S.MessageConstatnts.KEYS.ACTION]),n[S.ActionConstatnts.ACTION_KEYS.EXTRAS]){var o=n[S.ActionConstatnts.ACTION_KEYS.EXTRAS];if(o[S.ActionConstatnts.ACTION_KEYS.SCOPE]){var s=o[S.ActionConstatnts.ACTION_KEYS.SCOPE];s[S.ActionConstatnts.ACTION_KEYS.NEW]&&s[S.ActionConstatnts.ACTION_KEYS.OLD]&&(e.setOldScope(s[S.ActionConstatnts.ACTION_KEYS.OLD]),e.setNewScope(s[S.ActionConstatnts.ACTION_KEYS.NEW]))}}n[S.MessageConstatnts.KEYS.METADATA]&&e.setMetadata(n[S.MessageConstatnts.KEYS.METADATA]);var r=n[S.ActionConstatnts.ACTION_KEYS.ENTITIES];if(r[S.ActionConstatnts.ACTION_SUBJECTS.ACTION_BY])if(r[S.ActionConstatnts.ACTION_SUBJECTS.ACTION_BY][S.ActionConstatnts.ACTION_KEYS.ENTITY_TYPE]==S.ActionConstatnts.ACTION_ENTITY_TYPE.USER){var i=new u.User(r[S.ActionConstatnts.ACTION_SUBJECTS.ACTION_BY][S.ActionConstatnts.ACTION_KEYS.ENTITY]);Object.assign(i,r[S.ActionConstatnts.ACTION_SUBJECTS.ACTION_BY][S.ActionConstatnts.ACTION_KEYS.ENTITY]),e.actionBy=i,e.setSender(i)}else{var a=new c.Group("","","");Object.assign(a,r[S.ActionConstatnts.ACTION_SUBJECTS.ACTION_BY][S.ActionConstatnts.ACTION_KEYS.ENTITY]),e.actionBy=a}if(r[S.ActionConstatnts.ACTION_SUBJECTS.ACTION_FOR])if(r[S.ActionConstatnts.ACTION_SUBJECTS.ACTION_FOR][S.ActionConstatnts.ACTION_KEYS.ENTITY_TYPE]==S.ActionConstatnts.ACTION_ENTITY_TYPE.USER){i=new u.User(r[S.ActionConstatnts.ACTION_SUBJECTS.ACTION_FOR][S.ActionConstatnts.ACTION_KEYS.ENTITY]);Object.assign(i,r[S.ActionConstatnts.ACTION_SUBJECTS.ACTION_FOR][S.ActionConstatnts.ACTION_KEYS.ENTITY]),e.actionFor=i}else{a=new c.Group("","","");Object.assign(a,r[S.ActionConstatnts.ACTION_SUBJECTS.ACTION_FOR][S.ActionConstatnts.ACTION_KEYS.ENTITY]),e.actionFor=a}if(r[S.ActionConstatnts.ACTION_SUBJECTS.ACTION_ON])if(r[S.ActionConstatnts.ACTION_SUBJECTS.ACTION_ON][S.ActionConstatnts.ACTION_KEYS.ENTITY_TYPE]==S.ActionConstatnts.ACTION_ENTITY_TYPE.USER){i=new u.User(r[S.ActionConstatnts.ACTION_SUBJECTS.ACTION_ON][S.ActionConstatnts.ACTION_KEYS.ENTITY]);Object.assign(i,r[S.ActionConstatnts.ACTION_SUBJECTS.ACTION_ON][S.ActionConstatnts.ACTION_KEYS.ENTITY]),e.actionOn=i}else if(r[S.ActionConstatnts.ACTION_SUBJECTS.ACTION_ON][S.ActionConstatnts.ACTION_KEYS.ENTITY_TYPE]==S.ActionConstatnts.ACTION_ENTITY_TYPE.GROUP){a=new c.Group("","","");Object.assign(a,r[S.ActionConstatnts.ACTION_SUBJECTS.ACTION_ON][S.ActionConstatnts.ACTION_KEYS.ENTITY]),e.actionOn=a}else if(r[S.ActionConstatnts.ACTION_SUBJECTS.ACTION_ON][S.ActionConstatnts.ACTION_KEYS.ENTITY_TYPE]==S.ActionConstatnts.ACTION_ENTITY_TYPE.MESSAGE){var E=p.MessageController.trasformJSONMessge(r[S.ActionConstatnts.ACTION_SUBJECTS.ACTION_ON][S.ActionConstatnts.ACTION_KEYS.ENTITY]);e.actionOn=E}return e.setMessage(e.getActionMessage(e)),e},e.prototype.getOldScope=function(){return this.oldScope},e.prototype.setOldScope=function(t){this.oldScope=t},e.prototype.getNewScope=function(){return this.newScope},e.prototype.setNewScope=function(t){this.newScope=t},e.prototype.getRawData=function(){return this.rawData},e.prototype.setRawData=function(t){this.rawData=t},e.prototype.getMessage=function(){return this.message},e.prototype.setMessage=function(t){this.message=t},e.prototype.getAction=function(){return this.action},e.prototype.setAction=function(t){this.action=t},e.prototype.getSender=function(){try{return this.getSenderFromData()}catch(t){return this.sender}},e.prototype.getActionBy=function(){return this.actionBy},e.prototype.setActionBy=function(t){this.actionBy=t},e.prototype.getActionOn=function(){return this.actionOn},e.prototype.setActionOn=function(t){this.actionOn=t},e.prototype.getActionFor=function(){return this.actionFor},e.prototype.setActionFor=function(t){this.actionFor=t},e.prototype.getMetadata=function(){return this.data.metadata&&(this.metadata=this.data.metadata),this.metadata},e.prototype.setMetadata=function(t){this.metadata=t,this.data=r(r({},this.data),{metadata:t})},e.prototype.getActionMessage=function(t){var e="";switch(t.getType()){case S.ActionConstatnts.ACTION_KEYS.ACTION_TYPE_USER:case S.ActionConstatnts.ACTION_KEYS.ACTION_TYPE_GROUP:switch(t.getAction()){case S.ActionConstatnts.ACTION_KEYS.ACTION_CREATED:case S.ActionConstatnts.ACTION_KEYS.ACTION_UPDATED:case S.ActionConstatnts.ACTION_KEYS.ACTION_DELETED:}break;case S.ActionConstatnts.ACTION_KEYS.ACTION_TYPE_GROUP_MEMBER:switch(t.getAction()){case S.ActionConstatnts.ACTION_KEYS.TYPE_MEMBER_JOINED:var n=t.getActionBy();e=a.format(S.ActionConstatnts.ActionMessages.ACTION_GROUP_JOINED_MESSAGE,n.getName());break;case S.ActionConstatnts.ACTION_KEYS.TYPE_MEMBER_LEFT:n=t.getActionBy();e=a.format(S.ActionConstatnts.ActionMessages.ACTION_GROUP_LEFT_MESSAGE,n.getName());break;case S.ActionConstatnts.ACTION_KEYS.TYPE_MEMBER_KICKED:n=t.getActionBy();var o=t.getActionOn();e=a.format(S.ActionConstatnts.ActionMessages.ACTION_MEMBER_KICKED_MESSAGE,n.getName(),o.getName());break;case S.ActionConstatnts.ACTION_KEYS.TYPE_MEMBER_BANNED:n=t.getActionBy(),o=t.getActionOn();e=a.format(S.ActionConstatnts.ActionMessages.ACTION_MEMBER_BANNED_MESSAGE,n.getName(),o.getName());break;case S.ActionConstatnts.ACTION_KEYS.TYPE_MEMBER_UNBANNED:n=t.getActionBy(),o=t.getActionOn();e=a.format(S.ActionConstatnts.ActionMessages.ACTION_MEMBER_UNBANNED_MESSAGE,n.getName(),o.getName());break;case S.ActionConstatnts.ACTION_KEYS.ACTION_SCOPE_CHANGED:n=t.getActionBy(),o=t.getActionOn();var s=t.getNewScope();e=a.format(S.ActionConstatnts.ActionMessages.ACTION_MEMBER_SCOPE_CHANGED,n.getName(),o.getName(),s);break;case S.ActionConstatnts.ACTION_KEYS.TYPE_MEMBER_ADDED:n=t.getActionBy(),o=t.getActionOn();e=a.format(S.ActionConstatnts.ActionMessages.ACTION_MEMBER_ADDED_TO_GROUP,n.getName(),o.getName());break;case S.ActionConstatnts.ACTION_KEYS.TYPE_MESSAGE_EDITED:e=a.format(S.ActionConstatnts.ActionMessages.ACTION_MESSAGE_EDITED_MESSAGE,"");break;case S.ActionConstatnts.ACTION_KEYS.TYPE_MESSAGE_DELETED:e=a.format(S.ActionConstatnts.ActionMessages.ACTION_MESSAGE_DELETED_MESSAGE,"")}}return e},e.prototype.getSenderFromData=function(){var t=this.data[S.ActionConstatnts.ACTION_KEYS.ENTITIES];if(t[S.ActionConstatnts.ACTION_SUBJECTS.ACTION_BY]&&t[S.ActionConstatnts.ACTION_SUBJECTS.ACTION_BY][S.ActionConstatnts.ACTION_KEYS.ENTITY_TYPE]==S.ActionConstatnts.ACTION_ENTITY_TYPE.USER){var e=new u.User(t[S.ActionConstatnts.ACTION_SUBJECTS.ACTION_BY][S.ActionConstatnts.ACTION_KEYS.ENTITY]);return Object.assign(e,t[S.ActionConstatnts.ACTION_SUBJECTS.ACTION_BY][S.ActionConstatnts.ACTION_KEYS.ENTITY]),e}},e.TYPE=S.MessageConstatnts.TYPE,e.RECEIVER_TYPE=S.MessageConstatnts.RECEIVER_TYPE,e.CATEGORY=S.MessageConstatnts.CATEGORY,e.ACTION_TYPE=S.ActionConstatnts.ACTION_TYPE,e}(i.BaseMessage);e.Action=E},function(t,e,n){"use strict";var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__assign||function(){return(i=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var s in e=arguments[n])Object.prototype.hasOwnProperty.call(e,s)&&(t[s]=e[s]);return t}).apply(this,arguments)};e.__esModule=!0,e.Call=void 0;var s=n(7),a=n(8),E=n(1),c=n(0),u=n(3),S=function(s){function t(t,e,n,o){return c.isFalsy(o)?s.call(this,t,e,n,E.MessageCategory.CALL)||this:s.call(this,t,e,n,o)||this}return r(t,s),t.prototype.getCallInitiator=function(){return this.getCallInitiatedByFromData()},t.prototype.setCallInitiator=function(t){this.callInitiator=t},t.prototype.getCallReceiver=function(){return this.getCallReceivedByFromData()},t.prototype.setCallReceiver=function(t){this.callReceiver=t},t.prototype.getData=function(){return this.data},t.prototype.setData=function(t){this.data=t},t.prototype.getSessionId=function(){return this.sessionId},t.prototype.setSessionId=function(t){this.sessionId=t},t.prototype.getMetadata=function(){return this.data.metadata&&(this.metadata=this.data.metadata),this.metadata},t.prototype.setMetadata=function(t){this.metadata=t,this.data=i(i({},this.data),{metadata:t})},t.prototype.getSender=function(){try{return this.getSenderFromData()}catch(t){return this.sender}},t.prototype.getAction=function(){return this.action},t.prototype.setAction=function(t){this.action=t},t.prototype.getInitiatedAt=function(){return this.initiatedAt},t.prototype.setInitiatedAt=function(t){this.initiatedAt=t},t.prototype.getJoinedAt=function(){return this.joinedAt},t.prototype.setJoinedAt=function(t){this.joinedAt=t},t.prototype.getRawData=function(){return this.rawData},t.prototype.setRawData=function(t){this.rawData=t},t.callFromJSON=function(t){try{var e=new this(t[E.MessageConstatnts.KEYS.RECEIVER],t[E.MessageConstatnts.KEYS.TYPE],t[E.MessageConstatnts.KEYS.RECEIVER_TYPE],E.MessageCategory.CALL),n=t[E.MessageConstatnts.KEYS.DATA];e.setAction(n[E.MessageConstatnts.KEYS.ACTION]),n[E.MessageConstatnts.KEYS.METADATA]&&e.setMetadata(n[E.MessageConstatnts.KEYS.METADATA]);var o=n[E.ActionConstatnts.ACTION_KEYS.ENTITIES];if(o[E.ActionConstatnts.ACTION_SUBJECTS.ACTION_BY])o[E.ActionConstatnts.ACTION_SUBJECTS.ACTION_BY];if(o[E.ActionConstatnts.ACTION_SUBJECTS.ACTION_ON]){var s=o[E.ActionConstatnts.ACTION_SUBJECTS.ACTION_ON];if(s[E.CallConstants.CALL_KEYS.CALL_ENTITY]){var r=s[E.CallConstants.CALL_KEYS.CALL_ENTITY];if(r[E.CallConstants.CALL_KEYS.CALL_SESSION_ID]&&(e.sessionId=r[E.CallConstants.CALL_KEYS.CALL_SESSION_ID]),r[E.CallConstants.CALL_KEYS.CALL_STATUS]&&(e.status=r[E.CallConstants.CALL_KEYS.CALL_STATUS]),r[E.CallConstants.CALL_KEYS.CALL_DATA]){var i=r[E.CallConstants.CALL_KEYS.CALL_DATA];if(i[E.CallConstants.CALL_KEYS.CALL_METADATA]&&(e.metadata=i[E.CallConstants.CALL_KEYS.CALL_METADATA]),i[E.ResponseConstants.RESPONSE_KEYS.KEY_ENTITIES])i[E.ResponseConstants.RESPONSE_KEYS.KEY_ENTITIES]}r[E.CallConstants.CALL_KEYS.CALL_INITIATED_AT]&&(e.initiatedAt=r[E.CallConstants.CALL_KEYS.CALL_INITIATED_AT]),r[E.CallConstants.CALL_KEYS.CALL_JOINED_AT]&&(e.joinedAt=r[E.CallConstants.CALL_KEYS.CALL_JOINED_AT]),r[E.CallConstants.CALL_KEYS.CALL_LEFT_AT]&&(e.joinedAt=r[E.CallConstants.CALL_KEYS.CALL_LEFT_AT])}}return e}catch(t){c.Logger.error("CallModel: callFromJSON",t)}},t.prototype.getSenderFromData=function(){try{var t=this.getData();if((t=t[E.ActionConstatnts.ACTION_KEYS.ENTITIES])[E.ActionConstatnts.ACTION_SUBJECTS.ACTION_BY][E.CallConstants.CALL_KEYS.CALL_ENTITY])return new u.User(t[E.ActionConstatnts.ACTION_SUBJECTS.ACTION_BY][E.CallConstants.CALL_KEYS.CALL_ENTITY])}catch(t){c.Logger.error("CallModel:getSenderFromData",t)}},t.prototype.getCallInitiatedByFromData=function(){try{var t=this.getData();if((t=t[E.ActionConstatnts.ACTION_KEYS.ENTITIES])[E.ActionConstatnts.ACTION_SUBJECTS.ACTION_ON][E.CallConstants.CALL_KEYS.CALL_ENTITY][E.CallConstants.CALL_KEYS.CALL_DATA][E.ActionConstatnts.ACTION_KEYS.ENTITIES][E.CallConstants.CALL_KEYS.CALL_SENDER])return new u.User(t[E.ActionConstatnts.ACTION_SUBJECTS.ACTION_ON][E.CallConstants.CALL_KEYS.CALL_ENTITY][E.CallConstants.CALL_KEYS.CALL_DATA][E.ActionConstatnts.ACTION_KEYS.ENTITIES][E.CallConstants.CALL_KEYS.CALL_SENDER][E.CallConstants.CALL_KEYS.CALL_ENTITY])}catch(t){c.Logger.error("CallModel:getCallInitiatedByFromData",t)}},t.prototype.getCallReceivedByFromData=function(){try{var t=this.getData();if((t=t[E.ActionConstatnts.ACTION_KEYS.ENTITIES])[E.ActionConstatnts.ACTION_SUBJECTS.ACTION_FOR][E.CallConstants.CALL_KEYS.CALL_ENTITY]){if(t[E.ActionConstatnts.ACTION_SUBJECTS.ACTION_FOR][E.CallConstants.CALL_KEYS.CALL_ENTITY_TYPE]==E.CallConstants.CALL_KEYS.CALL_ENTITY_USER)return new u.User(t[E.ActionConstatnts.ACTION_SUBJECTS.ACTION_FOR][E.CallConstants.CALL_KEYS.CALL_ENTITY]);var e=new a.Group(t[E.ActionConstatnts.ACTION_SUBJECTS.ACTION_FOR][E.CallConstants.CALL_KEYS.CALL_ENTITY][E.GroupConstants.KEYS.GUID],t[E.ActionConstatnts.ACTION_SUBJECTS.ACTION_FOR][E.CallConstants.CALL_KEYS.CALL_ENTITY][E.GroupConstants.KEYS.NAME],t[E.ActionConstatnts.ACTION_SUBJECTS.ACTION_FOR][E.CallConstants.CALL_KEYS.CALL_ENTITY][E.GroupConstants.KEYS.TYPE]);return Object.assign(e,t[E.ActionConstatnts.ACTION_SUBJECTS.ACTION_FOR][E.CallConstants.CALL_KEYS.CALL_ENTITY])}}catch(t){c.Logger.error("CallModel:getCallReceivedByFromData",t)}},t.TYPE=E.MessageConstatnts.TYPE,t.RECEIVER_TYPE=E.MessageConstatnts.RECEIVER_TYPE,t.CATEGORY=E.MessageConstatnts.CATEGORY,t.ACTION_TYPE=E.ActionConstatnts.ACTION_TYPE,t}(s.BaseMessage);e.Call=S},function(t,e,n){"use strict";e.__esModule=!0,e.MessageReceipt=void 0;var o=function(){function t(){this.RECEIPT_TYPE={READ_RECEIPT:"read",DELIVERY_RECEIPT:"delivery"},this.receiptType=this.RECEIPT_TYPE.DELIVERY_RECEIPT}return t.prototype.getReceiverType=function(){return this.receiverType},t.prototype.setReceiverType=function(t){this.receiverType=t},t.prototype.getSender=function(){return this.sender},t.prototype.setSender=function(t){this.sender=t},t.prototype.getReceiver=function(){return this.receiver},t.prototype.setReceiver=function(t){this.receiver=t},t.prototype.getTimestamp=function(){return this.timestamp},t.prototype.setTimestamp=function(t){this.timestamp=t},t.prototype.setReadAt=function(t){this.readAt=t},t.prototype.getReadAt=function(){return this.readAt},t.prototype.setDeliveredAt=function(t){this.deliveredAt=t},t.prototype.getDeliveredAt=function(){return this.deliveredAt},t.prototype.getMessageId=function(){return this.messageId},t.prototype.setMessageId=function(t){this.messageId=t},t.prototype.getReceiptType=function(){return this.receiptType},t.prototype.setReceiptType=function(t){void 0===t&&(t=this.RECEIPT_TYPE.DELIVERY_RECEIPT),this.receiptType=t},t}();e.MessageReceipt=o},function(t,e,n){"use strict";e.__esModule=!0,e.ConversationController=void 0;var a=n(39),E=n(0),o=function(){function t(){}return t.trasformJSONConversation=function(t,e,n,o,s,r){var i;try{i=new a.Conversation(t,e,n,o,s,r)}catch(t){E.Logger.error("ConversationController:transformJSONConversation",t)}return i},t}();e.ConversationController=o},function(t,e,n){"use strict";e.__esModule=!0,e.MessageListnerMaping=void 0;var r=n(0),i=n(1),a=n(2),o=n(12),s=function(){function t(t){this.store=i.constants.DEFAULT_STORE,r.isFalsy(t)||(this.store=t);try{this.settingsStore=o.default}catch(t){r.Logger.error("MessageListnerEventMaping: constructor",{e:t})}}return t.getInstance=function(){return null==t.settingsStore&&(t.settingsStore=new t),t.settingsStore},t.prototype.set=function(t,e){var n=r.getKeyprefix(i.LOCAL_STORE.MESSAGE_LISTENERS_LIST,t);return this.settingsStore.setItem(n,JSON.stringify(e))},t.prototype.get=function(t){var o=this,s=r.getKeyprefix(i.LOCAL_STORE.MESSAGE_LISTENERS_LIST,t);return new Promise(function(n,e){try{o.settingsStore.getItem(s).then(function(e){try{n(JSON.parse(e))}catch(t){n(e)}},function(t){e(t)})}catch(t){e(new a.CometChatException(t))}})},t.prototype.selectStore=function(t){this.store=t},t.settingsStore=null,t}();e.MessageListnerMaping=s},function(t,e,n){"use strict";e.__esModule=!0,e.TypingIndicator=void 0;var o=function(){function t(t,e,n){this.receiverId=t,this.receiverType=e,this.metadata=n}return t.prototype.getReceiverType=function(){return this.receiverType},t.prototype.setReceiverType=function(t){this.receiverType=t},t.prototype.getReceiverId=function(){return this.receiverId},t.prototype.setReceiverId=function(t){this.receiverId=t},t.prototype.getMetadata=function(){return this.metadata},t.prototype.setMetadata=function(t){this.metadata=t},t.prototype.getSender=function(){return this.sender},t.prototype.setSender=function(t){this.sender=t},t}();e.TypingIndicator=o},function(t,e,n){"use strict";e.__esModule=!0,e.TransientMessage=void 0;var o=function(){function t(t,e,n){this.receiverId=t,this.receiverType=e,this.data=n||{}}return t.prototype.getReceiverId=function(){return this.receiverId},t.prototype.setReceiverId=function(t){this.receiverId=t},t.prototype.getReceiverType=function(){return this.receiverType},t.prototype.setReceiverType=function(t){this.receiverType=t},t.prototype.getData=function(){return this.data},t.prototype.setData=function(t){this.data=t},t.prototype.getSender=function(){return this.sender},t.prototype.setSender=function(t){this.sender=t},t}();e.TransientMessage=o},function(t,e,n){"use strict";e.__esModule=!0,e.CometChat=e.init=void 0;var o=n(5);e.init=function(t){return o.CometChat.getInstance(t)},e.CometChat=o.CometChat},function(t,e,n){"use strict";e.__esModule=!0,e.EndpointFactory=void 0;var E=n(0),c=n(1),u=n(14),S=n(5),p=n(2),o=function(){function a(){this.baseUrl="https://%s.apiclient-%s.cometchat.io/",this.apiVersion=c.APPINFO.apiVersion,this.adminApiUrl="https://%s.api-%s.cometchat.io/",this.adminApiVersion=c.APPINFO.apiVersion,this.extensionApi="https://%s-%s.%s/%s",this.prosodyApi="https://%s.%s/%s",this.wsApi="https://%s/%s",this.uriEndpoints={authToken:{endpoint:"users/{{uid}}/auth_tokens",method:"POST",data:{uid:"string|max:100"},isAdminApi:!0},appSettings:{endpoint:"settings",method:"GET"},login:{endpoint:"admin/users/auth",method:"POST",data:{uid:"string|max:100"}},logout:{endpoint:"admin/users/auth/{{authToken}}",method:"DELETE"},getMyDetails:{endpoint:"me",method:"GET"},updateMyDetails:{endpoint:"me",method:"PUT"},getJWT:{endpoint:"me/jwt",method:"POST"},users:{endpoint:"users",method:"GET"},user:{endpoint:"users/{{uid}}",method:"GET"},blockUsers:{endpoint:"blockedusers",method:"POST"},blockedUsersList:{endpoint:"blockedusers",method:"GET"},unblockUsers:{endpoint:"blockedusers",method:"DELETE"},userLogout:{endpoint:"me",method:"DELETE"},createUser:{endpoint:"users",method:"POST",isAdminApi:!0},updateUser:{endpoint:"users/{{uid}}",method:"PUT",isAdminApi:!0},sendFriendRequests:{endpoint:"user/friends",method:"POST",data:{uids:"array<string|max:100>"}},getFriends:{endpoint:"user/friends",method:"GET"},unfriend:{endpoint:"user/friends/{{uid}}/{{gid}}",method:"DELETE",data:{uids:"array<string|max:100>"}},acceptFriendRequest:{endpoint:"user/friends/{{uid}}/accept",method:"PUT",data:{uids:"array<string|max:100>"}},rejectFriendRequest:{endpoint:"user/friends/{{uid}}/reject",method:"DELETE",data:{uids:"array<string|max:100>"}},createGroup:{endpoint:"groups",method:"POST",data:{guid:"required|string|max:100",name:"required|string|max:100",type:"enum|public,protected,password",password:"filled|string|max:100"}},getGroups:{endpoint:"groups",method:"GET"},getGroup:{endpoint:"groups/{{guid}}",method:"GET"},updateGroup:{endpoint:"groups/{{guid}}",method:"PUT"},deleteGroup:{endpoint:"groups/{{guid}}",method:"DELETE"},addGroupMembers:{endpoint:"groups/{{guid}}/members",method:"POST",data:{uids:"array<string|max:100>"}},getGroupMembers:{endpoint:"groups/{{guid}}/members",method:"GET"},joinGroup:{endpoint:"groups/{{guid}}/members",method:"POST"},leaveGroup:{endpoint:"groups/{{guid}}/members",method:"DELETE"},kickGroupMembers:{endpoint:"groups/{{guid}}/members/{{uid}}",method:"DELETE",data:{uids:"array<string|max:100>"}},changeScopeOfMember:{endpoint:"groups/{{guid}}/members/{{uid}}",method:"PUT",data:{uids:"array<string|max:100>"}},banGroupMember:{endpoint:"groups/{{guid}}/bannedusers/{{uid}}",method:"POST",data:{uids:"array<string|max:100>"}},unbanGroupMember:{endpoint:"groups/{{guid}}/bannedusers/{{uid}}",method:"DELETE",data:{uids:"array<string|max:100>"}},addMemebersToGroup:{endpoint:"groups/{{guid}}/members",method:"PUT"},getBannedGroupMembers:{endpoint:"groups/{{guid}}/bannedusers",method:"GET"},promotemoteGroupMember:{endpoint:"groups/{{guid}}/promote",method:"PUT",data:{uids:"array<string|max:100>"}},demoteGroupMember:{endpoint:"groups/{{guid}}/demote",method:"DELETE",data:{uids:"array<string|max:100>"}},transferOwnership:{endpoint:"groups/{{guid}}/owner",method:"PATCH"},sendMessage:{endpoint:"messages",method:"POST",data:{sender:"array:string:max:100>",isGroupMember:"filled|boolean|bail",data:"required|json"}},sendMessageInThread:{endpoint:"messages/{{parentId}}/thread",method:"POST",data:{sender:"array:string:max:100>",isGroupMember:"filled|boolean|bail",data:"required|json"}},getMessages:{endpoint:"messages",method:"GET"},getMessageDetails:{endpoint:"messages/{{messageId}}",method:"GET"},getUserMessages:{endpoint:"users/{{listId}}/messages",method:"GET"},getGroupMessages:{endpoint:"groups/{{listId}}/messages",method:"GET"},getThreadMessages:{endpoint:"messages/{{listId}}/thread",method:"GET"},getMessage:{endpoint:"user/messages/{{muid}}",method:"GET"},updateMessage:{endpoint:"messages/{{messageId}}",method:"PUT"},deleteMessage:{endpoint:"messages/{{messageId}}",method:"DELETE"},createCallSession:{endpoint:"calls",method:"POST",data:{}},updateCallSession:{endpoint:"calls/{{sessionid}}",method:"put",data:{}},getConversations:{endpoint:"conversations",method:"GET"},getUserConversation:{endpoint:"users/{{uid}}/conversation",method:"GET"},getGroupConversation:{endpoint:"groups/{{guid}}/conversation",method:"GET"},deleteUserConversation:{endpoint:"users/{{uid}}/conversation",method:"DELETE"},deleteGroupConversation:{endpoint:"groups/{{guid}}/conversation",method:"DELETE"},updateUserConversation:{endpoint:"users/{{uid}}/conversation",method:"PUT"},updateGroupConversation:{endpoint:"groups/{{guid}}/conversation",method:"PUT"},updateCallType:{endpoint:"calls/{{sessionid}}/type",method:"PATCH"},getUserConversationStarter:{endpoint:"ai/conversation-starters/users/{{uid}}",method:"GET",isAIApi:!0},getGroupConversationStarter:{endpoint:"ai/conversation-starters/groups/{{guid}}",method:"GET",isAIApi:!0},getUserSmartReply:{endpoint:"ai/smart-replies/users/{{uid}}",method:"GET",isAIApi:!0},getGroupSmartReply:{endpoint:"ai/smart-replies/groups/{{guid}}",method:"GET",isAIApi:!0}}}return a.prototype.getEndpointData=function(i){return new Promise(function(o,e){try{var s=S.CometChat.appSettings.getAdminHost(),r=S.CometChat.appSettings.getClientHost();u.LocalStorage.getInstance().get(c.LOCAL_STORE.KEY_APP_SETTINGS).then(function(t){if(E.isFalsy(t)){var e={};if((new a).uriEndpoints.hasOwnProperty(i))if((e=(new a).uriEndpoints[i]).hasOwnProperty("isAdminApi"))if(E.isFalsy(s)){var n=E.format((new a).adminApiUrl,S.CometChat.getAppId(),S.CometChat.appSettings.getRegion())+(new a).adminApiVersion+"/"+e.endpoint;e.endpoint=n,o(e)}else{n="https://"+s+"/"+e.endpoint;e.endpoint=n,o(e)}else if(E.isFalsy(r)){n=E.format((new a).baseUrl,S.CometChat.getAppId(),S.CometChat.appSettings.getRegion())+(new a).apiVersion+"/"+e.endpoint;e.endpoint=n,o(e)}else{n="https://"+r+"/"+e.endpoint;e.endpoint=n,o(e)}}else{e={};if((new a).uriEndpoints.hasOwnProperty(i))if((e=(new a).uriEndpoints[i]).hasOwnProperty("isAdminApi")){n="https://"+t[c.APP_SETTINGS.KEYS.ADMIN_API_HOST]+"/"+t[c.APP_SETTINGS.KEYS.CHAT_API_VERSION]+"/"+e.endpoint;e.endpoint=n,o(e)}else{n="https://"+t[c.APP_SETTINGS.KEYS.CLIENT_API_HOST]+"/"+t[c.APP_SETTINGS.KEYS.CHAT_API_VERSION]+"/"+e.endpoint;e.endpoint=n,o(e)}}},function(t){var e;if((new a).uriEndpoints.hasOwnProperty(i))if((e=(new a).uriEndpoints[i]).hasOwnProperty(["isAdminApi"]))if(E.isFalsy(s)){var n=E.format((new a).adminApiUrl,S.CometChat.getAppId(),S.CometChat.appSettings.getRegion())+(new a).adminApiVersion+"/"+e.endpoint;e.endpoint=n,o(e)}else e.endpoint="https://"+s+"/"+e.endpoint,o(e);else if(E.isFalsy(r)){n=E.format((new a).baseUrl,S.CometChat.getAppId(),S.CometChat.appSettings.getRegion())+(new a).apiVersion+"/"+e.endpoint;e.endpoint=n,o(e)}else e.endpoint="https://"+r+"/"+e.endpoint,o(e)})}catch(t){e(new p.CometChatException(t))}})},a}();e.EndpointFactory=o},function(t,e){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(t){"object"==typeof window&&(n=window)}t.exports=n},function(t,e,n){"use strict";e.__esModule=!0,e.getEndPoint=void 0;var o=n(31),i=n(2);e.getEndPoint=function(t,r){void 0===t&&(t=""),void 0===r&&(r={});var e=new o.EndpointFactory;return new Promise(function(o,s){try{e.getEndpointData(t).then(function(t){var e=t;if(e){for(var n in r)e.endpoint=e.endpoint.replace("{{"+n+"}}",r[n]);o(e)}else s({error:"Unknown endPoint name."})})}catch(t){s(new i.CometChatException(t))}})}},function(t,e,n){"use strict";e.__esModule=!0,e.MainVideoContainerSetting=e.CallSettingsBuilder=e.CallSettings=void 0;var o=n(1),s=n(0),r=function(){function t(t){this.sessionID=t.sessionID,this.defaultLayout=t.defaultLayout,this.isAudioOnly=t.isAudioOnly,this.region=t.region,this.domain=t.domain,this.user=t.user,this.listener=t.listener,this.mode=t.mode,this.ShowEndCallButton=t.ShowEndCallButton,this.ShowSwitchCameraButton=t.ShowSwitchCameraButton,this.ShowMuteAudioButton=t.ShowMuteAudioButton,this.ShowPauseVideoButton=t.ShowPauseVideoButton,this.ShowAudioModeButton=t.ShowAudioModeButton,this.StartAudioMuted=t.StartAudioMuted,this.StartVideoMuted=t.StartVideoMuted,this.analyticsSettings=t.analyticsSettings,this.appId=t.appId,this.defaultAudioMode=t.defaultAudioMode,this.ShowSwitchToVideoCallButton=t.ShowSwitchToVideoCallButton,this.AvatarMode=t.AvatarMode,this.ShowRecordingButton=t.ShowRecordingButton,this.StartRecordingOnCallStart=t.StartRecordingOnCallStart,this.MainVideoContainerSetting=t.MainVideoContainerSetting,this.EnableVideoTileClick=t.EnableVideoTileClick,this.enableDraggableVideoTile=t.enableDraggableVideoTile}return t.prototype.getSessionId=function(){return this.sessionID},t.prototype.isAudioOnlyCall=function(){return this.isAudioOnly},t.prototype.getUser=function(){return this.user},t.prototype.getRegion=function(){return this.region},t.prototype.getAppId=function(){return this.appId},t.prototype.getDomain=function(){return this.domain},t.prototype.isDefaultLayoutEnabled=function(){return this.defaultLayout},t.prototype.getCallEventListener=function(){return this.listener},t.prototype.getMode=function(){return this.mode},t.prototype.isEndCallButtonEnabled=function(){return this.ShowEndCallButton},t.prototype.isSwitchCameraButtonEnabled=function(){return this.ShowSwitchCameraButton},t.prototype.isMuteAudioButtonEnabled=function(){return this.ShowMuteAudioButton},t.prototype.isPauseVideoButtonEnabled=function(){return this.ShowPauseVideoButton},t.prototype.isAudioModeButtonEnabled=function(){return this.ShowAudioModeButton},t.prototype.getStartWithAudioMuted=function(){return this.StartAudioMuted},t.prototype.getStartWithVideoMuted=function(){return this.StartVideoMuted},t.prototype.getAnalyticsSettings=function(){return this.analyticsSettings},t.prototype.getDefaultAudioMode=function(){return this.defaultAudioMode},t.prototype.isAudioToVideoButtonEnabled=function(){return this.ShowSwitchToVideoCallButton},t.prototype.getAvatarMode=function(){return this.AvatarMode},t.prototype.isRecordingButtonEnabled=function(){return this.ShowRecordingButton},t.prototype.shouldStartRecordingOnCallStart=function(){return this.StartRecordingOnCallStart},t.prototype.getMainVideoContainerSetting=function(){return this.MainVideoContainerSetting},t.prototype.isVideoTileClickEnabled=function(){return this.EnableVideoTileClick},t.prototype.isVideoTileDragEnabled=function(){return this.enableDraggableVideoTile},t.POSITION_TOP_LEFT="top-left",t.POSITION_TOP_RIGHT="top-right",t.POSITION_BOTTOM_LEFT="bottom-left",t.POSITION_BOTTOM_RIGHT="bottom-right",t.ASPECT_RATIO_DEFAULT="default",t.ASPECT_RATIO_CONTAIN="contain",t.ASPECT_RATIO_COVER="cover",t}();e.CallSettings=r;var i=function(){function t(){this.defaultLayout=!0,this.isAudioOnly=!1,this.mode=o.CallConstants.CALL_MODE.DEFAULT,this.ShowEndCallButton=!0,this.ShowSwitchCameraButton=!0,this.ShowMuteAudioButton=!0,this.ShowPauseVideoButton=!0,this.ShowAudioModeButton=!0,this.StartAudioMuted=!1,this.StartVideoMuted=!1,this.analyticsSettings={},this.ShowSwitchToVideoCallButton=!0,this.AvatarMode="circle",this.ShowRecordingButton=!1,this.StartRecordingOnCallStart=!1,this.MainVideoContainerSetting=new a,this.EnableVideoTileClick=!0,this.enableDraggableVideoTile=!0}return t.prototype.setSessionID=function(t){return this.sessionID=t,this},t.prototype.enableDefaultLayout=function(t){return this.defaultLayout=t,this},t.prototype.setIsAudioOnlyCall=function(t){return this.isAudioOnly=t,this},t.prototype.setRegion=function(t){return this.region=t,this},t.prototype.setDomain=function(t){return this.domain=t,this},t.prototype.setUser=function(t){return this.user=t,this},t.prototype.setCallEventListener=function(t){return this.listener=t,this},t.prototype.setMode=function(t){return this.mode=t,this},t.prototype.showEndCallButton=function(t){return this.ShowEndCallButton=t,this},t.prototype.showSwitchCameraButton=function(t){return this.ShowSwitchCameraButton=t,this},t.prototype.showMuteAudioButton=function(t){return this.ShowMuteAudioButton=t,this},t.prototype.showPauseVideoButton=function(t){return this.ShowPauseVideoButton=t,this},t.prototype.showAudioModeButton=function(t){return this.ShowAudioModeButton=t,this},t.prototype.startWithAudioMuted=function(t){return this.StartAudioMuted=t,this},t.prototype.startWithVideoMuted=function(t){return this.StartVideoMuted=t,this},t.prototype.setAnalyticsSettings=function(t){return this.analyticsSettings=t,this},t.prototype.setAppId=function(t){return this.appId=t,this},t.prototype.setDefaultAudioMode=function(t){return this.defaultAudioMode=t,this},t.prototype.showSwitchToVideoCallButton=function(t){return this.ShowSwitchToVideoCallButton=t,this},t.prototype.setAvatarMode=function(t){return this.AvatarMode=t,this},t.prototype.showRecordingButton=function(t){return this.ShowRecordingButton=t,this},t.prototype.startRecordingOnCallStart=function(t){return this.StartRecordingOnCallStart=t,this},t.prototype.setMainVideoContainerSetting=function(t){return this.MainVideoContainerSetting=t,this},t.prototype.enableVideoTileClick=function(t){return this.EnableVideoTileClick=t,this},t.prototype.enableVideoTileDrag=function(t){return this.enableDraggableVideoTile=t,this},t.prototype.build=function(){return new r(this)},t}();e.CallSettingsBuilder=i;var a=function(){function t(){this.videoFit=r.ASPECT_RATIO_CONTAIN,this.zoomButton=o.CallConstants.ZOOM_BUTTON_DEFAULT_PARAMS,this.fullScreenButton=o.CallConstants.FULL_SCREEN_BUTTON_DEFAULT_PARAMS,this.userListButton=o.CallConstants.USER_LIST_BUTTON_DEFAULT_PARAMS,this.nameLabel=o.CallConstants.NAME_LABEL_DEFAULT_PARAMS}return t.prototype.setMainVideoAspectRatio=function(t){this.videoFit=t},t.prototype.setFullScreenButtonParams=function(t,e){s.isFalsy(t)||(this.fullScreenButton[o.CallConstants.MAIN_VIDEO_CONTAINER_SETTINGS.KEYS.POSITION]=t),null!=e&&null!=e&&(this.fullScreenButton[o.CallConstants.MAIN_VIDEO_CONTAINER_SETTINGS.KEYS.VISIBILITY]=e)},t.prototype.setNameLabelParams=function(t,e,n){s.isFalsy(t)||(this.nameLabel[o.CallConstants.MAIN_VIDEO_CONTAINER_SETTINGS.KEYS.POSITION]=t),null!=e&&null!=e&&(this.nameLabel[o.CallConstants.MAIN_VIDEO_CONTAINER_SETTINGS.KEYS.VISIBILITY]=e),s.isFalsy(n)||(this.nameLabel[o.CallConstants.MAIN_VIDEO_CONTAINER_SETTINGS.KEYS.COLOR]=n)},t.prototype.setZoomButtonParams=function(t,e){s.isFalsy(t)||(this.zoomButton[o.CallConstants.MAIN_VIDEO_CONTAINER_SETTINGS.KEYS.POSITION]=t),null!=e&&null!=e&&(this.zoomButton[o.CallConstants.MAIN_VIDEO_CONTAINER_SETTINGS.KEYS.VISIBILITY]=e)},t.prototype.setUserListButtonParams=function(t,e){s.isFalsy(t)||(this.userListButton[o.CallConstants.MAIN_VIDEO_CONTAINER_SETTINGS.KEYS.POSITION]=t),null!=e&&null!=e&&(this.userListButton[o.CallConstants.MAIN_VIDEO_CONTAINER_SETTINGS.KEYS.VISIBILITY]=e)},t}();e.MainVideoContainerSetting=a},function(t,e,n){"use strict";var o,s=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});e.__esModule=!0,e.CallingComponent=void 0;var i,a,E,c,u,S=n(44),p=n(22),C=n(5),l=n(3),T=n(1),g=n(15),d=n(45),_=n(0),h=n(6),r=function(e){function r(t){var r=e.call(this,t)||this;return r.state={shouldLoad:!1},a=t.callsettings,_.getCallSettings(a).then(function(t){var e=t.callSettingsNew,n=t.call,o=t.CallScreen,s=t.CometChatRTC;E=e,i=n,c=o,u=s,r.setState({shouldLoad:!0})}),r}return s(r,e),r.prototype.render=function(){return this.state.shouldLoad?S.createElement(p.View,{style:{flex:1,backgroundColor:"#000"}},S.createElement(c,{ref:function(t){return r.ref=t},style:{flex:1,backgroundColor:"#000"},callsettings:E,onCallEnded:function(){_.Logger.log("CallingComponent","oncallEnded")},onCallEndButtonPressed:function(){var t,e,n,o;i?(_.isFalsy(u)?(null===(t=null==r?void 0:r.ref)||void 0===t?void 0:t.endCall)&&(null===(e=null==r?void 0:r.ref)||void 0===e||e.endCall()):u.endCall(),setTimeout(function(){C.CometChat.endCall(a.getSessionId(),!0)},1e3)):(_.isFalsy(u)?(null===(n=null==r?void 0:r.ref)||void 0===n?void 0:n.endCall)&&(null===(o=null==r?void 0:r.ref)||void 0===o||o.endCall()):u.endCall(),g.CallController.getInstance().getCallListner()&&g.CallController.getInstance().getCallListner()._eventListener.onCallEnded(null))},onUserJoined:function(t){if(t){var e=void 0;_.isFalsy(t.uid)||_.isFalsy(t.name)||((e=new l.User(t)).setStatus("online"),C.CometChat.user.getUid().toLowerCase()!=e.getUid().toLowerCase()&&g.CallController.getInstance().getCallListner()&&(_.isFalsy(g.CallController.getInstance().getCallListner()._eventListener.onUserJoined)||g.CallController.getInstance().getCallListner()._eventListener.onUserJoined(e)))}},onUserLeft:function(t){if(t){var e=void 0;_.isFalsy(t.uid)||_.isFalsy(t.name)||((e=new l.User(t)).setStatus("online"),C.CometChat.user.getUid().toLowerCase()!=e.getUid().toLowerCase()&&g.CallController.getInstance().getCallListner()&&(_.isFalsy(g.CallController.getInstance().getCallListner()._eventListener.onUserLeft)||g.CallController.getInstance().getCallListner()._eventListener.onUserLeft(e)))}},onUserListChanged:function(t){var n=[];t&&0<t.length&&(t.map(function(t){if(!_.isFalsy(t.uid)&&!_.isFalsy(t.name)){var e=new l.User(t);e.setStatus("online"),n.push(e)}}),g.CallController.getInstance().getCallListner()&&(_.isFalsy(g.CallController.getInstance().getCallListner()._eventListener.onUserListUpdated)||g.CallController.getInstance().getCallListner()._eventListener.onUserListUpdated(n)))},onAudioModeChanged:function(t){var o=[];t&&0<t.length&&(t.map(function(t){var e="",n=!1;t.hasOwnProperty("mode")&&(e=t.mode),t.hasOwnProperty("isSelected")&&(n=t.isSelected),t.hasOwnProperty("type")&&(e=t.type),t.hasOwnProperty("selected")&&(n=t.selected),o.push(new d.AudioMode(e,n))}),g.CallController.getInstance().getCallListner()&&(_.isFalsy(g.CallController.getInstance().getCallListner()._eventListener.onAudioModesUpdated)||g.CallController.getInstance().getCallListner()._eventListener.onAudioModesUpdated(o)))},onCallSwitchedToVideo:function(t){if(_.Logger.info("onCallSwitchedToVideo received in SDK = ",t),t.hasOwnProperty("initiator")&&t.hasOwnProperty("sessionId")&&!_.isFalsy(t.initiator.uid)&&!_.isFalsy(t.sessionId)&&t.hasOwnProperty("accepted")&&!_.isFalsy(t.accepted.uid)){var e=t.sessionId,n=new l.User(t.initiator);n.setStatus("online");var o=new l.User(t.accepted);if(o.setStatus("online"),g.CallController.getInstance().getCallListner()&&(_.isFalsy(g.CallController.getInstance().getCallListner()._eventListener.onCallSwitchedToVideo)||g.CallController.getInstance().getCallListner()._eventListener.onCallSwitchedToVideo(e,n,o)),t.initiator.uid.toLowerCase()===C.CometChat.user.getUid().toLowerCase()&&!t.sessionId.includes("v1."))try{h.makeApiCall("updateCallType",{sessionid:e},{type:"video"}).then(function(t){_.Logger.log("API :: response",t)},function(t){_.Logger.error("CallController :: onSwitchedToVideo",t)})}catch(t){_.Logger.error("CallController :: onSwitchedToVideo",t)}}},onRecordingToggled:function(t){if(_.Logger.info("onRecordingToggled received in SDK = ",t),t&&t.hasOwnProperty("user")&&t.hasOwnProperty("recordingStarted")&&!_.isFalsy(t.user.uid)&&!_.isFalsy(t.user.name)){var e=new l.User(t.user);e.setStatus("online");var n=t.recordingStarted;g.CallController.getInstance().getCallListner()&&(n?_.isFalsy(g.CallController.getInstance().getCallListner()._eventListener.onRecordingStarted)||g.CallController.getInstance().getCallListner()._eventListener.onRecordingStarted(e):_.isFalsy(g.CallController.getInstance().getCallListner()._eventListener.onRecordingStopped)||g.CallController.getInstance().getCallListner()._eventListener.onRecordingStopped(e))}},onUserMuted:function(t){if(_.Logger.info("onUserMuted received in SDK = ",t),t&&t.hasOwnProperty("muted")&&t.hasOwnProperty("mutedBy")&&!_.isFalsy(t.muted.uid)&&!_.isFalsy(t.muted.name)&&!_.isFalsy(t.mutedBy.uid)&&!_.isFalsy(t.mutedBy.name)){var e=new l.User(t.muted);e.setStatus("online");var n=new l.User(t.mutedBy);n.setStatus("online"),g.CallController.getInstance().getCallListner()&&(_.isFalsy(g.CallController.getInstance().getCallListner()._eventListener.onUserMuted)||g.CallController.getInstance().getCallListner()._eventListener.onUserMuted(e,n))}}})):null},r.switchCamera=function(){var t,e;_.isFalsy(u)?(null===(t=null==r?void 0:r.ref)||void 0===t?void 0:t.switchCamera)?null===(e=null==r?void 0:r.ref)||void 0===e||e.switchCamera():_.Logger.error("CallingComponent :: switchCamera","Calling Component is not installed"):u.switchCamera()},r.endCall=function(t,e){var n,o;void 0===t&&(t=!1),_.isFalsy(u)?(null===(n=null==r?void 0:r.ref)||void 0===n?void 0:n.endCall)?(null===(o=null==r?void 0:r.ref)||void 0===o||o.endCall(),t&&!_.isFalsy(e)&&g.CallController.getInstance().getCallListner()&&(_.isFalsy(g.CallController.getInstance().getCallListner()._eventListener.onCallEnded)||g.CallController.getInstance().getCallListner()._eventListener.onCallEnded(e))):_.Logger.error("CallingComponent :: endCall","Calling Component is not installed"):u.endCall()},r.muteAudio=function(t){var e,n,o,s;t?_.isFalsy(u)?(null===(e=null==r?void 0:r.ref)||void 0===e?void 0:e.muteAudio)?null===(n=null==r?void 0:r.ref)||void 0===n||n.muteAudio():_.Logger.error("CallingComponent :: muteAudio","Calling Component is not installed"):u.muteAudio():_.isFalsy(u)?(null===(o=null==r?void 0:r.ref)||void 0===o?void 0:o.unMuteAudio)?null===(s=null==r?void 0:r.ref)||void 0===s||s.unMuteAudio():_.Logger.error("CallingComponent :: muteAudio","Calling Component is not installed"):u.unMuteAudio()},r.pauseVideo=function(t){var e,n,o,s;t?_.isFalsy(u)?(null===(e=null==r?void 0:r.ref)||void 0===e?void 0:e.pauseVideo)?null===(n=null==r?void 0:r.ref)||void 0===n||n.pauseVideo():_.Logger.error("CallingComponent :: pauseVideo","Calling Component is not installed"):u.pauseVideo():_.isFalsy(u)?(null===(o=null==r?void 0:r.ref)||void 0===o?void 0:o.unPauseVideo)?null===(s=null==r?void 0:r.ref)||void 0===s||s.unPauseVideo():_.Logger.error("CallingComponent :: muteAudio","Calling Component is not installed"):u.unPauseVideo()},r.setAudioMode=function(t){var e,n;_.isFalsy(u)?(null===(e=null==r?void 0:r.ref)||void 0===e?void 0:e.setAudioMode)?(t=t.toUpperCase(),-1<Object.keys(T.CallConstants.AUDIO_MODE).indexOf(t)&&(null===(n=null==r?void 0:r.ref)||void 0===n||n.setAudioMode(t))):_.Logger.error("CallingComponent :: setAudioMode","Calling Component is not installed"):(t=t.toUpperCase(),-1<Object.keys(T.CallConstants.AUDIO_MODE).indexOf(t)&&u.setAudioMode(t))},r.getAudioOutputModes=function(){return new Promise(function(e,n){var t,o;if(_.isFalsy(u))(null===(t=null==r?void 0:r.ref)||void 0===t?void 0:t.getAudioModes)?null===(o=null==r?void 0:r.ref)||void 0===o||o.getAudioModes().then(function(t){var o=[];t.hasOwnProperty("modes")&&t.modes.map(function(t){var e="",n=!1;t.hasOwnProperty("mode")&&(e=t.mode),t.hasOwnProperty("isSelected")&&(n=t.isSelected),t.hasOwnProperty("type")&&(e=t.type),t.hasOwnProperty("selected")&&(n=t.selected),o.push(new d.AudioMode(e,n))}),e(o)},function(t){n(t)}):_.Logger.error("CallingComponent :: getAudioOutputModes","Calling Component is not installed");else{var s=[];u.getAudioModes().then(function(t){t.hasOwnProperty("modes")&&t.modes.map(function(t){var e="",n=!1;t.hasOwnProperty("mode")&&(e=t.mode),t.hasOwnProperty("isSelected")&&(n=t.isSelected),t.hasOwnProperty("type")&&(e=t.type),t.hasOwnProperty("selected")&&(n=t.selected),s.push(new d.AudioMode(e,n))}),e(s)},function(t){n(t)})}})},r.switchToVideoCall=function(){var t,e;_.isFalsy(u)?(null===(t=null==r?void 0:r.ref)||void 0===t?void 0:t.switchToVideoCall)?null===(e=null==r?void 0:r.ref)||void 0===e||e.switchToVideoCall():_.Logger.error("CallingComponent: switchToVideoCall","Calling Component is not installed"):u.switchToVideoCall()},r.startCallRecording=function(){var t,e;_.isFalsy(u)?(null===(t=null==r?void 0:r.ref)||void 0===t?void 0:t.startRecording)?null===(e=null==r?void 0:r.ref)||void 0===e||e.startRecording():_.Logger.error("CallingComponent: startCallRecording","Calling Component is not installed"):u.startRecording()},r.stopCallRecording=function(){var t,e;_.isFalsy(u)?(null===(t=null==r?void 0:r.ref)||void 0===t?void 0:t.stopRecording)?null===(e=null==r?void 0:r.ref)||void 0===e||e.stopRecording():_.Logger.error("CallingComponent: stopCallRecording","Calling Component is not installed"):u.stopRecording()},r.ref=null,r}(S.Component);e.CallingComponent=r},function(t,e,n){"use strict";e.__esModule=!0,e.KeyStore=void 0;var r=n(0),i=n(1),a=n(2),o=n(12),s=function(){function t(t){this.store=i.constants.DEFAULT_STORE,r.isFalsy(t)||(this.store=t);try{this.keyStore=o.default}catch(t){r.Logger.error("KeyStore: constructor",{e:t})}}return t.getInstance=function(){return null==t.KeyStore&&(t.KeyStore=new t),t.KeyStore},t.prototype.set=function(t,e){var n=r.getKeyprefix(i.LOCAL_STORE.KEYS_STORE,t);return this.keyStore.setItem(n,JSON.stringify(e))},t.prototype.get=function(t){var o=this,s=r.getKeyprefix(i.LOCAL_STORE.KEYS_STORE,t);return new Promise(function(n,e){try{o.keyStore.getItem(s).then(function(e){try{n(JSON.parse(e))}catch(t){n(e)}},function(t){e(t)})}catch(t){e(new a.CometChatException(t))}})},t}();e.KeyStore=s},function(t,e,n){"use strict";e.__esModule=!0,e.GroupMembersController=void 0;var o=n(38),s=n(1),r=n(0),i=function(){function t(){}return t.trasformJSONGroupMember=function(e){var t;try{return e.status&&"offline"!==e.status?e.status="online":e.status="offline",t=new o.GroupMember(e[s.GroupMemersConstans.KEYS.UID]),Object.assign(t,e),t}catch(t){return r.Logger.error("GroupMembersController:trasformJSONGroupMember",{e:t,groupMember:e}),e}},t}();e.GroupMembersController=i},function(t,e,n){"use strict";var o,s=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});e.__esModule=!0,e.GroupMember=void 0;var r=n(3),i=n(1),a=function(o){function t(t,e){var n=o.call(this,t)||this;return n.joinedAt=0,e&&(n.scope=e),n}return s(t,o),t.prototype.setScope=function(t){this.scope=t},t.prototype.setJoinedAt=function(t){this.joinedAt=t},t.prototype.setGuid=function(t){this.guid=t},t.prototype.getScope=function(){return this.scope},t.prototype.getJoinedAt=function(){return this.joinedAt},t.prototype.getGuid=function(){return this.guid},t.GroupMemberScope=i.GroupMemberScope,t}(r.User);e.GroupMember=a},function(t,e,n){"use strict";e.__esModule=!0,e.Conversation=void 0;var i=n(10),a=n(1),E=n(11),c=n(16),o=function(){function t(t,e,n,o,s,r){this.conversationId=t,this.conversationType=e,r&&0<r.length&&(this.tags=r),void 0!==n&&void 0!==(this.lastMessage=n).id&&(this.lastMessage=i.MessageController.trasformJSONMessge(n)),this.conversationType==a.MessageConstatnts.RECEIVER_TYPE.USER?this.conversationWith=E.UsersController.trasformJSONUser(o):this.conversationWith=c.GroupsController.trasformJSONGroup(o),this.unreadMessageCount=void 0!==s?s:0}return t.prototype.setConversationId=function(t){this.conversationId=t},t.prototype.setConversationType=function(t){this.conversationType=t},t.prototype.setLastMessage=function(t){this.lastMessage=t},t.prototype.setConversationWith=function(t){this.conversationWith=t},t.prototype.setUnreadMessageCount=function(t){this.unreadMessageCount=t},t.prototype.getConversationId=function(){return this.conversationId},t.prototype.getConversationType=function(){return this.conversationType},t.prototype.getLastMessage=function(){return this.lastMessage},t.prototype.getConversationWith=function(){return this.conversationWith},t.prototype.getUnreadMessageCount=function(){return this.unreadMessageCount},t.prototype.getTags=function(){return this.tags},t}();e.Conversation=o},function(t,e,n){"use strict";e.__esModule=!0,e.TypingNotificationController=void 0;var o=n(0),s=function(){function t(){}return t.addTypingStarted=function(t){this.TYPING_STARTED_MAP[t]=o.getCurrentTime()},t.removeTypingStarted=function(t){delete this.TYPING_STARTED_MAP[t]},t.getTypingStartedMap=function(t){if(t)return this.TYPING_STARTED_MAP[t]},t.addTypingEnded=function(t){this.TYPING_ENDED_MAP[t]=o.getCurrentTime()},t.removeTypingEnded=function(t){delete this.TYPING_ENDED_MAP[t]},t.getTypingEndedMap=function(t){if(t)return this.TYPING_ENDED_MAP[t]},t.addIncomingTypingStarted=function(t){this.INCOMING_TYPING_STARTED_MAP[t.getReceiverId()]={typingNotification:t,timestamp:o.getCurrentTime()}},t.removeIncomingTypingStarted=function(t){delete this.INCOMING_TYPING_STARTED_MAP[t.getReceiverId()]},t.TYPING_STARTED_MAP={},t.TYPING_ENDED_MAP={},t.INCOMING_TYPING_STARTED_MAP={},t}();e.TypingNotificationController=s},function(t,e,n){"use strict";var o=this&&this.__spreadArrays||function(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var o=Array(t),s=0;for(e=0;e<n;e++)for(var r=arguments[e],i=0,a=r.length;i<a;i++,s++)o[s]=r[i];return o};e.__esModule=!0,e.ListenerHandlers=void 0;var s=n(0),r=n(21),i=function(){function t(){this.connectionHandlers=[],this.loginHandlers=[],this.messageHandlers=[],this.userHandlers=[],this.groupHandlers=[],this.callHandlers=[]}return t.getInstance=function(){return null!=this.listenerHandlers&&null!=this.listenerHandlers||(this.listenerHandlers=new t),this.listenerHandlers},t.prototype.addConnectionEventListener=function(e,t){try{this.connectionHandlers=this.connectionHandlers.filter(function(t){return t._name!=e}),this.connectionHandlers=o(this.connectionHandlers,[new r.WSConnectionListener(e,t)])}catch(t){s.Logger.error("ListenerHandlers: addWSConnectionEventListener",t)}},t.prototype.removeConnectionEventListener=function(e){try{this.connectionHandlers=this.connectionHandlers.filter(function(t){return t._name!==e})}catch(t){s.Logger.error("ListenerHandlers: removeWSConnectionEventListener",t)}},t.prototype.addLoginEventListener=function(e,t){try{this.loginHandlers=this.loginHandlers.filter(function(t){return t._name!=e}),this.loginHandlers=o(this.loginHandlers,[new r.UserLoginListener(e,t)])}catch(t){s.Logger.error("ListenerHandlers: addLoginEventListener",t)}},t.prototype.removeLoginEventListener=function(e){try{this.loginHandlers=this.loginHandlers.filter(function(t){return t._name!==e})}catch(t){s.Logger.error("ListenerHandlers: removeLoginEventListener",t)}},t.prototype.addMessageEventListener=function(e,t){try{this.messageHandlers=this.messageHandlers.filter(function(t){return t._name!=e}),this.messageHandlers=o(this.messageHandlers,[new r.MessagesListener(e,t)])}catch(t){s.Logger.error("ListenerHandlers: addMessageEventListener",t)}},t.prototype.removeMessageEventListener=function(e){try{this.messageHandlers=this.messageHandlers.filter(function(t){return t._name!==e})}catch(t){s.Logger.error("ListenerHandlers: removeMessageEventListener",t)}},t.prototype.addUserEventListener=function(e,t){try{this.userHandlers=this.userHandlers.filter(function(t){return t._name!=e}),this.userHandlers=o(this.userHandlers,[new r.UsersListener(e,t)])}catch(t){s.Logger.error("ListenerHandlers: addUserEventListener",t)}},t.prototype.removeUserEventListener=function(e){try{this.userHandlers=this.userHandlers.filter(function(t){return t._name!==e})}catch(t){s.Logger.error("ListenerHandlers: removeUserEventListener",t)}},t.prototype.addGroupEventListener=function(e,t){try{this.groupHandlers=this.groupHandlers.filter(function(t){return t._name!=e}),this.groupHandlers=o(this.groupHandlers,[new r.GroupsListener(e,t)])}catch(t){s.Logger.error("ListenerHandlers: addGroupEventListener",t)}},t.prototype.removeGroupEventListener=function(e){try{this.groupHandlers=this.groupHandlers.filter(function(t){return t._name!==e})}catch(t){s.Logger.error("ListenerHandlers: removeGroupEventListener",t)}},t.prototype.addCallEventListener=function(e,t){try{this.callHandlers=this.callHandlers.filter(function(t){return t._name!=e}),this.callHandlers=o(this.callHandlers,[new r.CallsListener(e,t)])}catch(t){s.Logger.error("ListenerHandlers: addCallEventListener",t)}},t.prototype.removeCallEventListener=function(e){try{this.callHandlers=this.callHandlers.filter(function(t){return t._name!==e})}catch(t){s.Logger.error("ListenerHandlers: removeCallEventListener",t)}},t.listenerHandlers=new t,t}();e.ListenerHandlers=i},function(t,e,n){"use strict";e.__esModule=!0,e.getWSURL=e.stringifyMessage=e.checkConnection=void 0;var o=n(1),s=n(0),r=n(4);e.checkConnection=function(t){return t&&t.readyState===r.READY_STATE.OPEN},e.stringifyMessage=function(t){return JSON.stringify(t)},e.getWSURL=function(){return new Promise(function(n,t){s.getAppSettings().then(function(t){var e=r.WS.protocol+s.getChatHost(t)+":"+t[o.APP_SETTINGS.KEYS.CHAT_WSS_PORT];n(e)},function(t){s.Logger.error("WSHelper :: getWSURL",t)})})}},function(t,e,n){"use strict";e.__esModule=!0,e.RTCUser=void 0;var o=n(0),s=function(){function t(t){this.avatar="",o.isFalsy(t)||(this.uid=t.toString())}return t.prototype.setUID=function(t){this.uid=t?t.toString():""},t.prototype.getUID=function(){return this.uid.toString()},t.prototype.setName=function(t){this.name=t?t.toString():""},t.prototype.getName=function(){return this.name.toString()},t.prototype.setAvatar=function(t){this.avatar=t?t.toString():""},t.prototype.getAvatar=function(){return this.avatar.toString()},t.prototype.setJWT=function(t){this.jwt=t?t.toString():""},t.prototype.getJWT=function(){return this.jwt.toString()},t.prototype.setResource=function(t){this.resource=t?t.toString():""},t.prototype.getResource=function(){return this.resource.toString()},t}();e.RTCUser=s},function(t,e){t.exports=s},function(t,e,n){"use strict";e.__esModule=!0,e.AudioMode=void 0;var o=n(0),s=function(){function t(t,e){this.isSelected=!1,this.mode="",o.isFalsy(t)||(this.mode=t.toString()),this.isSelected=e||!1}return t.prototype.setMode=function(t){this.mode=t?t.toString():""},t.prototype.getMode=function(){return this.mode.toString()},t.prototype.setIsSelected=function(t){this.isSelected=t||!1},t.prototype.getIsSelected=function(){return this.isSelected},t}();e.AudioMode=s},function(t,e,n){"use strict";e.__esModule=!0,e.GroupsRequestBuilder=e.GroupsRequest=void 0;var s=n(6),o=n(0),r=n(2),i=n(16),a=n(1),E=function(){function t(t){this.cursor=-1,this.total=-1,this.next_page=1,this.last_page=-1,this.current_page=1,this.total_pages=-1,this.hasJoined=0,this.withTags=!1,this.pagination={total:0,count:0,per_page:0,current_page:0,total_pages:0,links:[]},o.isFalsy(t)||(o.isFalsy(t.limit)||(this.limit=t.limit),o.isFalsy(t.searchKeyword)||(this.searchKeyword=t.searchKeyword),o.isFalsy(t.hasJoined)||(this.hasJoined=1),o.isFalsy(t.tags)||(this.tags=t.tags),o.isFalsy(t.showTags)||(this.withTags=t.showTags))}return t.prototype.validateGroupBuilder=function(){if(void 0===this.limit)return new r.CometChatException(JSON.parse(o.format(JSON.stringify(a.GENERAL_ERROR.METHOD_COMPULSORY),"SET_LIMIT","SET_LIMIT","Set Limit")));if(isNaN(this.limit))return new r.CometChatException(JSON.parse(o.format(JSON.stringify(a.GENERAL_ERROR.PARAMETER_MUST_BE_A_NUMBER),"SET_LIMIT","SET_LIMIT","setLimit()")));if(this.limit>a.DEFAULT_VALUES.GROUPS_MAX_LIMIT)return new r.CometChatException(JSON.parse(o.format(JSON.stringify(a.GENERAL_ERROR.LIMIT_EXCEEDED),"SET_LIMIT","SET_LIMIT",a.DEFAULT_VALUES.GROUPS_MAX_LIMIT)));if(this.limit<a.DEFAULT_VALUES.ZERO)return new r.CometChatException(JSON.parse(o.format(JSON.stringify(a.GENERAL_ERROR.PARAMETER_MUST_BE_A_POSITIVE_NUMBER),"SET_LIMIT","SET_LIMIT","setLimit()")));if(void 0!==this.searchKeyword){if(typeof this.searchKeyword!==a.COMMON_UTILITY_CONSTANTS.TYPE_CONSTANTS.STRING)return new r.CometChatException(JSON.parse(o.format(JSON.stringify(a.GENERAL_ERROR.PARAMETER_MUST_BE_A_STRING),"SET_SEARCH_KEYWORD","SET_SEARCH_KEYWORD","setSearchKeyword()")));if(o.isFalsy(this.searchKeyword.trim()))return new r.CometChatException(JSON.parse(o.format(JSON.stringify(a.GENERAL_ERROR.INVALID),"SET_SEARCH_KEYWORD","SET_SEARCH_KEYWORD","search keyword","search keyword")));this.searchKeyword=this.searchKeyword.trim()}if(void 0!==this.withTags){if(typeof this.withTags!==a.COMMON_UTILITY_CONSTANTS.TYPE_CONSTANTS.BOOLEAN)return new r.CometChatException(JSON.parse(o.format(JSON.stringify(a.GENERAL_ERROR.PARAMETER_MUST_BE_A_BOOLEAN),"WITH_TAGS","WITH_TAGS","withTags()")));1==this.withTags?this.withTags=!0:this.withTags=!1}return void 0===this.tags||Array.isArray(this.tags)?void 0:new r.CometChatException(JSON.parse(o.format(JSON.stringify(a.GENERAL_ERROR.PARAMETER_MUST_BE_AN_ARRAY),"TAGS","TAGS","setTags()")))},t.prototype.fetchNext=function(){var o=this;return new Promise(function(e,n){try{var t=o.validateGroupBuilder();if(t instanceof r.CometChatException)return void n(t);s.makeApiCall("getGroups",{},o.getNextData()).then(function(t){if(t.meta&&(o.total_pages=t.meta.pagination.total_pages),0<t.data.length){o.pagination=t.meta.pagination;var n=[];t.data.map(function(t,e){n.push(i.GroupsController.trasformJSONGroup(t))}),e(n)}e([])},function(t){n(new r.CometChatException(t.error))})}catch(t){n(new r.CometChatException(t))}})},t.prototype.getNextData=function(){var t={};if(t.per_page=this.limit,o.isFalsy(this.searchKeyword)||(t.searchKey=this.searchKeyword),o.isFalsy(this.hasJoined)||(t.hasJoined=1),o.isFalsy(this.tags)||(t.tags=this.tags),o.isFalsy(this.withTags)||(t.withTags=1),1==this.current_page)t.page=this.next_page,this.next_page++,this.current_page++;else{if(this.next_page>this.total_pages)return t.page=this.next_page,t;t.page=this.next_page++}return t},t.MAX_LIMIT=100,t.DEFAULT_LIMIT=30,t}();e.GroupsRequest=E;var c=function(){function t(){}return t.prototype.setLimit=function(t){return this.limit=t,this},t.prototype.setSearchKeyword=function(t){return this.searchKeyword=t,this},t.prototype.joinedOnly=function(t){return this.hasJoined=t,this},t.prototype.setTags=function(t){return this.tags=t,this},t.prototype.withTags=function(t){return this.showTags=t,this},t.prototype.build=function(){return new E(this)},t}();e.GroupsRequestBuilder=c},function(t,e,n){"use strict";e.__esModule=!0,e.GroupMembersRequestBuilder=e.GroupMembersRequest=void 0;var s=n(6),o=n(0),r=n(14),i=n(2),a=n(37),E=n(1),c=function(){function t(t){this.cursor=-1,this.total=-1,this.next_page=1,this.last_page=-1,this.current_page=1,this.total_pages=-1,this.pagination={total:0,count:0,per_page:0,current_page:0,total_pages:0,links:[]},this.store=r.LocalStorage.getInstance(),o.isFalsy(t)||(this.limit=t.limit,this.guid=t.guid,o.isFalsy(t.searchKeyword)||(this.searchKeyword=t.searchKeyword),o.isFalsy(t.scopes)||(this.scopes=t.scopes))}return t.prototype.validateGroupMembersBuilder=function(){if(void 0===this.limit)return new i.CometChatException(JSON.parse(o.format(JSON.stringify(E.GENERAL_ERROR.METHOD_COMPULSORY),"SET_LIMIT","SET_LIMIT","Set Limit")));if(isNaN(this.limit))return new i.CometChatException(JSON.parse(o.format(JSON.stringify(E.GENERAL_ERROR.PARAMETER_MUST_BE_A_NUMBER),"SET_LIMIT","SET_LIMIT","setLimit()")));if(this.limit>E.DEFAULT_VALUES.USERS_MAX_LIMIT)return new i.CometChatException(JSON.parse(o.format(JSON.stringify(E.GENERAL_ERROR.LIMIT_EXCEEDED),"SET_LIMIT","SET_LIMIT",E.DEFAULT_VALUES.USERS_MAX_LIMIT)));if(this.limit<E.DEFAULT_VALUES.ZERO)return new i.CometChatException(JSON.parse(o.format(JSON.stringify(E.GENERAL_ERROR.PARAMETER_MUST_BE_A_POSITIVE_NUMBER),"SET_LIMIT","SET_LIMIT","setLimit()")));if(void 0!==this.searchKeyword){if(typeof this.searchKeyword!==E.COMMON_UTILITY_CONSTANTS.TYPE_CONSTANTS.STRING)return new i.CometChatException(JSON.parse(o.format(JSON.stringify(E.GENERAL_ERROR.PARAMETER_MUST_BE_A_STRING),"SET_SEARCH_KEYWORD","SET_SEARCH_KEYWORD","setSearchKeyword()")));if(o.isFalsy(this.searchKeyword.trim()))return new i.CometChatException(JSON.parse(o.format(JSON.stringify(E.GENERAL_ERROR.INVALID),"SET_SEARCH_KEYWORD","SET_SEARCH_KEYWORD","search keyword","search keyword")));this.searchKeyword=this.searchKeyword.trim()}if(void 0!==this.guid){if(typeof this.guid!==E.COMMON_UTILITY_CONSTANTS.TYPE_CONSTANTS.STRING)return new i.CometChatException(JSON.parse(o.format(JSON.stringify(E.GENERAL_ERROR.PARAMETER_MUST_BE_A_STRING),"GUID","GUID","GroupMembersRequestBuilder()")));if(o.isFalsy(this.guid))return new i.CometChatException(JSON.parse(o.format(JSON.stringify(E.GENERAL_ERROR.INVALID),"GUID","GUID","GUID","GUID")))}return void 0===this.scopes||Array.isArray(this.scopes)?void 0:new i.CometChatException(JSON.parse(o.format(JSON.stringify(E.GENERAL_ERROR.PARAMETER_MUST_BE_AN_ARRAY),"SET_SCOPES","SET_SCOPES","setScopes()")))},t.prototype.fetchNext=function(){var o=this;return new Promise(function(n,e){try{var t=o.validateGroupMembersBuilder();if(t instanceof i.CometChatException)return void e(t);s.makeApiCall("getGroupMembers",{guid:o.guid},o.getNextData()).then(function(t){if(t.meta&&(o.total_pages=t.meta.pagination.total_pages),0<t.data.length){o.pagination=t.meta.pagination;var e=[];t.data.map(function(t){t.guid=o.guid,e.push(a.GroupMembersController.trasformJSONGroupMember(t))}),n(e)}else n([])},function(t){e(new i.CometChatException(t.error))})}catch(t){e(new i.CometChatException(t))}})},t.prototype.getNextData=function(){var t={};if(t.per_page=this.limit,o.isFalsy(this.searchKeyword)||(t.searchKey=this.searchKeyword),o.isFalsy(this.scopes)||(t.scopes=this.scopes),1==this.current_page)t.page=this.next_page,this.next_page++,this.current_page++;else{if(this.next_page>this.total_pages)return t.page=this.next_page,t;t.page=this.next_page++}return t},t.MAX_LIMIT=2,t.DEFAULT_LIMIT=1,t}();e.GroupMembersRequest=c;var u=function(){function t(t){this.guid=t}return t.prototype.setLimit=function(t){return this.limit=t,this},t.prototype.setSearchKeyword=function(t){return this.searchKeyword=t,this},t.prototype.setScopes=function(t){return this.scopes=t,this},t.prototype.build=function(){return new c(this)},t}();e.GroupMembersRequestBuilder=u},function(t,e,n){"use strict";e.__esModule=!0,e.BannedMembersRequestBuilder=e.BannedMembersRequest=void 0;var s=n(6),o=n(0),r=n(2),i=n(37),a=n(1),E=function(){function t(t){this.cursor=-1,this.total=-1,this.next_page=1,this.last_page=-1,this.current_page=1,this.total_pages=-1,this.pagination={total:0,count:0,per_page:0,current_page:0,total_pages:0,links:[]},o.isFalsy(t)||(this.limit=t.limit,this.guid=t.guid,o.isFalsy(t.searchKeyword)||(this.searchKeyword=t.searchKeyword),o.isFalsy(t.scopes)||(this.scopes=t.scopes))}return t.prototype.validateBannedMembersBuilder=function(){if(void 0===this.limit)return new r.CometChatException(JSON.parse(o.format(JSON.stringify(a.GENERAL_ERROR.METHOD_COMPULSORY),"SET_LIMIT","SET_LIMIT","Set Limit")));if(isNaN(this.limit))return new r.CometChatException(JSON.parse(o.format(JSON.stringify(a.GENERAL_ERROR.PARAMETER_MUST_BE_A_NUMBER),"SET_LIMIT","SET_LIMIT","setLimit()")));if(this.limit>a.DEFAULT_VALUES.USERS_MAX_LIMIT)return new r.CometChatException(JSON.parse(o.format(JSON.stringify(a.GENERAL_ERROR.LIMIT_EXCEEDED),"SET_LIMIT","SET_LIMIT",a.DEFAULT_VALUES.USERS_MAX_LIMIT)));if(this.limit<a.DEFAULT_VALUES.ZERO)return new r.CometChatException(JSON.parse(o.format(JSON.stringify(a.GENERAL_ERROR.PARAMETER_MUST_BE_A_POSITIVE_NUMBER),"SET_LIMIT","SET_LIMIT","setLimit()")));if(void 0!==this.searchKeyword){if(typeof this.searchKeyword!==a.COMMON_UTILITY_CONSTANTS.TYPE_CONSTANTS.STRING)return new r.CometChatException(JSON.parse(o.format(JSON.stringify(a.GENERAL_ERROR.PARAMETER_MUST_BE_A_STRING),"SET_SEARCH_KEYWORD","SET_SEARCH_KEYWORD","setSearchKeyword()")));if(o.isFalsy(this.searchKeyword.trim()))return new r.CometChatException(JSON.parse(o.format(JSON.stringify(a.GENERAL_ERROR.INVALID),"SET_SEARCH_KEYWORD","SET_SEARCH_KEYWORD","search keyword","search keyword")));this.searchKeyword=this.searchKeyword.trim()}if(void 0!==this.guid){if(typeof this.guid!==a.COMMON_UTILITY_CONSTANTS.TYPE_CONSTANTS.STRING)return new r.CometChatException(JSON.parse(o.format(JSON.stringify(a.GENERAL_ERROR.PARAMETER_MUST_BE_A_STRING),"GUID","GUID","GroupMembersRequestBuilder()")));if(o.isFalsy(this.guid))return new r.CometChatException(JSON.parse(o.format(JSON.stringify(a.GENERAL_ERROR.INVALID),"GUID","GUID","GUID","GUID")))}return void 0===this.scopes||Array.isArray(this.scopes)?void 0:new r.CometChatException(JSON.parse(o.format(JSON.stringify(a.GENERAL_ERROR.PARAMETER_MUST_BE_AN_ARRAY),"SET_SCOPES","SET_SCOPES","setScopes()")))},t.prototype.fetchNext=function(){var o=this;return new Promise(function(n,e){try{var t=o.validateBannedMembersBuilder();if(t instanceof r.CometChatException)return void e(t);s.makeApiCall("getBannedGroupMembers",{guid:o.guid},o.getNextData()).then(function(t){if(t.meta&&(o.total_pages=t.meta.pagination.total_pages),0<t.data.length){o.pagination=t.meta.pagination;var e=[];t.data.map(function(t){t.guid=o.guid,e.push(i.GroupMembersController.trasformJSONGroupMember(t))}),n(e)}else n([])},function(t){e(new r.CometChatException(t.error))})}catch(t){e(new r.CometChatException(t))}})},t.prototype.getNextData=function(){var t={};if(t.per_page=this.limit,o.isFalsy(this.searchKeyword)||(t.searchKey=this.searchKeyword),o.isFalsy(this.scopes)||(t.scopes=this.scopes),1==this.current_page)t.page=this.next_page,this.next_page++,this.current_page++;else{if(this.next_page>this.total_pages)return t.page=this.next_page,t;t.page=this.next_page++}return t},t.MAX_LIMIT=2,t.DEFAULT_LIMIT=1,t}();e.BannedMembersRequest=E;var c=function(){function t(t){this.guid=t}return t.prototype.setLimit=function(t){return this.limit=t,this},t.prototype.setSearchKeyword=function(t){return this.searchKeyword=t,this},t.prototype.setScopes=function(t){return this.scopes=t,this},t.prototype.build=function(){return new E(this)},t}();e.BannedMembersRequestBuilder=c},function(t,e,n){"use strict";e.__esModule=!0,e.UsersRequestBuilder=e.UsersRequest=void 0;var s=n(6),o=n(0),r=n(11),i=n(2),a=n(50),E=n(1),c=function(){function e(t){this.next_page=1,this.current_page=1,this.total_pages=-1,this.hideBlockedUsers=!1,this.friendsOnly=!1,this.fetchingInProgress=!1,this.withTags=!1,this.pagination={total:0,count:0,per_page:0,current_page:0,total_pages:0,links:[]},e.userStore=a.UserStore.getInstance(),o.isFalsy(t)||(this.limit=t.limit,o.isFalsy(t.searchKeyword)||(this.searchKeyword=t.searchKeyword),o.isFalsy(t.status)||(t.status==e.USER_STATUS.ONLINE?this.status=E.PresenceConstatnts.STATUS.AVAILABLE:this.status=t.status),o.isFalsy(t.shouldHideBlockedUsers)||(this.hideBlockedUsers=t.shouldHideBlockedUsers),o.isFalsy(t.showFriendsOnly)||(this.friendsOnly=t.showFriendsOnly),o.isFalsy(t.showTags)||(this.withTags=t.showTags),o.isFalsy(t.role)||(this.role=t.role),o.isFalsy(t.roles)||(this.roles=t.roles),o.isFalsy(t.tags)||(this.tags=t.tags),o.isFalsy(t.UIDs)||(this.UIDs=t.UIDs),o.isFalsy(t.SortBy)||(this.sortBy=t.SortBy),o.isFalsy(t.SearchIn)||(this.searchIn=t.SearchIn),o.isFalsy(t.SortOrder)||(this.sortOrder=t.SortOrder))}return e.prototype.validateUserBuilder=function(){if(void 0===this.limit)return new i.CometChatException(JSON.parse(o.format(JSON.stringify(E.GENERAL_ERROR.METHOD_COMPULSORY),"SET_LIMIT","SET_LIMIT","Set Limit")));if(isNaN(this.limit))return new i.CometChatException(JSON.parse(o.format(JSON.stringify(E.GENERAL_ERROR.PARAMETER_MUST_BE_A_NUMBER),"SET_LIMIT","SET_LIMIT","setLimit()")));if(this.limit>E.DEFAULT_VALUES.USERS_MAX_LIMIT)return new i.CometChatException(JSON.parse(o.format(JSON.stringify(E.GENERAL_ERROR.LIMIT_EXCEEDED),"SET_LIMIT","SET_LIMIT",E.DEFAULT_VALUES.USERS_MAX_LIMIT)));if(this.limit<E.DEFAULT_VALUES.ZERO)return new i.CometChatException(JSON.parse(o.format(JSON.stringify(E.GENERAL_ERROR.PARAMETER_MUST_BE_A_POSITIVE_NUMBER),"SET_LIMIT","SET_LIMIT","setLimit()")));if(void 0!==this.searchKeyword){if(typeof this.searchKeyword!==E.COMMON_UTILITY_CONSTANTS.TYPE_CONSTANTS.STRING)return new i.CometChatException(JSON.parse(o.format(JSON.stringify(E.GENERAL_ERROR.PARAMETER_MUST_BE_A_STRING),"SET_SEARCH_KEYWORD","SET_SEARCH_KEYWORD","setSearchKeyword()")));if(o.isFalsy(this.searchKeyword.trim()))return new i.CometChatException(JSON.parse(o.format(JSON.stringify(E.GENERAL_ERROR.INVALID),"SET_SEARCH_KEYWORD","SET_SEARCH_KEYWORD","search keyword","search keyword")));this.searchKeyword=this.searchKeyword.trim()}if(this.status){if(typeof this.status!==E.COMMON_UTILITY_CONSTANTS.TYPE_CONSTANTS.STRING)return new i.CometChatException(JSON.parse(o.format(JSON.stringify(E.GENERAL_ERROR.PARAMETER_MUST_BE_A_STRING),"SET_STATUS","SET_STATUS","setStatus()")));if("available"!=this.status.toLowerCase()&&"offline"!=this.status.toLowerCase())return new i.CometChatException(E.UserErrors.INVALID_STATUS)}if(void 0!==this.hideBlockedUsers){if(typeof this.hideBlockedUsers!==E.COMMON_UTILITY_CONSTANTS.TYPE_CONSTANTS.BOOLEAN)return new i.CometChatException(JSON.parse(o.format(JSON.stringify(E.GENERAL_ERROR.PARAMETER_MUST_BE_A_BOOLEAN),"HIDE_BLOCKED_USERS","HIDE_BLOCKED_USERS","hideBlockedUsers()")));1==this.hideBlockedUsers?this.hideBlockedUsers=!0:this.hideBlockedUsers=!1}if(void 0!==this.friendsOnly){if(typeof this.friendsOnly!==E.COMMON_UTILITY_CONSTANTS.TYPE_CONSTANTS.BOOLEAN)return new i.CometChatException(JSON.parse(o.format(JSON.stringify(E.GENERAL_ERROR.PARAMETER_MUST_BE_A_BOOLEAN),"FRIENDS_ONLY","FRIENDS_ONLY","friendsOnly()")));1==this.friendsOnly?this.friendsOnly=!0:this.friendsOnly=!1}if(void 0!==this.withTags){if(typeof this.withTags!==E.COMMON_UTILITY_CONSTANTS.TYPE_CONSTANTS.BOOLEAN)return new i.CometChatException(JSON.parse(o.format(JSON.stringify(E.GENERAL_ERROR.MUST_BE_A_BOOLEAN),"WITH_TAGS","WITH_TAGS","withTags()")));1==this.withTags?this.withTags=!0:this.withTags=!1}if(void 0!==this.roles&&!Array.isArray(this.roles))return new i.CometChatException(JSON.parse(o.format(JSON.stringify(E.GENERAL_ERROR.PARAMETER_MUST_BE_AN_ARRAY),"ROLES","ROLES","setRoles()")));if(void 0!==this.tags&&!Array.isArray(this.tags))return new i.CometChatException(JSON.parse(o.format(JSON.stringify(E.GENERAL_ERROR.PARAMETER_MUST_BE_AN_ARRAY),"TAGS","TAGS","setTags()")));if(void 0!==this.UIDs&&!Array.isArray(this.UIDs))return new i.CometChatException(JSON.parse(o.format(JSON.stringify(E.GENERAL_ERROR.PARAMETER_MUST_BE_AN_ARRAY),"UIDs","UIDs","setUIDs()")));if(this.sortBy){if(typeof this.sortBy!==E.COMMON_UTILITY_CONSTANTS.TYPE_CONSTANTS.STRING)return new i.CometChatException(JSON.parse(o.format(JSON.stringify(E.GENERAL_ERROR.PARAMETER_MUST_BE_A_STRING),"SORT_BY","SORT_BY","sortBy()")));if(o.isFalsy(this.sortBy.trim()))return new i.CometChatException(JSON.parse(o.format(JSON.stringify(E.GENERAL_ERROR.INVALID),"SORT_BY","SORT_BY","sort by","sort by")));this.sortBy=this.sortBy.trim().toLowerCase()}if(this.sortOrder){if(typeof this.sortOrder!==E.COMMON_UTILITY_CONSTANTS.TYPE_CONSTANTS.STRING)return new i.CometChatException(JSON.parse(o.format(JSON.stringify(E.GENERAL_ERROR.PARAMETER_MUST_BE_A_STRING),"SORT_BY_ORDER","SORT_BY_ORDER","sortByOrder()")));if(o.isFalsy(this.sortOrder.trim()))return new i.CometChatException(JSON.parse(o.format(JSON.stringify(E.GENERAL_ERROR.INVALID),"SORT_BY_ORDER","SORT_BY_ORDER","sort order","sort order")));this.sortOrder=this.sortOrder.trim().toLowerCase()}return this.searchIn&&!Array.isArray(this.searchIn)?new i.CometChatException(JSON.parse(o.format(JSON.stringify(E.GENERAL_ERROR.PARAMETER_MUST_BE_AN_ARRAY),"SEARCH_IN","SEARCH_IN","searchIn()"))):void 0},e.prototype.fetchNext=function(){var o=this;return new Promise(function(n,e){try{if(o.fetchingInProgress)o.fetchingInProgress=!1,n([]);else{o.fetchingInProgress=!0;var t=o.validateUserBuilder();if(t instanceof i.CometChatException)return void e(t);s.makeApiCall("users",{},o.getNextData()).then(function(t){if(t.meta&&(o.total_pages=t.meta.pagination.total_pages),0<t.data.length){o.pagination=t.meta.pagination;var e=[];t.data.map(function(t){e.push(r.UsersController.trasformJSONUser(t))}),n(e)}else n([]);o.fetchingInProgress=!1},function(t){o.fetchingInProgress=!1,e(new i.CometChatException(t.error))})}}catch(t){o.fetchingInProgress=!1,e(new i.CometChatException(t))}})},e.prototype.getNextData=function(){var t={};if(t.per_page=this.limit,o.isFalsy(this.searchKeyword)||(t.searchKey=this.searchKeyword),o.isFalsy(this.status)||(t.status=this.status),o.isFalsy(this.hideBlockedUsers)||(t.hideBlockedUsers=1),o.isFalsy(this.role)||(t.roles=this.role),o.isFalsy(this.roles)||(t.roles=this.roles),o.isFalsy(this.tags)||(t.tags=this.tags),o.isFalsy(this.friendsOnly)||(t.friendsOnly=1),o.isFalsy(this.withTags)||(t.withTags=1),o.isFalsy(this.UIDs)||(t.uids=this.UIDs),o.isFalsy(this.sortBy)||(t.sortBy=this.sortBy),o.isFalsy(this.sortOrder)||(t.sortOrder=this.sortOrder),o.isFalsy(this.searchIn)||(t.searchIn=this.searchIn),1==this.current_page)t.page=this.next_page,this.next_page++,this.current_page++;else{if(this.next_page>this.total_pages)return t.page=this.next_page,t;t.page=this.next_page++}return t},e.USER_STATUS={ONLINE:E.PresenceConstatnts.STATUS.ONLINE,OFFLINE:E.PresenceConstatnts.STATUS.OFFLINE},e}();e.UsersRequest=c;var u=function(){function t(){this.shouldHideBlockedUsers=!1}return t.prototype.setLimit=function(t){return this.limit=t,this},t.prototype.setStatus=function(t){return this.status=t,this},t.prototype.setSearchKeyword=function(t){return this.searchKeyword=t,this},t.prototype.hideBlockedUsers=function(t){return this.shouldHideBlockedUsers=t,this},t.prototype.setRole=function(t){return this.role=t,this},t.prototype.setRoles=function(t){return this.roles=t,this},t.prototype.friendsOnly=function(t){return this.showFriendsOnly=t,this},t.prototype.setTags=function(t){return this.tags=t,this},t.prototype.withTags=function(t){return this.showTags=t,this},t.prototype.setUIDs=function(t){return this.UIDs=t,this},t.prototype.sortBy=function(t){return this.SortBy=t,this},t.prototype.sortByOrder=function(t){return this.SortOrder=t,this},t.prototype.searchIn=function(t){return this.SearchIn=t,this},t.prototype.build=function(){return this.role&&this.roles&&this.roles.push(this.role),new c(this)},t}();e.UsersRequestBuilder=u},function(t,e,n){"use strict";e.__esModule=!0,e.UserStore=void 0;var r=n(0),i=n(1),a=n(2),o=n(12),s=function(){function t(t){this.store=i.constants.DEFAULT_STORE,r.isFalsy(t)||(this.store=t);try{this.userStore=o.default}catch(t){r.Logger.error("UserStore: constructor",{e:t})}}return t.getInstance=function(){return null==t.UserStore&&(t.UserStore=new t),t.UserStore},t.prototype.set=function(t,e){var n=r.getKeyprefix(i.LOCAL_STORE.USERS_STORE,t);return this.userStore.setItem(n,JSON.stringify(e))},t.prototype.get=function(t){var o=this,s=r.getKeyprefix(i.LOCAL_STORE.USERS_STORE,t);return new Promise(function(n,e){try{o.userStore.getItem(s).then(function(e){try{n(JSON.parse(e))}catch(t){n(e)}},function(t){e(t)})}catch(t){e(new a.CometChatException(t))}})},t.prototype.clear=function(t){},t.prototype.selectStore=function(t){this.store=t},t.prototype.storeUsers=function(t){var e=this;return t.map(function(t){e.set(t.getUid(),t)}),!0},t.prototype.storeUser=function(t){return this.set(t.getUid(),t),!0},t}();e.UserStore=s},function(t,e,n){"use strict";e.__esModule=!0,e.ConversationsRequestBuilder=e.ConversationsRequest=void 0;var s=n(6),o=n(0),r=n(2),i=n(26),a=n(1),E=function(){function t(t){this.limit=100,this.next_page=1,this.current_page=1,this.total_pages=-1,this.fetchingInProgress=!1,this.getUserAndGroupTags=!1,this.withTags=!1,this.pagination={total:0,count:0,per_page:0,current_page:0,total_pages:0,links:[]},o.isFalsy(t)||(this.limit=t.limit,o.isFalsy(t.conversationType)||(this.conversationType=t.conversationType)),o.isFalsy(t.getUserAndGroupTags)||(this.getUserAndGroupTags=t.getUserAndGroupTags),t.tags&&(this.tags=t.tags),o.isFalsy(t.WithTags)||(this.withTags=t.WithTags),t.groupTags&&(this.groupTags=t.groupTags),t.userTags&&(this.userTags=t.userTags)}return t.prototype.validateConversationBuilder=function(){return void 0===this.limit?new r.CometChatException(JSON.parse(o.format(JSON.stringify(a.GENERAL_ERROR.METHOD_COMPULSORY),"SET_LIMIT","SET_LIMIT","Set Limit"))):isNaN(this.limit)?new r.CometChatException(JSON.parse(o.format(JSON.stringify(a.GENERAL_ERROR.PARAMETER_MUST_BE_A_NUMBER),"SET_LIMIT","SET_LIMIT","setLimit()"))):this.limit>a.DEFAULT_VALUES.CONVERSATION_MAX_LIMIT?new r.CometChatException(JSON.parse(o.format(JSON.stringify(a.GENERAL_ERROR.LIMIT_EXCEEDED),"SET_LIMIT","SET_LIMIT",a.DEFAULT_VALUES.CONVERSATION_MAX_LIMIT))):this.limit<a.DEFAULT_VALUES.ZERO?new r.CometChatException(JSON.parse(o.format(JSON.stringify(a.GENERAL_ERROR.PARAMETER_MUST_BE_A_POSITIVE_NUMBER),"SET_LIMIT","SET_LIMIT","setLimit()"))):void 0},t.prototype.fetchNext=function(){var o=this;return new Promise(function(n,e){try{if(o.fetchingInProgress)o.fetchingInProgress=!1,n([]);else{o.fetchingInProgress=!0;var t=o.validateConversationBuilder();if(t instanceof r.CometChatException)return void e(t);s.makeApiCall("getConversations",{},o.getNextData()).then(function(t){if(t.meta&&(o.total_pages=t.meta.pagination.total_pages),0<t.data.length){o.pagination=t.meta.pagination;var e=[];t.data.map(function(t){e.push(i.ConversationController.trasformJSONConversation(t.conversationId,t.conversationType,t.lastMessage,t.conversationWith,parseInt(t.unreadMessageCount),t.tags?t.tags:[]))}),n(e)}else n([]);o.fetchingInProgress=!1},function(t){o.fetchingInProgress=!1,e(new r.CometChatException(t.error))})}}catch(t){o.fetchingInProgress=!1,e(new r.CometChatException(t))}})},t.prototype.getNextData=function(){var t={};if(t.per_page=this.limit,o.isFalsy(this.conversationType)||(t.conversationType=this.conversationType),o.isFalsy(this.getUserAndGroupTags)||(t.withUserAndGroupTags=this.getUserAndGroupTags),o.isFalsy(this.tags)||(t.tags=this.tags),o.isFalsy(this.withTags)||(t.withTags=this.withTags),o.isFalsy(this.userTags)||(t.userTags=this.userTags),o.isFalsy(this.groupTags)||(t.groupTags=this.groupTags),1==this.current_page)t.page=this.next_page,this.next_page++,this.current_page++;else{if(this.next_page>this.total_pages)return t.page=this.next_page,t;t.page=this.next_page++}return t},t}();e.ConversationsRequest=E;var c=function(){function t(){this.WithTags=!1}return t.prototype.setLimit=function(t){return this.limit=t,this},t.prototype.setConversationType=function(t){return this.conversationType=t,this},t.prototype.withUserAndGroupTags=function(t){return"boolean"==typeof t&&(this.getUserAndGroupTags=t),this},t.prototype.setTags=function(t){return this.tags=t,this},t.prototype.withTags=function(t){return this.WithTags=t,this},t.prototype.setGroupTags=function(t){return this.groupTags=t,this},t.prototype.setUserTags=function(t){return this.userTags=t,this},t.prototype.build=function(){return new E(this)},t}();e.ConversationsRequestBuilder=c},function(t,e,n){"use strict";var h=this&&this.__awaiter||function(t,i,a,E){return new(a||(a=Promise))(function(n,e){function o(t){try{r(E.next(t))}catch(t){e(t)}}function s(t){try{r(E.throw(t))}catch(t){e(t)}}function r(t){var e;t.done?n(t.value):(e=t.value,e instanceof a?e:new a(function(t){t(e)})).then(o,s)}r((E=E.apply(t,i||[])).next())})},R=this&&this.__generator||function(n,o){var s,r,i,t,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return t={next:e(0),throw:e(1),return:e(2)},"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(s)throw new TypeError("Generator is already executing.");for(;a;)try{if(s=1,r&&(i=2&e[0]?r.return:e[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,e[1])).done)return i;switch(r=0,i&&(e=[2&e[0],i.value]),e[0]){case 0:case 1:i=e;break;case 4:return a.label++,{value:e[1],done:!1};case 5:a.label++,r=e[1],e=[0];continue;case 7:e=a.ops.pop(),a.trys.pop();continue;default:if(!(i=0<(i=a.trys).length&&i[i.length-1])&&(6===e[0]||2===e[0])){a=0;continue}if(3===e[0]&&(!i||e[1]>i[0]&&e[1]<i[3])){a.label=e[1];break}if(6===e[0]&&a.label<i[1]){a.label=i[1],i=e;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(e);break}i[2]&&a.ops.pop(),a.trys.pop();continue}e=o.call(n,a)}catch(t){e=[6,t],r=0}finally{s=i=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}},s=this&&this.__spreadArrays||function(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var o=Array(t),s=0;for(e=0;e<n;e++)for(var r=arguments[e],i=0,a=r.length;i<a;i++,s++)o[s]=r[i];return o};e.__esModule=!0,e.MessagesRequestBuilder=e.MessagesRequest=void 0;var A=n(2),I=n(6),f=n(10),O=n(0),r=n(53),N=n(1),i=n(13),m=n(27),y=n(30),o=function(){function t(t){this.limit=N.DEFAULT_VALUES.MSGS_LIMIT,this.timestamp=0,this.id=N.DEFAULT_VALUES.DEFAULT_MSG_ID,this.messageStore=r.MessagesStore.getInstance(),this.endpointName="getUserMessages",this.listId="",this.totalPages=0,this.unread=!1,this.inProgress=!1,this.hideMessagesFromBlockedUsers=!1,this.updatedAt=0,this.onlyUpdates=0,this.paginationMeta={},this.WithTags=!1,this.hideDeletedMessages=!1,this.limit=t.limit,this.paginationMeta[N.MessageConstatnts.PAGINATION.KEYS.PER_PAGE]=this.limit,this.uid=t.uid,this.guid=t.guid,this.parentMessageId=t.parentMessageId,this.timestamp=t.timestamp,this.timestamp&&(this.paginationMeta[N.MessageConstatnts.PAGINATION.KEYS.SENT_AT]=this.timestamp),this.id=t.id,this.id!=N.DEFAULT_VALUES.DEFAULT_MSG_ID&&(this.paginationMeta[N.MessageConstatnts.PAGINATION.KEYS.ID]=this.id),this.hideMessagesFromBlockedUsers=t.HideMessagesFromBlockedUsers,this.hideMessagesFromBlockedUsers&&(this.paginationMeta[N.MessageConstatnts.PAGINATION.KEYS.HIDE_MESSAGES_FROM_BLOCKED_USER]=this.hideMessagesFromBlockedUsers),this.unread=t.unread,this.unread&&(this.paginationMeta[N.MessageConstatnts.PAGINATION.KEYS.UNREAD]=this.unread),t.searchKey&&(this.searchKey=t.searchKey,this.paginationMeta[N.MessageConstatnts.PAGINATION.KEYS.SEARCH_KEY]=this.searchKey),t.onlyUpdate&&(this.onlyUpdates=t.onlyUpdate,this.paginationMeta[N.MessageConstatnts.PAGINATION.KEYS.ONLY_UPDATES]=this.onlyUpdates),t.updatedAt&&(this.updatedAt=t.updatedAt,this.paginationMeta[N.MessageConstatnts.PAGINATION.KEYS.UPDATED_AT]=this.updatedAt),t.category&&(this.category=t.category),t.categories&&(this.categories=t.categories),t.type&&(this.type=t.type),t.types&&(this.types=t.types),t.WithTags&&(this.WithTags=t.WithTags),t.tags&&(this.tags=t.tags),t.HideReplies&&(this.hideReplies=t.HideReplies,this.paginationMeta[N.MessageConstatnts.PAGINATION.KEYS.HIDE_REPLIES]=this.hideReplies),this.hideDeletedMessages=t.HideDeletedMessages,this.hideDeletedMessages&&(this.paginationMeta[N.MessageConstatnts.PAGINATION.KEYS.HIDE_DELETED_MESSAGES]=this.hideDeletedMessages)}return t.prototype.fetchNext=function(){var t=this;return new Promise(function(s,r){return h(t,void 0,void 0,function(){var e,n,o;return R(this,function(t){switch(t.label){case 0:if(t.trys.push([0,5,,6]),this.inProgress)return this.inProgress=!1,r(new A.CometChatException(i.MESSAGES_REQUEST_ERRORS.REQUEST_IN_PROGRESS_ERROR)),[2];if(this.inProgress=!0,this.onlyUpdates){if(0==this.updatedAt)return this.inProgress=!1,r(new A.CometChatException(i.MESSAGES_REQUEST_ERRORS.NOT_ENOUGH_PARAMS)),[2]}else if(0==this.timestamp&&0==this.id&&0==this.updatedAt)return this.inProgress=!1,r(new A.CometChatException(i.MESSAGES_REQUEST_ERRORS.NOT_ENOUGH_PARAMS)),[2];this.affix=N.MessageConstatnts.PAGINATION.AFFIX.APPEND,this.paginationMeta[N.MessageConstatnts.PAGINATION.KEYS.AFFIX]=this.affix,this.currentMethod=N.MessageConstatnts.PAGINATION.AFFIX.APPEND,t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.makeAPICall()];case 2:return e=t.sent(),s(e),this.inProgress=!1,[3,4];case 3:return n=t.sent(),this.inProgress=!1,r(new A.CometChatException(n)),[3,4];case 4:return[3,6];case 5:return o=t.sent(),this.inProgress=!1,r(new A.CometChatException(o)),[3,6];case 6:return[2]}})})})},t.prototype.fetchPrevious=function(){var t=this;return new Promise(function(s,r){return h(t,void 0,void 0,function(){var e,n,o;return R(this,function(t){switch(t.label){case 0:if(t.trys.push([0,5,,6]),this.inProgress)return r(new A.CometChatException(i.MESSAGES_REQUEST_ERRORS.REQUEST_IN_PROGRESS_ERROR)),this.inProgress=!1,[2];if(this.inProgress=!0,this.onlyUpdates&&0==this.updatedAt)return this.inProgress=!1,r(new A.CometChatException(i.MESSAGES_REQUEST_ERRORS.NOT_ENOUGH_PARAMS)),[2];this.affix=N.MessageConstatnts.PAGINATION.AFFIX.PREPEND,this.paginationMeta[N.MessageConstatnts.PAGINATION.KEYS.AFFIX]=this.affix,this.currentMethod=N.MessageConstatnts.PAGINATION.AFFIX.PREPEND,t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.makeAPICall()];case 2:return e=t.sent(),s(e),this.inProgress=!1,[3,4];case 3:return n=t.sent(),this.inProgress=!1,r(new A.CometChatException(n)),[3,4];case 4:return[3,6];case 5:return o=t.sent(),this.inProgress=!1,r(new A.CometChatException(o)),[3,6];case 6:return[2]}})})})},t.prototype.makeAPICall=function(){var _=this;return new Promise(function(o,e){try{var t=_.uid;if(void 0!==t){if(typeof t!==N.COMMON_UTILITY_CONSTANTS.TYPE_CONSTANTS.STRING)return void e(new A.CometChatException(JSON.parse(O.format(JSON.stringify(N.GENERAL_ERROR.PARAMETER_MUST_BE_A_STRING),"UID","UID","setUID()"))));if(O.isFalsy(t.trim()))return void e(new A.CometChatException(JSON.parse(O.format(JSON.stringify(N.GENERAL_ERROR.INVALID),"UID","UID","UID","UID"))));_.uid=t.trim()}var n=_.guid;if(void 0!==n){if(typeof n!==N.COMMON_UTILITY_CONSTANTS.TYPE_CONSTANTS.STRING)return void e(new A.CometChatException(JSON.parse(O.format(JSON.stringify(N.GENERAL_ERROR.PARAMETER_MUST_BE_A_STRING),"GUID","GUID","setGUID()"))));if(O.isFalsy(n.trim()))return void e(new A.CometChatException(JSON.parse(O.format(JSON.stringify(N.GENERAL_ERROR.INVALID),"GUID","GUID","GUID","GUID"))));_.guid=n.trim()}var s=_.parentMessageId;if(void 0!==s){if(isNaN(s))return void e(new A.CometChatException(JSON.parse(O.format(JSON.stringify(N.GENERAL_ERROR.PARAMETER_MUST_BE_A_NUMBER),"PARENT_MESSAGE_ID","PARENT_MESSAGE_ID","setParentMessageId()"))));if(s<N.DEFAULT_VALUES.ZERO)return void e(new A.CometChatException(JSON.parse(O.format(JSON.stringify(N.GENERAL_ERROR.PARAMETER_MUST_BE_A_POSITIVE_NUMBER),"PARENT_MESSAGE_ID","PARENT_MESSAGE_ID","setParentMessageId()"))))}var r=_.paginationMeta[N.MessageConstatnts.PAGINATION.KEYS.PER_PAGE];if(void 0===r)return void e(new A.CometChatException(JSON.parse(O.format(JSON.stringify(N.GENERAL_ERROR.METHOD_COMPULSORY),"SET_LIMIT","SET_LIMIT","Set Limit"))));if(isNaN(r))return void e(new A.CometChatException(JSON.parse(O.format(JSON.stringify(N.GENERAL_ERROR.PARAMETER_MUST_BE_A_NUMBER),"SET_LIMIT","SET_LIMIT","setLimit()"))));if(r>N.DEFAULT_VALUES.MSGS_MAX_LIMIT)return void e(new A.CometChatException(JSON.parse(O.format(JSON.stringify(N.GENERAL_ERROR.LIMIT_EXCEEDED),"SET_LIMIT","SET_LIMIT",N.DEFAULT_VALUES.MSGS_MAX_LIMIT))));if(r<N.DEFAULT_VALUES.ZERO)return void e(new A.CometChatException(JSON.parse(O.format(JSON.stringify(N.GENERAL_ERROR.PARAMETER_MUST_BE_A_POSITIVE_NUMBER),"SET_LIMIT","SET_LIMIT","setLimit()"))));var i=_.paginationMeta[N.MessageConstatnts.PAGINATION.KEYS.SEARCH_KEY];if(void 0!==i){if(typeof i!==N.COMMON_UTILITY_CONSTANTS.TYPE_CONSTANTS.STRING)return void e(new A.CometChatException(JSON.parse(O.format(JSON.stringify(N.GENERAL_ERROR.PARAMETER_MUST_BE_A_STRING),"SET_SEARCH_KEYWORD","SET_SEARCH_KEYWORD","setSearchKeyword()"))));if(O.isFalsy(i.trim()))return void e(new A.CometChatException(JSON.parse(O.format(JSON.stringify(N.GENERAL_ERROR.INVALID),"SET_SEARCH_KEYWORD","SET_SEARCH_KEYWORD","search keyword","search keyword"))));_.paginationMeta[N.MessageConstatnts.PAGINATION.KEYS.SEARCH_KEY]=i.trim()}var a=_.paginationMeta[N.MessageConstatnts.PAGINATION.KEYS.ID];if(void 0!==a){if(isNaN(a))return void e(new A.CometChatException(JSON.parse(O.format(JSON.stringify(N.GENERAL_ERROR.PARAMETER_MUST_BE_A_NUMBER),"MESSAGE_ID","MESSAGE_ID","setMessageId()"))));if(a<N.DEFAULT_VALUES.ZERO)return void e(new A.CometChatException(JSON.parse(O.format(JSON.stringify(N.GENERAL_ERROR.PARAMETER_MUST_BE_A_POSITIVE_NUMBER),"MESSAGE_ID","MESSAGE_ID","setMessageId()"))))}var E=_.paginationMeta[N.MessageConstatnts.PAGINATION.KEYS.SENT_AT];if(void 0!==E){if(isNaN(E))return void e(new A.CometChatException(JSON.parse(O.format(JSON.stringify(N.GENERAL_ERROR.PARAMETER_MUST_BE_A_NUMBER),"TIMESTAMP","TIMESTAMP","setTimestamp()"))));if(E<N.DEFAULT_VALUES.ZERO)return void e(new A.CometChatException(JSON.parse(O.format(JSON.stringify(N.GENERAL_ERROR.PARAMETER_MUST_BE_A_POSITIVE_NUMBER),"TIMESTAMP","TIMESTAMP","setTimestamp()"))))}var c=_.hideMessagesFromBlockedUsers;if(void 0!==c){if(typeof c!==N.COMMON_UTILITY_CONSTANTS.TYPE_CONSTANTS.BOOLEAN)return void e(new A.CometChatException(JSON.parse(O.format(JSON.stringify(N.GENERAL_ERROR.PARAMETER_MUST_BE_A_BOOLEAN),"HIDE_MESSAGES_FROM_BLOCKED_USERS","HIDE_MESSAGES_FROM_BLOCKED_USERS","hideMessagesFromBlockedUsers()"))));_.paginationMeta[N.MessageConstatnts.PAGINATION.KEYS.HIDE_MESSAGES_FROM_BLOCKED_USER]=1==c?1:0}var u=_.unread;if(void 0!==u){if(typeof u!==N.COMMON_UTILITY_CONSTANTS.TYPE_CONSTANTS.BOOLEAN)return void e(new A.CometChatException(JSON.parse(O.format(JSON.stringify(N.GENERAL_ERROR.PARAMETER_MUST_BE_A_BOOLEAN),"UNREAD","UNREAD","setUnread()"))));_.paginationMeta[N.MessageConstatnts.PAGINATION.KEYS.UNREAD]=1==u?1:0}var S=_.category;if(void 0!==S){if(typeof S!==N.COMMON_UTILITY_CONSTANTS.TYPE_CONSTANTS.STRING)return void e(new A.CometChatException(JSON.parse(O.format(JSON.stringify(N.GENERAL_ERROR.PARAMETER_MUST_BE_A_STRING),"SET_CATEGORY","SET_CATEGORY","setCategory()"))));if(O.isFalsy(S.trim()))return void e(new A.CometChatException(JSON.parse(O.format(JSON.stringify(N.GENERAL_ERROR.INVALID),"SET_CATEGORY","SET_CATEGORY","category","category"))));_.paginationMeta[N.MessageConstatnts.PAGINATION.KEYS.CATEGORIES]=S.trim()}var p=_.categories;if(void 0!==p){if(!Array.isArray(p))return void e(new A.CometChatException(JSON.parse(O.format(JSON.stringify(N.GENERAL_ERROR.PARAMETER_MUST_BE_AN_ARRAY),"SET_CATEGORIES","SET_CATEGORIES","setCategories()"))));0<p.length&&(_.paginationMeta[N.MessageConstatnts.PAGINATION.KEYS.CATEGORIES]=p)}var C=_.type;if(void 0!==C){if(typeof C!==N.COMMON_UTILITY_CONSTANTS.TYPE_CONSTANTS.STRING)return void e(new A.CometChatException(JSON.parse(O.format(JSON.stringify(N.GENERAL_ERROR.PARAMETER_MUST_BE_A_STRING),"SET_TYPE","SET_TYPE","setType()"))));if(O.isFalsy(C.trim()))return void e(new A.CometChatException(JSON.parse(O.format(JSON.stringify(N.GENERAL_ERROR.INVALID),"SET_TYPE","SET_TYPE","type","type"))));_.paginationMeta[N.MessageConstatnts.PAGINATION.KEYS.TYPES]=C.trim()}var l=_.types;if(void 0!==l){if(!Array.isArray(l))return void e(new A.CometChatException(JSON.parse(O.format(JSON.stringify(N.GENERAL_ERROR.PARAMETER_MUST_BE_AN_ARRAY),"SET_TYPES","SET_TYPES","setTypes()"))));0<l.length&&(_.paginationMeta[N.MessageConstatnts.PAGINATION.KEYS.TYPES]=l)}var T=_.tags;if(void 0!==T){if(!Array.isArray(T))return void e(new A.CometChatException(JSON.parse(O.format(JSON.stringify(N.GENERAL_ERROR.PARAMETER_MUST_BE_AN_ARRAY),"SET_TAGS","SET_TAGS","setTags()"))));0<T.length&&(_.paginationMeta[N.MessageConstatnts.PAGINATION.KEYS.TAGS]=T)}var g=_.WithTags;if(void 0!==g){if(typeof g!==N.COMMON_UTILITY_CONSTANTS.TYPE_CONSTANTS.BOOLEAN)return void e(new A.CometChatException(JSON.parse(O.format(JSON.stringify(N.GENERAL_ERROR.PARAMETER_MUST_BE_A_BOOLEAN),"WITH_TAGS","WITH_TAGS","withTags()"))));_.paginationMeta[N.MessageConstatnts.PAGINATION.KEYS.WITH_TAGS]=1==g?1:0}var d=_.hideDeletedMessages;if(void 0!==d){if(typeof d!==N.COMMON_UTILITY_CONSTANTS.TYPE_CONSTANTS.BOOLEAN)return void e(new A.CometChatException(JSON.parse(O.format(JSON.stringify(N.GENERAL_ERROR.PARAMETER_MUST_BE_A_BOOLEAN),"HIDE_DELETED_MESSAGES","HIDE_DELETED_MESSAGES","hideDeletedMessages()"))));_.paginationMeta[N.MessageConstatnts.PAGINATION.KEYS.HIDE_DELETED_MESSAGES]=1==d?1:0}if(_.createEndpoint(),_.totalPages)if(1!=_.totalPages);else if(_.lastAffix==_.affix)return void o([]);I.makeApiCall(_.endpointName,{listId:_.listId},_.paginationMeta).then(function(n){return h(_,void 0,void 0,function(){var E,e=this;return R(this,function(t){return E=[],n[N.ResponseConstants.RESPONSE_KEYS.KEY_META][N.ResponseConstants.RESPONSE_KEYS.KEY_CURSOR].hasOwnProperty(N.MessageConstatnts.PAGINATION.KEYS.ID)&&0==this.id&&(this.id=parseInt(n.meta.cursor[N.MessageConstatnts.PAGINATION.KEYS.ID])),n[N.ResponseConstants.RESPONSE_KEYS.KEY_META][N.ResponseConstants.RESPONSE_KEYS.KEY_CURSOR].hasOwnProperty(N.MessageConstatnts.PAGINATION.KEYS.SENT_AT)&&0==this.timestamp&&(this.timestamp=n.meta.cursor[N.MessageConstatnts.PAGINATION.KEYS.SENT_AT]),n.meta.pagination.hasOwnProperty("total_pages")&&(this.totalPages=n.meta.pagination.total_pages),n.meta.cursor.hasOwnProperty("affix")&&(this.lastAffix=n.meta.cursor.affix),n.data[0]?(0<this.id&&(this.id=parseInt(n.data[0].id)),0<this.timestamp&&(this.timestamp=n.data[0].sentAt),n.data.map(function(a){return h(e,void 0,void 0,function(){var e,n,o,s,r,i;return R(this,function(t){switch(t.label){case 0:return m.MessageListnerMaping.getInstance().get(N.LOCAL_STORE.KEY_MESSAGE_LISTENER_LIST).then(function(t){parseInt(a.id)>t&&m.MessageListnerMaping.getInstance().set(N.LOCAL_STORE.KEY_MESSAGE_LISTENER_LIST,parseInt(a.id))},function(t){m.MessageListnerMaping.getInstance().set(N.LOCAL_STORE.KEY_MESSAGE_LISTENER_LIST,parseInt(a.id))}),this.affix==N.MessageConstatnts.PAGINATION.AFFIX.APPEND?(this.id<parseInt(a.id)&&0<this.id&&(this.id=parseInt(a.id)),this.timestamp<a.sentAt&&0<this.timestamp&&(this.timestamp=a.sentAt),this.updatedAt<a.updatedAt&&0<this.updatedAt&&(this.updatedAt=a.updatedAt)):(this.id>parseInt(a.id)&&(this.id=parseInt(a.id)),this.timestamp>a.sentAt&&(this.timestamp=a.sentAt),this.updatedAt>a.updatedAt&&(this.updatedAt=a.updatedAt)),this.id&&(this.paginationMeta[N.MessageConstatnts.PAGINATION.KEYS.ID]=this.id),this.timestamp&&(this.paginationMeta[N.MessageConstatnts.PAGINATION.KEYS.SENT_AT]=this.timestamp),this.updatedAt&&(this.paginationMeta[N.MessageConstatnts.PAGINATION.KEYS.UPDATED_AT]=this.updatedAt),a.category!==N.MessageConstatnts.CATEGORY.MESSAGE&&a.category!==N.MessageConstatnts.CATEGORY.CUSTOM||a.type===N.MessageConstatnts.TYPE.TEXT||!a.data.attachments||0===(null===(s=a.data.attachments)||void 0===s?void 0:s.length)?[3,2]:(null===(r=y.CometChat.user)||void 0===r?void 0:r.getFat())&&y.CometChat.SECURED_MEDIA_HOST?(e=y.CometChat.SECURED_MEDIA_HOST,n=null===(i=y.CometChat.user)||void 0===i?void 0:i.getFat(),[4,O.updatePropertiesWithDynamicValue(a,e,"?"+N.ADDITIONAL_CONSTANTS.SECURE_URL_PROPERTY+"="+n)]):[3,2];case 1:(o=t.sent())&&(a=o),t.label=2;case 2:return E.push(f.MessageController.trasformJSONMessge(a)),[2]}})})})):E=[],o(E),[2]})})},function(t){e(new A.CometChatException(t.error))})}catch(t){e(new A.CometChatException(t))}})},t.prototype.createEndpoint=function(){this.parentMessageId?(this.endpointName="getThreadMessages",this.listId=this.parentMessageId.toString(),this.hideReplies&&(this.hideReplies=!1,delete this.paginationMeta[N.MessageConstatnts.PAGINATION.KEYS.HIDE_REPLIES])):(O.isFalsy(this.guid)||O.isFalsy(this.uid))&&O.isFalsy(this.guid)?(O.isFalsy(this.uid)?this.endpointName="getMessages":this.endpointName="getUserMessages",this.listId=this.uid):(this.endpointName="getGroupMessages",this.listId=this.guid)},t.prototype.makeData=function(){var t={};t[N.MessageConstatnts.PAGINATION.KEYS.PER_PAGE]=this.limit,t[N.MessageConstatnts.PAGINATION.KEYS.AFFIX]=this.affix,(O.isFalsy(this.guid)||O.isFalsy(this.uid))&&O.isFalsy(this.guid)&&O.isFalsy(this.uid)},t.prototype.getFilteredPreviousDataByReceiverId=function(e){return h(this,void 0,void 0,function(){var n,o=this;return R(this,function(t){switch(t.label){case 0:switch(n=[],e){case"user":return[3,1];case"group":return[3,3];case"both":return[3,5]}return[3,7];case 1:return[4,r.MessagesStore.getInstance().get(this.uid).then(function(e){Object.keys(e).filter(function(t){return parseInt(t)>o.id}).map(function(t){n=s(n,[e[t]])})})];case 2:return t.sent(),[3,9];case 3:return[4,r.MessagesStore.getInstance().get(this.guid).then(function(e){Object.keys(e).filter(function(t){return parseInt(t)>o.id}).map(function(t){n=s(n,[e[t]])})})];case 4:t.sent(),t.label=5;case 5:return[4,r.MessagesStore.getInstance().get(this.guid).then(function(e){Object.keys(e).filter(function(t){return parseInt(t)>o.id}).filter(function(t){return e[t].sender.uid==o.uid}).map(function(t){n=s(n,[e[t]])})})];case 6:return t.sent(),[3,9];case 7:return[4,r.MessagesStore.getInstance().getAllMessages().then(function(e){Object.keys(e).filter(function(t){return parseInt(t)>o.id}).map(function(t){n=s(n,[e[t]])})})];case 8:return t.sent(),[3,9];case 9:return[2,n]}})})},t.prototype.getFilteredNextDataByReceiverId=function(e){return h(this,void 0,void 0,function(){var n,o=this;return R(this,function(t){switch(t.label){case 0:switch(n=[],e){case"user":return[3,1];case"group":return[3,3];case"both":return[3,5]}return[3,7];case 1:return[4,r.MessagesStore.getInstance().get(this.uid).then(function(e){Object.keys(e).filter(function(t){return parseInt(t)>o.id}).map(function(t){n=s(n,[e[t]])})})];case 2:return t.sent(),[3,9];case 3:return[4,r.MessagesStore.getInstance().get(this.guid).then(function(e){Object.keys(e).filter(function(t){return parseInt(t)>o.id}).map(function(t){n=s(n,[e[t]])})})];case 4:t.sent(),t.label=5;case 5:return[4,r.MessagesStore.getInstance().get(this.guid).then(function(e){Object.keys(e).filter(function(t){return parseInt(t)>o.id}).filter(function(t){return e[t].sender.uid==o.uid}).map(function(t){n=s(n,[e[t]])})})];case 6:return t.sent(),[3,9];case 7:return[4,r.MessagesStore.getInstance().getAllMessages().then(function(e){Object.keys(e).filter(function(t){return parseInt(t)>o.id}).map(function(t){n=s(n,[e[t]])})})];case 8:return t.sent(),[3,9];case 9:return[2,n]}})})},t}();e.MessagesRequest=o;var a=function(){function t(){this.maxLimit=N.DEFAULT_VALUES.MSGS_MAX_LIMIT,this.timestamp=0,this.id=N.DEFAULT_VALUES.DEFAULT_MSG_ID,this.unread=!1,this.HideMessagesFromBlockedUsers=!1,this.onlyUpdate=0,this.HideDeletedMessages=!1,this.WithTags=!1}return t.prototype.setLimit=function(t){return this.limit=t,this},t.prototype.setGUID=function(t){return this.guid=t,this},t.prototype.setUID=function(t){return this.uid=t,this},t.prototype.setParentMessageId=function(t){return this.parentMessageId=t,this},t.prototype.setTimestamp=function(t){return void 0===t&&(t=O.getCurrentTime()),this.timestamp=t,this},t.prototype.setMessageId=function(t){return void 0===t&&(t=N.DEFAULT_VALUES.DEFAULT_MSG_ID),this.id=t,this},t.prototype.setUnread=function(t){return void 0===t&&(t=!1),this.unread=t,this},t.prototype.hideMessagesFromBlockedUsers=function(t){return void 0===t&&(t=!1),this.HideMessagesFromBlockedUsers=t,this},t.prototype.setSearchKeyword=function(t){return this.searchKey=t,this},t.prototype.setUpdatedAfter=function(t){return this.updatedAt=t,this},t.prototype.updatesOnly=function(t){return t&&(this.onlyUpdate=1),this},t.prototype.setCategory=function(t){return this.category=t,this},t.prototype.setCategories=function(t){return this.categories=t,this},t.prototype.setType=function(t){return this.type=t,this},t.prototype.setTypes=function(t){return this.types=t,this},t.prototype.hideReplies=function(t){return this.HideReplies=t,this},t.prototype.hideDeletedMessages=function(t){return this.HideDeletedMessages=t,this},t.prototype.setTags=function(t){return this.tags=t,this},t.prototype.withTags=function(t){return this.WithTags=t,this},t.prototype.build=function(){return this.category&&this.categories&&this.categories.push(this.category),this.type&&this.types&&this.types.push(this.type),new o(this)},t}();e.MessagesRequestBuilder=a},function(t,e,n){"use strict";var a=this&&this.__assign||function(){return(a=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var s in e=arguments[n])Object.prototype.hasOwnProperty.call(e,s)&&(t[s]=e[s]);return t}).apply(this,arguments)};e.__esModule=!0,e.MessagesStore=void 0;var o=n(5),E=n(0),c=n(1),r=n(2),s=n(12),i=function(){function t(t){this.store=c.constants.DEFAULT_STORE,E.isFalsy(t)||(this.store=t);try{this.messagesStore=s.default}catch(t){E.Logger.error("MessageStore: constructor",{e:t})}}return t.getInstance=function(){return null==t.MessagesStore&&(t.MessagesStore=new t),t.MessagesStore},t.prototype.set=function(t,e){var n=E.getKeyprefix(c.LOCAL_STORE.MESSAGES_STORE,t);return this.messagesStore.setItem(n,JSON.stringify(e))},t.prototype.get=function(t){var o=this,s=E.getKeyprefix(c.LOCAL_STORE.MESSAGES_STORE,t);return new Promise(function(n,e){try{o.messagesStore.getItem(s).then(function(e){try{n(JSON.parse(e))}catch(t){n(e)}},function(t){e(t)})}catch(t){e(new r.CometChatException(t))}})},t.prototype.getAllMessages=function(){var n=this,o={};return new Promise(function(t,e){n.messagesStore.iterate(function(t,e,n){e!=c.constants.MSG_VER_POST&&e!=c.constants.MSG_VER_POST&&(o=a(a({},o),t))}).then(function(){t(o)})})},t.prototype.clear=function(t){},t.prototype.selectStore=function(t){this.store=t},t.prototype.storeMessages=function(t){var n=this;if(o.CometChat.user.getUid()){var s=o.CometChat.user.getUid(),r={},i=0;return this.get(c.constants.MSG_VER_POST).then(function(o){t.map(function(t){var e;if(!E.isFalsy(t)){0==i&&(i=parseInt(t.getId().toString())),i>t.getId()&&(i=parseInt(t.getId().toString())),o<t.getId()&&(o=parseInt(t.getId().toString()));var n=void 0;n=t.getSender()instanceof Object?t.getSender().getUid():t.getSender(),t.getReceiverType()==c.MessageConstatnts.RECEIVER_TYPE.GROUP&&(n=t.getReceiver()),t.getSender()instanceof Object?t.getSender().getUid()==s&&(n=t.getReceiver()):t.getSender()==s&&(n=t.getReceiver()),r[n]||(r[n]={}),r[n]=a(a({},r[n]),((e={})[t.getId()]=t,e))}}),n.get(c.constants.MSG_VER_PRE).then(function(t){(0<i&&i<t||null==t)&&n.set(c.constants.MSG_VER_PRE,i)})&&0<o&&n.set(c.constants.MSG_VER_POST,o),Object.keys(r).map(function(e){n.get(e).then(function(t){null==t&&(t={}),n.set(e,a(a({},r[e]),t))})})}),!0}},t}();e.MessagesStore=i},function(t,e,n){"use strict";e.__esModule=!0,e.BlockedUsersRequestBuilder=e.BlockedUsersRequest=void 0;var s=n(6),o=n(0),r=n(11),i=n(2),a=n(1),E=function(){function t(t){this.next_page=1,this.current_page=1,this.total_pages=-1,this.fetchingInProgress=!1,this.pagination={total:0,count:0,per_page:0,current_page:0,total_pages:0,links:[]},o.isFalsy(t)||(this.limit=t.limit,o.isFalsy(t.searchKeyword)||(this.searchKeyword=t.searchKeyword),o.isFalsy(t.direction)||(this.direction=t.direction))}return t.prototype.validateBlockedUsersBuilder=function(){if(void 0===this.limit)return new i.CometChatException(JSON.parse(o.format(JSON.stringify(a.GENERAL_ERROR.METHOD_COMPULSORY),"SET_LIMIT","SET_LIMIT","Set Limit")));if(isNaN(this.limit))return new i.CometChatException(JSON.parse(o.format(JSON.stringify(a.GENERAL_ERROR.PARAMETER_MUST_BE_A_NUMBER),"SET_LIMIT","SET_LIMIT","setLimit()")));if(this.limit>a.DEFAULT_VALUES.USERS_MAX_LIMIT)return new i.CometChatException(JSON.parse(o.format(JSON.stringify(a.GENERAL_ERROR.LIMIT_EXCEEDED),"SET_LIMIT","SET_LIMIT",a.DEFAULT_VALUES.USERS_MAX_LIMIT)));if(this.limit<a.DEFAULT_VALUES.ZERO)return new i.CometChatException(JSON.parse(o.format(JSON.stringify(a.GENERAL_ERROR.PARAMETER_MUST_BE_A_POSITIVE_NUMBER),"SET_LIMIT","SET_LIMIT","setLimit()")));if(void 0!==this.searchKeyword){if(typeof this.searchKeyword!==a.COMMON_UTILITY_CONSTANTS.TYPE_CONSTANTS.STRING)return new i.CometChatException(JSON.parse(o.format(JSON.stringify(a.GENERAL_ERROR.PARAMETER_MUST_BE_A_STRING),"SET_SEARCH_KEYWORD","SET_SEARCH_KEYWORD","setSearchKeyword()")));if(o.isFalsy(this.searchKeyword.trim()))return new i.CometChatException(JSON.parse(o.format(JSON.stringify(a.GENERAL_ERROR.INVALID),"SET_SEARCH_KEYWORD","SET_SEARCH_KEYWORD","search keyword","search keyword")));this.searchKeyword=this.searchKeyword.trim()}if(void 0!==this.direction){if(typeof this.direction!==a.COMMON_UTILITY_CONSTANTS.TYPE_CONSTANTS.STRING)return new i.CometChatException(JSON.parse(o.format(JSON.stringify(a.GENERAL_ERROR.PARAMETER_MUST_BE_A_STRING),"SET_DIRECTION","SET_DIRECTION","setDirection()")));if(this.direction!=a.BlockedUsersConstants.REQUEST_KEYS.DIRECTIONS.BOTH&&this.direction!=a.BlockedUsersConstants.REQUEST_KEYS.DIRECTIONS.BLOCKED_BY_ME&&this.direction!=a.BlockedUsersConstants.REQUEST_KEYS.DIRECTIONS.HAS_BLOCKED_ME)return new i.CometChatException(a.UserErrors.INVALID_DIRECTION)}},t.prototype.fetchNext=function(){var o=this;return new Promise(function(n,e){try{if(o.fetchingInProgress)o.fetchingInProgress=!1,n([]);else{o.fetchingInProgress=!0;var t=o.validateBlockedUsersBuilder();if(t instanceof i.CometChatException)return void e(t);s.makeApiCall("blockedUsersList",{},o.getNextData()).then(function(t){if(t.meta&&(o.total_pages=t.meta.pagination.total_pages),0<t.data.length){o.pagination=t.meta.pagination;var e=[];t.data.map(function(t){e.push(r.UsersController.trasformJSONUser(t))}),n(e)}else n([]);o.fetchingInProgress=!1},function(t){o.fetchingInProgress=!1,e(new i.CometChatException(t.error))})}}catch(t){o.fetchingInProgress=!1,e(new i.CometChatException(t))}})},t.prototype.getNextData=function(){var t={};if(t.per_page=this.limit,o.isFalsy(this.direction)||(t.direction=this.direction),o.isFalsy(this.searchKeyword)||(t.searchKey=this.searchKeyword),1==this.current_page)t.page=this.next_page,this.next_page++,this.current_page++;else{if(this.next_page>this.total_pages)return t.page=this.next_page,t;t.page=this.next_page++}return t},t.MAX_LIMIT=2,t.DEFAULT_LIMIT=1,t.directions=a.BlockedUsersConstants.REQUEST_KEYS.DIRECTIONS,t}();e.BlockedUsersRequest=E;var c=function(){function t(){}return t.prototype.setLimit=function(t){return this.limit=t,this},t.prototype.setSearchKeyword=function(t){return this.searchKeyword=t,this},t.prototype.setDirection=function(t){return this.direction=t,this},t.prototype.blockedByMe=function(){return this.direction=a.BlockedUsersConstants.REQUEST_KEYS.DIRECTIONS.BLOCKED_BY_ME,this},t.prototype.hasBlockedMe=function(){return this.direction=a.BlockedUsersConstants.REQUEST_KEYS.DIRECTIONS.HAS_BLOCKED_ME,this},t.prototype.build=function(){return new E(this)},t}();e.BlockedUsersRequestBuilder=c},function(t,e,n){"use strict";e.__esModule=!0,e.AppSettingsBuilder=e.AppSettings=void 0;var o=n(1),s=function(){function e(t){this.subscriptionType=e.SUBSCRIPTION_TYPE_NONE,this.roles=null,this.region=o.DEFAULT_VALUES.REGION_DEFAULT,this.autoJoinGroup=!0,this.establishSocketConnection=!0,this.adminHost=null,this.clientHost=null,this.subscriptionType=t.subscriptionType,this.roles=t.roles,this.region=t.region,this.autoJoinGroup=t.autoJoinGroup,this.establishSocketConnection=t.establishSocketConnection,this.adminHost=t.adminHost,this.clientHost=t.clientHost}return e.prototype.getSubscriptionType=function(){return this.subscriptionType},e.prototype.getRoles=function(){return this.roles},e.prototype.getRegion=function(){return this.region},e.prototype.getIsAutoJoinEnabled=function(){return this.autoJoinGroup},e.prototype.shouldAutoEstablishSocketConnection=function(){return this.establishSocketConnection},e.prototype.getAdminHost=function(){return this.adminHost},e.prototype.getClientHost=function(){return this.clientHost},e.SUBSCRIPTION_TYPE_NONE="NONE",e.SUBSCRIPTION_TYPE_ALL_USERS="ALL_USERS",e.SUBSCRIPTION_TYPE_ROLES="ROLES",e.SUBSCRIPTION_TYPE_FRIENDS="FRIENDS",e.REGION_EU=o.DEFAULT_VALUES.REGION_DEFAULT_EU,e.REGION_US=o.DEFAULT_VALUES.REGION_DEFAULT_US,e.REGION_IN=o.DEFAULT_VALUES.REGION_DEFAULT_IN,e.REGION_PRIVATE=o.DEFAULT_VALUES.REGION_DEFAULT_PRIVATE,e}();e.AppSettings=s;var r=function(){function t(){this.subscriptionType=s.SUBSCRIPTION_TYPE_NONE,this.roles=null,this.region=o.DEFAULT_VALUES.REGION_DEFAULT,this.autoJoinGroup=!0,this.establishSocketConnection=!0,this.adminHost=null,this.clientHost=null}return t.prototype.subscribePresenceForAllUsers=function(){return this.subscriptionType=s.SUBSCRIPTION_TYPE_ALL_USERS,this},t.prototype.subscribePresenceForRoles=function(t){return this.subscriptionType=s.SUBSCRIPTION_TYPE_ROLES,this.roles=t,this},t.prototype.subscribePresenceForFriends=function(){return this.subscriptionType=s.SUBSCRIPTION_TYPE_FRIENDS,this},t.prototype.setRegion=function(t){return void 0===t&&(t=o.DEFAULT_VALUES.REGION_DEFAULT),this.region=t.toLowerCase(),this},t.prototype.enableAutoJoinForGroups=function(t){return void 0===t&&(t=!0),this.autoJoinGroup=t,this},t.prototype.autoEstablishSocketConnection=function(t){return void 0===t&&(t=!0),this.establishSocketConnection=t,this},t.prototype.overrideAdminHost=function(t){return this.adminHost=t,this},t.prototype.overrideClientHost=function(t){return this.clientHost=t,this},t.prototype.build=function(){return new s(this)},t}();e.AppSettingsBuilder=r},function(t,e,n){"use strict";e.__esModule=!0,e.CometChatHelper=void 0;var S=n(10),p=n(1),C=n(11),l=n(16),T=n(26),o=n(5),s=n(2),r=n(0),i=function(){function t(){}return t.processMessage=function(t){try{return S.MessageController.trasformJSONMessge(t)}catch(t){r.Logger.error("CometChatHelper: processMessage",t)}},t.getConversationFromMessage=function(u){return new Promise(function(E,c){try{o.CometChat.getLoggedinUser().then(function(t){if(null!==t){var e=S.MessageController.trasformJSONMessge(u),n=e.receiverType,o=e.conversationId,s=void 0,r=S.MessageController.trasformJSONMessge(u);if(n==p.MessageConstatnts.RECEIVER_TYPE.USER){var i=C.UsersController.trasformJSONUser(e[p.MessageConstatnts.KEYS.SENDER]);s=i.getUid()==t.getUid()?C.UsersController.trasformJSONUser(e[p.MessageConstatnts.KEYS.RECEIVER]):i}else s=l.GroupsController.trasformJSONGroup(e[p.MessageConstatnts.KEYS.RECEIVER]);var a=T.ConversationController.trasformJSONConversation(o,n,r,s,0,[]);E(a)}else c(p.UserErrors.USER_NOT_LOGGED_IN)},function(t){c(new s.CometChatException(t.error))})}catch(t){c(new s.CometChatException(t))}})},t}();e.CometChatHelper=i},function(t,e,n){"use strict";var o=this&&this.__awaiter||function(t,i,a,E){return new(a||(a=Promise))(function(n,e){function o(t){try{r(E.next(t))}catch(t){e(t)}}function s(t){try{r(E.throw(t))}catch(t){e(t)}}function r(t){var e;t.done?n(t.value):(e=t.value,e instanceof a?e:new a(function(t){t(e)})).then(o,s)}r((E=E.apply(t,i||[])).next())})},a=this&&this.__generator||function(n,o){var s,r,i,t,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return t={next:e(0),throw:e(1),return:e(2)},"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(s)throw new TypeError("Generator is already executing.");for(;a;)try{if(s=1,r&&(i=2&e[0]?r.return:e[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,e[1])).done)return i;switch(r=0,i&&(e=[2&e[0],i.value]),e[0]){case 0:case 1:i=e;break;case 4:return a.label++,{value:e[1],done:!1};case 5:a.label++,r=e[1],e=[0];continue;case 7:e=a.ops.pop(),a.trys.pop();continue;default:if(!(i=0<(i=a.trys).length&&i[i.length-1])&&(6===e[0]||2===e[0])){a=0;continue}if(3===e[0]&&(!i||e[1]>i[0]&&e[1]<i[3])){a.label=e[1];break}if(6===e[0]&&a.label<i[1]){a.label=i[1],i=e;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(e);break}i[2]&&a.ops.pop(),a.trys.pop();continue}e=o.call(n,a)}catch(t){e=[6,t],r=0}finally{s=i=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}};e.__esModule=!0,e.WSConnectionHelper=void 0;var p=n(5),C=n(1),s=n(15),r=n(40),l=n(0),i=n(41),E=n(36),c=n(27),u=n(23),S=n(24),T=n(58),g=n(59),d=n(60),_=n(61),h=n(62),R=n(63),A=n(64),I=n(25),f=n(29),O=n(28),N=n(4),m=n(42),y=n(22),L=i.ListenerHandlers.getInstance(),M=function(){function i(){var e=this;this.startWSResponseTimer=function(){i.wsResponseTimer=setInterval(function(){try{1<i.wsResponseTime?i.wsResponseTime=i.wsResponseTime-1:1===i.wsResponseTime&&(p.CometChat.disconnectInternally(),e.clearPingTimer(),e.clearWSResponseTimer(),i.appInactiveTimer&&i.clearAppInactiveTimer())}catch(t){l.Logger.error("CometChat: startWSResponseTimer",t)}},1e3)},this.clearWSResponseTimer=function(){try{i.wsResponseTime=30,clearInterval(i.wsResponseTimer)}catch(t){l.Logger.error("WSConnectionHelper: clearWSResponseTimer",t)}},y.AppState.addEventListener("change",function(t){p.CometChat.appSettings.shouldAutoEstablishSocketConnection()||("active"===t?(i.isAppInactive=!1,i.pingTimer&&i.clearAppInactiveTimer(),!i.pingTimer&&m.checkConnection(e.connection)&&(e.pingWS(),e.startPingingWS())):i.isAppInactive=!0)})}return i.getInstance=function(){try{return null!=this.wsConnectionHelper&&null!=this.wsConnectionHelper||(this.wsConnectionHelper=new i),this.wsConnectionHelper}catch(t){l.Logger.error("WSConnectionHelper: getInstance",t)}},i.prototype.WSLogin=function(e,n){var o=this;try{m.getWSURL().then(function(t){o.connection=new WebSocket(t),n&&o.connection&&o.connection.readyState==N.READY_STATE.CONNECTING&&n(o.connection.readyState),o.connection.onopen=function(t){o.onOpen(t,n),o.authenticateUser(e)},o.connection.onclose=function(t){o.onClose(t,n)},o.connection.onmessage=function(t){o.onMessage(t)}},function(t){l.Logger.error("WSConnectionHelper :: WSLogin",t)})}catch(t){l.Logger.error("WSConnectionHelper: WSLogin",t)}},i.prototype.onOpen=function(t,e){try{e&&this.connection&&e(this.connection.readyState)}catch(t){l.Logger.error("WSConnectionHelper: onOpen",t)}},i.prototype.onClose=function(t,e){try{e&&this.connection&&e(this.connection.readyState,t)}catch(t){l.Logger.error("WSConnectionHelper: onClose",t)}},i.prototype.onMessage=function(t){if(t.data&&"string"==typeof t.data)try{var e=JSON.parse(t.data);if(e&&e.action&&e.action===N.KEYS.PONG)return;var n=this.getCometChatEventFromMessage(JSON.parse(t.data));if(n.getDeviceId()===p.CometChat.getSessionId()&&n.getType()!==N.AUTH.TYPE)return;switch(n.getType()){case N.TYPING_INDICATOR.TYPE:this.publishTypingIndicator(n);break;case N.RECEIPTS.TYPE:this.publishReceipts(n);break;case N.PRESENCE.TYPE:this.publishPresence(n);break;case N.AUTH.TYPE:this.authResponseReceived(n);break;case N.MESSAGE.TYPE:this.publishMessages(n);break;case N.TRANSIENT_MESSAGE.TYPE:this.publishTransientMessage(n);break;default:l.Logger.log("WSHelper: onMessage :: unknown type",t.data)}}catch(t){l.Logger.error("WSHelper: onMessage",t)}else l.Logger.log("WSHelper: onMessage :: object data",t.data)},i.prototype.authenticateUser=function(u){var S=this;try{p.CometChat.getLoggedinUser().then(function(c){c?E.KeyStore.getInstance().get("deviceId").then(function(E){l.getAppSettings().then(function(t){var e=null;window&&window.location&&window.location.origin&&(e=window.location.origin);var n="",o=E,s={version:C.SDKHeader.sdkVersion,apiVersion:t[C.APP_SETTINGS.KEYS.CHAT_API_VERSION],origin:e,uts:(new Date).getTime()};l.isFalsy(p.CometChat.resource)||(s.resource=p.CometChat.resource),l.isFalsy(p.CometChat.platform)||(s.platform=p.CometChat.platform),l.isFalsy(p.CometChat.language)||(s.language=p.CometChat.language),navigator&&(n=navigator.userAgent);var r={appInfo:s,userAgent:n,deviceId:o,platform:C.SDKHeader.platform},i=new T.CometChatAuthEvent(p.CometChat.getAppId(),"","",c.getUid(),p.CometChat.getSessionId());if(i.setAuth(u),i.setPresenceSubscription(p.CometChat.appSettings.getSubscriptionType()),i.setDeviceId(p.CometChat.getSessionId()),i.setExtraParmaeters(r),m.checkConnection(S.connection)){var a=i.getAsString();S.connection.send(a)}})}):l.Logger.log("no logged-in user","null")},function(t){l.Logger.log("error in fetching logged-in user",t)})}catch(t){l.Logger.error("WSConnectionHelper: startTypingIndicator",t)}},i.prototype.authResponseReceived=function(t){try{"200"===t.getCode()&&"OK"===t.getStatus()&&this.startPingingWS()}catch(t){l.Logger.error("WSConnectionHelper: authResponseReceived",t)}},i.prototype.WSLogout=function(){try{this.clearPingTimer(),m.checkConnection(this.connection)&&this.connection.close(N.LOGOUT_CODE,N.LOGOUT_REASON)}catch(t){l.Logger.error("WSConnectionHelper: WSLogout",t)}},i.clearAppInactiveTimer=function(){try{i.appInactiveTime=30,clearInterval(i.appInactiveTimer)}catch(t){l.Logger.error("WSConnectionHelper: clearAppInactiveTime",t)}},i.startAppInactiveTimer=function(){i.appInactiveTimer=setInterval(function(){try{1<i.appInactiveTime?i.appInactiveTime=i.appInactiveTime-1:1===i.appInactiveTime&&(p.CometChat.disconnectInternally(),clearInterval(i.appInactiveTimer),i.appInactiveTime=30)}catch(t){l.Logger.error("CometChat: startAppInactiveTimer",t)}},1e3)},i.prototype.pingWS=function(r){return o(this,void 0,void 0,function(){var e,n,o,s;return a(this,function(t){switch(t.label){case 0:return(e=r||{}).onError,n=e.onSuccess,m.checkConnection(this.connection)?(o=new d.CometChatPingEvent("","","","",""),s=o.getAsString(),this.connection.send(s),i.isAppInactive&&this.startWSResponseTimer(),[4,this.listenForPong()]):[3,2];case 1:t.sent()?(l.Logger.log("WSConnectionHelper :: startPingingWS","pong success"),i.isAppInactive?(this.clearWSResponseTimer(),i.pingTimer&&this.clearPingTimer(),i.appInactiveTimer&&i.clearAppInactiveTimer(),i.startAppInactiveTimer()):i.appInactiveTimer&&i.clearAppInactiveTimer(),p.CometChat.getConnectionStatus()!=C.CONNECTION_STATUS.CONNECTED&&(this.WSLogout(),this.connection=null,p.CometChat.getInstance().makeWSConnection()),n&&n({status:p.CometChat.getConnectionStatus()})):(i.isAppInactive?(i.appInactiveTimer&&i.clearAppInactiveTimer(),i.startAppInactiveTimer()):i.appInactiveTimer&&i.clearAppInactiveTimer(),l.Logger.log("WSConnectionHelper :: startPingingWS","pong failure"),this.WSLogout(),this.connection=null,p.CometChat.getInstance().setConnectionStatus(C.CONNECTION_STATUS.DISCONNECTED),L.connectionHandlers.map(function(t){try{t._eventListener&&(l.isFalsy(t._eventListener.onDisconnected)||t._eventListener.onDisconnected())}catch(t){l.Logger.error("WSConnectionHandlers: Disconnected Status",t)}}),p.CometChat.getInstance().accidentallyDisconnected()),t.label=2;case 2:return[2]}})})},i.prototype.startPingingWS=function(){var t=this;try{i.pingTimer||(i.pingTimer=setInterval(function(){return o(t,void 0,void 0,function(){return a(this,function(t){return this.pingWS(),[2]})})},15e3))}catch(t){l.Logger.error("WSConnectionHelper: startPingingWS",t)}},i.prototype.listenForPong=function(){var o=this;return new Promise(function(e,t){var n=setTimeout(function(){e(!1)},3e3);o.connection.addEventListener("message",function(t){t&&t.data&&"string"==typeof t.data&&(JSON.parse(t.data).action===N.KEYS.PONG&&(clearTimeout(n),e(!0)))})})},i.prototype.clearPingTimer=function(){i.pingTimer&&(clearInterval(i.pingTimer),i.pingTimer=void 0)},i.prototype.sendOnlineEvent=function(){var o=this;try{m.checkConnection(this.connection)&&p.CometChat.getLoggedinUser().then(function(t){if(t){t.authToken&&delete t.authToken;var e={appId:p.CometChat.getAppId(),deviceId:p.CometChat.getSessionId(),type:N.PRESENCE.TYPE,body:{action:N.PRESENCE.ACTION.ONLINE,timestamp:Math.floor((new Date).getTime()/1e3),user:t}};if(m.checkConnection(o.connection)){var n=m.stringifyMessage(e);o.connection.send(n)}}else l.Logger.log("no logged-in user","null")},function(t){l.Logger.log("error in fetching logged-in user",t)})}catch(t){l.Logger.error("WSConnectionHelper: sendOnlineEvent",t)}},i.prototype.sendOfflineEvent=function(){var o=this;try{m.checkConnection(this.connection)&&p.CometChat.getLoggedinUser().then(function(t){if(t){t.authToken&&delete t.authToken;var e={appId:p.CometChat.getAppId(),deviceId:p.CometChat.getSessionId(),type:N.PRESENCE.TYPE,body:{action:N.PRESENCE.ACTION.OFFLINE,timestamp:Math.floor((new Date).getTime()/1e3),user:t}};if(m.checkConnection(o.connection)){var n=m.stringifyMessage(e);o.connection.send(n)}}else l.Logger.log("no logged-in user","null")},function(t){l.Logger.log("error in fetching logged-in user",t)})}catch(t){l.Logger.error("WSConnectionHelper: sendOfflineEvent",t)}},i.prototype.startTypingIndicator=function(s,r,i){var a=this;try{p.CometChat.getLoggedinUser().then(function(t){if(t){var e=new O.TypingIndicator(s,r);t.authToken&&delete t.authToken,e.setSender(t),i&&e.setMetadata(i);var n=new A.CometChatTypingEvent(p.CometChat.getAppId(),s,r,t.getUid(),p.CometChat.getSessionId());if(n.setAction(N.TYPING_INDICATOR.ACTION.STARTED),n.setTypingIndicator(e),m.checkConnection(a.connection)){var o=n.getAsString();a.connection.send(o)}}else l.Logger.log("no logged-in user","null")},function(t){l.Logger.log("error in fetching logged-in user",t)})}catch(t){l.Logger.error("WSConnectionHelper: startTypingIndicator",t)}},i.prototype.pauseTypingIndicator=function(s,r,i){var a=this;try{p.CometChat.getLoggedinUser().then(function(t){if(t){var e=new O.TypingIndicator(s,r);t.authToken&&delete t.authToken,e.setSender(t),i&&e.setMetadata(i);var n=new A.CometChatTypingEvent(p.CometChat.getAppId(),s,r,t.getUid(),p.CometChat.getSessionId());if(n.setAction(N.TYPING_INDICATOR.ACTION.ENDED),n.setTypingIndicator(e),m.checkConnection(a.connection)){var o=n.getAsString();a.connection.send(o)}}else l.Logger.log("no logged-in user","null")},function(t){l.Logger.log("error in fetching logged-in user",t)})}catch(t){l.Logger.error("WSConnectionHelper: pauseTypingIndicator",t)}},i.prototype.markAsRead=function(s,r,i,a){var E=this;try{p.CometChat.getLoggedinUser().then(function(t){if(t){var e=new h.CometChatReceiptEvent(p.CometChat.getAppId(),s,r,t.getUid(),p.CometChat.getSessionId(),a);e.setAction(N.RECEIPTS.ACTION.READ);var n=new I.MessageReceipt;if(t.authToken&&delete t.authToken,n.setSender(t),n.setReceiverType(r),n.setReceiver(s),n.setReceiptType(N.RECEIPTS.RECEIPT_TYPE.READ_RECEIPT),n.setMessageId(i),n.setTimestamp(Math.floor((new Date).getTime()/1e3).toString()),e.setMessageReceipt(n),m.checkConnection(E.connection)){var o=e.getAsString();E.connection.send(o)}}else l.Logger.log("no logged-in user","null")},function(t){l.Logger.log("error in fetching logged-in user",t)})}catch(t){l.Logger.error("WSConnectionHelper: markAsRead",t)}},i.prototype.markAsDelivered=function(s,r,i,a){var E=this;try{p.CometChat.getLoggedinUser().then(function(t){if(t){var e=new h.CometChatReceiptEvent(p.CometChat.getAppId(),s,r,t.getUid(),p.CometChat.getSessionId(),a);e.setAction(N.RECEIPTS.ACTION.DELIVERED);var n=new I.MessageReceipt;if(t.authToken&&delete t.authToken,n.setSender(t),n.setReceiverType(r),n.setReceiver(s),n.setReceiptType(N.RECEIPTS.RECEIPT_TYPE.DELIVERY_RECEIPT),n.setMessageId(i),n.setTimestamp(Math.floor((new Date).getTime()/1e3).toString()),e.setMessageReceipt(n),m.checkConnection(E.connection)){var o=e.getAsString();E.connection.send(o)}}else l.Logger.log("no logged-in user","null")},function(t){l.Logger.log("error in fetching logged-in user",t)})}catch(t){l.Logger.error("WSConnectionHelper: markAsDelivered",t)}},i.prototype.sendTransientMessage=function(s,r,i){var a=this;try{p.CometChat.getLoggedinUser().then(function(t){if(t){var e=new f.TransientMessage(s,r,i);t.authToken&&delete t.authToken,e.setSender(t);var n=new R.CometChatTransientEvent(p.CometChat.getAppId(),s,r,t.getUid(),p.CometChat.getSessionId());if(n.setTransientMessage(e),m.checkConnection(a.connection)){var o=n.getAsString();a.connection.send(o)}}else l.Logger.log("no logged-in user","null")},function(t){l.Logger.log("error in fetching logged-in user",t)})}catch(t){l.Logger.error("WSConnectionHelper: sendTransientMessage",t)}},i.prototype.publishTypingIndicator=function(t){try{var e=t.getTypingIndicator();switch(t.getAction()){case N.TYPING_INDICATOR.ACTION.STARTED:L.messageHandlers.map(function(t){t._eventListener.onTypingStarted&&t._eventListener.onTypingStarted(e)}),r.TypingNotificationController.addIncomingTypingStarted(e);break;case N.TYPING_INDICATOR.ACTION.ENDED:L.messageHandlers.map(function(t){t._eventListener.onTypingEnded&&t._eventListener.onTypingEnded(e)}),r.TypingNotificationController.removeIncomingTypingStarted(e)}}catch(t){l.Logger.error("WSHelper: publishTypingIndicator",t)}},i.prototype.publishReceipts=function(t){try{var e=t.getMessageReceipt();switch(t.getAction()){case N.RECEIPTS.ACTION.DELIVERED:L.messageHandlers.map(function(t){t._eventListener.onMessagesDelivered&&t._eventListener.onMessagesDelivered(e)});break;case N.RECEIPTS.ACTION.READ:L.messageHandlers.map(function(t){t._eventListener.onMessagesRead&&t._eventListener.onMessagesRead(e)})}}catch(t){l.Logger.error("WSHelper: publishReceipts",t)}},i.prototype.publishPresence=function(t){try{var e=t.getUser();switch(e.setLastActiveAt(t.getTimestamp()),t.getAction()){case N.PRESENCE.ACTION.ONLINE:case N.PRESENCE.ACTION.AVAILABLE:e.setStatus(C.PresenceConstatnts.STATUS.ONLINE),L.userHandlers.map(function(t){l.isFalsy(t._eventListener.onUserOnline)||t._eventListener.onUserOnline(e)});break;case N.PRESENCE.ACTION.OFFLINE:e.setStatus(C.PresenceConstatnts.STATUS.OFFLINE),L.userHandlers.map(function(t){l.isFalsy(t._eventListener.onUserOffline)||t._eventListener.onUserOffline(e)})}}catch(t){l.Logger.error("WSHelper: publishPresence",t)}},i.prototype.publishMessages=function(t){try{var e=t.getMessage();e&&e.getId()&&c.MessageListnerMaping.getInstance().set("all",e.getId()),e instanceof S.Call?this.publishCallMessage(e):e instanceof u.Action?this.publishActionMessage(e):this.publishMessage(e)}catch(t){l.Logger.error("WSHelper: publishMessages",t)}},i.prototype.publishMessage=function(n){try{L.messageHandlers.map(function(t){if(t._eventListener){var e=n;switch(e.getType()){case C.MessageConstatnts.TYPE.TEXT:l.isFalsy(t._eventListener.onTextMessageReceived)||t._eventListener.onTextMessageReceived(n);break;case C.MessageConstatnts.TYPE.CUSTOM:l.isFalsy(t._eventListener.onCustomMessageReceived)||t._eventListener.onCustomMessageReceived(n);break;default:e.getCategory()==C.MessageCategory.CUSTOM?l.isFalsy(t._eventListener.onCustomMessageReceived)||t._eventListener.onCustomMessageReceived(n):l.isFalsy(t._eventListener.onMediaMessageReceived)||t._eventListener.onMediaMessageReceived(n)}}})}catch(t){l.Logger.error("WSHelper: publishMessage",t)}},i.prototype.publishCallMessage=function(e){try{var n=s.CallController.getInstance().getActiveCall();switch(e.getStatus()){case C.CallConstants.CALL_STATUS.INITIATED:e.getReceiverType()==C.CallConstants.RECEIVER_TYPE_GROUP?L.callHandlers.map(function(t){e.getCallInitiator().getUid().toLocaleLowerCase()!=p.CometChat.user.getUid().toLocaleLowerCase()&&(l.isFalsy(t._eventListener.onIncomingCallReceived)||t._eventListener.onIncomingCallReceived(e))}):L.callHandlers.map(function(t){l.isFalsy(t._eventListener.onIncomingCallReceived)||t._eventListener.onIncomingCallReceived(e)});break;case C.CallConstants.CALL_STATUS.ONGOING:e.getReceiverType()==C.CallConstants.RECEIVER_TYPE_GROUP?e.getCallInitiator().getUid().toLocaleLowerCase()==p.CometChat.user.getUid().toLocaleLowerCase()&&L.callHandlers.map(function(t){l.isFalsy(t._eventListener.onOutgoingCallAccepted)||t._eventListener.onOutgoingCallAccepted(e)}):L.callHandlers.map(function(t){l.isFalsy(t._eventListener.onOutgoingCallAccepted)||t._eventListener.onOutgoingCallAccepted(e)});break;case C.CallConstants.CALL_STATUS.UNANSWERED:if(e.getCallInitiator().getUid().toLocaleLowerCase()==p.CometChat.user.getUid().toLocaleLowerCase())L.callHandlers.map(function(t){l.isFalsy(t._eventListener.onOutgoingCallRejected)||t._eventListener.onOutgoingCallRejected(e)});else{if(null!==n&&n.getSessionId()===e.getSessionId())try{s.CallController.getInstance().endCall()}catch(t){l.Logger.error("CallError",t)}L.callHandlers.map(function(t){l.isFalsy(t._eventListener.onIncomingCallCancelled)||t._eventListener.onIncomingCallCancelled(e)})}break;case C.CallConstants.CALL_STATUS.REJECTED:if(e.getReceiverType()==C.CallConstants.RECEIVER_TYPE_GROUP)e.getCallInitiator().getUid().toLocaleLowerCase()==p.CometChat.user.getUid().toLocaleLowerCase()&&L.callHandlers.map(function(t){l.isFalsy(t._eventListener.onOutgoingCallRejected)||t._eventListener.onOutgoingCallRejected(e)});else{if(null!==n&&n.getSessionId()===e.getSessionId())try{s.CallController.getInstance().endCall()}catch(t){l.Logger.error("CallError",t)}L.callHandlers.map(function(t){l.isFalsy(t._eventListener.onOutgoingCallRejected)||t._eventListener.onOutgoingCallRejected(e)})}break;case C.CallConstants.CALL_STATUS.BUSY:e.getReceiverType()==C.CallConstants.RECEIVER_TYPE_GROUP?e.getCallInitiator().getUid().toLocaleLowerCase()==p.CometChat.user.getUid().toLocaleLowerCase()&&L.callHandlers.map(function(t){l.isFalsy(t._eventListener.onOutgoingCallRejected)||t._eventListener.onOutgoingCallRejected(e)}):L.callHandlers.map(function(t){if(null!==n&&n.getSessionId()===e.getSessionId())try{s.CallController.getInstance().endCall()}catch(t){l.Logger.error("CallError",t)}l.isFalsy(t._eventListener.onOutgoingCallRejected)||t._eventListener.onOutgoingCallRejected(e)});break;case C.CallConstants.CALL_STATUS.CANCELLED:if(L.callHandlers.map(function(t){l.isFalsy(t._eventListener.onIncomingCallCancelled)||t._eventListener.onIncomingCallCancelled(e)}),null!==n&&n.getSessionId()===e.getSessionId())try{s.CallController.getInstance().endCall()}catch(t){l.Logger.error("CallError",t)}break;case C.CallConstants.CALL_STATUS.ENDED:if(L.callHandlers.map(function(t){l.isFalsy(t._eventListener.onCallEndedMessageReceived)||t._eventListener.onCallEndedMessageReceived(e)}),null!==n&&n.getSessionId()===e.getSessionId())try{l.isCallingComponentInstalled()&&(s.CallController.getInstance().endSession(!0,e),s.CallController.getInstance().endCall())}catch(t){l.Logger.error("CallError",t)}break;default:l.Logger.log("WSHelper: publishCallMessage :: unknown status",e)}}catch(t){l.Logger.error("WSHelper: publishCallMessage",t)}},i.prototype.publishActionMessage=function(e){try{switch(e.getAction()){case C.ActionConstatnts.ACTION_TYPE.TYPE_MEMBER_JOINED:L.groupHandlers.map(function(t){l.isFalsy(t._eventListener.onGroupMemberJoined)||t._eventListener.onGroupMemberJoined(e,e.getActionBy(),e.getActionFor())});break;case C.ActionConstatnts.ACTION_TYPE.TYPE_MEMBER_INVITED:L.groupHandlers.map(function(t){l.isFalsy(t._eventListener.onGroupMemberJoined)||t._eventListener.onGroupMemberJoined(e,e.getActionBy(),e.getActionFor())});break;case C.ActionConstatnts.ACTION_TYPE.TYPE_MEMBER_LEFT:L.groupHandlers.map(function(t){l.isFalsy(t._eventListener.onGroupMemberLeft)||t._eventListener.onGroupMemberLeft(e,e.getActionBy(),e.getActionFor())});break;case C.ActionConstatnts.ACTION_TYPE.TYPE_MEMBER_BANNED:L.groupHandlers.map(function(t){l.isFalsy(t._eventListener.onGroupMemberBanned)||t._eventListener.onGroupMemberBanned(e,e.getActionOn(),e.getActionBy(),e.getActionFor())});break;case C.ActionConstatnts.ACTION_TYPE.TYPE_MEMBER_KICKED:L.groupHandlers.map(function(t){l.isFalsy(t._eventListener.onGroupMemberKicked)||t._eventListener.onGroupMemberKicked(e,e.getActionOn(),e.getActionBy(),e.getActionFor())});break;case C.ActionConstatnts.ACTION_TYPE.TYPE_MEMBER_UNBANNED:L.groupHandlers.map(function(t){l.isFalsy(t._eventListener.onGroupMemberUnbanned)||t._eventListener.onGroupMemberUnbanned(e,e.getActionOn(),e.getActionBy(),e.getActionFor())});break;case C.ActionConstatnts.ACTION_TYPE.TYPE_MEMBER_SCOPE_CHANGED:L.groupHandlers.map(function(t){l.isFalsy(t._eventListener.onGroupMemberScopeChanged)||t._eventListener.onGroupMemberScopeChanged(e,e.getActionOn(),e.getNewScope(),e.getOldScope(),e.getActionFor())});break;case C.ActionConstatnts.ACTION_TYPE.TYPE_MESSAGE_EDITED:L.messageHandlers.map(function(t){l.isFalsy(t._eventListener.onMessageEdited)||t._eventListener.onMessageEdited(e.getActionOn())});break;case C.ActionConstatnts.ACTION_TYPE.TYPE_MESSAGE_DELETED:L.messageHandlers.map(function(t){l.isFalsy(t._eventListener.onMessageDeleted)||t._eventListener.onMessageDeleted(e.getActionOn())});break;case C.ActionConstatnts.ACTION_TYPE.TYPE_MEMBER_ADDED:L.groupHandlers.map(function(t){l.isFalsy(t._eventListener.onGroupMemberAddedToGroup)||t._eventListener.onGroupMemberAddedToGroup(e,e.getActionOn(),e.getActionBy(),e.getActionFor())});break;default:l.Logger.log("WSHelper: publishActionMessage :: unknown action",e)}}catch(t){l.Logger.error("WSHelper: publishActionMessage",t)}},i.prototype.publishTransientMessage=function(t){try{var e=t.getTransientMessage();L.messageHandlers.map(function(t){t._eventListener.onTransientMessageReceived&&t._eventListener.onTransientMessageReceived(e)})}catch(t){l.Logger.error("WSHelper: publishTransientMessage",t)}},i.prototype.getCometChatEventFromMessage=function(t){try{if(t.hasOwnProperty(N.KEYS.TYPE))switch(t.type){case N.TYPING_INDICATOR.TYPE:return A.CometChatTypingEvent.getTypingEventFromJSON(t);case N.RECEIPTS.TYPE:return h.CometChatReceiptEvent.getReceiptEventFromJSON(t);case N.PRESENCE.TYPE:return _.CometChatPresenceEvent.getPresenceEventFromJSON(t);case N.MESSAGE.TYPE:return g.CometChatMessageEvent.getMessageEventFromJSON(t);case N.AUTH.TYPE:return T.CometChatAuthEvent.getAuthEventFromJSON(t);case N.TRANSIENT_MESSAGE.TYPE:return R.CometChatTransientEvent.getTransientEventFromJSON(t)}}catch(t){l.Logger.error("WSConnectionHelper: getCometChatEventFromMessage",t)}},i.wsConnectionHelper=new i,i.appInactiveTime=30,i.isAppInactive=!1,i.wsResponseTime=30,i}();e.WSConnectionHelper=M},function(t,e,n){"use strict";var o,s=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});e.__esModule=!0,e.CometChatAuthEvent=void 0;var S=n(4),r=function(i){function u(t,e,n,o,s){var r=i.call(this,t,e,n,o,s)||this;return r.setType(S.AUTH.TYPE),r}return s(u,i),u.prototype.getStatus=function(){return this.status},u.prototype.setStatus=function(t){this.status=t},u.prototype.getCode=function(){return this.code},u.prototype.setCode=function(t){this.code=t},u.prototype.setAuth=function(t){this.auth=t},u.prototype.getAuth=function(){return this.auth},u.prototype.setPresenceSubscription=function(t){this.presenceSubscription=t},u.prototype.getPresenceSubscription=function(){return this.presenceSubscription},u.prototype.setDeviceId=function(t){this.deviceId=t},u.prototype.getdeviceId=function(){return this.deviceId},u.prototype.setExtraParmaeters=function(t){this.params=t},u.prototype.getExtraParameters=function(){return this.params},u.prototype.getAsString=function(){return JSON.stringify(this.getAsJSONObject())},u.prototype.getAsJSONObject=function(){var t=this.getCometChatEventJSON(),e={};return e[S.KEYS.AUTH]=this.auth,e[S.KEYS.DEVICE_ID]=this.deviceId,e[S.KEYS.PRESENCE_SUBSCRIPTION]=this.presenceSubscription,e[S.KEYS.PARAMS]=this.params,t[S.KEYS.BODY]=e,t},u.getAuthEventFromJSON=function(t){var e=t[S.KEYS.APP_ID],n=t[S.KEYS.RECEIVER],o=t[S.KEYS.RECEIVER_TYPE],s=t[S.KEYS.DEVICE_ID],r=t[S.KEYS.SENDER],i=t[S.KEYS.BODY],a=i[S.KEYS.STATUS],E=i[S.KEYS.CODE],c=new u(e,n,o,r,s);return c.setStatus(a),c.setCode(E),c},u}(n(9).CometChatEvent);e.CometChatAuthEvent=r},function(t,e,n){"use strict";var o,s=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});e.__esModule=!0,e.CometChatMessageEvent=void 0;var u=n(10),S=n(4),r=function(i){function c(t,e,n,o,s){var r=i.call(this,t,e,n,o,s)||this;return r.setType(S.MESSAGE.TYPE),r}return s(c,i),c.prototype.getMessage=function(){return this.message},c.prototype.setMessage=function(t){this.message=t},c.getMessageEventFromJSON=function(t){var e=t[S.KEYS.APP_ID],n=t[S.KEYS.RECEIVER],o=t[S.KEYS.RECEIVER_TYPE],s=t[S.KEYS.DEVICE_ID],r=t[S.KEYS.SENDER],i=t[S.KEYS.BODY],a=new c(e,n,o,r,s),E=u.MessageController.trasformJSONMessge(i);return a.setMessage(E),a},c}(n(9).CometChatEvent);e.CometChatMessageEvent=r},function(t,e,n){"use strict";var o,s=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});e.__esModule=!0,e.CometChatPingEvent=void 0;var i=n(4),r=function(r){function t(t,e,n,o,s){return r.call(this,t,e,n,o,s)||this}return s(t,r),t.prototype.getAsString=function(){return JSON.stringify(this.getAsJSONObject())},t.prototype.getAsJSONObject=function(){var t={};return t[i.KEYS.ACTION]=i.KEYS.PING,t[i.KEYS.ACK]="true",t},t}(n(9).CometChatEvent);e.CometChatPingEvent=r},function(t,e,n){"use strict";var o,s=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});e.__esModule=!0,e.CometChatPresenceEvent=void 0;var u=n(4),r=n(9),S=n(3),i=function(i){function c(t,e,n,o,s){var r=i.call(this,t,e,n,o,s)||this;return r.setType(u.PRESENCE.TYPE),r}return s(c,i),c.prototype.getAction=function(){return this.action},c.prototype.setAction=function(t){this.action=t},c.prototype.getUser=function(){return this.user},c.prototype.setUser=function(t){this.user=t},c.prototype.getTimestamp=function(){return this.timestamp},c.prototype.setTimestamp=function(t){this.timestamp=t},c.getPresenceEventFromJSON=function(t){var e=t[u.KEYS.APP_ID],n=t[u.KEYS.DEVICE_ID],o=t[u.KEYS.SENDER],s=t[u.KEYS.BODY],r=s[u.KEYS.ACTION],i=s[u.KEYS.USER],a=s[u.KEYS.TIMESTAMP],E=new c(e,"","",o,n);return E.setAction(r),E.setUser(new S.User(i)),E.setTimestamp(a),E},c}(r.CometChatEvent);e.CometChatPresenceEvent=i},function(t,e,n){"use strict";var o,s=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});e.__esModule=!0,e.CometChatReceiptEvent=void 0;var l=n(4),r=n(9),T=n(25),g=n(3),i=function(a){function C(t,e,n,o,s,r){var i=a.call(this,t,e,n,o,s,r)||this;return i.setType(l.RECEIPTS.TYPE),i}return s(C,a),C.prototype.getAction=function(){return this.action},C.prototype.setAction=function(t){this.action=t},C.prototype.getMessageReceipt=function(){return this.receipt},C.prototype.setMessageReceipt=function(t){this.receipt=t},C.prototype.getAsString=function(){return JSON.stringify(this.getAsJSONObject())},C.prototype.getAsJSONObject=function(){var t=this.getCometChatEventJSON(),e={};return e[l.KEYS.ACTION]=this.action,e[l.KEYS.MESSAGE_ID]=this.receipt.getMessageId(),e[l.KEYS.USER]=this.receipt.getSender(),t[l.KEYS.BODY]=e,t},C.getReceiptEventFromJSON=function(t){var e=t[l.KEYS.APP_ID],n=t[l.KEYS.RECEIVER],o=t[l.KEYS.RECEIVER_TYPE],s=t[l.KEYS.DEVICE_ID],r=t[l.KEYS.SENDER],i=t[l.KEYS.BODY],a=i[l.KEYS.ACTION],E=i[l.KEYS.USER],c=i[l.KEYS.MESSAGE_ID],u=i[l.KEYS.TIMESTAMP],S=new C(e,n,o,r,s);S.setAction(a);var p=new T.MessageReceipt;return p.setSender(new g.User(E)),p.setReceiverType(o),p.setReceiver(n),a===l.RECEIPTS.ACTION.DELIVERED&&(p.setReceiptType(l.RECEIPTS.RECEIPT_TYPE.DELIVERY_RECEIPT),p.setDeliveredAt(u)),a===l.RECEIPTS.ACTION.READ&&(p.setReceiptType(l.RECEIPTS.RECEIPT_TYPE.READ_RECEIPT),p.setReadAt(u)),p.setMessageId(c.toString()),p.setTimestamp(u),S.setMessageReceipt(p),S},C}(r.CometChatEvent);e.CometChatReceiptEvent=i},function(t,e,n){"use strict";var o,s=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});e.__esModule=!0,e.CometChatTransientEvent=void 0;var p=n(4),r=n(9),C=n(29),l=n(3),i=function(i){function S(t,e,n,o,s){var r=i.call(this,t,e,n,o,s)||this;return r.setType(p.TRANSIENT_MESSAGE.TYPE),r}return s(S,i),S.prototype.getTransientMessage=function(){return this.transientMessage},S.prototype.setTransientMessage=function(t){this.transientMessage=t},S.prototype.getAsString=function(){return JSON.stringify(this.getAsJSONObject())},S.prototype.getAsJSONObject=function(){var t=this.getCometChatEventJSON(),e={};return e[p.KEYS.USER]=this.transientMessage.getSender(),this.transientMessage.getData()&&(e[p.KEYS.DATA]=this.transientMessage.getData()),t[p.KEYS.BODY]=e,t},S.getTransientEventFromJSON=function(t){var e=t[p.KEYS.APP_ID],n=t[p.KEYS.RECEIVER],o=t[p.KEYS.RECEIVER_TYPE],s=t[p.KEYS.DEVICE_ID],r=t[p.KEYS.SENDER],i=t[p.KEYS.BODY],a=i[p.KEYS.USER],E=i[p.KEYS.DATA],c=new S(e,n,o,r,s),u=new C.TransientMessage(n,o,E);return u.setSender(new l.User(a)),i.hasOwnProperty(p.KEYS.DATA)&&i[p.KEYS.DATA]&&u.setData(E),c.setTransientMessage(u),c},S}(r.CometChatEvent);e.CometChatTransientEvent=i},function(t,e,n){"use strict";var o,s=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});e.__esModule=!0,e.CometChatTypingEvent=void 0;var C=n(4),r=n(9),l=n(28),T=n(3),i=function(i){function p(t,e,n,o,s){var r=i.call(this,t,e,n,o,s)||this;return r.setType(C.TYPING_INDICATOR.TYPE),r}return s(p,i),p.prototype.getAction=function(){return this.action},p.prototype.setAction=function(t){this.action=t},p.prototype.getTypingIndicator=function(){return this.typingIndicator},p.prototype.setTypingIndicator=function(t){this.typingIndicator=t},p.prototype.getAsString=function(){return JSON.stringify(this.getAsJSONObject())},p.prototype.getAsJSONObject=function(){var t=this.getCometChatEventJSON(),e={};return e[C.KEYS.ACTION]=this.action,e[C.KEYS.USER]=this.typingIndicator.getSender(),this.typingIndicator.getMetadata()&&(e[C.KEYS.METADATA]=this.typingIndicator.getMetadata()),t[C.KEYS.BODY]=e,t},p.getTypingEventFromJSON=function(t){var e=t[C.KEYS.APP_ID],n=t[C.KEYS.RECEIVER],o=t[C.KEYS.RECEIVER_TYPE],s=t[C.KEYS.DEVICE_ID],r=t[C.KEYS.SENDER],i=t[C.KEYS.BODY],a=i[C.KEYS.ACTION],E=i[C.KEYS.USER],c=i[C.KEYS.METADATA],u=new p(e,n,o,r,s);u.setAction(a);var S=new l.TypingIndicator(n,o);return S.setSender(new T.User(E)),i.hasOwnProperty(C.KEYS.METADATA)&&i[C.KEYS.METADATA]&&S.setMetadata(c),u.setTypingIndicator(S),u},p}(r.CometChatEvent);e.CometChatTypingEvent=i},function(t,e,n){"use strict";e.__esModule=!0,e.CCExtension=void 0;var o=n(0),s=function(){function t(t){this.id="",this.name="",t&&(o.isFalsy(t.id)||(this.id=t.id),o.isFalsy(t.name)||(this.name=t.name))}return t.prototype.getId=function(){return this.id},t.prototype.getName=function(){return this.name},t}();e.CCExtension=s},function(t,B,e){"use strict";(function(t){var o=e(67),r=e(68),i=e(69);function n(){return S.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function a(t,e){if(n()<e)throw new RangeError("Invalid typed array length");return S.TYPED_ARRAY_SUPPORT?(t=new Uint8Array(e)).__proto__=S.prototype:(null===t&&(t=new S(e)),t.length=e),t}function S(t,e,n){if(!(S.TYPED_ARRAY_SUPPORT||this instanceof S))return new S(t,e,n);if("number"!=typeof t)return s(this,t,e,n);if("string"==typeof e)throw new Error("If encoding is specified then the first argument must be a string");return c(this,t)}function s(t,e,n,o){if("number"==typeof e)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer?function(t,e,n,o){if(e.byteLength,n<0||e.byteLength<n)throw new RangeError("'offset' is out of bounds");if(e.byteLength<n+(o||0))throw new RangeError("'length' is out of bounds");e=void 0===n&&void 0===o?new Uint8Array(e):void 0===o?new Uint8Array(e,n):new Uint8Array(e,n,o);S.TYPED_ARRAY_SUPPORT?(t=e).__proto__=S.prototype:t=u(t,e);return t}(t,e,n,o):"string"==typeof e?function(t,e,n){"string"==typeof n&&""!==n||(n="utf8");if(!S.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var o=0|C(e,n),s=(t=a(t,o)).write(e,n);s!==o&&(t=t.slice(0,s));return t}(t,e,n):function(t,e){if(S.isBuffer(e)){var n=0|p(e.length);return 0===(t=a(t,n)).length||e.copy(t,0,0,n),t}if(e){if("undefined"!=typeof ArrayBuffer&&e.buffer instanceof ArrayBuffer||"length"in e)return"number"!=typeof e.length||(o=e.length)!=o?a(t,0):u(t,e);if("Buffer"===e.type&&i(e.data))return u(t,e.data)}var o;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(t,e)}function E(t){if("number"!=typeof t)throw new TypeError('"size" argument must be a number');if(t<0)throw new RangeError('"size" argument must not be negative')}function c(t,e){if(E(e),t=a(t,e<0?0:0|p(e)),!S.TYPED_ARRAY_SUPPORT)for(var n=0;n<e;++n)t[n]=0;return t}function u(t,e){var n=e.length<0?0:0|p(e.length);t=a(t,n);for(var o=0;o<n;o+=1)t[o]=255&e[o];return t}function p(t){if(t>=n())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+n().toString(16)+" bytes");return 0|t}function C(t,e){if(S.isBuffer(t))return t.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(t)||t instanceof ArrayBuffer))return t.byteLength;"string"!=typeof t&&(t=""+t);var n=t.length;if(0===n)return 0;for(var o=!1;;)switch(e){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return G(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return w(t).length;default:if(o)return G(t).length;e=(""+e).toLowerCase(),o=!0}}function l(t,e,n){var o=t[e];t[e]=t[n],t[n]=o}function T(t,e,n,o,s){if(0===t.length)return-1;if("string"==typeof n?(o=n,n=0):2147483647<n?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=s?0:t.length-1),n<0&&(n=t.length+n),n>=t.length){if(s)return-1;n=t.length-1}else if(n<0){if(!s)return-1;n=0}if("string"==typeof e&&(e=S.from(e,o)),S.isBuffer(e))return 0===e.length?-1:g(t,e,n,o,s);if("number"==typeof e)return e&=255,S.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?s?Uint8Array.prototype.indexOf.call(t,e,n):Uint8Array.prototype.lastIndexOf.call(t,e,n):g(t,[e],n,o,s);throw new TypeError("val must be string, number or Buffer")}function g(t,e,n,o,s){var r,i=1,a=t.length,E=e.length;if(void 0!==o&&("ucs2"===(o=String(o).toLowerCase())||"ucs-2"===o||"utf16le"===o||"utf-16le"===o)){if(t.length<2||e.length<2)return-1;a/=i=2,E/=2,n/=2}function c(t,e){return 1===i?t[e]:t.readUInt16BE(e*i)}if(s){var u=-1;for(r=n;r<a;r++)if(c(t,r)===c(e,-1===u?0:r-u)){if(-1===u&&(u=r),r-u+1===E)return u*i}else-1!==u&&(r-=r-u),u=-1}else for(a<n+E&&(n=a-E),r=n;0<=r;r--){for(var S=!0,p=0;p<E;p++)if(c(t,r+p)!==c(e,p)){S=!1;break}if(S)return r}return-1}function d(t,e,n,o){n=Number(n)||0;var s=t.length-n;o?s<(o=Number(o))&&(o=s):o=s;var r=e.length;if(r%2!=0)throw new TypeError("Invalid hex string");r/2<o&&(o=r/2);for(var i=0;i<o;++i){var a=parseInt(e.substr(2*i,2),16);if(isNaN(a))return i;t[n+i]=a}return i}function _(t,e,n,o){return K(function(t){for(var e=[],n=0;n<t.length;++n)e.push(255&t.charCodeAt(n));return e}(e),t,n,o)}function h(t,e,n){return 0===e&&n===t.length?o.fromByteArray(t):o.fromByteArray(t.slice(e,n))}function R(t,e,n){n=Math.min(t.length,n);for(var o=[],s=e;s<n;){var r,i,a,E,c=t[s],u=null,S=239<c?4:223<c?3:191<c?2:1;if(s+S<=n)switch(S){case 1:c<128&&(u=c);break;case 2:128==(192&(r=t[s+1]))&&127<(E=(31&c)<<6|63&r)&&(u=E);break;case 3:r=t[s+1],i=t[s+2],128==(192&r)&&128==(192&i)&&2047<(E=(15&c)<<12|(63&r)<<6|63&i)&&(E<55296||57343<E)&&(u=E);break;case 4:r=t[s+1],i=t[s+2],a=t[s+3],128==(192&r)&&128==(192&i)&&128==(192&a)&&65535<(E=(15&c)<<18|(63&r)<<12|(63&i)<<6|63&a)&&E<1114112&&(u=E)}null===u?(u=65533,S=1):65535<u&&(u-=65536,o.push(u>>>10&1023|55296),u=56320|1023&u),o.push(u),s+=S}return function(t){var e=t.length;if(e<=A)return String.fromCharCode.apply(String,t);var n="",o=0;for(;o<e;)n+=String.fromCharCode.apply(String,t.slice(o,o+=A));return n}(o)}B.Buffer=S,B.SlowBuffer=function(t){+t!=t&&(t=0);return S.alloc(+t)},B.INSPECT_MAX_BYTES=50,S.TYPED_ARRAY_SUPPORT=void 0!==t.TYPED_ARRAY_SUPPORT?t.TYPED_ARRAY_SUPPORT:function(){try{var t=new Uint8Array(1);return t.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===t.foo()&&"function"==typeof t.subarray&&0===t.subarray(1,1).byteLength}catch(t){return!1}}(),B.kMaxLength=n(),S.poolSize=8192,S._augment=function(t){return t.__proto__=S.prototype,t},S.from=function(t,e,n){return s(null,t,e,n)},S.TYPED_ARRAY_SUPPORT&&(S.prototype.__proto__=Uint8Array.prototype,S.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&S[Symbol.species]===S&&Object.defineProperty(S,Symbol.species,{value:null,configurable:!0})),S.alloc=function(t,e,n){return o=null,r=e,i=n,E(s=t),s<=0?a(o,s):void 0!==r?"string"==typeof i?a(o,s).fill(r,i):a(o,s).fill(r):a(o,s);var o,s,r,i},S.allocUnsafe=function(t){return c(null,t)},S.allocUnsafeSlow=function(t){return c(null,t)},S.isBuffer=function(t){return!(null==t||!t._isBuffer)},S.compare=function(t,e){if(!S.isBuffer(t)||!S.isBuffer(e))throw new TypeError("Arguments must be Buffers");if(t===e)return 0;for(var n=t.length,o=e.length,s=0,r=Math.min(n,o);s<r;++s)if(t[s]!==e[s]){n=t[s],o=e[s];break}return n<o?-1:o<n?1:0},S.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},S.concat=function(t,e){if(!i(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return S.alloc(0);var n;if(void 0===e)for(n=e=0;n<t.length;++n)e+=t[n].length;var o=S.allocUnsafe(e),s=0;for(n=0;n<t.length;++n){var r=t[n];if(!S.isBuffer(r))throw new TypeError('"list" argument must be an Array of Buffers');r.copy(o,s),s+=r.length}return o},S.byteLength=C,S.prototype._isBuffer=!0,S.prototype.swap16=function(){var t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var e=0;e<t;e+=2)l(this,e,e+1);return this},S.prototype.swap32=function(){var t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var e=0;e<t;e+=4)l(this,e,e+3),l(this,e+1,e+2);return this},S.prototype.swap64=function(){var t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var e=0;e<t;e+=8)l(this,e,e+7),l(this,e+1,e+6),l(this,e+2,e+5),l(this,e+3,e+4);return this},S.prototype.toString=function(){var t=0|this.length;return 0===t?"":0===arguments.length?R(this,0,t):function(t,e,n){var o=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(e>>>=0))return"";for(t||(t="utf8");;)switch(t){case"hex":return O(this,e,n);case"utf8":case"utf-8":return R(this,e,n);case"ascii":return I(this,e,n);case"latin1":case"binary":return f(this,e,n);case"base64":return h(this,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return N(this,e,n);default:if(o)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),o=!0}}.apply(this,arguments)},S.prototype.equals=function(t){if(!S.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===S.compare(this,t)},S.prototype.inspect=function(){var t="",e=B.INSPECT_MAX_BYTES;return 0<this.length&&(t=this.toString("hex",0,e).match(/.{2}/g).join(" "),this.length>e&&(t+=" ... ")),"<Buffer "+t+">"},S.prototype.compare=function(t,e,n,o,s){if(!S.isBuffer(t))throw new TypeError("Argument must be a Buffer");if(void 0===e&&(e=0),void 0===n&&(n=t?t.length:0),void 0===o&&(o=0),void 0===s&&(s=this.length),e<0||n>t.length||o<0||s>this.length)throw new RangeError("out of range index");if(s<=o&&n<=e)return 0;if(s<=o)return-1;if(n<=e)return 1;if(this===t)return 0;for(var r=(s>>>=0)-(o>>>=0),i=(n>>>=0)-(e>>>=0),a=Math.min(r,i),E=this.slice(o,s),c=t.slice(e,n),u=0;u<a;++u)if(E[u]!==c[u]){r=E[u],i=c[u];break}return r<i?-1:i<r?1:0},S.prototype.includes=function(t,e,n){return-1!==this.indexOf(t,e,n)},S.prototype.indexOf=function(t,e,n){return T(this,t,e,n,!0)},S.prototype.lastIndexOf=function(t,e,n){return T(this,t,e,n,!1)},S.prototype.write=function(t,e,n,o){if(void 0===e)o="utf8",n=this.length,e=0;else if(void 0===n&&"string"==typeof e)o=e,n=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e|=0,isFinite(n)?(n|=0,void 0===o&&(o="utf8")):(o=n,n=void 0)}var s=this.length-e;if((void 0===n||s<n)&&(n=s),0<t.length&&(n<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");o||(o="utf8");for(var r,i,a,E,c,u,S,p,C,l=!1;;)switch(o){case"hex":return d(this,t,e,n);case"utf8":case"utf-8":return p=e,C=n,K(G(t,(S=this).length-p),S,p,C);case"ascii":return _(this,t,e,n);case"latin1":case"binary":return _(this,t,e,n);case"base64":return E=this,c=e,u=n,K(w(t),E,c,u);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return i=e,a=n,K(function(t,e){for(var n,o,s,r=[],i=0;i<t.length&&!((e-=2)<0);++i)n=t.charCodeAt(i),o=n>>8,s=n%256,r.push(s),r.push(o);return r}(t,(r=this).length-i),r,i,a);default:if(l)throw new TypeError("Unknown encoding: "+o);o=(""+o).toLowerCase(),l=!0}},S.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var A=4096;function I(t,e,n){var o="";n=Math.min(t.length,n);for(var s=e;s<n;++s)o+=String.fromCharCode(127&t[s]);return o}function f(t,e,n){var o="";n=Math.min(t.length,n);for(var s=e;s<n;++s)o+=String.fromCharCode(t[s]);return o}function O(t,e,n){var o=t.length;(!e||e<0)&&(e=0),(!n||n<0||o<n)&&(n=o);for(var s="",r=e;r<n;++r)s+=Y(t[r]);return s}function N(t,e,n){for(var o=t.slice(e,n),s="",r=0;r<o.length;r+=2)s+=String.fromCharCode(o[r]+256*o[r+1]);return s}function m(t,e,n){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(n<t+e)throw new RangeError("Trying to access beyond buffer length")}function y(t,e,n,o,s,r){if(!S.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(s<e||e<r)throw new RangeError('"value" argument is out of bounds');if(n+o>t.length)throw new RangeError("Index out of range")}function L(t,e,n,o){e<0&&(e=65535+e+1);for(var s=0,r=Math.min(t.length-n,2);s<r;++s)t[n+s]=(e&255<<8*(o?s:1-s))>>>8*(o?s:1-s)}function M(t,e,n,o){e<0&&(e=4294967295+e+1);for(var s=0,r=Math.min(t.length-n,4);s<r;++s)t[n+s]=e>>>8*(o?s:3-s)&255}function P(t,e,n,o,s,r){if(n+o>t.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function v(t,e,n,o,s){return s||P(t,0,n,4),r.write(t,e,n,o,23,4),n+4}function U(t,e,n,o,s){return s||P(t,0,n,8),r.write(t,e,n,o,52,8),n+8}S.prototype.slice=function(t,e){var n,o=this.length;if((t=~~t)<0?(t+=o)<0&&(t=0):o<t&&(t=o),(e=void 0===e?o:~~e)<0?(e+=o)<0&&(e=0):o<e&&(e=o),e<t&&(e=t),S.TYPED_ARRAY_SUPPORT)(n=this.subarray(t,e)).__proto__=S.prototype;else{var s=e-t;n=new S(s,void 0);for(var r=0;r<s;++r)n[r]=this[r+t]}return n},S.prototype.readUIntLE=function(t,e,n){t|=0,e|=0,n||m(t,e,this.length);for(var o=this[t],s=1,r=0;++r<e&&(s*=256);)o+=this[t+r]*s;return o},S.prototype.readUIntBE=function(t,e,n){t|=0,e|=0,n||m(t,e,this.length);for(var o=this[t+--e],s=1;0<e&&(s*=256);)o+=this[t+--e]*s;return o},S.prototype.readUInt8=function(t,e){return e||m(t,1,this.length),this[t]},S.prototype.readUInt16LE=function(t,e){return e||m(t,2,this.length),this[t]|this[t+1]<<8},S.prototype.readUInt16BE=function(t,e){return e||m(t,2,this.length),this[t]<<8|this[t+1]},S.prototype.readUInt32LE=function(t,e){return e||m(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},S.prototype.readUInt32BE=function(t,e){return e||m(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},S.prototype.readIntLE=function(t,e,n){t|=0,e|=0,n||m(t,e,this.length);for(var o=this[t],s=1,r=0;++r<e&&(s*=256);)o+=this[t+r]*s;return(s*=128)<=o&&(o-=Math.pow(2,8*e)),o},S.prototype.readIntBE=function(t,e,n){t|=0,e|=0,n||m(t,e,this.length);for(var o=e,s=1,r=this[t+--o];0<o&&(s*=256);)r+=this[t+--o]*s;return(s*=128)<=r&&(r-=Math.pow(2,8*e)),r},S.prototype.readInt8=function(t,e){return e||m(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},S.prototype.readInt16LE=function(t,e){e||m(t,2,this.length);var n=this[t]|this[t+1]<<8;return 32768&n?4294901760|n:n},S.prototype.readInt16BE=function(t,e){e||m(t,2,this.length);var n=this[t+1]|this[t]<<8;return 32768&n?4294901760|n:n},S.prototype.readInt32LE=function(t,e){return e||m(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},S.prototype.readInt32BE=function(t,e){return e||m(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},S.prototype.readFloatLE=function(t,e){return e||m(t,4,this.length),r.read(this,t,!0,23,4)},S.prototype.readFloatBE=function(t,e){return e||m(t,4,this.length),r.read(this,t,!1,23,4)},S.prototype.readDoubleLE=function(t,e){return e||m(t,8,this.length),r.read(this,t,!0,52,8)},S.prototype.readDoubleBE=function(t,e){return e||m(t,8,this.length),r.read(this,t,!1,52,8)},S.prototype.writeUIntLE=function(t,e,n,o){(t=+t,e|=0,n|=0,o)||y(this,t,e,n,Math.pow(2,8*n)-1,0);var s=1,r=0;for(this[e]=255&t;++r<n&&(s*=256);)this[e+r]=t/s&255;return e+n},S.prototype.writeUIntBE=function(t,e,n,o){(t=+t,e|=0,n|=0,o)||y(this,t,e,n,Math.pow(2,8*n)-1,0);var s=n-1,r=1;for(this[e+s]=255&t;0<=--s&&(r*=256);)this[e+s]=t/r&255;return e+n},S.prototype.writeUInt8=function(t,e,n){return t=+t,e|=0,n||y(this,t,e,1,255,0),S.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[e]=255&t,e+1},S.prototype.writeUInt16LE=function(t,e,n){return t=+t,e|=0,n||y(this,t,e,2,65535,0),S.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):L(this,t,e,!0),e+2},S.prototype.writeUInt16BE=function(t,e,n){return t=+t,e|=0,n||y(this,t,e,2,65535,0),S.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):L(this,t,e,!1),e+2},S.prototype.writeUInt32LE=function(t,e,n){return t=+t,e|=0,n||y(this,t,e,4,4294967295,0),S.TYPED_ARRAY_SUPPORT?(this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t):M(this,t,e,!0),e+4},S.prototype.writeUInt32BE=function(t,e,n){return t=+t,e|=0,n||y(this,t,e,4,4294967295,0),S.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):M(this,t,e,!1),e+4},S.prototype.writeIntLE=function(t,e,n,o){if(t=+t,e|=0,!o){var s=Math.pow(2,8*n-1);y(this,t,e,n,s-1,-s)}var r=0,i=1,a=0;for(this[e]=255&t;++r<n&&(i*=256);)t<0&&0===a&&0!==this[e+r-1]&&(a=1),this[e+r]=(t/i>>0)-a&255;return e+n},S.prototype.writeIntBE=function(t,e,n,o){if(t=+t,e|=0,!o){var s=Math.pow(2,8*n-1);y(this,t,e,n,s-1,-s)}var r=n-1,i=1,a=0;for(this[e+r]=255&t;0<=--r&&(i*=256);)t<0&&0===a&&0!==this[e+r+1]&&(a=1),this[e+r]=(t/i>>0)-a&255;return e+n},S.prototype.writeInt8=function(t,e,n){return t=+t,e|=0,n||y(this,t,e,1,127,-128),S.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),t<0&&(t=255+t+1),this[e]=255&t,e+1},S.prototype.writeInt16LE=function(t,e,n){return t=+t,e|=0,n||y(this,t,e,2,32767,-32768),S.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):L(this,t,e,!0),e+2},S.prototype.writeInt16BE=function(t,e,n){return t=+t,e|=0,n||y(this,t,e,2,32767,-32768),S.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):L(this,t,e,!1),e+2},S.prototype.writeInt32LE=function(t,e,n){return t=+t,e|=0,n||y(this,t,e,4,2147483647,-2147483648),S.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24):M(this,t,e,!0),e+4},S.prototype.writeInt32BE=function(t,e,n){return t=+t,e|=0,n||y(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),S.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):M(this,t,e,!1),e+4},S.prototype.writeFloatLE=function(t,e,n){return v(this,t,e,!0,n)},S.prototype.writeFloatBE=function(t,e,n){return v(this,t,e,!1,n)},S.prototype.writeDoubleLE=function(t,e,n){return U(this,t,e,!0,n)},S.prototype.writeDoubleBE=function(t,e,n){return U(this,t,e,!1,n)},S.prototype.copy=function(t,e,n,o){if(n||(n=0),o||0===o||(o=this.length),e>=t.length&&(e=t.length),e||(e=0),0<o&&o<n&&(o=n),o===n)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(o<0)throw new RangeError("sourceEnd out of bounds");o>this.length&&(o=this.length),t.length-e<o-n&&(o=t.length-e+n);var s,r=o-n;if(this===t&&n<e&&e<o)for(s=r-1;0<=s;--s)t[s+e]=this[s+n];else if(r<1e3||!S.TYPED_ARRAY_SUPPORT)for(s=0;s<r;++s)t[s+e]=this[s+n];else Uint8Array.prototype.set.call(t,this.subarray(n,n+r),e);return r},S.prototype.fill=function(t,e,n,o){if("string"==typeof t){if("string"==typeof e?(o=e,e=0,n=this.length):"string"==typeof n&&(o=n,n=this.length),1===t.length){var s=t.charCodeAt(0);s<256&&(t=s)}if(void 0!==o&&"string"!=typeof o)throw new TypeError("encoding must be a string");if("string"==typeof o&&!S.isEncoding(o))throw new TypeError("Unknown encoding: "+o)}else"number"==typeof t&&(t&=255);if(e<0||this.length<e||this.length<n)throw new RangeError("Out of range index");if(n<=e)return this;var r;if(e>>>=0,n=void 0===n?this.length:n>>>0,t||(t=0),"number"==typeof t)for(r=e;r<n;++r)this[r]=t;else{var i=S.isBuffer(t)?t:G(new S(t,o).toString()),a=i.length;for(r=0;r<n-e;++r)this[r+e]=i[r%a]}return this};var D=/[^+\/0-9A-Za-z-_]/g;function Y(t){return t<16?"0"+t.toString(16):t.toString(16)}function G(t,e){var n;e=e||1/0;for(var o=t.length,s=null,r=[],i=0;i<o;++i){if(55295<(n=t.charCodeAt(i))&&n<57344){if(!s){if(56319<n){-1<(e-=3)&&r.push(239,191,189);continue}if(i+1===o){-1<(e-=3)&&r.push(239,191,189);continue}s=n;continue}if(n<56320){-1<(e-=3)&&r.push(239,191,189),s=n;continue}n=65536+(s-55296<<10|n-56320)}else s&&-1<(e-=3)&&r.push(239,191,189);if(s=null,n<128){if((e-=1)<0)break;r.push(n)}else if(n<2048){if((e-=2)<0)break;r.push(n>>6|192,63&n|128)}else if(n<65536){if((e-=3)<0)break;r.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;r.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return r}function w(t){return o.toByteArray(function(t){var e;if((t=(e=t,e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")).replace(D,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}(t))}function K(t,e,n,o){for(var s=0;s<o&&!(s+n>=e.length||s>=t.length);++s)e[s+n]=t[s];return s}}).call(this,e(32))},function(t,e,n){"use strict";e.byteLength=function(t){var e=C(t),n=e[0],o=e[1];return 3*(n+o)/4-o},e.toByteArray=function(t){for(var e,n=C(t),o=n[0],s=n[1],r=new p((c=o,u=s,3*(c+u)/4-u)),i=0,a=0<s?o-4:o,E=0;E<a;E+=4)e=S[t.charCodeAt(E)]<<18|S[t.charCodeAt(E+1)]<<12|S[t.charCodeAt(E+2)]<<6|S[t.charCodeAt(E+3)],r[i++]=e>>16&255,r[i++]=e>>8&255,r[i++]=255&e;var c,u;2===s&&(e=S[t.charCodeAt(E)]<<2|S[t.charCodeAt(E+1)]>>4,r[i++]=255&e);1===s&&(e=S[t.charCodeAt(E)]<<10|S[t.charCodeAt(E+1)]<<4|S[t.charCodeAt(E+2)]>>2,r[i++]=e>>8&255,r[i++]=255&e);return r},e.fromByteArray=function(t){for(var e,n=t.length,o=n%3,s=[],r=0,i=n-o;r<i;r+=16383)s.push(E(t,r,i<r+16383?i:r+16383));1===o?(e=t[n-1],s.push(a[e>>2]+a[e<<4&63]+"==")):2===o&&(e=(t[n-2]<<8)+t[n-1],s.push(a[e>>10]+a[e>>4&63]+a[e<<2&63]+"="));return s.join("")};for(var a=[],S=[],p="undefined"!=typeof Uint8Array?Uint8Array:Array,o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=0,r=o.length;s<r;++s)a[s]=o[s],S[o.charCodeAt(s)]=s;function C(t){var e=t.length;if(0<e%4)throw new Error("Invalid string. Length must be a multiple of 4");var n=t.indexOf("=");return-1===n&&(n=e),[n,n===e?0:4-n%4]}function E(t,e,n){for(var o,s,r=[],i=e;i<n;i+=3)o=(t[i]<<16&16711680)+(t[i+1]<<8&65280)+(255&t[i+2]),r.push(a[(s=o)>>18&63]+a[s>>12&63]+a[s>>6&63]+a[63&s]);return r.join("")}S["-".charCodeAt(0)]=62,S["_".charCodeAt(0)]=63},function(t,e){e.read=function(t,e,n,o,s){var r,i,a=8*s-o-1,E=(1<<a)-1,c=E>>1,u=-7,S=n?s-1:0,p=n?-1:1,C=t[e+S];for(S+=p,r=C&(1<<-u)-1,C>>=-u,u+=a;0<u;r=256*r+t[e+S],S+=p,u-=8);for(i=r&(1<<-u)-1,r>>=-u,u+=o;0<u;i=256*i+t[e+S],S+=p,u-=8);if(0===r)r=1-c;else{if(r===E)return i?NaN:1/0*(C?-1:1);i+=Math.pow(2,o),r-=c}return(C?-1:1)*i*Math.pow(2,r-o)},e.write=function(t,e,n,o,s,r){var i,a,E,c=8*r-s-1,u=(1<<c)-1,S=u>>1,p=23===s?Math.pow(2,-24)-Math.pow(2,-77):0,C=o?0:r-1,l=o?1:-1,T=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,i=u):(i=Math.floor(Math.log(e)/Math.LN2),e*(E=Math.pow(2,-i))<1&&(i--,E*=2),2<=(e+=1<=i+S?p/E:p*Math.pow(2,1-S))*E&&(i++,E/=2),u<=i+S?(a=0,i=u):1<=i+S?(a=(e*E-1)*Math.pow(2,s),i+=S):(a=e*Math.pow(2,S-1)*Math.pow(2,s),i=0));8<=s;t[n+C]=255&a,C+=l,a/=256,s-=8);for(i=i<<s|a,c+=s;0<c;t[n+C]=255&i,C+=l,i/=256,c-=8);t[n+C-l]|=128*T}},function(t,e){var n={}.toString;t.exports=Array.isArray||function(t){return"[object Array]"==n.call(t)}},function(t,e,n){var i=n(71),a=n(72);t.exports=function(t,e,n){var o=e&&n||0;"string"==typeof t&&(e="binary"===t?new Array(16):null,t=null);var s=(t=t||{}).random||(t.rng||i)();if(s[6]=15&s[6]|64,s[8]=63&s[8]|128,e)for(var r=0;r<16;++r)e[o+r]=s[r];return e||a(s)}},function(t,e){var n="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(n){var o=new Uint8Array(16);t.exports=function(){return n(o),o}}else{var s=new Array(16);t.exports=function(){for(var t,e=0;e<16;e++)0==(3&e)&&(t=4294967296*Math.random()),s[e]=t>>>((3&e)<<3)&255;return s}}},function(t,e){for(var s=[],n=0;n<256;++n)s[n]=(n+256).toString(16).substr(1);t.exports=function(t,e){var n=e||0,o=s;return[o[t[n++]],o[t[n++]],o[t[n++]],o[t[n++]],"-",o[t[n++]],o[t[n++]],"-",o[t[n++]],o[t[n++]],"-",o[t[n++]],o[t[n++]],"-",o[t[n++]],o[t[n++]],o[t[n++]],o[t[n++]],o[t[n++]],o[t[n++]]].join("")}}])}),function(){try{require("@cometchat/calls-sdk-react-native")&&(this.CometChatCalling={},this.CometChatCalling.isCallingComponentInstalled=!0,this.CometChatCalling.CallScreen=require("@cometchat/calls-sdk-react-native").default,this.CometChatCalling.CometChatRTC=require("@cometchat/calls-sdk-react-native").CometChatRTC,this.CometChatCalling.CometChatCalls=require("@cometchat/calls-sdk-react-native").CometChatCalls,this.CometChatCalling.CallEventListener=require("@cometchat/calls-sdk-react-native").CallEventListener)}catch(t){}}();