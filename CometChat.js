!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t(require("@react-native-async-storage/async-storage"),require("@cometchat-pro/react-native-calls"),require("react"),require("react-native"));else if("function"==typeof define&&define.amd)define(["@react-native-async-storage/async-storage","@cometchat-pro/react-native-calls","react","react-native"],t);else{var n="object"==typeof exports?t(require("@react-native-async-storage/async-storage"),require("@cometchat-pro/react-native-calls"),require("react"),require("react-native")):t(e["@react-native-async-storage/async-storage"],e["@cometchat-pro/react-native-calls"],e.react,e["react-native"]);for(var s in n)("object"==typeof exports?exports:e)[s]=n[s]}}(window,function(n,s,o,r){return function(n){var s={};function o(e){if(s[e])return s[e].exports;var t=s[e]={i:e,l:!1,exports:{}};return n[e].call(t.exports,t,t.exports,o),t.l=!0,t.exports}return o.m=n,o.c=s,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var s in t)o.d(n,s,function(e){return t[e]}.bind(null,s));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="",o(o.s=40)}([function(e,r,t){"use strict";r.__esModule=!0;var s=t(14),i=t(1),o=t(6),a=t(2),E=t(16),c=t(17),u=t(19),p=t(3),n=t(13);function S(e){return null!=e&&("string"==typeof e&&(e=e.trim()),"object"==typeof e&&0===Object.keys(e).length&&(e=void 0)),["",0,"0",!1,null,"null",void 0,"undefined"].includes(e)}function C(e){for(var s=[],t=1;t<arguments.length;t++)s[t-1]=arguments[t];return e.split("%s").reduce(function(e,t,n){return e+t+(s[n]||"")},"")}r.getChatHost=function(e){return e[i.APP_SETTINGS.KEYS.CHAT_HOST_OVERRIDE]?e[i.APP_SETTINGS.KEYS.CHAT_HOST_OVERRIDE]:e[i.APP_SETTINGS.KEYS.CHAT_HOST_APP_SPECIFIC]?e[i.APP_SETTINGS.KEYS.CHAT_HOST_APP_SPECIFIC]:e[i.APP_SETTINGS.KEYS.CHAT_HOST]},r.getJidHost=function(e){return e[i.APP_SETTINGS.KEYS.JID_HOST_OVERRIDE]?e[i.APP_SETTINGS.KEYS.JID_HOST_OVERRIDE]:e[i.APP_SETTINGS.KEYS.CHAT_HOST]},r.isObject=function(e){return e instanceof Object&&e.constructor===Object},r.isTruthy=function(e){return[!0,1,"1","true","TRUE"].includes(e)},r.isFalsy=S,r.getOrdinalSuffix=function(e){var t=e%10,n=e%100;return 1==t&&11!=n?e+"st":2==t&&12!=n?e+"nd":3==t&&13!=n?e+"rd":e+"th"},r.format=C,r.createUidFromJid=function(e){return e.substring(e.lastIndexOf("]")+1,e.lastIndexOf("@"))};var l=function(){function e(){}return e.log=function(e,t){},e.error=function(e,t){},e.info=function(e,t){},e}();function T(){return new Promise(function(t,n){o.makeApiCall("appSettings").then(function(e){s.LocalStorage.getInstance().set(i.LOCAL_STORE.KEY_APP_SETTINGS,e.data),e.data.MODE&&p.CometChat.setMode(e.data.MODE),t(e.data)},function(e){n(new a.CometChatException(e.error))})})}r.Logger=l,r.getCurrentTime=function(){return(new Date).getTime()},r.getAppSettings=function(){return new Promise(function(t,n){s.LocalStorage.getInstance().get(i.LOCAL_STORE.KEY_APP_SETTINGS).then(function(e){S(e)?T().then(function(e){t(e)},function(e){n(e)}):t(e)},function(e){n(e)})})},r.getUpdatedSettings=T,r.isImage=function(e){var t;return e.type&&e.type.toLowerCase().includes("image")&&(t=!0),t},r.isVideo=function(e){var t;return e.type&&e.type.toLowerCase().includes("video")&&(t=!0),t},r.isAudio=function(e){var t;return e.type&&e.type.toLowerCase().includes("audio")&&(t=!0),t},r.validateScope=function(e){return typeof e!==i.COMMON_UTILITY_CONSTANTS.TYPE_CONSTANTS.STRING?new a.CometChatException(JSON.parse(C(JSON.stringify(i.GENERAL_ERROR.MUST_BE_A_STRING),"SCOPE","SCOPE","Scope"))):S(e)?new a.CometChatException(JSON.parse(C(JSON.stringify(i.GENERAL_ERROR.INVALID),"SCOPE","SCOPE","scope","scope"))):e!=p.CometChat.GROUP_MEMBER_SCOPE.ADMIN&&e!=p.CometChat.GROUP_MEMBER_SCOPE.MODERATOR&&e!=p.CometChat.GROUP_MEMBER_SCOPE.PARTICIPANT?new a.CometChatException(i.GroupErrors.INVALID_SCOPE):void 0},r.validateUpdateGroup=function(e){return e.hasOwnProperty(i.GroupConstants.KEYS.GUID)?typeof e[i.GroupConstants.KEYS.GUID]!==i.COMMON_UTILITY_CONSTANTS.TYPE_CONSTANTS.STRING?new a.CometChatException(JSON.parse(C(JSON.stringify(i.GENERAL_ERROR.MUST_BE_A_STRING),"GUID","GUID","GUID"))):S(e[i.GroupConstants.KEYS.GUID])?new a.CometChatException(JSON.parse(C(JSON.stringify(i.GENERAL_ERROR.INVALID_GROUP_PROPERTY),"GUID","GUID","GUID","GUID"))):e.hasOwnProperty(i.GroupConstants.KEYS.NAME)&&""===e[i.GroupConstants.KEYS.NAME]?new a.CometChatException(JSON.parse(C(JSON.stringify(i.GENERAL_ERROR.EMPTY_STRING),"GROUP_NAME","GROUP_NAME","Group name"))):void 0:new a.CometChatException(JSON.parse(C(JSON.stringify(i.GENERAL_ERROR.PARAMETER_COMPULSORY),"GUID","GUID","GUID","GUID")))},r.validateJoinGroup=function(e,t,n){if(typeof e==i.COMMON_UTILITY_CONSTANTS.TYPE_CONSTANTS.OBJECT){if(!e.hasOwnProperty(i.GroupConstants.KEYS.GUID))return new a.CometChatException(JSON.parse(C(JSON.stringify(i.GENERAL_ERROR.PARAMETER_COMPULSORY),"GUID","GUID","GUID","GUID")));if(typeof e[i.GroupConstants.KEYS.GUID]!==i.COMMON_UTILITY_CONSTANTS.TYPE_CONSTANTS.STRING)return new a.CometChatException(JSON.parse(C(JSON.stringify(i.GENERAL_ERROR.MUST_BE_A_STRING),"GUID","GUID","GUID")));if(S(e[i.GroupConstants.KEYS.GUID]))return new a.CometChatException(JSON.parse(C(JSON.stringify(i.GENERAL_ERROR.INVALID_GROUP_PROPERTY),"GUID","GUID","GUID","GUID")));if(!e.hasOwnProperty(i.GroupConstants.KEYS.TYPE))return new a.CometChatException(JSON.parse(C(JSON.stringify(i.GENERAL_ERROR.PARAMETER_COMPULSORY),"GROUP_TYPE","GROUP_TYPE","Group type","Group type")));if(typeof e[i.GroupConstants.KEYS.TYPE]!==i.COMMON_UTILITY_CONSTANTS.TYPE_CONSTANTS.STRING)return new a.CometChatException(JSON.parse(C(JSON.stringify(i.GENERAL_ERROR.MUST_BE_A_STRING),"GROUP_TYPE","GROUP_TYPE","Group type")));if(S(e[i.GroupConstants.KEYS.TYPE]))return new a.CometChatException(JSON.parse(C(JSON.stringify(i.GENERAL_ERROR.INVALID_GROUP_PROPERTY),"GROUP_TYPE","GROUP_TYPE","type","type")));if(e[i.GroupConstants.KEYS.TYPE].toLowerCase()!=p.CometChat.GROUP_TYPE.PUBLIC&&e[i.GroupConstants.KEYS.TYPE].toLowerCase()!=p.CometChat.GROUP_TYPE.PASSWORD&&e[i.GroupConstants.KEYS.TYPE].toLowerCase()!=p.CometChat.GROUP_TYPE.PROTECTED&&e[i.GroupConstants.KEYS.TYPE].toLowerCase()!=p.CometChat.GROUP_TYPE.PRIVATE)return new a.CometChatException(i.GroupErrors.INVALID_GROUP_TYPE);if(e[i.GroupConstants.KEYS.TYPE].toLowerCase()==p.CometChat.GROUP_TYPE.PASSWORD){if(!e.hasOwnProperty(i.GroupConstants.KEYS.PASSWORD))return new a.CometChatException(JSON.parse(C(JSON.stringify(i.GENERAL_ERROR.PASSWORD_COMPULSORY),"PASSWORD","PASSWORD")));if(typeof e[i.GroupConstants.KEYS.PASSWORD]!==i.COMMON_UTILITY_CONSTANTS.TYPE_CONSTANTS.STRING)return new a.CometChatException(JSON.parse(C(JSON.stringify(i.GENERAL_ERROR.MUST_BE_A_STRING),"PASSWORD","PASSWORD","Password")));if(S(e[i.GroupConstants.KEYS.PASSWORD]))return new a.CometChatException(JSON.parse(C(JSON.stringify(i.GENERAL_ERROR.INVALID_GROUP_PROPERTY),"PASSWORD","PASSWORD","password","password")))}}else{if(void 0!==e){if(typeof e!==i.COMMON_UTILITY_CONSTANTS.TYPE_CONSTANTS.STRING)return new a.CometChatException(JSON.parse(C(JSON.stringify(i.GENERAL_ERROR.MUST_BE_A_STRING),"GUID","GUID","GUID")));if(S(e))return new a.CometChatException(JSON.parse(C(JSON.stringify(i.GENERAL_ERROR.INVALID_GROUP_PROPERTY),"GUID","GUID","GUID","GUID")))}if(void 0!==t){if(typeof t!==i.COMMON_UTILITY_CONSTANTS.TYPE_CONSTANTS.STRING)return new a.CometChatException(JSON.parse(C(JSON.stringify(i.GENERAL_ERROR.MUST_BE_A_STRING),"GROUP_TYPE","GROUP_TYPE","Group type")));if(S(t))return new a.CometChatException(JSON.parse(C(JSON.stringify(i.GENERAL_ERROR.INVALID_GROUP_PROPERTY),"GROUP_TYPE","GROUP_TYPE","type","type")));if(t.toLowerCase()!=p.CometChat.GROUP_TYPE.PUBLIC&&t.toLowerCase()!=p.CometChat.GROUP_TYPE.PASSWORD&&t.toLowerCase()!=p.CometChat.GROUP_TYPE.PROTECTED&&t.toLowerCase()!=p.CometChat.GROUP_TYPE.PRIVATE)return new a.CometChatException(i.GroupErrors.INVALID_GROUP_TYPE);if(t.toLowerCase()==p.CometChat.GROUP_TYPE.PASSWORD){if(typeof n!==i.COMMON_UTILITY_CONSTANTS.TYPE_CONSTANTS.STRING)return new a.CometChatException(JSON.parse(C(JSON.stringify(i.GENERAL_ERROR.MUST_BE_A_STRING),"PASSWORD","PASSWORD","Password")));if(S(n))return new a.CometChatException(JSON.parse(C(JSON.stringify(i.GENERAL_ERROR.INVALID_GROUP_PROPERTY),"PASSWORD","PASSWORD","password","password")))}}}},r.validateCreateGroup=function(e){if(!e.hasOwnProperty(i.GroupConstants.KEYS.GUID))return new a.CometChatException(JSON.parse(C(JSON.stringify(i.GENERAL_ERROR.PARAMETER_COMPULSORY),"GUID","GUID","GUID","GUID")));if(typeof e[i.GroupConstants.KEYS.GUID]!==i.COMMON_UTILITY_CONSTANTS.TYPE_CONSTANTS.STRING)return new a.CometChatException(JSON.parse(C(JSON.stringify(i.GENERAL_ERROR.MUST_BE_A_STRING),"GUID","GUID","GUID")));if(S(e[i.GroupConstants.KEYS.GUID]))return new a.CometChatException(JSON.parse(C(JSON.stringify(i.GENERAL_ERROR.INVALID_GROUP_PROPERTY),"GUID","GUID","GUID","GUID")));if(!e.hasOwnProperty(i.GroupConstants.KEYS.NAME))return new a.CometChatException(JSON.parse(C(JSON.stringify(i.GENERAL_ERROR.PARAMETER_COMPULSORY),"GROUP_NAME","GROUP_NAME","Group name","Group name")));if(typeof e[i.GroupConstants.KEYS.NAME]!==i.COMMON_UTILITY_CONSTANTS.TYPE_CONSTANTS.STRING)return new a.CometChatException(JSON.parse(C(JSON.stringify(i.GENERAL_ERROR.MUST_BE_A_STRING),"GROUP_NAME","GROUP_NAME","Group name")));if(S(e[i.GroupConstants.KEYS.NAME]))return new a.CometChatException(JSON.parse(C(JSON.stringify(i.GENERAL_ERROR.INVALID_GROUP_PROPERTY),"GROUP_NAME","GROUP_NAME","name","name")));if(!e.hasOwnProperty(i.GroupConstants.KEYS.TYPE))return new a.CometChatException(JSON.parse(C(JSON.stringify(i.GENERAL_ERROR.PARAMETER_COMPULSORY),"GROUP_TYPE","GROUP_TYPE","Group type","Group type")));if(typeof e[i.GroupConstants.KEYS.TYPE]!==i.COMMON_UTILITY_CONSTANTS.TYPE_CONSTANTS.STRING)return new a.CometChatException(JSON.parse(C(JSON.stringify(i.GENERAL_ERROR.MUST_BE_A_STRING),"GROUP_TYPE","GROUP_TYPE","Group type")));if(S(e[i.GroupConstants.KEYS.TYPE]))return new a.CometChatException(JSON.parse(C(JSON.stringify(i.GENERAL_ERROR.INVALID_GROUP_PROPERTY),"GROUP_TYPE","GROUP_TYPE","type","type")));if(e[i.GroupConstants.KEYS.TYPE].toLowerCase()!=p.CometChat.GROUP_TYPE.PUBLIC&&e[i.GroupConstants.KEYS.TYPE].toLowerCase()!=p.CometChat.GROUP_TYPE.PASSWORD&&e[i.GroupConstants.KEYS.TYPE].toLowerCase()!=p.CometChat.GROUP_TYPE.PROTECTED&&e[i.GroupConstants.KEYS.TYPE].toLowerCase()!=p.CometChat.GROUP_TYPE.PRIVATE)return new a.CometChatException(i.GroupErrors.INVALID_GROUP_TYPE);if(e[i.GroupConstants.KEYS.TYPE].toLowerCase()==p.CometChat.GROUP_TYPE.PASSWORD){if(!e.hasOwnProperty(i.GroupConstants.KEYS.PASSWORD))return new a.CometChatException(JSON.parse(C(JSON.stringify(i.GENERAL_ERROR.PASSWORD_COMPULSORY),"PASSWORD","PASSWORD")));if(typeof e[i.GroupConstants.KEYS.PASSWORD]!==i.COMMON_UTILITY_CONSTANTS.TYPE_CONSTANTS.STRING)return new a.CometChatException(JSON.parse(C(JSON.stringify(i.GENERAL_ERROR.MUST_BE_A_STRING),"PASSWORD","PASSWORD","Password")));if(S(e[i.GroupConstants.KEYS.PASSWORD]))return new a.CometChatException(JSON.parse(C(JSON.stringify(i.GENERAL_ERROR.INVALID_GROUP_PROPERTY),"PASSWORD","PASSWORD","password","password")))}if(e.hasOwnProperty(i.GroupConstants.KEYS.TAGS)){if(!Array.isArray(e[i.GroupConstants.KEYS.TAGS]))return new a.CometChatException(JSON.parse(C(JSON.stringify(i.GENERAL_ERROR.MUST_BE_AN_ARRAY),"GROUP_TAGS","GROUP_TAGS","Group tags")));if(0===e[i.GroupConstants.KEYS.TAGS].length)return new a.CometChatException(JSON.parse(C(JSON.stringify(i.GENERAL_ERROR.EMPTY_ARRAY),"GROUP_TAGS","GROUP_TAGS","Group tags")))}},r.validateId=function(e,t){if("user"===t){if(typeof e!==i.COMMON_UTILITY_CONSTANTS.TYPE_CONSTANTS.STRING)return new a.CometChatException(JSON.parse(C(JSON.stringify(i.GENERAL_ERROR.MUST_BE_A_STRING),"UID","UID","UID")));if(S(e))return new a.CometChatException(JSON.parse(C(JSON.stringify(i.GENERAL_ERROR.INVALID),"UID","UID","UID","UID")))}if("group"===t){if(typeof e!==i.COMMON_UTILITY_CONSTANTS.TYPE_CONSTANTS.STRING)return new a.CometChatException(JSON.parse(C(JSON.stringify(i.GENERAL_ERROR.MUST_BE_A_STRING),"GUID","GUID","GUID")));if(S(e))return new a.CometChatException(JSON.parse(C(JSON.stringify(i.GENERAL_ERROR.INVALID),"GUID","GUID","GUID","GUID")))}},r.validateHideMessagesFromBlockedUsers=function(e){if(typeof e!==i.COMMON_UTILITY_CONSTANTS.TYPE_CONSTANTS.BOOLEAN)return new a.CometChatException(JSON.parse(C(JSON.stringify(i.GENERAL_ERROR.MUST_BE_A_BOOLEAN),"HIDE_MESSAGES_FROM_BLOCKED_USERS","HIDE_MESSAGES_FROM_BLOCKED_USERS","hideMessagesFromBlockedUsers")))},r.validateArray=function(e,t){var n="List should be an array.";return n="blockUsers"===t?"blockUsers() method accepts an array of users.":"unblockUsers"===t?"unblockUsers() method accepts an array of users.":"groupMembers"===t?"addMembersToGroup() method accepts members list as an array of users.":"addMembersToGroup() method accepts bannedMembers list as an array of users.",typeof e!=i.COMMON_UTILITY_CONSTANTS.TYPE_CONSTANTS.OBJECT?new a.CometChatException(JSON.parse(C(JSON.stringify(i.GENERAL_ERROR.INVALID_ARRAY),"USER_LIST","USER_LIST",n))):Array.isArray(e)?void 0:new a.CometChatException(JSON.parse(C(JSON.stringify(i.GENERAL_ERROR.INVALID_ARRAY),"USER_LIST","USER_LIST",n)))},r.validateMsgId=function(e){return isNaN(e)?new a.CometChatException(JSON.parse(C(JSON.stringify(i.GENERAL_ERROR.MUST_BE_A_NUMBER),"MESSAGE_ID","MESSAGE_ID","Message Id"))):S(e)?new a.CometChatException(n.ERRORS.PARAMETER_MISSING):void 0},r.validateChatType=function(e){return typeof e!==i.COMMON_UTILITY_CONSTANTS.TYPE_CONSTANTS.STRING?new a.CometChatException(JSON.parse(C(JSON.stringify(i.GENERAL_ERROR.MUST_BE_A_STRING),"RECEIVER_TYPE","RECEIVER_TYPE","Receiver type"))):S(e)?new a.CometChatException(JSON.parse(C(JSON.stringify(i.GENERAL_ERROR.INVALID),"RECEIVER_TYPE","RECEIVER_TYPE","receiver type","receiver type"))):e!=i.MessageConstatnts.RECEIVER_TYPE.GROUP&&e!=i.MessageConstatnts.RECEIVER_TYPE.USER?new a.CometChatException(i.MessageErrors.INVALID_RECEIVER_TYPE):void 0},r.validateMessage=function(e){var t=e;if(typeof t.getReceiverId()!==i.COMMON_UTILITY_CONSTANTS.TYPE_CONSTANTS.STRING)return new a.CometChatException(JSON.parse(C(JSON.stringify(i.GENERAL_ERROR.MUST_BE_A_STRING),"RECEIVER_ID","RECEIVER_ID","Receiver Id")));if(S(t.getReceiverId()))return new a.CometChatException(JSON.parse(C(JSON.stringify(i.GENERAL_ERROR.INVALID),"RECEIVER_ID","RECEIVER_ID","receiver id","receiver id")));if(typeof t.getReceiverType()!==i.COMMON_UTILITY_CONSTANTS.TYPE_CONSTANTS.STRING)return new a.CometChatException(JSON.parse(C(JSON.stringify(i.GENERAL_ERROR.MUST_BE_A_STRING),"RECEIVER_TYPE","RECEIVER_TYPE","Receiver Type")));if(S(t.getReceiverType()))return new a.CometChatException(JSON.parse(C(JSON.stringify(i.GENERAL_ERROR.INVALID),"RECEIVER_TYPE","RECEIVER_TYPE","receiver type","receiver type")));if(t.getReceiverType()!=i.MessageConstatnts.RECEIVER_TYPE.GROUP&&t.getReceiverType()!=i.MessageConstatnts.RECEIVER_TYPE.USER)return new a.CometChatException(i.MessageErrors.INVALID_RECEIVER_TYPE);if(e instanceof E.TextMessage){var n=e;if(typeof n.getText()!==i.COMMON_UTILITY_CONSTANTS.TYPE_CONSTANTS.STRING)return new a.CometChatException(JSON.parse(C(JSON.stringify(i.GENERAL_ERROR.MUST_BE_A_STRING),"MESSAGE_TEXT","MESSAGE_TEXT","Message text")));if(""===n.getText().trim())return new a.CometChatException(JSON.parse(C(JSON.stringify(i.GENERAL_ERROR.EMPTY_STRING),"MESSAGE_TEXT","MESSAGE_TEXT","Message text")))}if(e instanceof c.MediaMessage){var s=e;if(s.getData()&&s.getData().hasOwnProperty("attachments")){var o=s.getAttachment();if(!o.getExtension())return new a.CometChatException(JSON.parse(C(JSON.stringify(i.GENERAL_ERROR.MISSING_KEY),"extension","Attachment")));if(!o.getMimeType())return new a.CometChatException(JSON.parse(C(JSON.stringify(i.GENERAL_ERROR.MISSING_KEY),"mimeType","Attachment")));if(!o.getName())return new a.CometChatException(JSON.parse(C(JSON.stringify(i.GENERAL_ERROR.MISSING_KEY),"name","Attachment")));if(!o.getUrl())return new a.CometChatException(JSON.parse(C(JSON.stringify(i.GENERAL_ERROR.MISSING_KEY),"url","Attachment")))}else{if(typeof s.file!==i.COMMON_UTILITY_CONSTANTS.TYPE_CONSTANTS.OBJECT)return new a.CometChatException(JSON.parse(C(JSON.stringify(i.GENERAL_ERROR.MUST_BE_A_OBJECT),"MEDIA_OBJECT","MEDIA_OBJECT","Media object")));if(S(s.file))return new a.CometChatException(JSON.parse(C(JSON.stringify(i.GENERAL_ERROR.INVALID),"MEDIA_OBJECT","MEDIA_OBJECT","Media object","Media object")));if("image"==s.getType()){if(!r.isImage(s.file))return new a.CometChatException(JSON.parse(C(JSON.stringify(i.GENERAL_ERROR.INVALID_MEDIA_FILE),"IMAGE_FILE","IMAGE_FILE")))}else if("video"==s.getType()){if(!r.isVideo(s.file))return new a.CometChatException(JSON.parse(C(JSON.stringify(i.GENERAL_ERROR.INVALID_MEDIA_FILE),"VIDEO_FILE","VIDEO_FILE")))}else if("audio"==s.getType()&&!r.isAudio(s.file))return new a.CometChatException(JSON.parse(C(JSON.stringify(i.GENERAL_ERROR.INVALID_MEDIA_FILE),"AUDIO_FILE","AUDIO_FILE")))}}if(e instanceof u.CustomMessage&&S(e.getCustomData()))return new a.CometChatException(JSON.parse(C(JSON.stringify(i.GENERAL_ERROR.INVALID),"CUSTOM_DATA","CUSTOM_DATA","custom data","custom data")))},r.validateCreateUser=function(e){if(!e.hasOwnProperty(i.UserConstants.UID))return new a.CometChatException(JSON.parse(C(JSON.stringify(i.GENERAL_ERROR.PARAMETER_COMPULSORY),"UID","UID","UID","UID")));if(typeof e[i.UserConstants.UID]!==i.COMMON_UTILITY_CONSTANTS.TYPE_CONSTANTS.STRING)return new a.CometChatException(JSON.parse(C(JSON.stringify(i.GENERAL_ERROR.MUST_BE_A_STRING),"UID","UID","UID")));if(S(e[i.UserConstants.UID]))return new a.CometChatException(JSON.parse(C(JSON.stringify(i.GENERAL_ERROR.INVALID_USER_PROPERTY),"UID","UID","UID","UID")));if(!e.hasOwnProperty(i.UserConstants.NAME))return new a.CometChatException(JSON.parse(C(JSON.stringify(i.GENERAL_ERROR.PARAMETER_COMPULSORY),"USER_NAME","USER_NAME","User name","User name")));if(typeof e[i.UserConstants.NAME]!==i.COMMON_UTILITY_CONSTANTS.TYPE_CONSTANTS.STRING)return new a.CometChatException(JSON.parse(C(JSON.stringify(i.GENERAL_ERROR.MUST_BE_A_STRING),"USER_NAME","USER_NAME","User name")));if(S(e[i.UserConstants.NAME]))return new a.CometChatException(JSON.parse(C(JSON.stringify(i.GENERAL_ERROR.INVALID_USER_PROPERTY),"USER_NAME","USER_NAME","name","name")));if(e.hasOwnProperty(i.UserConstants.AVATAR)&&""===e[i.UserConstants.AVATAR])return new a.CometChatException(JSON.parse(C(JSON.stringify(i.GENERAL_ERROR.EMPTY_STRING),"USER_AVATAR","USER_AVATAR","User avatar")));if(e.hasOwnProperty(i.UserConstants.META_DATA)&&""===e[i.UserConstants.META_DATA])return new a.CometChatException(JSON.parse(C(JSON.stringify(i.GENERAL_ERROR.EMPTY_STRING),"USER_METADATA","USER_METADATA","User metadata")));if(e.hasOwnProperty(i.UserConstants.LINK)&&""===e[i.UserConstants.LINK])return new a.CometChatException(JSON.parse(C(JSON.stringify(i.GENERAL_ERROR.EMPTY_STRING),"USER_LINK","USER_LINK","User link")));if(e.hasOwnProperty(i.UserConstants.STATUS_MESSAGE)&&""===e[i.UserConstants.STATUS_MESSAGE])return new a.CometChatException(JSON.parse(C(JSON.stringify(i.GENERAL_ERROR.EMPTY_STRING),"USER_STATUS_MESSAGE","USER_STATUS_MESSAGE","User status message")));if(e.hasOwnProperty(i.UserConstants.ROLE)&&""===e[i.UserConstants.ROLE])return new a.CometChatException(JSON.parse(C(JSON.stringify(i.GENERAL_ERROR.EMPTY_STRING),"USER_ROLE","USER_ROLE","User role")));if(e.hasOwnProperty(i.UserConstants.TAGS)){if(!Array.isArray(e[i.UserConstants.TAGS]))return new a.CometChatException(JSON.parse(C(JSON.stringify(i.GENERAL_ERROR.MUST_BE_AN_ARRAY),"USER_TAGS","USER_TAGS","User tags")));if(0===e[i.UserConstants.TAGS].length)return new a.CometChatException(JSON.parse(C(JSON.stringify(i.GENERAL_ERROR.EMPTY_ARRAY),"USER_TAGS","USER_TAGS","User tags")))}},r.validateUpdateUser=function(e){return e.hasOwnProperty(i.UserConstants.UID)?typeof e[i.UserConstants.UID]!==i.COMMON_UTILITY_CONSTANTS.TYPE_CONSTANTS.STRING?new a.CometChatException(JSON.parse(C(JSON.stringify(i.GENERAL_ERROR.MUST_BE_A_STRING),"UID","UID","UID"))):S(e[i.UserConstants.UID])?new a.CometChatException(JSON.parse(C(JSON.stringify(i.GENERAL_ERROR.INVALID_USER_PROPERTY),"UID","UID","UID","UID"))):e.hasOwnProperty(i.UserConstants.NAME)&&""===e[i.UserConstants.NAME]?new a.CometChatException(JSON.parse(C(JSON.stringify(i.GENERAL_ERROR.EMPTY_STRING),"USER_NAME","USER_NAME","User name"))):void 0:new a.CometChatException(JSON.parse(C(JSON.stringify(i.GENERAL_ERROR.PARAMETER_COMPULSORY),"UID","UID","UID","UID")))},r.validateConversationType=function(e){return typeof e!==i.COMMON_UTILITY_CONSTANTS.TYPE_CONSTANTS.STRING?new a.CometChatException(JSON.parse(C(JSON.stringify(i.GENERAL_ERROR.MUST_BE_A_STRING),"CONVERSATION_TYPE","CONVERSATION_TYPE","Conversation type"))):S(e)?new a.CometChatException(JSON.parse(C(JSON.stringify(i.GENERAL_ERROR.INVALID),"CONVERSATION_TYPE","CONVERSATION_TYPE","conversation type","conversation type"))):(e=e.toLowerCase())!=p.CometChat.RECEIVER_TYPE.USER&&e!=p.CometChat.RECEIVER_TYPE.GROUP?new a.CometChatException(i.ConversationErrors.INVALID_CONVERSATION_TYPE):void 0},r.getKeyprefix=function(e,t){switch(e){case i.LOCAL_STORE.COMMON_STORE:return C(i.LOCAL_STORE.KEY_STRING,C(i.LOCAL_STORE.STORE_STRING,p.CometChat.getAppId(),i.LOCAL_STORE.COMMON_STORE),t);case i.LOCAL_STORE.KEYS_STORE:return C(i.LOCAL_STORE.KEY_STRING,C(i.LOCAL_STORE.STORE_STRING,p.CometChat.getAppId(),i.LOCAL_STORE.KEYS_STORE),t);case i.LOCAL_STORE.MESSAGES_STORE:return C(i.LOCAL_STORE.KEY_STRING,C(i.LOCAL_STORE.STORE_STRING,p.CometChat.getAppId(),i.LOCAL_STORE.MESSAGES_STORE),t);case i.LOCAL_STORE.MESSAGE_LISTENERS_LIST:return C(i.LOCAL_STORE.KEY_STRING,C(i.LOCAL_STORE.STORE_STRING,p.CometChat.getAppId(),i.LOCAL_STORE.MESSAGE_LISTENERS_LIST),t);case i.LOCAL_STORE.USERS_STORE:return C(i.LOCAL_STORE.KEY_STRING,C(i.LOCAL_STORE.STORE_STRING,p.CometChat.getAppId(),i.LOCAL_STORE.USERS_STORE),t)}}},function(e,t,n){"use strict";t.__esModule=!0;var s,o,r,i=n(2);t.constants={DEFAULT_STORE:"cometchat",MSG_VER_PRE:"store-ver-pre",MSG_VER_POST:"store-ver-post"},t.DEFAULT_VALUES={ZERO:0,MSGS_LIMIT:30,MSGS_MAX_LIMIT:100,USERS_LIMIT:30,USERS_MAX_LIMIT:100,GROUPS_LIMIT:30,GROUPS_MAX_LIMIT:100,CONVERSATION_MAX_LIMIT:50,CALL_TIMEOUT:45,DEFAULT_MSG_ID:0,DEFAULT_MAX_TYPING_INDICATOR_LIMIT:5,REGION_DEFAULT:"eu",REGION_DEFAULT_EU:"eu",REGION_DEFAULT_US:"us",REGION_DEFAULT_IN:"in",REGION_DEFAULT_PRIVATE:"private"},(s=t.GroupType||(t.GroupType={})).Public="public",s.Private="private",s.Protected="protected",s.Password="password",t.GROUP_TYPE={PUBLIC:"public",PRIVATE:"private",PROTECTED:"password",PASSWORD:"password"},(o=t.GroupMemberScope||(t.GroupMemberScope={})).Admin="admin",o.Moderator="moderator",o.Member="member",t.GROUP_MEMBER_SCOPE={ADMIN:"admin",MODERATOR:"moderator",PARTICIPANT:"participant"},t.APPINFO={platform:"REACT_NATIVE",sdkVersion:"v3.0.0-beta2",apiVersion:"v3.0",sdkVersionWithUnderScore:"3_0_0_beta2"},t.SDKHeader={platform:"react-native",sdkVersion:"3.0.0-beta2",sdk:"%s@%s"},t.WS={CONVERSATION:{TYPE:{CHAT:"chat",GROUP_CHAT:"groupchat"}}},t.ANALYTICS={analyticsHost:"metrics-%s.cometchat.io",analyticsVersion:"v1"},t.LOCAL_STORE={COMMON_STORE:"common_store",MESSAGE_LISTENERS_LIST:"message_listeners_list",USERS_STORE:"users_store",MESSAGES_STORE:"messages_store",KEYS_STORE:"keys_store",STORE_STRING:"%s:%s",KEY_STRING:"%s/%s",KEY_USER:"user",KEY_APP_SETTINGS:"app_settings",KEY_APP_ID:"appId",KEY_DEVICE_ID:"deviceId",KEY_MESSAGE_LISTENER_LIST:"all"},t.ResponseConstants={RESPONSE_KEYS:{KEY_DATA:"data",KEY_META:"meta",KEY_CURSOR:"cursor",KEY_ACTION:"action",KEY_MESSAGE:"message",KEY_ERROR:"error",KEY_ERROR_DETAILS:"details",KEY_ERROR_CODE:"code",KEY_ERROR_MESSAGE:"message",KEY_AUTH_TOKEN:"authToken",KEY_WS_CHANNEL:"wsChannel",KEY_IDENTITY:"identity",KEY_SERVICE:"identity",KEY_ENTITIES:"entities",KEY_ENTITITY:"entity",KEY_ENTITYTYPE:"entityType",KEY_ATTACHMENTS:"attachments",CODE_REQUEST_OK:200,CODE_BAD_REQUEST:401,UNREAD_UNDELIVERED_KEYS:{ENTITY:"entity",ENTITY_TYPE:"entityType",ENTITY_Id:"entityId",COUNT:"count"},GROUP_MEMBERS_RESPONSE:{SUCCESS:"success",ERROR:"error",MESSAGE:"message"},KEY_ENTITY_TYPE:{USER:"user",GROUP:"group"}}},t.DELIVERY_RECEIPTS={RECEIVER_ID:"receiverId",RECEIVER_TYPE:"type",RECIPIENT:"recipient",MESSAGE_ID:"messageId",RECEIVED:"delivered",DELIVERED_AT:"deliveredAt",ID:"id",TIME:"time",DELIVERED_TO_ME_AT:"deliveredToMeAt"},t.READ_RECEIPTS={RECEIVER_ID:"receiverId",RECEIVER_TYPE:"type",RECIPIENT:"recipient",MESSAGE_ID:"messageId",READ:"read",READ_AT:"readAt",ID:"id",TIME:"time",READ_BY_ME_AT:"readByMeAt"},t.MessageConstatnts={TYPE:{TEXT:"text",MEDIA:"media",IMAGE:"image",VIDEO:"video",AUDIO:"audio",FILE:"file",CUSTOM:"custom"},CATEGORY:{MESSAGE:"message",ACTION:"action",CALL:"call",CUSTOM:"custom"},RECEIVER_TYPE:{USER:"user",GROUP:"group"},KEYS:{ATTATCHMENT:"attatchment",ATTATCHMENTS:"attachments",ACTION:"action",TYPE:"type",DATA:"data",ID:"id",MUID:"muid",SENDER:"sender",RECEIVER:"receiver",RECEIVER_ID:"receiverId",CATEGORY:"category",RECEIVER_TYPE:"receiverType",SENT_AT:"sentAt",STATUS:"status",TEXT:"text",URL:"url",METADATA:"metadata",RECEIPTS:"receipts",MY_RECEIPTS:"myReceipt",CUSTOM_DATA:"customData",CUSTOM_SUB_TYPE:"subType",RESOURCE:"resource"},KNOWN_MEDIA_TYPE:{IMAGE:[],VIDEO:[],AUDIO:[],FILE:[]},PAGINATION:{AFFIX:{APPEND:"append",PREPEND:"prepend"},CURSOR_FILEDS:{ID:"id",SENT_AT:"sentAt"},CURSOR_AFFIX_DEFAULT:"prepend",CURSOR_FIELD_DEFAULT:"sentAt",KEYS:{PER_PAGE:"per_page",CURSOR_AFFIX:"cursorAffix",AFFIX:"affix",CURSOR_FIELD:"cursorField",CURSOR_VALUE:"cursorValue",UID:"uid",SENT_AT:"sentAt",ID:"id",CURRENT_PAGE:"page",UNREAD:"unread",HIDE_MESSAGES_FROM_BLOCKED_USER:"hideMessagesFromBlockedUsers",SEARCH_KEY:"searchKey",ONLY_UPDATES:"onlyUpdates",UPDATED_AT:"updatedAt",CATEGORY:"category",CATEGORIES:"categories",TYPE:"type",TYPES:"types",HIDE_REPLIES:"hideReplies"}}},t.ATTACHMENTS_CONSTANTS={KEYS:{EXTENSION:"extension",MIME_TYPE:"mimeType",NAME:"name",SIZE:"size",URL:"url"}},(r=t.MessageCategory||(t.MessageCategory={})).ACTION="action",r.MESSAGE="message",r.CALL="call",r.CUSTOM="custom",t.TYPING_NOTIFICATION={RECEIVER_ID:"receiverId",RECEIVER_TYPE:"receiverType",META:"metadata",KEYS:{TYPING_NOTIFICATION:"typingNotification",TIMESTAMP:"timestamp"},ACTIONS:{STARTED:"started",ENDED:"ended"}},t.ActionConstatnts={ACTION_SUBJECTS:{ACTION_ON:"on",ACTION_BY:"by",ACTION_FOR:"for"},ACTION_ENTITY_TYPE:{GROUP_USER:"groupuser",USER:"user",GROUP:"group",MESSAGE:"message"},ACTION_KEYS:{ACTION_CREATED:"created",ACTION_UPDATED:"updated",ACTION_DELETED:"deleted",ENTITIES:"entities",ENTITY:"entity",ENTITY_TYPE:"entityType",TYPE_MEMBER_JOINED:"joined",TYPE_MEMBER_LEFT:"left",TYPE_MEMBER_KICKED:"kicked",TYPE_MEMBER_BANNED:"banned",TYPE_MEMBER_UNBANNED:"unbanned",TYPE_MEMBER_INVITED:"invited",TYPE_MEMBER_ADDED:"added",ACTION_SCOPE_CHANGED:"scopeChanged",ACTION_TYPE_USER:"user",ACTION_TYPE_GROUP:"group",ACTION_TYPE_GROUP_MEMBER:"groupMember",TYPE_MESSAGE_EDITED:"edited",TYPE_MESSAGE_DELETED:"deleted",ACTION_TYPE_CALL:"call",EXTRAS:"extras",SCOPE:"scope",NEW:"new",OLD:"old"},ActionMessages:{ACTION_GROUP_JOINED_MESSAGE:"%s joined",ACTION_GROUP_LEFT_MESSAGE:"%s left",ACTION_MEMBER_KICKED_MESSAGE:"%s kicked %s",ACTION_MEMBER_BANNED_MESSAGE:"%s banned %s",ACTION_MEMBER_UNBANNED_MESSAGE:"%s unbanned %s",ACTION_MEMBER_INVITED_MESSAGE:"%s banned %s",ACTION_MESSAGE_EDITED_MESSAGE:" Message Edited",ACTION_MESSAGE_DELETED_MESSAGE:"Message Deleted",ACTION_MEMBER_SCOPE_CHANGED:"%s made %s %s",ACTION_MEMBER_ADDED_TO_GROUP:"%s added %s"},ACTION_TYPE:{TYPE_MEMBER_JOINED:"joined",TYPE_MEMBER_LEFT:"left",TYPE_MEMBER_KICKED:"kicked",TYPE_MEMBER_BANNED:"banned",TYPE_MEMBER_UNBANNED:"unbanned",TYPE_MEMBER_INVITED:"invited",TYPE_MEMBER_SCOPE_CHANGED:"scopeChanged",TYPE_MESSAGE:"message",TYPE_MESSAGE_EDITED:"edited",TYPE_MESSAGE_DELETED:"deleted",TYPE_MEMBER_ADDED:"added"},ACTIONS:{MEMBER_ADDED:"added",MEMBER_JOINED:"joined",MEMBER_LEFT:"left",MEMBER_KICKED:"kicked",MEMBER_BANNED:"banned",MEMBER_UNBANNED:"unbanned",MEMBER_INVITED:"invited",MEMBER_SCOPE_CHANGED:"scopeChanged",MESSAGE_EDITED:"edited",MESSSAGE_DELETED:"deleted",TYPE_USER:"user",TYPE_GROUP:"group",TYPE_GROUP_MEMBER:"groupMember"}},t.BlockedUsersConstants={REQUEST_KEYS:{DIRECTIONS:{BOTH:"both",HAS_BLOCKED_ME:"hasBlockedMe",BLOCKED_BY_ME:"blockedByMe"}}},t.CallConstants={CALL_MODE:{DEFAULT:"DEFAULT",SPOTLIGHT:"SPOTLIGHT",SINGLE:"SINGLE"},AUDIO_MODE:{SPEAKER:"SPEAKER",EARPIECE:"EARPIECE",BLUETOOTH:"BLUETOOTH",HEADPHONES:"HEADPHONES"},CALL_TYPE:{AUDIO:"audio",VIDEO:"video"},RECEIVER_TYPE_GROUP:"group",RECEIVER_TYPE_USER:"user",CALL_KEYS:{CALL_DATA:"data",CALL_ID:"id",CALL_SESSION_ID:"sessionid",CALL_RECEIVER:"receiver",CALL_SENDER:"sender",CALL_RECEIVER_TYPE:"receiverType",CALL_STATUS:"status",CALL_TYPE:"type",CALL_INITIATED_AT:"initiatedAt",CALL_JOINED_AT:"joinedAt",CALL_LEFT_AT:"leftAt",CALL_METADATA:"metadata",CALL_ENTITIES:"entities",CALL_ENTITY_TYPE:"entityType",CALL_ENTITY:"entity",CALL_ENTITY_USER:"user",CALL_ENTITY_GROUP:"group"},CALL_STATUS:{INITIATED:"initiated",ONGOING:"ongoing",UNANSWERED:"unanswered",REJECTED:"rejected",BUSY:"busy",CANCELLED:"cancelled",ENDED:"ended"}},t.GroupConstants={KEYS:{NAME:"name",GUID:"guid",TYPE:"type",PASSWORD:"password",ICON:"icon",DESCRIPTION:"description",OWNER:"owner",METADATA:"metadata",CREATED_AT:"createdAt",UPDATED_AT:"updatedAt",HAS_JOINED:"hasJoined",WS_CHANNEL:"wsChannel",TAGS:"tags"}},t.GroupMemersConstans={KEYS:{SCOPE:"scope",UID:"uid",GUID:"guid",USER:"user",NAME:"name"}},t.UserConstants={UID:"uid",NAME:"name",AUTH_TOKEN:"authToken",AVATAR:"avatar",LAST_ACTIVE_AT:"lastActiveAt",LINK:"link",META_DATA:"metadata",ROLE:"role",STATUS:"status",STATUS_MESSAGE:"statusMessage",USER_NAME:"user_name",TAGS:"tags"},t.Errors={ERROR_IO_EXCEPTION:"ERROR_IO_EXCEPTION",ERROR_JSON_EXCEPTION:"ERROR_JSON_EXCEPTION",ERROR_PASSWORD_MISSING:"ERROR_PASSWORD_MISSING",ERROR_LIMIT_EXCEEDED:"ERROR_LIMIT_EXCEEDED",ERROR_USER_NOT_LOGGED_IN:"ERROR_USER_NOT_LOGGED_IN",ERROR_INVALID_GUID:"ERROR_INVALID_GUID",ERROR_PASSWORD_MISSING_MESSAGE:"Password is mandatory for a password group",ERROR_LIMIT_EXCEEDED_MESSAGE:"Limit Exceeded Max limit of %s",ERROR_USER_NOT_LOGGED_IN_MESSAGE:"Please log in to CometChat before calling this method",ERROR_INVALID_GUID_MESSAGE:"Please provide a valid GUID",ERROR_DEFAULT_MESSAGE:"Something went wrong",ERR_SETTINGS_HASH_OUTDATED:"ERR_SETTINGS_HASH_OUTDATED",ERR_NO_AUTH:"ERR_NO_AUTH"},t.CALL_ERROR={CALL_ALREADY_INITIATED:{code:"CALL_ALREADY_INITIATED",name:"CALL_ALREADY_INITIATED",message:"There is already call in progress",details:{}},ERROR_IN_CALLING:{code:"CALL_IN_PROGRESS",name:"CALL_ALREADY_INITIATED",message:"There is already call in progress",details:{}},CANNOT_ACCEPT_CALL:{code:"OTHER_CALL_ONGOING",name:"OTHER_CALL_ONGOING",message:"There is already a call in progress",details:{}},NOT_INITIALIZED:{code:"NOT_INITIALIZED",name:"NOT_INITIALIZED",message:"Please call the CometChat.init() method before calling any other methods related to CometChat.",details:{}},NOT_LOGGED_IN:{code:"NOT_LOGGED_IN",name:"NOT_LOGGED_IN",message:"Please login before starting a call.",details:{}},SESSION_ID_REQUIRED:{code:"SESSION_ID_REQUIRED",name:"SESSION_ID_REQUIRED",message:"Please make sure you are passing correct session id.",details:{}},JWT_NOT_FOUND:{code:"JWT_NOT_FOUND",name:"JWT_NOT_FOUND",message:"There was some issue while fetching JWT from API.",details:{}}},t.PARAMETER_ERROR={PARAMETER_REQUIRED:{code:"%s_NOT_PROVIDED",name:"%s_NOT_PROVIDED",message:"please provide the %s.",details:{}}},t.GENERAL_ERROR={MUST_BE_A_STRING:{code:"INVALID_%s",name:"INVALID_%s",message:"%s should be a string.",details:{}},MUST_BE_A_NUMBER:{code:"INVALID_%s",name:"INVALID_%s",message:"%s should be a number.",details:{}},MUST_BE_A_OBJECT:{code:"INVALID_%s",name:"INVALID_%s",message:"%s should be a object.",details:{}},MUST_BE_AN_ARRAY:{code:"INVALID_%s",name:"INVALID_%s",message:"%s should be an array.",details:{}},MUST_BE_A_BOOLEAN:{code:"INVALID_%s",name:"INVALID_%s",message:"%s should be a boolean.",details:{}},MUST_BE_A_BLOB:{code:"INVALID_%s",name:"INVALID_%s",message:"%s should be a blob.",details:{}},INVALID:{code:"INVALID_%s",name:"INVALID_%s",message:"Invalid %s. Please provide a valid %s.",details:{}},METHOD_COMPULSORY:{code:"%s_IS_COMPULSORY",name:"%s_IS_COMPULSORY",message:"%s is required.",details:{}},LIMIT_EXCEEDED:{code:"ERROR_%s_EXCEEDED",name:"ERROR_%s_EXCEEDED",message:"Limit exceeded max limit of %s.",details:{}},MUST_BE_A_POSITIVE_NUMBER:{code:"INVALID_%s",name:"INVALID_%s",message:"%s should be a postive integer greater than 0.",details:{}},INVALID_MEDIA_FILE:{code:"INVALID_%s",name:"INVALID_%s",message:"The message type does not match the file's mime type.",details:{}},EMPTY_STRING:{code:"INVALID_%s",name:"INVALID_%s",message:"%s cannot be empty.",details:{}},MISSING_KEY:{code:"MISSING_KEY",name:"MISSING_KEY",message:"The key %s is missing from the %s object.",details:{}},EMPTY_ARRAY:{code:"INVALID_%s",name:"INVALID_%s",message:"The parameter %s should be an array and it cannot be empty.",details:{}},INVALID_SEARCH_KEYWORD:{code:"INVALID_SEARCH_KEYWORD",name:"INVALID_SEARCH_KEYWORD",message:"Invalid search keyword. Please provide a valid search keyword.",details:{}},INVALID_GROUP_PROPERTY:{code:"INVALID_%s",name:"INVALID_%s",message:"Invalid %s provided for the group. Please provide a valid %s.",details:{}},INVALID_USER_PROPERTY:{code:"INVALID_%s",name:"INVALID_%s",message:"Invalid %s provided for a user. Please provide a valid %s.",details:{}},PARAMETER_MUST_BE_A_NUMBER:{code:"INVALID_%s",name:"INVALID_%s",message:"%s method accepts parameter as a number.",details:{}},PARAMETER_MUST_BE_AN_ARRAY:{code:"INVALID_%s",name:"INVALID_%s",message:"%s method accepts parameter as an array.",details:{}},PARAMETER_MUST_BE_A_BOOLEAN:{code:"INVALID_%s",name:"INVALID_%s",message:"%s method accepts parameter as a boolean.",details:{}},PARAMETER_MUST_BE_A_POSITIVE_NUMBER:{code:"INVALID_%s",name:"INVALID_%s",message:"%s method accepts parameter to be a positive number greater than 0.",details:{}},PARAMETER_MUST_BE_A_STRING:{code:"INVALID_%s",name:"INVALID_%s",message:"%s method accepts parameter as a string.",details:{}},PARAMETER_COMPULSORY:{code:"%s_IS_COMPULSORY",name:"%s_IS_COMPULSORY",message:"%s cannot be blank. Please provide a valid %s.",details:{}},PASSWORD_COMPULSORY:{code:"%s_IS_COMPULSORY",name:"%s_IS_COMPULSORY",message:"Password is mandatory for a password group.",details:{}},INVALID_ARRAY:{code:"INVALID_%s",name:"INVALID_%s",message:"%s",details:{}}},t.UserErrors={INVALID_STATUS:new i.CometChatException({code:"INVALID_STATUS_VALUE",name:"INVALID_STATUS_VALUE",message:"The `status` parameter accepts only `online` or `offline`.",details:""}),INVALID_DIRECTION:new i.CometChatException({code:"INVALID_DIRECTION_VALUE",name:"INVALID_DIRECTION_VALUE",message:"The `direction` parameter accepts only `both`, `blockeyByMe` or `hasBlockedMe`.",details:""}),USER_NOT_LOGGED_IN:new i.CometChatException({code:"USER_NOT_LOGGED_IN",name:"USER_NOT_LOGGED_IN",message:"Please log in to CometChat before calling this method.",details:""})},t.GroupErrors={NOT_A_GROUP:new i.CometChatException({code:"NOT_A_GROUP",message:"Please use group class to construct a new group."}),INVALID_SCOPE:new i.CometChatException({code:"INVALID_SCOPE_VALUE",name:"INVALID_SCOPE_VALUE",message:"Scope can be `admin`, `moderator` or `participant`.",details:""}),INVALID_GROUP_TYPE:new i.CometChatException({code:"INVALID_GROUP_TYPE",name:"INVALID_GROUP_TYPE",message:"Group type can be `public`, `private`, `protected` or `password`.",details:""})},t.ConversationErrors={INVALID_CONVERSATION_TYPE:{code:"INVALID_CONVERSATION_TYPE",name:"INVALID_CONVERSATION_TYPE",message:"Conversation type can be `user` or `group`.",details:"Please check the value of conversationType."},CONVERSATION_NOT_FOUND:{code:"CONVERSATION_NOT_FOUND",name:"CONVERSATION_NOT_FOUND",message:"Conversation for %s %s not found.",details:"Please check the value of conversationWith and conversationType."}},t.ExtensionErrors={INVALID_EXTENSION:{code:"ERROR_INVALID_EXTENSION",name:"ERROR_INVALID_EXTENSION",message:"The provided extension cannot be null or empty. Please provide a valid extension.",details:{}},EXTENSION_NOT_FOUND:{code:"ERROR_EXTENSION_NOT_FOUND",name:"ERROR_EXTENSION_NOT_FOUND",message:"The provided extension could not be found.",details:{}}},t.MessageErrors={INVALID_RECEIVER_TYPE:{code:"INVALID_RECEIVER_TYPE",name:"INVALID_RECEIVER_TYPE",message:"Receiver type can be `user` or `group`.",details:"Please check the value of receiverType."}},t.FeatureRestrictionErrors={INVALID_FEATURE:{code:"ERROR_INVALID_FEATURE",name:"ERROR_INVALID_FEATURE",message:"The provided feature cannot be null or empty. Please provide a valid feature.",details:{}},FEATURE_NOT_FOUND:{code:"ERROR_FEATURE_NOT_FOUND",name:"ERROR_FEATURE_NOT_FOUND",message:"The provided feature could not be found.",details:{}}},t.PresenceConstatnts={STATUS:{ONLINE:"online",AVAILABLE:"available",OFFLINE:"offline",JOINED:"JOINED",LEFT:"LEFT"}},t.APP_SETTINGS={APP_SETTINGS:"app_settings",KEYS:{CHAT_HOST:"CHAT_HOST",CHAT_USE_SSL:"CHAT_USE_SSL",GROUP_SERVICE:"GROUP_SERVICE",CALL_SERVICE:"CALL_SERVICE",CHAT_WS_PORT:"CHAT_WS_PORT",CHAT_WSS_PORT:"CHAT_WSS_PORT",CHAT_HTTP_BIND_PORT:"CHAT_HTTP_BIND_PORT",CHAT_HTTPS_BIND_PORT:"CHAT_HTTPS_BIND_PORT",ADMIN_API_HOST:"ADMIN_API_HOST",CLIENT_API_HOST:"CLIENT_API_HOST",WEBRTC_HOST:"WEBRTC_HOST",WEBRTC_USE_SSL:"WEBRTC_USE_SSL",WEBRTC_WS_PORT:"WEBRTC_WS_PORT",WEBRTC_WSS_PORT:"WEBRTC_WSS_PORT",WEBRTC_HTTP_BIND_PORT:"WEBRTC_HTTP_BIND_PORT",WEBRTC_HTTPS_BIND_PORT:"WEBRTC_HTTPS_BIND_PORT",EXTENSION_LIST:"extensions",EXTENSION_KEYS:{ID:"id",NAME:"name"},JID_HOST_OVERRIDE:"JID_HOST_OVERRIDE",CHAT_HOST_OVERRIDE:"CHAT_HOST_OVERRIDE",CHAT_HOST_APP_SPECIFIC:"CHAT_HOST_APP_SPECIFIC",MODE:"MODE",CONNECTION_TYPE:"connection_type",DEFAULT_MODE:"DEFAULT",HIGH_VOL_MODE:"HIGH_VOL",FLAKY_MODE:"FLAKY",POLLING_ENABLED:"POLLING_ENABLED",POLLING_INTERVAL:"POLLING_INTERVAL",ANALYTICS_PING_DISABLED:"ANALYTICS_PING_DISABLED",ANALYTICS_HOST:"ANALYTICS_HOST",ANALYTICS_VERSION:"ANALYTICS_VERSION",ANALYTICS_USE_SSL:"ANALYTICS_USE_SSL",SETTINGS_HASH:"settingsHash",SETTINGS_HASH_RECEIVED_AT:"settingsHashReceivedAt",DENY_FALLBACK_TO_POLLING:"DENY_FALLBACK_TO_POLLING",APP_VERSION:"APP_VERSION"}},t.COMMON_UTILITY_CONSTANTS={TYPE_CONSTANTS:{BOOLEAN:"boolean",STRING:"string",OBJECT:"object",NUMBER:"number"}},t.CONNECTION_STATUS={CONNECTED:"connected",CONNECTING:"connecting",DISCONNECTED:"disconnected",FEATURE_THROTTLED:"featureThrottled"},t.API_ERROR_CODES={AUTH_ERR_AUTH_TOKEN_NOT_FOUND:"AUTH_ERR_AUTH_TOKEN_NOT_FOUND"},t.PROSODY_API={DOMAIN_PREFIX:"xmpp",PATH:{ROOM:"room",ROOM_SIZE:"room-size",SESSIONS:"sessions"},RESPONSE:{PARTICIPANTS:"participants"},QUERY_PARAMETERS:{DOMAIN:"domain",ROOM:"room"}},t.ProsodyApiErrors={INVALID_SESSIONID:{code:"ERROR_INVALID_SESSIONID",name:"ERROR_INVALID_SESSIONID",message:"The provided sessionId cannot be null or empty. Please provide a valid sessionId.",details:""},INVALID_TYPE:{code:"ERROR_INVALID_TYPE",name:"ERROR_INVALID_TYPE",message:"The provided type cannot be null or empty. Please provide a valid type.",details:""}},t.JWT_API={KEYS:{PASSTHROUGH:"passthrough",EXPAND:"expand"}}},function(e,t,n){"use strict";t.__esModule=!0;var s=function(e){null!==e.code&&void 0!==e.code&&""!==e.code&&(this.code=e.code),null!==e.name&&void 0!==e.name&&""!==e.name&&(this.name=e.name),null!==e.message&&void 0!==e.message&&""!==e.message&&(this.message=e.message),null!==e.details&&void 0!==e.details&&""!==e.details&&(this.details=e.details)};t.CometChatException=s},function(e,z,$){"use strict";(function(t){var C=this&&this.__assign||function(){return(C=Object.assign||function(e){for(var t,n=1,s=arguments.length;n<s;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},E=this&&this.__awaiter||function(r,i,a,E){return new(a||(a=Promise))(function(e,t){function n(e){try{o(E.next(e))}catch(e){t(e)}}function s(e){try{o(E.throw(e))}catch(e){t(e)}}function o(t){t.done?e(t.value):new a(function(e){e(t.value)}).then(n,s)}o((E=E.apply(r,i||[])).next())})},c=this&&this.__generator||function(n,s){var o,r,i,e,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return e={next:t(0),throw:t(1),return:t(2)},"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return function(t){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,r&&(i=2&t[0]?r.return:t[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,t[1])).done)return i;switch(r=0,i&&(t=[2&t[0],i.value]),t[0]){case 0:case 1:i=t;break;case 4:return a.label++,{value:t[1],done:!1};case 5:a.label++,r=t[1],t=[0];continue;case 7:t=a.ops.pop(),a.trys.pop();continue;default:if(!(i=0<(i=a.trys).length&&i[i.length-1])&&(6===t[0]||2===t[0])){a=0;continue}if(3===t[0]&&(!i||t[1]>i[0]&&t[1]<i[3])){a.label=t[1];break}if(6===t[0]&&a.label<i[1]){a.label=i[1],i=t;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(t);break}i[2]&&a.ops.pop(),a.trys.pop();continue}t=s.call(n,a)}catch(e){t=[6,e],r=0}finally{o=i=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([t,e])}}};z.__esModule=!0;var u=$(28),T=$(0),d=$(2),g=$(6),_=$(4),h=$(14),p=$(17),a=$(8),S=$(16),A=$(9),R=$(10),I=$(1),f=$(7),O=$(15),r=$(41),e=$(23),n=$(21),N=$(24),m=$(13),s=$(20),o=$(46),i=$(47),y=$(49),L=$(51),M=$(52),P=$(35),v=$(26),D=$(37),U=$(19),Y=$(33),w=$(61),G=$(62),K=$(63),x=$(34),b=$(25),F=$(18),B=$(32),V=$(30),l=$(36),J=$(38),k=$(5),H=$(64),W=$(66),j=$(29),X=$(67),q=l.WSConnectionHelper.getInstance(),Q=J.ListenerHandlers.getInstance(),Z=function(){function l(e){try{t.DOMParser=$(70).DOMParser,t.document=(new t.DOMParser).parseFromString("<?xml version='1.0'?>","text/xml"),t.btoa=H.encode,t.atob=H.decode,l.appId=e,l.localStorage=h.LocalStorage.getInstance(),l.keyStore=r.KeyStore.getInstance()}catch(e){T.Logger.error("CometChat: constructor",e)}}return l.setAuthToken=function(e){try{l.authToken=e}catch(e){T.Logger.error("CometChat: setAuthToken",e)}},l.prototype.getAuthToken=function(){try{return l.authToken}catch(e){T.Logger.error("CometChat: getAuthToken",e)}},l.getAppId=function(){try{return l.appId}catch(e){T.Logger.error("CometChat: getAppId",e)}},l.prototype.getApiKey=function(){try{return l.apiKey}catch(e){T.Logger.error("CometChat: getApiKey",e)}},l.getMode=function(){try{return l.mode}catch(e){T.Logger.error("CometChat: getMode",e)}},l.setMode=function(e){try{l.mode=e}catch(e){T.Logger.error("CometChat: getMode",e)}},l.getSessionId=function(){try{return l.sessionId}catch(e){T.Logger.error("CometChat: getAppId",e)}},l.getLastMessageId=function(){try{return l.lastMessageId}catch(e){T.Logger.error("CometChat: getLastMessageId",e)}},l.setLastMessageId=function(e){try{l.lastMessageId=e}catch(e){T.Logger.error("CometChat: getLastMessageId",e)}},l.setSuccessfulTimeStamp=function(e){try{l.successfulPingTimeStamp=e}catch(e){T.Logger.error("CometChat: setSuccessfulTimeStamp",e)}},l.getSuccessfultTimeStamp=function(){try{return l.successfulPingTimeStamp}catch(e){T.Logger.error("CometChat: getSuccessfultTimeStamp",e)}},l.isPollingEnabled=function(){try{return l.pollingEnabled}catch(e){T.Logger.error("CometChat: isPollingEnabled",e)}},l.didMessagesPollingStart=function(){try{return l.isMessagesPollingStarted}catch(e){T.Logger.error("CometChat: didMessagesPollingStart",e)}},l.didAnalyticsPingStart=function(){try{return l.isAnalyticsPingStarted}catch(e){T.Logger.error("CometChat: didAnalyticsPingStart",e)}},l.init=function(o,e){var s=this;return void 0===o&&(o=""),void 0===e&&(e={}),new Promise(function(n,t){try{l.pollingMessagesId=0,"object"==typeof o&&(o.hasOwnProperty("appId")&&(o=o.appId),o.hasOwnProperty("appSettings")&&(e=o.appSettings)),T.isFalsy(e)?e=(new G.AppSettingsBuilder).setRegion(G.AppSettings.REGION_EU).build():e.getRegion()==G.AppSettings.REGION_PRIVATE&&(e.region=o),s.appSettings=e,T.isFalsy(o)?t(new d.CometChatException(m.INIT_ERROR.NO_APP_ID)):(l.setSuccessfulTimeStamp((new Date).getTime()),s.initialzed=!0,l.appId=o,l.getInstance(o),l.sessionId=I.APPINFO.platform+"-"+I.APPINFO.sdkVersionWithUnderScore+"-"+X()+"-"+(new Date).getTime(),l.setLastMessageId(0),l.shouldFallBackToPolling=!0,h.LocalStorage.getInstance().get(I.LOCAL_STORE.KEY_APP_ID).then(function(e){if(null==e||null==e)l.appId=o,l.getInstance(o),h.LocalStorage.getInstance().set(I.LOCAL_STORE.KEY_APP_ID,o),n(!0);else{var t=e.toLocaleString();t===o?(l.appId=t,l.getInstance(t),h.LocalStorage.getInstance().get(I.LOCAL_STORE.KEY_USER).then(function(e){e?(l.isLoggedOut=!1,l.user=new _.Me(e),l.setAuthToken(l.user.getAuthToken()),e.jwt&&(l.jwt=e.jwt),n(!0),h.LocalStorage.getInstance().get(I.LOCAL_STORE.KEY_APP_SETTINGS).then(function(e){if(e){if(e.hasOwnProperty(I.APP_SETTINGS.KEYS.APP_VERSION)){var t=parseInt(I.APPINFO.sdkVersion.charAt(1));e[I.APP_SETTINGS.KEYS.APP_VERSION]<t&&l.getInstance().restart(l.user.getAuthToken())}else l.getInstance().restart(l.user.getAuthToken());e[I.APP_SETTINGS.KEYS.MODE]&&(l.mode=e[I.APP_SETTINGS.KEYS.MODE]),e[I.APP_SETTINGS.KEYS.SETTINGS_HASH]&&(l.settingsHash=e[I.APP_SETTINGS.KEYS.SETTINGS_HASH]),e[I.APP_SETTINGS.KEYS.SETTINGS_HASH_RECEIVED_AT]&&(l.settingsHashReceivedAt=e[I.APP_SETTINGS.KEYS.SETTINGS_HASH_RECEIVED_AT]),e[I.APP_SETTINGS.KEYS.ANALYTICS_HOST]&&(l.analyticsHost=e[I.APP_SETTINGS.KEYS.ANALYTICS_HOST]),e[I.APP_SETTINGS.KEYS.ANALYTICS_VERSION]&&(l.analyticsVersion=e[I.APP_SETTINGS.KEYS.ANALYTICS_VERSION]),l.isAnalyticsDisabled=!!e[I.APP_SETTINGS.KEYS.ANALYTICS_PING_DISABLED],e.hasOwnProperty(I.APP_SETTINGS.KEYS.DENY_FALLBACK_TO_POLLING)&&(l.shouldFallBackToPolling=!1),l.didAnalyticsPingStart()||l.isAnalyticsDisabled||(l.pingAnalytics(),l.startAnalyticsPingTimer()),e[I.APP_SETTINGS.KEYS.POLLING_ENABLED]?(l.pollingEnabled=!0,e[I.APP_SETTINGS.KEYS.POLLING_INTERVAL]&&(l.pollingInterval=e[I.APP_SETTINGS.KEYS.POLLING_INTERVAL]),s.currentConnectionStatus=I.CONNECTION_STATUS.FEATURE_THROTTLED,l.didMessagesPollingStart()||(Q.connectionHandlers.map(function(e){try{e._eventListener&&(T.isFalsy(e._eventListener.onFeatureThrottled)||e._eventListener.onFeatureThrottled())}catch(e){T.Logger.error("ConnectionHandlers: Feature Throttled Status",e)}}),l.pollingMessagesTimestamp=Math.floor((new Date).getTime()/1e3),l.fetchMessages(),l.startMessagesTimer())):(l.pollingEnabled=!1,l.isConnectingFromInit=!0,l.WSLogin(l.user))}})):n(!0)})):s.clearCache().then(function(){l.apiKey=void 0,l.user=void 0,l.authToken=void 0,l.cometChat=void 0,l.mode=void 0,q.WSLogout(),l.appId=o,h.LocalStorage.getInstance().set(I.LOCAL_STORE.KEY_APP_ID,o),l.getInstance(o),n(!0)})}r.KeyStore.getInstance().get(I.LOCAL_STORE.KEY_DEVICE_ID).then(function(e){if(null==e){var t=X(),n=(new Date).getTime(),s=o+"_"+t+"_"+n;r.KeyStore.getInstance().set(I.LOCAL_STORE.KEY_DEVICE_ID,s)}})}))}catch(e){t(new d.CometChatException(e))}})},l.isInitialized=function(){try{return this.initialzed}catch(e){T.Logger.error("CometChat: isInitialized",e)}},l.getInstance=function(e){try{return this.cometChat||(this.cometChat=new l(e)),this.cometChat}catch(e){T.Logger.error("CometChat: getInstance",e)}},l.registerTokenForPushNotification=function(p,S){var C=this;return new Promise(function(c,u){try{l.keyStore.get(I.LOCAL_STORE.KEY_DEVICE_ID).then(function(e){var t="",n=e,s=I.APPINFO.platform,o=I.APPINFO.sdkVersion,r=I.APPINFO.apiVersion;if(navigator&&(t=navigator.userAgent),null==n){var i=X(),a=(new Date).getTime();n=C.appId+"_"+i+"_"+a,l.keyStore.set(I.LOCAL_STORE.KEY_DEVICE_ID,n)}var E={platform:s,deviceId:n,appInfo:{version:o,apiVersion:r,userAgent:t,pushNotification:{fcmDeviceToken:p,settings:S}}};g.makeApiCall("updateMyDetails",{},E,!1).then(function(e){c("Token Registration successful")},function(e){u(new d.CometChatException(e.error))}).catch(function(e){u(new d.CometChatException(e))})})}catch(e){u(new d.CometChatException(e))}})},l.pushToLoginListener=function(t,n){l.shouldPushLoginListener&&Q.loginHandlers.map(function(e){try{if(e._eventListener)switch(n){case"Login_Success":T.isFalsy(e._eventListener.loginSuccess)||e._eventListener.loginSuccess(t);break;case"Login_Failure":T.isFalsy(e._eventListener.loginFailure)||e._eventListener.loginFailure(t);break;case"Logout_Success":T.isFalsy(e._eventListener.logoutSuccess)||e._eventListener.logoutSuccess()}}catch(e){T.Logger.error("ConnectionHandlers: onConnected Status",e)}})},l.login=function(){for(var E=this,c=[],e=0;e<arguments.length;e++)c[e]=arguments[e];return new Promise(function(i,a){try{if(l.pollingMessagesId=0,l.loginInProgress){l.isLoggedOut=!0;var t=new d.CometChatException(m.LOGIN_ERROR.REQUEST_IN_PROGRESS);return a(t)}l.loginInProgress=!0,l.isConnectingFromInit=!1,l.localStorage.get(I.LOCAL_STORE.KEY_APP_ID).then(function(e){if(null==e||null==e){var t=new d.CometChatException(m.LOGIN_ERROR.NOT_INITIALIZED);return l.pushToLoginListener(t,"Login_Failure"),l.loginInProgress=!1,l.isLoggedOut=!0,a(t)}var n=e.toLocaleString();if(E.getInstance(n),l.appId=n,h.LocalStorage.getInstance().set(I.LOCAL_STORE.KEY_APP_ID,n),"object"==typeof c[0]){var s=c[0];c[0].hasOwnProperty("authToken")?c[0]=s.authToken:c[0].hasOwnProperty("username")&&c[0].hasOwnProperty("apiKey")&&(c[0]=s.username,c[1]=s.apiKey)}if(2==c.length){if(T.isFalsy(c[0])||T.isFalsy(c[1])){t=new d.CometChatException(m.ERRORS.PARAMETER_MISSING);return l.pushToLoginListener(t,"Login_Failure"),l.loginInProgress=!1,l.isLoggedOut=!0,a(t)}}else{if(1!=c.length){t=new d.CometChatException(m.ERRORS.PARAMETER_MISSING);return l.pushToLoginListener(t,"Login_Failure"),l.loginInProgress=!1,l.isLoggedOut=!0,a(t)}if(T.isFalsy(c[0])){var t=new d.CometChatException(m.ERRORS.PARAMETER_MISSING);return l.pushToLoginListener(t,"Login_Failure"),l.loginInProgress=!1,l.isLoggedOut=!0,a(t)}}if(T.isFalsy(E.getAppId())){t=new d.CometChatException(m.LOGIN_ERROR.NOT_INITIALIZED);return l.pushToLoginListener(t,"Login_Failure"),l.loginInProgress=!1,l.isLoggedOut=!0,a(t)}return l.localStorage.get(I.LOCAL_STORE.KEY_USER).then(function(r){if(2==c.length){l.apiKey=c[1];var e=c[0];if(null!=r&&r.uid!==c[0])l.localStorage.clearStore().then(function(){q.WSLogout(),l.generateAuthToken(e).then(function(e){l.user=new _.Me(e),l.setAuthToken(l.user.getAuthToken()),l.getLoggedInUser().then(function(e){(l.user=new _.Me(e)).setAuthToken(l.authToken),l.setAuthToken(l.user.getAuthToken());var t=l.user;t.setStatus(I.PresenceConstatnts.STATUS.ONLINE),l.localStorage.set("user",t);var n=new _.User(t);i(n),l.isConnectingFromInit||l.pushToLoginListener(n,"Login_Success"),l.loginInProgress=!1,l.didAnalyticsPingStart()||l.isAnalyticsDisabled||(l.pingAnalytics(),l.startAnalyticsPingTimer()),l.isLoggedOut=!1,l.isPollingEnabled()?(l.currentConnectionStatus=I.CONNECTION_STATUS.FEATURE_THROTTLED,l.didMessagesPollingStart()||(Q.connectionHandlers.map(function(e){try{e._eventListener&&(T.isFalsy(e._eventListener.onFeatureThrottled)||e._eventListener.onFeatureThrottled())}catch(e){T.Logger.error("ConnectionHandlers: Feature Throttled Status",e)}}),l.pollingMessagesTimestamp=Math.floor((new Date).getTime()/1e3),l.fetchMessages(),l.startMessagesTimer())):l.WSLogin(l.user)},function(e){return l.pushToLoginListener(e,"Login_Failure"),l.loginInProgress=!1,l.isLoggedOut=!0,a(e)})},function(e){return l.pushToLoginListener(e,"Login_Failure"),l.loginInProgress=!1,l.isLoggedOut=!0,a(e)})});else{if(!T.isFalsy(l.authToken)){var t=new _.User(E.user);return l.pushToLoginListener(t,"Login_Success"),l.loginInProgress=!1,l.isLoggedOut=!1,i(t)}if(!T.isFalsy(e)){if(T.isFalsy(l.apiKey)){var n=new d.CometChatException(m.LOGIN_ERROR.UNAUTHORISED);return l.pushToLoginListener(n,"Login_Failure"),l.loginInProgress=!1,l.isLoggedOut=!0,a(n)}E.generateAuthToken(e).then(function(e){E.user=new _.Me(e),E.setAuthToken(l.user.getAuthToken()),E.getLoggedInUser().then(function(e){E.user=new _.Me(e),E.user.setAuthToken(l.authToken),E.setAuthToken(E.user.getAuthToken()),q.WSLogout();var t=E.user;t.setStatus(I.PresenceConstatnts.STATUS.ONLINE),E.localStorage.set("user",t);var n=new _.User(t);i(n),l.isConnectingFromInit||l.pushToLoginListener(n,"Login_Success"),l.loginInProgress=!1,l.didAnalyticsPingStart()||l.isAnalyticsDisabled||(l.pingAnalytics(),l.startAnalyticsPingTimer()),l.isLoggedOut=!1,l.isPollingEnabled()?(E.currentConnectionStatus=I.CONNECTION_STATUS.FEATURE_THROTTLED,l.didMessagesPollingStart()||(Q.connectionHandlers.map(function(e){try{e._eventListener&&(T.isFalsy(e._eventListener.onFeatureThrottled)||e._eventListener.onFeatureThrottled())}catch(e){T.Logger.error("ConnectionHandlers: Feature Throttled Status",e)}}),l.pollingMessagesTimestamp=Math.floor((new Date).getTime()/1e3),l.fetchMessages(),l.startMessagesTimer())):E.WSLogin(E.user)},function(e){return l.pushToLoginListener(e,"Login_Failure"),l.loginInProgress=!1,l.isLoggedOut=!0,a(e)})},function(e){return l.pushToLoginListener(e,"Login_Failure"),l.loginInProgress=!1,l.isLoggedOut=!0,a(e)})}}}else l.authToken=c[0],E.getLoggedInUser().then(function(e){if(e.authToken!=c[0]){var s=E;s.localStorage.clearStore().then(function(){q.WSLogout(),s.getLoggedInUser().then(function(e){(l.user=new _.Me(e)).setAuthToken(l.authToken),l.setAuthToken(l.user.getAuthToken());var t=l.user;t.setStatus(I.PresenceConstatnts.STATUS.ONLINE),s.localStorage.set("user",t);var n=new _.User(t);i(n),l.isConnectingFromInit||l.pushToLoginListener(n,"Login_Success"),l.loginInProgress=!1,l.didAnalyticsPingStart()||l.isAnalyticsDisabled||(l.pingAnalytics(),l.startAnalyticsPingTimer()),l.isLoggedOut=!1,l.isPollingEnabled()?(s.currentConnectionStatus=I.CONNECTION_STATUS.FEATURE_THROTTLED,l.didMessagesPollingStart()||(Q.connectionHandlers.map(function(e){try{e._eventListener&&(T.isFalsy(e._eventListener.onFeatureThrottled)||e._eventListener.onFeatureThrottled())}catch(e){T.Logger.error("ConnectionHandlers: Feature Throttled Status",e)}}),l.pollingMessagesTimestamp=Math.floor((new Date).getTime()/1e3),l.fetchMessages(),l.startMessagesTimer())):l.WSLogin(new _.Me(e))},function(e){return l.pushToLoginListener(e,"Login_Failure"),l.loginInProgress=!1,l.isLoggedOut=!0,a(e)})})}else{if(r){var t=new _.User(e);return l.pushToLoginListener(t,"Login_Success"),l.loginInProgress=!1,l.isLoggedOut=!1,i(t)}(l.user=new _.Me(e)).setAuthToken(l.authToken),l.setAuthToken(l.user.getAuthToken());var n=l.user;n.setStatus(I.PresenceConstatnts.STATUS.ONLINE),l.localStorage.set("user",n);var o=new _.User(n);i(o),l.isConnectingFromInit||l.pushToLoginListener(o,"Login_Success"),l.loginInProgress=!1,l.didAnalyticsPingStart()||l.isAnalyticsDisabled||(l.pingAnalytics(),l.startAnalyticsPingTimer()),l.isLoggedOut=!1,l.isPollingEnabled()?(l.currentConnectionStatus=I.CONNECTION_STATUS.FEATURE_THROTTLED,l.didMessagesPollingStart()||(Q.connectionHandlers.map(function(e){try{e._eventListener&&(T.isFalsy(e._eventListener.onFeatureThrottled)||e._eventListener.onFeatureThrottled())}catch(e){T.Logger.error("ConnectionHandlers: Feature Throttled Status",e)}}),l.pollingMessagesTimestamp=Math.floor((new Date).getTime()/1e3),l.fetchMessages(),l.startMessagesTimer())):l.WSLogin(new _.Me(e))}},function(e){return l.pushToLoginListener(e,"Login_Failure"),l.loginInProgress=!1,l.isLoggedOut=!0,a(e)})})})}catch(e){t=new d.CometChatException(e);return l.pushToLoginListener(t,"Login_Failure"),l.loginInProgress=!1,l.isLoggedOut=!0,a(t)}})},l.sendMessage=function(a){var e=this;return new Promise(function(r,i){return E(e,void 0,void 0,function(){var t,n,s,o=this;return c(this,function(e){try{return a instanceof S.TextMessage||a instanceof p.MediaMessage||a instanceof U.CustomMessage||(a=a[I.MessageConstatnts.KEYS.ATTATCHMENT]?(t=I.MessageConstatnts.TYPE.FILE,T.isImage(a[I.MessageConstatnts.KEYS.ATTATCHMENT])?t=I.MessageConstatnts.TYPE.IMAGE:T.isAudio(a[I.MessageConstatnts.KEYS.ATTATCHMENT])?t=I.MessageConstatnts.TYPE.AUDIO:T.isVideo(a[I.MessageConstatnts.KEYS.ATTATCHMENT])&&(t=I.MessageConstatnts.TYPE.VIDEO),new p.MediaMessage(a[I.MessageConstatnts.KEYS.RECEIVER_ID],a[I.MessageConstatnts.KEYS.ATTATCHMENT],t,a[I.MessageConstatnts.KEYS.RECEIVER_TYPE])):new S.TextMessage(a[I.MessageConstatnts.KEYS.RECEIVER_ID],a[I.MessageConstatnts.KEYS.TEXT],a[I.MessageConstatnts.KEYS.RECEIVER_TYPE])),(n=T.validateMessage(a))instanceof d.CometChatException?(i(n),[2]):(a.receiver=a.receiverId,delete a.receiverId,s=a.parentMessageId,[2,g.makeApiCall(s?"sendMessageInThread":"sendMessage",s?{parentId:s}:{},a,a instanceof p.MediaMessage).then(function(n){return E(o,void 0,void 0,function(){var t;return c(this,function(e){return t=A.MessageController.trasformJSONMessge(n.data),l.setLastMessageId(t.id),r(t),[2]})})},function(e){i(new d.CometChatException(e.error))})])}catch(e){i(new d.CometChatException(e))}return[2]})})})},l.sendDirectMessage=function(e){try{return Object.assign(e,{receiverType:I.MessageConstatnts.RECEIVER_TYPE.USER}),this.sendMessage(e)}catch(e){T.Logger.error("CometChat: sendDirectMessage",e)}},l.sendGroupMessage=function(e){try{return Object.assign(e,{receiverType:I.MessageConstatnts.RECEIVER_TYPE.GROUP}),this.sendMessage(e)}catch(e){T.Logger.error("CometChat: sendGroupMessage",e)}},l.sendMediaMessage=function(e){try{return this.sendMessage(e)}catch(e){T.Logger.error("CometChat: sendMediaMessage",e)}},l.sendCustomMessage=function(e){try{return this.sendMessage(e)}catch(e){T.Logger.error("CometChat: sendCustomMessage",e)}},l.getLastDeliveredMessageId=function(){return E(this,void 0,void 0,function(){var t;return c(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,P.MessageListnerMaping.getInstance().get(I.LOCAL_STORE.KEY_MESSAGE_LISTENER_LIST)];case 1:return[2,e.sent()];case 2:return t=e.sent(),T.Logger.error("CometChat: getLastDeliveredMessageId",t),[3,3];case 3:return[2]}})})},l.startTyping=function(e){try{if(T.isFalsy(e))return;var t=void 0,n=this.RECEIVER_TYPE.USER,s={};if(e instanceof v.TypingIndicator)t=e.getReceiverId(),n=e.getReceiverType(),s=e.getMetadata();else{if(!e.hasOwnProperty(I.TYPING_NOTIFICATION.RECEIVER_ID))return;t=e[I.TYPING_NOTIFICATION.RECEIVER_ID],e.hasOwnProperty(I.TYPING_NOTIFICATION.RECEIVER_TYPE)&&(n=e[I.TYPING_NOTIFICATION.RECEIVER_TYPE]),e.hasOwnProperty(I.TYPING_NOTIFICATION.META)&&(s=e[I.TYPING_NOTIFICATION.META])}if(T.isFalsy(t))return;if(null==D.TypingNotificationController.getTypingStartedMap(t)){var o=l.getMode();return T.isFalsy(o)||o&&o===I.APP_SETTINGS.KEYS.DEFAULT_MODE?(q.startTypingIndicator(t,n,s),D.TypingNotificationController.addTypingStarted(t),void D.TypingNotificationController.removeTypingEnded(t)):void 0}}catch(e){T.Logger.error("CometChat: startTyping",e)}},l.endTyping=function(e){try{if(T.isFalsy(e))return;var t=void 0,n=this.RECEIVER_TYPE.USER,s={};if(e instanceof v.TypingIndicator)t=e.getReceiverId(),n=e.getReceiverType(),s=e.getMetadata();else{if(!e.hasOwnProperty(I.TYPING_NOTIFICATION.RECEIVER_ID))return;t=e[I.TYPING_NOTIFICATION.RECEIVER_ID],e.hasOwnProperty(I.TYPING_NOTIFICATION.RECEIVER_TYPE)&&(n=e[I.TYPING_NOTIFICATION.RECEIVER_TYPE]),n=n==this.RECEIVER_TYPE.USER?I.WS.CONVERSATION.TYPE.CHAT:I.WS.CONVERSATION.TYPE.GROUP_CHAT,e.hasOwnProperty(I.TYPING_NOTIFICATION.META)&&(s=e[I.TYPING_NOTIFICATION.META])}if(T.isFalsy(t))return;if(null==D.TypingNotificationController.getTypingEndedMap(t)){var o=l.getMode();return T.isFalsy(o)||o&&o===I.APP_SETTINGS.KEYS.DEFAULT_MODE?(q.pauseTypingIndicator(t,n,s),D.TypingNotificationController.addTypingEnded(t),void D.TypingNotificationController.removeTypingStarted(t)):void 0}}catch(e){T.Logger.error("CometChat: endTyping",e)}},l.markAsRead=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];try{var n=void 0,s=void 0,o=void 0,r=void 0;if(3===e.length)return void T.Logger.log("CometChat: markAsRead()","Deprecated method called.");if(4===e.length){if("string"!=typeof e[0])return void T.Logger.log("CometChat: markAsRead()","Expected messageId to be a string");if(n=e[0],"string"!=typeof e[1])return void T.Logger.log("CometChat: markAsRead()","Expected receiverId to be a string");if(s=e[1],"string"!=typeof e[2])return void T.Logger.log("CometChat: markAsRead()","Expected receiverType to be a string");if(o=e[2],"string"!=typeof e[3])return void T.Logger.log("CometChat: markAsRead()","Expected senderId to be a string");r=e[3]}else{if(1!==e.length)return void T.Logger.log("CometChat: markAsRead()","Invalid number of arguments passed.");if(!(e[0]instanceof a.BaseMessage))return void T.Logger.log("CometChat: markAsRead()","Expected a message object");var i=e[0];n=i.getId().toString(),s=(o=i.getReceiverType())===I.MessageConstatnts.RECEIVER_TYPE.USER?i.getSender().getUid():i.getReceiverId(),r=i.getSender().getUid()}q.markAsRead(s,o,n,r)}catch(e){T.Logger.error("CometChat: markAsRead",e)}},l.markAsDelivered=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];try{var n=void 0,s=void 0,o=void 0,r=void 0;if(3===e.length)return void T.Logger.log("CometChat: markAsRead()","Deprecated method called.");if(4===e.length){if("string"!=typeof e[0])return void T.Logger.log("CometChat: markAsRead()","Expected messageId to be a string");if(n=e[0],"string"!=typeof e[1])return void T.Logger.log("CometChat: markAsRead()","Expected receiverId to be a string");if(s=e[1],"string"!=typeof e[2])return void T.Logger.log("CometChat: markAsRead()","Expected receiverType to be a string");if(o=e[2],"string"!=typeof e[3])return void T.Logger.log("CometChat: markAsRead()","Expected senderId to be a string");r=e[3]}else{if(1!==e.length)return void T.Logger.log("CometChat: markAsRead()","Invalid number of arguments passed.");if(!(e[0]instanceof a.BaseMessage))return void T.Logger.log("CometChat: markAsRead()","Expected a message object");var i=e[0];n=i.getId().toString(),s=(o=i.getReceiverType())===I.MessageConstatnts.RECEIVER_TYPE.USER?i.getSender().getUid():i.getReceiverId(),r=i.getSender().getUid()}q.markAsDelivered(s,o,n,r)}catch(e){T.Logger.error("CometChat: markAsDelivered",e)}},l.getMessageDetails=function(e){return new Promise(function(t,n){try{T.isFalsy(e)?n(new d.CometChatException(m.ERRORS.PARAMETER_MISSING)):g.makeApiCall("getMessageDetails",{messageId:e}).then(function(e){t(A.MessageController.trasformJSONMessge(e.data))},function(e){T.Logger.error("CometChat:GetMessageDetails:",e),n(new d.CometChatException(e.error))})}catch(e){n(new d.CometChatException(e))}})},l.getMessageReceipts=function(s){return new Promise(function(t,n){try{var e=T.validateMsgId(s);if(e instanceof d.CometChatException)return void n(e);T.isFalsy(s)?n(new d.CometChatException(m.ERRORS.PARAMETER_MISSING)):g.makeApiCall("getMessageDetails",{messageId:s}).then(function(e){A.MessageController.getReceiptsFromJSON(e.data).then(function(e){t(e)},function(e){n(new d.CometChatException(e))})},function(e){T.Logger.error("CometChat:GetMessageDetails:",e),n(new d.CometChatException(e.error))})}catch(e){n(new d.CometChatException(e))}})},l.getUnreadMessageCount=function(n){void 0===n&&(n=!1);var o=0;return new Promise(function(s,t){try{var e=T.validateHideMessagesFromBlockedUsers(n);if(e instanceof d.CometChatException)return void t(e);n&&(o=1),g.makeApiCall("getMessages",{},{unread:1,count:1,hideMessagesFromBlockedUsers:o}).then(function(e){var t={},n={};e.data.map(function(e){e[I.ResponseConstants.RESPONSE_KEYS.UNREAD_UNDELIVERED_KEYS.ENTITY_TYPE]==I.MessageConstatnts.RECEIVER_TYPE.GROUP?n[e[I.ResponseConstants.RESPONSE_KEYS.UNREAD_UNDELIVERED_KEYS.ENTITY_Id]]=e[I.ResponseConstants.RESPONSE_KEYS.UNREAD_UNDELIVERED_KEYS.COUNT]:t[e[I.ResponseConstants.RESPONSE_KEYS.UNREAD_UNDELIVERED_KEYS.ENTITY_Id]]=e[I.ResponseConstants.RESPONSE_KEYS.UNREAD_UNDELIVERED_KEYS.COUNT]}),s({users:t,groups:n})},function(e){t(new d.CometChatException(e.error))})}catch(e){t(new d.CometChatException(e))}})},l.getUnreadMessageCountForAllUsers=function(s){void 0===s&&(s=!1);var o=0;return new Promise(function(n,t){try{var e=T.validateHideMessagesFromBlockedUsers(s);if(e instanceof d.CometChatException)return void t(e);s&&(o=1),g.makeApiCall("getMessages",{},{hideMessagesFromBlockedUsers:o,receiverType:I.MessageConstatnts.RECEIVER_TYPE.USER,unread:1,count:1}).then(function(e){var t={};e.data.map(function(e){t[e[I.ResponseConstants.RESPONSE_KEYS.UNREAD_UNDELIVERED_KEYS.ENTITY_Id]]=e[I.ResponseConstants.RESPONSE_KEYS.UNREAD_UNDELIVERED_KEYS.COUNT]}),n(C({},t))},function(e){t(new d.CometChatException(e.error))})}catch(e){t(new d.CometChatException(e))}})},l.getUnreadMessageCountForAllGroups=function(s){void 0===s&&(s=!1);var o=0;return new Promise(function(n,t){try{var e=T.validateHideMessagesFromBlockedUsers(s);if(e instanceof d.CometChatException)return void t(e);s&&(o=1),g.makeApiCall("getMessages",{},{hideMessagesFromBlockedUsers:o,receiverType:I.MessageConstatnts.RECEIVER_TYPE.GROUP,unread:1,count:1}).then(function(e){var t={};e.data.map(function(e){e[I.ResponseConstants.RESPONSE_KEYS.UNREAD_UNDELIVERED_KEYS.ENTITY_TYPE]==I.MessageConstatnts.RECEIVER_TYPE.GROUP&&(t[e[I.ResponseConstants.RESPONSE_KEYS.UNREAD_UNDELIVERED_KEYS.ENTITY_Id]]=e[I.ResponseConstants.RESPONSE_KEYS.UNREAD_UNDELIVERED_KEYS.COUNT])}),n(C({},t))},function(e){t(new d.CometChatException(e.error))})}catch(e){t(new d.CometChatException(e))}})},l.getUnreadMessageCountForUser=function(o,r){void 0===r&&(r=!1);var i=0;return new Promise(function(n,t){try{var e=T.validateId(o,"user");if(e instanceof d.CometChatException)return void t(e);var s=T.validateHideMessagesFromBlockedUsers(r);if(s instanceof d.CometChatException)return void t(s);r&&(i=1),g.makeApiCall("getUserMessages",{listId:o},{hideMessagesFromBlockedUsers:i,unread:1,count:1,uid:o}).then(function(e){var t={};e.data.map(function(e){t[e[I.ResponseConstants.RESPONSE_KEYS.UNREAD_UNDELIVERED_KEYS.ENTITY_Id]]=e[I.ResponseConstants.RESPONSE_KEYS.UNREAD_UNDELIVERED_KEYS.COUNT]}),n(C({},t))},function(e){t(new d.CometChatException(e.error))})}catch(e){t(new d.CometChatException(e))}})},l.getUnreadMessageCountForGroup=function(o,r){void 0===r&&(r=!1);var i=0;return new Promise(function(n,t){try{var e=T.validateId(o,"group");if(e instanceof d.CometChatException)return void t(e);var s=T.validateHideMessagesFromBlockedUsers(r);if(s instanceof d.CometChatException)return void t(s);r&&(i=1),g.makeApiCall("getGroupMessages",{listId:o},{hideMessagesFromBlockedUsers:i,unread:1,count:1,guid:o}).then(function(e){var t={};e.data.map(function(e){e[I.ResponseConstants.RESPONSE_KEYS.UNREAD_UNDELIVERED_KEYS.ENTITY_TYPE]==I.MessageConstatnts.RECEIVER_TYPE.GROUP&&(t[e[I.ResponseConstants.RESPONSE_KEYS.UNREAD_UNDELIVERED_KEYS.ENTITY_Id]]=e[I.ResponseConstants.RESPONSE_KEYS.UNREAD_UNDELIVERED_KEYS.COUNT])}),n(C({},t))},function(e){t(new d.CometChatException(e.error))})}catch(e){t(new d.CometChatException(e))}})},l.editMessage=function(s){return new Promise(function(t,n){try{var e=T.validateMsgId(s.getId());if(e instanceof d.CometChatException)return void n(e);g.makeApiCall("updateMessage",{messageId:s.getId()},s).then(function(e){t(A.MessageController.trasformJSONMessge(e.data).getActionOn())},function(e){n(new d.CometChatException(e.error))})}catch(e){n(new d.CometChatException(e))}})},l.deleteMessage=function(s){return new Promise(function(t,n){try{var e=T.validateMsgId(s);if(e instanceof d.CometChatException)return void n(e);g.makeApiCall("deleteMessage",{messageId:s},{id:s}).then(function(e){t(A.MessageController.trasformJSONMessge(e.data).getActionOn())},function(e){n(new d.CometChatException(e.error))})}catch(e){n(new d.CometChatException(e))}})},l.createUser=function(o,r){return new Promise(function(n,t){try{if(T.isFalsy(r))return void t(new d.CometChatException(JSON.parse(T.format(JSON.stringify(I.GENERAL_ERROR.INVALID),"AUTH_KEY","AUTH_KEY","AUTH_KEY","AUTH_KEY"))));l.apiKey=r;var e=T.validateCreateUser(o);if(e instanceof d.CometChatException)return void t(e);if(!(o instanceof _.User)){var s=void 0;if(!o.hasOwnProperty(I.UserConstants.UID))return void t(new d.CometChatException(m.ERRORS.PARAMETER_MISSING));if(!o.hasOwnProperty(I.UserConstants.NAME))return void t(new d.CometChatException(m.ERRORS.PARAMETER_MISSING));s=new _.User(o[I.UserConstants.UID],o[I.UserConstants.NAME]),o.hasOwnProperty(I.UserConstants.AVATAR)&&s.setAvatar(o[I.UserConstants.AVATAR]),o.hasOwnProperty(I.UserConstants.ROLE)&&s.setRole(o[I.UserConstants.ROLE]),o.hasOwnProperty(I.UserConstants.META_DATA)&&s.setMetadata(o[I.UserConstants.META_DATA]),o.hasOwnProperty(I.UserConstants.LINK)&&s.setLink(o[I.UserConstants.LINK]),o.hasOwnProperty(I.UserConstants.STATUS_MESSAGE)&&s.setStatusMessage(o[I.UserConstants.STATUS_MESSAGE]),o.hasOwnProperty(I.UserConstants.TAGS)&&s.setTags(o[I.UserConstants.TAGS]),o=s}g.makeApiCall("createUser",{},o).then(function(e){var t=R.UsersController.trasformJSONUser(e.data);n(t)},function(e){t(new d.CometChatException(e.error))})}catch(e){t(new d.CometChatException(e))}})},l.updateUser=function(s,i){var a=this;return new Promise(function(o,t){try{if(T.isFalsy(i))return void t(new d.CometChatException(JSON.parse(T.format(JSON.stringify(I.GENERAL_ERROR.INVALID),"AUTH_KEY","AUTH_KEY","AUTH_KEY","AUTH_KEY"))));l.apiKey=i;var e=T.validateUpdateUser(s);if(e instanceof d.CometChatException)return void t(e);if(!(s instanceof _.User)){var n=void 0;if(!s.hasOwnProperty(I.UserConstants.UID))return void t(new d.CometChatException(m.ERRORS.PARAMETER_MISSING));n=new _.User(s[I.UserConstants.UID]),s.hasOwnProperty(I.UserConstants.NAME)&&n.setName(s[I.UserConstants.NAME]),s.hasOwnProperty(I.UserConstants.AVATAR)&&n.setAvatar(s[I.UserConstants.AVATAR]),s.hasOwnProperty(I.UserConstants.ROLE)&&n.setRole(s[I.UserConstants.ROLE]),s.hasOwnProperty(I.UserConstants.META_DATA)&&n.setMetadata(s[I.UserConstants.META_DATA]),s.hasOwnProperty(I.UserConstants.LINK)&&n.setLink(s[I.UserConstants.LINK]),s.hasOwnProperty(I.UserConstants.STATUS_MESSAGE)&&n.setStatusMessage(s[I.UserConstants.STATUS_MESSAGE]),s.hasOwnProperty(I.UserConstants.TAGS)&&n.setTags(s[I.UserConstants.TAGS]),s=n}var r=s.uid;g.makeApiCall("updateUser",{uid:r},s).then(function(s){if(a.user&&r.toLocaleLowerCase()===a.user.getUid().toLocaleLowerCase())h.LocalStorage.getInstance().get("user").then(function(e){if(e){var t=R.UsersController.trasformJSONUser(s.data),n=s.data;n.wsChannel=e.wsChannel,n.authToken=l.authToken,n.status=I.PresenceConstatnts.STATUS.ONLINE,e.jwt&&(n.jwt=e.jwt),l.user=new _.Me(n),a.localStorage.set("user",l.user),o(t)}});else{var e=R.UsersController.trasformJSONUser(s.data);o(e)}},function(e){t(new d.CometChatException(e.error))})}catch(e){t(new d.CometChatException(e))}})},l.updateCurrentUserDetails=function(o){var r=this;return new Promise(function(s,t){try{o.uid=r.user.uid;var e=T.validateUpdateUser(o);if(e instanceof d.CometChatException)return void t(e);if(!(o instanceof _.User)){var n=void 0;o.hasOwnProperty(I.UserConstants.UID)&&(n=new _.User(o[I.UserConstants.UID])),o.hasOwnProperty(I.UserConstants.NAME)&&n.setName(o[I.UserConstants.NAME]),o.hasOwnProperty(I.UserConstants.AVATAR)&&n.setAvatar(o[I.UserConstants.AVATAR]),o.hasOwnProperty(I.UserConstants.ROLE)&&n.setRole(o[I.UserConstants.ROLE]),o.hasOwnProperty(I.UserConstants.META_DATA)&&n.setMetadata(o[I.UserConstants.META_DATA]),o.hasOwnProperty(I.UserConstants.LINK)&&n.setLink(o[I.UserConstants.LINK]),o.hasOwnProperty(I.UserConstants.STATUS_MESSAGE)&&n.setStatusMessage(o[I.UserConstants.STATUS_MESSAGE]),o.hasOwnProperty(I.UserConstants.TAGS)&&n.setTags(o[I.UserConstants.TAGS]),o=n}g.makeApiCall("updateMyDetails",{},o).then(function(e){var t=R.UsersController.trasformJSONUser(e.data),n=l.user=new _.Me(e.data);n.setStatus(I.PresenceConstatnts.STATUS.ONLINE),l.localStorage.set("user",n),s(t)},function(e){t(new d.CometChatException(e.error))})}catch(e){t(new d.CometChatException(e))}})},l.getUser=function(s){return new Promise(function(n,t){try{"object"==typeof s&&s.hasOwnProperty("uid")&&(s=s.uid);var e=T.validateId(s,"user");if(e instanceof d.CometChatException)return void t(e);g.makeApiCall("user",{uid:s}).then(function(e){var t=R.UsersController.trasformJSONUser(e.data);n(t)}).catch(function(e){t(new d.CometChatException(e.error))})}catch(e){t(new d.CometChatException(e))}})},l.getLoggedInUser=function(){var S=this;return new Promise(function(u,p){try{l.localStorage.get(I.LOCAL_STORE.KEY_USER).then(function(e){if(e)u(l.user=new _.Me(e));else{var r="",i="",a=I.APPINFO.platform,E=I.APPINFO.sdkVersion,c=I.APPINFO.apiVersion;l.keyStore.get(I.LOCAL_STORE.KEY_DEVICE_ID).then(function(e){if(i=e,navigator&&(r=navigator.userAgent),null==i){var t=X(),n=(new Date).getTime();i=S.appId+"_"+t+"_"+n,l.keyStore.set(I.LOCAL_STORE.KEY_DEVICE_ID,i)}var s={version:E,apiVersion:c,userAgent:r};T.isFalsy(S.platform)||(s.platform=S.platform),T.isFalsy(S.language)||(s.language=S.language),T.isFalsy(S.resource)||(s.resource=S.resource);var o={platform:a,deviceId:i,appInfo:s};g.makeApiCall("updateMyDetails",{},o,!1).then(function(e){e.data.jwt&&(l.jwt=e.data.jwt);var t=e.data.settings;t&&(h.LocalStorage.getInstance().set("app_settings",t),t[I.APP_SETTINGS.KEYS.MODE]&&l.setMode(t[I.APP_SETTINGS.KEYS.MODE]),t[I.APP_SETTINGS.KEYS.SETTINGS_HASH]&&(l.settingsHash=t[I.APP_SETTINGS.KEYS.SETTINGS_HASH]),t[I.APP_SETTINGS.KEYS.SETTINGS_HASH_RECEIVED_AT]&&(l.settingsHashReceivedAt=t[I.APP_SETTINGS.KEYS.SETTINGS_HASH_RECEIVED_AT]),t[I.APP_SETTINGS.KEYS.ANALYTICS_HOST]&&(l.analyticsHost=t[I.APP_SETTINGS.KEYS.ANALYTICS_HOST]),t[I.APP_SETTINGS.KEYS.ANALYTICS_VERSION]&&(l.analyticsVersion=t[I.APP_SETTINGS.KEYS.ANALYTICS_VERSION]),l.isAnalyticsDisabled=!!t[I.APP_SETTINGS.KEYS.ANALYTICS_PING_DISABLED],t.hasOwnProperty(I.APP_SETTINGS.KEYS.DENY_FALLBACK_TO_POLLING)&&(l.shouldFallBackToPolling=!1),l.pollingEnabled=t[I.APP_SETTINGS.KEYS.POLLING_ENABLED],l.isPollingEnabled()&&t[I.APP_SETTINGS.KEYS.POLLING_INTERVAL]&&(l.pollingInterval=t[I.APP_SETTINGS.KEYS.POLLING_INTERVAL])),u(new _.Me(e.data))},function(e){p(new d.CometChatException(e.error))}).catch(function(e){p(new d.CometChatException(e))})})}})}catch(e){p(new d.CometChatException(e))}})},l.getLoggedinUser=function(){return new Promise(function(t,n){try{l.localStorage.get(I.LOCAL_STORE.KEY_USER).then(function(e){t(e?new _.User(e):null)},function(e){t(null)})}catch(e){n(new d.CometChatException(e))}})},l.blockUsers=function(s){return new Promise(function(t,n){try{var e=T.validateArray(s,"blockUsers");if(e instanceof d.CometChatException)return void n(e);T.isFalsy(s)?n(new d.CometChatException(m.USERS_REQUEST_ERRORS.EMPTY_USERS_LIST)):g.makeApiCall("blockUsers",{},{blockedUids:s}).then(function(e){t(e.data)},function(e){n(new d.CometChatException(e.error))})}catch(e){n(new d.CometChatException(e))}})},l.unblockUsers=function(s){return new Promise(function(t,n){try{var e=T.validateArray(s,"unblockUsers");if(e instanceof d.CometChatException)return void n(e);T.isFalsy(s)?n(new d.CometChatException(m.USERS_REQUEST_ERRORS.EMPTY_USERS_LIST)):g.makeApiCall("unblockUsers",{},{blockedUids:s}).then(function(e){t(e.data)},function(e){n(new d.CometChatException(e.error))})}catch(e){n(new d.CometChatException(e))}})},l.getConversation=function(i,a){return new Promise(function(n,s){try{var e=T.validateConversationType(a);if(e instanceof d.CometChatException)return void s(e);var t=T.validateId(i,a);if(t instanceof d.CometChatException)return void s(t);a=a.toLowerCase(),i=i.toLowerCase();var o={},r="";a===I.MessageConstatnts.RECEIVER_TYPE.GROUP?(r="getGroupConversation",o.guid=i):(r="getUserConversation",o.uid=i),g.makeApiCall(r,o).then(function(e){if(e.data){var t=e.data;n(b.ConversationController.trasformJSONConversation(t.conversationId,t.conversationType,t.lastMessage,t.conversationWith,t.unreadMessageCount))}else s(new d.CometChatException(JSON.parse(T.format(JSON.stringify(I.ConversationErrors.CONVERSATION_NOT_FOUND),a,i))))},function(e){s(new d.CometChatException(e.error))})}catch(e){s(new d.CometChatException(e))}})},l.deleteConversation=function(i,a){return new Promise(function(t,n){try{var e=T.validateConversationType(a);if(e instanceof d.CometChatException)return void n(e);var s=T.validateId(i,a);if(s instanceof d.CometChatException)return void n(s);var o={},r="";a=a.toLowerCase(),i=i.toLowerCase(),a===I.MessageConstatnts.RECEIVER_TYPE.GROUP?(r="deleteGroupConversation",o.guid=i):(r="deleteUserConversation",o.uid=i),g.makeApiCall(r,o).then(function(e){t("Conversation deleted successfully.")},function(e){n(new d.CometChatException(e.error))})}catch(e){n(new d.CometChatException(e))}})},l.createGroup=function(o){return new Promise(function(t,n){try{var e=T.validateCreateGroup(o);if(e instanceof d.CometChatException)return void n(e);if(!(o instanceof f.Group)){var s=void 0;if(!o.hasOwnProperty(I.GroupConstants.KEYS.GUID))return void n(new d.CometChatException(m.ERRORS.PARAMETER_MISSING));if(!o.hasOwnProperty(I.GroupConstants.KEYS.NAME))return void n(new d.CometChatException(m.ERRORS.PARAMETER_MISSING));if(s=new f.Group(o[I.GroupConstants.KEYS.GUID],o[I.GroupConstants.KEYS.NAME],""),o.hasOwnProperty(I.GroupConstants.KEYS.TYPE))if(o[I.GroupConstants.KEYS.TYPE].toLocaleLowerCase()==I.GroupType.Password){if(!o.hasOwnProperty(I.GroupConstants.KEYS.PASSWORD))return void n(new d.CometChatException(m.GROUP_CREATION_ERRORS.EMPTY_PASSWORD));s.setType(I.GROUP_TYPE.PASSWORD),s.setPassword(o[I.GroupConstants.KEYS.PASSWORD])}else s.setType(o[I.GroupConstants.KEYS.TYPE]);else s.setType(I.GROUP_TYPE.PUBLIC);o.hasOwnProperty(I.GroupConstants.KEYS.ICON)&&s.setIcon(o[I.GroupConstants.KEYS.ICON]),o.hasOwnProperty(I.GroupConstants.KEYS.DESCRIPTION)&&s.setDescription(o[I.GroupConstants.KEYS.DESCRIPTION]),o.hasOwnProperty(I.GroupConstants.KEYS.TAGS)&&s.setTags(o[I.GroupConstants.KEYS.TAGS]),o=s}g.makeApiCall("createGroup",{},o).then(function(e){O.GroupsController.trasformJSONGroup(e.data).setHasJoined(!0),t(O.GroupsController.trasformJSONGroup(e.data))},function(e){n(new d.CometChatException(e.error))})}catch(e){n(new d.CometChatException(e))}})},l.getGroup=function(s){return new Promise(function(t,n){try{"object"==typeof s&&s.hasOwnProperty("guid")&&(s=s.guid);var e=T.validateId(s,"group");if(e instanceof d.CometChatException)return void n(e);g.makeApiCall("getGroup",{guid:s}).then(function(e){t(O.GroupsController.trasformJSONGroup(e.data))},function(e){n(new d.CometChatException(e.error))})}catch(e){n(new d.CometChatException(e))}})},l.joinGroup=function(o,r,i){return void 0===r&&(r=I.GroupType.Public),void 0===i&&(i=""),new Promise(function(n,t){try{var e=T.validateJoinGroup(o,r,i);if(e instanceof d.CometChatException)return void t(e);var s=void 0;"object"==typeof o&&(o.hasOwnProperty(I.GroupConstants.KEYS.GUID)?(o.hasOwnProperty(I.GroupConstants.KEYS.TYPE)&&(r=o[I.GroupConstants.KEYS.TYPE],o[I.GroupConstants.KEYS.TYPE].toLocaleLowerCase()===I.GroupType.Password&&o.hasOwnProperty(I.GroupConstants.KEYS.PASSWORD)&&(i=o[I.GroupConstants.KEYS.PASSWORD])),o=o[I.GroupConstants.KEYS.GUID]):t(new d.CometChatException(m.ERRORS.PARAMETER_MISSING))),s=T.isFalsy(i)?new f.Group(o,"name",r):new f.Group(o,"name",r,i),g.makeApiCall("joinGroup",s,s).then(function(e){var t=O.GroupsController.trasformJSONGroup(e.data[I.ResponseConstants.RESPONSE_KEYS.KEY_DATA][I.ActionConstatnts.ACTION_KEYS.ENTITIES][I.ActionConstatnts.ACTION_SUBJECTS.ACTION_FOR][I.ActionConstatnts.ACTION_KEYS.ENTITY]);t.setHasJoined(!0),n(t)},function(e){t(new d.CometChatException(e.error))})}catch(e){t(new d.CometChatException(e))}})},l.updateGroup=function(o){return new Promise(function(t,n){try{var e=T.validateUpdateGroup(o);if(e instanceof d.CometChatException)return void n(e);if(!(o instanceof f.Group)){var s=void 0;if(!o.hasOwnProperty(I.GroupConstants.KEYS.GUID))return void n(new d.CometChatException(m.ERRORS.PARAMETER_MISSING));s=new f.Group(I.GroupConstants.KEYS.GUID,"",""),o.hasOwnProperty(I.GroupConstants.KEYS.TYPE)?s.setType(o[I.GroupConstants.KEYS.TYPE]):(o[I.GroupConstants.KEYS.TYPE]=I.GROUP_TYPE.PUBLIC,s.setType[I.GROUP_TYPE.PUBLIC]),o.hasOwnProperty(I.GroupConstants.KEYS.NAME)&&s.setName(o[I.GroupConstants.KEYS.NAME]),o.hasOwnProperty(I.GroupConstants.KEYS.ICON)&&s.setIcon(o[I.GroupConstants.KEYS.ICON]),o.hasOwnProperty(I.GroupConstants.KEYS.DESCRIPTION)&&s.setDescription(o[I.GroupConstants.KEYS.DESCRIPTION]),o.hasOwnProperty(I.GroupConstants.KEYS.TAGS)&&s.setTags(o[I.GroupConstants.KEYS.TAGS]),o=s}g.makeApiCall("updateGroup",o,o).then(function(e){t(O.GroupsController.trasformJSONGroup(e.data))},function(e){n(new d.CometChatException(e.error))})}catch(e){n(new d.CometChatException(e))}})},l.deleteGroup=function(s){return new Promise(function(t,n){try{var e=T.validateId(s,"group");if(e instanceof d.CometChatException)return void n(e);g.makeApiCall("deleteGroup",{guid:s}).then(function(e){t(!0)},function(e){n(new d.CometChatException(e.error))})}catch(e){n(new d.CometChatException(e))}})},l.leaveGroup=function(s){return new Promise(function(t,n){try{var e=T.validateId(s,"group");if(e instanceof d.CometChatException)return void n(e);g.makeApiCall("leaveGroup",{guid:s}).then(function(e){t(!0)},function(e){n(new d.CometChatException(e.error))})}catch(e){n(new d.CometChatException(e))}})},l.kickGroupMember=function(o,r){return new Promise(function(t,n){try{var e=T.validateId(o,"group");if(e instanceof d.CometChatException)return void n(e);var s=T.validateId(r,"user");if(s instanceof d.CometChatException)return void n(s);g.makeApiCall("kickGroupMembers",{guid:o,uid:r}).then(function(e){t(!0)},function(e){n(new d.CometChatException(e.error))})}catch(e){n(new d.CometChatException(e))}})},l.updateGroupMemberScope=function(r,i,a){return new Promise(function(t,n){try{var e=T.validateId(r,"group");if(e instanceof d.CometChatException)return void n(e);var s=T.validateId(i,"user");if(s instanceof d.CometChatException)return void n(s);var o=T.validateScope(a);if(o instanceof d.CometChatException)return void n(o);g.makeApiCall("changeScopeOfMember",{guid:r,uid:i},{scope:a}).then(function(e){t(!0)},function(e){n(new d.CometChatException(e.error))})}catch(e){n(new d.CometChatException(e))}})},l.banGroupMember=function(o,r){return new Promise(function(t,n){try{var e=T.validateId(o,"group");if(e instanceof d.CometChatException)return void n(e);var s=T.validateId(r,"user");if(s instanceof d.CometChatException)return void n(s);g.makeApiCall("banGroupMember",{guid:o,uid:r}).then(function(e){t(!0)},function(e){n(new d.CometChatException(e.error))})}catch(e){n(new d.CometChatException(e))}})},l.unbanGroupMember=function(o,r){return new Promise(function(t,n){try{var e=T.validateId(o,"group");if(e instanceof d.CometChatException)return void n(e);var s=T.validateId(r,"user");if(s instanceof d.CometChatException)return void n(s);g.makeApiCall("unbanGroupMember",{guid:o,uid:r}).then(function(e){t(!0)},function(e){n(new d.CometChatException(e.error))})}catch(e){n(new d.CometChatException(e))}})},l.addMembersToGroup=function(i,a,E){var c=[],u=[],p=[],S=[];return new Promise(function(e,t){try{var n=T.validateId(i,"group");if(n instanceof d.CometChatException)return void t(n);var s=T.validateArray(a,"groupMembers");if(s instanceof d.CometChatException)return void t(s);if(E){var o=T.validateArray(E,"bannedMembers");if(o instanceof d.CometChatException)return void t(o)}T.isFalsy(a)&&T.isFalsy(E)?t(new d.CometChatException({})):T.isFalsy(a)||T.isFalsy(E)?T.isFalsy(a)?E.map(function(e){S.push(e)}):(a.filter(function(e){if(e.getScope()==I.GROUP_MEMBER_SCOPE.ADMIN)return!0}).map(function(e){c.push(e.getUid())}),a.filter(function(e){if(e.getScope()==I.GROUP_MEMBER_SCOPE.MODERATOR)return!0}).map(function(e){u.push(e.getUid())}),a.filter(function(e){if(e.getScope()==I.GROUP_MEMBER_SCOPE.PARTICIPANT)return!0}).map(function(e){p.push(e.getUid())})):(a.filter(function(e){if(e.getScope()==I.GROUP_MEMBER_SCOPE.ADMIN)return!0}).map(function(e){c.push(e.getUid())}),a.filter(function(e){if(e.getScope()==I.GROUP_MEMBER_SCOPE.MODERATOR)return!0}).map(function(e){u.push(e.getUid())}),a.filter(function(e){if(e.getScope()==I.GROUP_MEMBER_SCOPE.PARTICIPANT)return!0}).map(function(e){p.push(e.getUid())}),E.map(function(e){S.push(e)}));var r={};T.isFalsy(c)||(r=C({},r,{admins:c})),T.isFalsy(p)||(r=C({},r,{participants:p})),T.isFalsy(u)||(r=C({},r,{moderators:u})),T.isFalsy(S)||(r=C({},r,{usersToBan:S})),g.makeApiCall("addMemebersToGroup",{guid:i},r).then(function(t){var n={};Object.keys(t.data.admins).map(function(e){t.data.admins[e][I.ResponseConstants.RESPONSE_KEYS.GROUP_MEMBERS_RESPONSE.SUCCESS]?n[e]=I.ResponseConstants.RESPONSE_KEYS.GROUP_MEMBERS_RESPONSE.SUCCESS:n[e]=t.data.admins[e][I.ResponseConstants.RESPONSE_KEYS.GROUP_MEMBERS_RESPONSE.ERROR][I.ResponseConstants.RESPONSE_KEYS.GROUP_MEMBERS_RESPONSE.MESSAGE]}),Object.keys(t.data.participants).map(function(e){t.data.participants[e][I.ResponseConstants.RESPONSE_KEYS.GROUP_MEMBERS_RESPONSE.SUCCESS]?n[e]=I.ResponseConstants.RESPONSE_KEYS.GROUP_MEMBERS_RESPONSE.SUCCESS:n[e]=t.data.participants[e][I.ResponseConstants.RESPONSE_KEYS.GROUP_MEMBERS_RESPONSE.ERROR][I.ResponseConstants.RESPONSE_KEYS.GROUP_MEMBERS_RESPONSE.MESSAGE]}),Object.keys(t.data.moderators).map(function(e){t.data.moderators[e][I.ResponseConstants.RESPONSE_KEYS.GROUP_MEMBERS_RESPONSE.SUCCESS]?n[e]=I.ResponseConstants.RESPONSE_KEYS.GROUP_MEMBERS_RESPONSE.SUCCESS:n[e]=t.data.moderators[e][I.ResponseConstants.RESPONSE_KEYS.GROUP_MEMBERS_RESPONSE.ERROR][I.ResponseConstants.RESPONSE_KEYS.GROUP_MEMBERS_RESPONSE.MESSAGE]}),Object.keys(t.data.usersToBan).map(function(e){t.data.usersToBan[e][I.ResponseConstants.RESPONSE_KEYS.GROUP_MEMBERS_RESPONSE.SUCCESS]?n[e]=I.ResponseConstants.RESPONSE_KEYS.GROUP_MEMBERS_RESPONSE.SUCCESS:n[e]=t.data.usersToBan[e][I.ResponseConstants.RESPONSE_KEYS.GROUP_MEMBERS_RESPONSE.ERROR][I.ResponseConstants.RESPONSE_KEYS.GROUP_MEMBERS_RESPONSE.MESSAGE]}),e(n)},function(e){t(new d.CometChatException(e.error))})}catch(e){t(new d.CometChatException(e))}})},l.transferGroupOwnership=function(o,r){return new Promise(function(n,t){try{var e=T.validateId(o,"group");if(e instanceof d.CometChatException)return void t(e);var s=T.validateId(r,"user");if(s instanceof d.CometChatException)return void t(s);g.makeApiCall("transferOwnership",{guid:o},{owner:r}).then(function(e){var t;t=e&&e.data&&e.data.message?e.data.message:"Ownership transferred to user "+r+" for the group with guid "+o+".",n(t)},function(e){t(new d.CometChatException(e.error))})}catch(e){t(new d.CometChatException(e))}})},l.initiateCall=function(t){var e=this;return new Promise(function(n,s){if(null===e.getActiveCall())try{T.isFalsy(JSON.parse(JSON.stringify(t)).sender)?T.isFalsy(e.getActiveCall())?(t.setStatus(I.CallConstants.CALL_STATUS.INITIATED),t.receiver=t.receiverId.toString(),delete t.receiverId,g.makeApiCall("createCallSession",{},t).then(function(e){var t=A.MessageController.trasformJSONMessge(e[I.ResponseConstants.RESPONSE_KEYS.KEY_DATA]);N.CallController.getInstance().initiateCall(t).then(function(e){n(t)}).catch(function(e){s(new d.CometChatException(e))})},function(e){s(new d.CometChatException(e.error))})):s(new d.CometChatException(I.CALL_ERROR.ERROR_IN_CALLING)):N.CallController.getInstance().initiateCall(t).then(function(e){n(Object.assign(t))}).catch(function(e){s(new d.CometChatException(e))})}catch(e){s(new d.CometChatException(e))}else s(new d.CometChatException(I.CALL_ERROR.CALL_ALREADY_INITIATED))})},l.acceptCall=function(s){var o=this;return new Promise(function(n,t){if(null===o.getActiveCall())try{var e={};e[I.CallConstants.CALL_KEYS.CALL_STATUS]=I.CallConstants.CALL_STATUS.ONGOING,g.makeApiCall("updateCallSession",{sessionid:s},e).then(function(e){var t=A.MessageController.trasformJSONMessge(e[I.ResponseConstants.RESPONSE_KEYS.KEY_DATA]);N.CallController.getInstance().onCallStarted(t),n(t)},function(e){t(new d.CometChatException(e.error))})}catch(e){t(new d.CometChatException(e))}else t(new d.CometChatException(I.CALL_ERROR.CANNOT_ACCEPT_CALL))})},l.rejectCall=function(e,t){try{switch(t){case I.CallConstants.CALL_STATUS.REJECTED:return this.rejectIncomingCall(e);case I.CallConstants.CALL_STATUS.CANCELLED:return this.cancelCall(e);case I.CallConstants.CALL_STATUS.BUSY:return this.sendBusyResponse(e);default:return this.endCall(e,!0)}}catch(e){T.Logger.error("CometChat: rejectCall",e)}},l.endCall=function(o,r){var i=this;return new Promise(function(n,t){T.isFalsy(r)&&(r=!1);var s=i.getActiveCall();if(null!==s){if(s.getSessionId()===o)try{var e={};e[I.CallConstants.CALL_KEYS.CALL_STATUS]=I.CallConstants.CALL_STATUS.ENDED,s.getJoinedAt()&&(e[I.CallConstants.CALL_KEYS.CALL_JOINED_AT]=s.getJoinedAt()),g.makeApiCall("updateCallSession",{sessionid:o},e).then(function(e){r||N.CallController.getInstance().endSession();var t=A.MessageController.trasformJSONMessge(e[I.ResponseConstants.RESPONSE_KEYS.KEY_DATA]);n(t),N.CallController.getInstance().getCallListner()&&N.CallController.getInstance().getCallListner()._eventListener.onCallEnded(t),N.CallController.getInstance().endCall()},function(e){T.Logger.log("calling Log",{error:e}),r||N.CallController.getInstance().endSession(),s.setStatus(I.CallConstants.CALL_STATUS.ENDED),n(s),N.CallController.getInstance().getCallListner()&&N.CallController.getInstance().getCallListner()._eventListener.onCallEnded(s),N.CallController.getInstance().endCall()})}catch(e){t(new d.CometChatException(e))}}else r||N.CallController.getInstance().endSession(),N.CallController.getInstance().getCallListner()&&N.CallController.getInstance().getCallListner()._eventListener.onCallEnded(null),n(null)})},l.getActiveCall=function(){try{return N.CallController.getInstance().getActiveCall()}catch(e){T.Logger.error("CometChat: getActiveCall",e)}},l.getCallParticipantCount=function(a,E){var c=this;return new Promise(function(r,i){try{T.getAppSettings().then(function(e){if(T.isFalsy(a))return i(new d.CometChatException(I.ProsodyApiErrors.INVALID_SESSIONID));if(T.isFalsy(E))return i(new d.CometChatException(I.ProsodyApiErrors.INVALID_TYPE));var t=c.appSettings.getRegion(),n={},s=e[I.APP_SETTINGS.KEYS.WEBRTC_HOST],o=T.format((new u.EndpointFactory).prosodyApi,I.PROSODY_API.DOMAIN_PREFIX,s,I.PROSODY_API.PATH.ROOM_SIZE);"direct"===E.toLowerCase()&&(a=("v1."+t+"."+l.getAppId()+"."+a).toLowerCase()),n[I.PROSODY_API.QUERY_PARAMETERS.DOMAIN]=s,n[I.PROSODY_API.QUERY_PARAMETERS.ROOM]=a,g.postData(o,"GET",n,{},!1).then(function(e){return e.text()}).then(function(e){var t=e?JSON.parse(e):{};return t.hasOwnProperty(I.PROSODY_API.RESPONSE.PARTICIPANTS)?r(t[I.PROSODY_API.RESPONSE.PARTICIPANTS]):r(0)}).catch(function(){var e={error:m.FETCH_ERROR.ERROR_IN_API_CALL};return i(e)})},function(e){return i(new d.CometChatException(e))})}catch(e){return i(new d.CometChatException(e))}})},l.rejectIncomingCall=function(s){return new Promise(function(n,t){try{var e={};e[I.CallConstants.CALL_KEYS.CALL_STATUS]=I.CallConstants.CALL_STATUS.REJECTED,g.makeApiCall("updateCallSession",{sessionid:s},e).then(function(e){var t=A.MessageController.trasformJSONMessge(e[I.ResponseConstants.RESPONSE_KEYS.KEY_DATA]);n(t)},function(e){t(new d.CometChatException(e.error))})}catch(e){t(new d.CometChatException(e))}})},l.cancelCall=function(o){var r=this;return new Promise(function(n,t){var e=r.getActiveCall();if(null!==e&&e.getSessionId()===o&&e.getCallInitiator().getUid().toLocaleLowerCase()===l.user.getUid().toLocaleLowerCase())try{var s={};s[I.CallConstants.CALL_KEYS.CALL_STATUS]=I.CallConstants.CALL_STATUS.CANCELLED,g.makeApiCall("updateCallSession",{sessionid:o},s).then(function(e){var t=A.MessageController.trasformJSONMessge(e[I.ResponseConstants.RESPONSE_KEYS.KEY_DATA]);N.CallController.getInstance().endCallSession(),n(t)},function(e){t(new d.CometChatException(e.error))})}catch(e){t(new d.CometChatException(e))}})},l.sendBusyResponse=function(s){return new Promise(function(n,t){try{var e={};e[I.CallConstants.CALL_KEYS.CALL_STATUS]=I.CallConstants.CALL_STATUS.BUSY,g.makeApiCall("updateCallSession",{sessionid:s},e).then(function(e){var t=A.MessageController.trasformJSONMessge(e[I.ResponseConstants.RESPONSE_KEYS.KEY_DATA]);n(t)},function(e){t(new d.CometChatException(e.error))})}catch(e){t(new d.CometChatException(e))}})},l.sendUnansweredResponse=function(n){return new Promise(function(s,t){try{var e={};e[I.CallConstants.CALL_KEYS.CALL_STATUS]=I.CallConstants.CALL_STATUS.UNANSWERED,g.makeApiCall("updateCallSession",{sessionid:n},e).then(function(e){var t=A.MessageController.trasformJSONMessge(e[I.ResponseConstants.RESPONSE_KEYS.KEY_DATA]),n=q.getCometChatEventFromMessage(Object.assign(t,e[I.ResponseConstants.RESPONSE_KEYS.KEY_DATA]));q.publishMessages(n),s(t)},function(e){t(new d.CometChatException(e.error))})}catch(e){t(new d.CometChatException(e))}})},l.addConnectionListener=function(e,t){try{Q.addConnectionEventListener(e,t)}catch(e){T.Logger.error("CometChat: addConnectionListener",e)}},l.removeConnectionListener=function(e){try{Q.removeConnectionEventListener(e)}catch(e){T.Logger.error("CometChat: removeConnectionListener",e)}},l.addMessageListener=function(e,t){try{Q.addMessageEventListener(e,t)}catch(e){T.Logger.error("CometChat: addMessageListener",e)}},l.removeMessageListener=function(e){try{Q.removeMessageEventListener(e)}catch(e){T.Logger.error("CometChat: removeMessageListener",e)}},l.addCallListener=function(e,t){try{Q.addCallEventListener(e,t)}catch(e){T.Logger.error("CometChat: addCallListener",e)}},l.removeCallListener=function(e){try{Q.removeCallEventListener(e)}catch(e){T.Logger.error("CometChat: removeCallListener",e)}},l.addUserListener=function(e,t){try{Q.addUserEventListener(e,t)}catch(e){T.Logger.error("CometChat: addUserListener",e)}},l.removeUserListener=function(e){try{Q.removeUserEventListener(e)}catch(e){T.Logger.error("CometChat: removeUserListener",e)}},l.addGroupListener=function(e,t){try{Q.addGroupEventListener(e,t)}catch(e){T.Logger.error("CometChat: addGroupListener",e)}},l.removeGroupListener=function(e){try{Q.removeGroupEventListener(e)}catch(e){T.Logger.error("CometChat: removeGroupListener",e)}},l.addLoginListener=function(e,t){try{Q.addLoginEventListener(e,t)}catch(e){T.Logger.error("CometChat: addLoginListener",e)}},l.removeLoginListener=function(e){try{Q.removeLoginEventListener(e)}catch(e){T.Logger.error("CometChat: removeLoginListener",e)}},l.generateAuthToken=function(p){var S=this;return new Promise(function(s,o){try{var r={},i="",a="",E=I.APPINFO.platform,c=I.APPINFO.sdkVersion,u=I.APPINFO.apiVersion;navigator&&(a=navigator.userAgent),l.keyStore.get(I.LOCAL_STORE.KEY_DEVICE_ID).then(function(e){if(null==(i=e)){var t=X(),n=(new Date).getTime();i=S.appId+"_"+t+"_"+n,l.keyStore.set(I.LOCAL_STORE.KEY_DEVICE_ID,i)}r={platform:E,deviceId:i,appInfo:{version:c,apiVersion:u,userAgent:a}},g.makeApiCall("authToken",{uid:p},r).then(function(e){s(e.data)}).catch(function(e){o(new d.CometChatException(e.error))})},function(e){T.Logger.error("Got error while fetching data from key store",e)})}catch(e){o(new d.CometChatException(e))}})},l.setAccidentalDisconnect=function(e){l.accidentalDisconnect=e},l.generateNewSessionId=function(){l.sessionId=I.APPINFO.platform+"-"+I.APPINFO.sdkVersionWithUnderScore+"-"+X()+"-"+(new Date).getTime()},l.tryReconnectingToWSOrStartPolling=function(){0===this.WSReconnectionStartTime&&(this.WSReconnectionStartTime=(new Date).getTime()),l.WSReconnectionInProgress||l.startWSReconnectionTimer(),l.isWSCheckTimerStarted||l.startWSCheckTimer()},l.startPolling=function(e){if(l.currentConnectionStatus=I.CONNECTION_STATUS.FEATURE_THROTTLED,!l.didMessagesPollingStart()){Q.connectionHandlers.map(function(e){try{e._eventListener&&(T.isFalsy(e._eventListener.onFeatureThrottled)||e._eventListener.onFeatureThrottled())}catch(e){T.Logger.error("ConnectionHandlers: Feature Throttled Status",e)}});var t=void 0;if(e){var n=l.getLastMessageId();0===(l.pollingMessagesId=n||0)&&(t=l.getSuccessfultTimeStamp())}else t=0<l.WSReconnectionStartTime?l.WSReconnectionStartTime:(new Date).getTime();l.pollingEnabledInternally=!0,l.pollingEnabled=!0,l.pollingMessagesTimestamp=Math.floor(t/1e3),l.fetchMessages(),l.startMessagesTimer()}},l.prototype.makeWSConnection=function(){l.setAccidentalDisconnect(!1),l.WSLogin(l.user)},l.prototype.accidentallyDisconnected=function(){l.currentConnectionStatus=I.CONNECTION_STATUS.CONNECTING,Q.connectionHandlers.map(function(e){try{e._eventListener&&(T.isFalsy(e._eventListener.inConnecting)||e._eventListener.inConnecting())}catch(e){T.Logger.error("ConnectionHandlers: inConnecting Status",e)}}),l.setAccidentalDisconnect(!0),l.tryReconnectingToWSOrStartPolling()},l.WSLogin=function(e){var n=this;q.WSLogin(e.getJWT(),function(e){switch(e){case k.READY_STATE.CONNECTING:var t=l.getConnectionStatus();n.currentConnectionStatus=I.CONNECTION_STATUS.CONNECTING,t==I.CONNECTION_STATUS.DISCONNECTED&&Q.connectionHandlers.map(function(e){try{e._eventListener&&(T.isFalsy(e._eventListener.inConnecting)||e._eventListener.inConnecting())}catch(e){T.Logger.error("connectionHandlers: Connecting Status",e)}});break;case k.READY_STATE.OPEN:t=l.getConnectionStatus();n.currentConnectionStatus=I.CONNECTION_STATUS.CONNECTED,t==I.CONNECTION_STATUS.CONNECTING&&Q.connectionHandlers.map(function(e){try{e._eventListener&&(T.isFalsy(e._eventListener.onConnected)||e._eventListener.onConnected())}catch(e){T.Logger.error("connectionHandlers: Connected Status",e)}}),l.WSReconnectionStartTime=0,l.pollingMessagesId=0,l.pollingEnabled=!1,l.pollingEnabledInternally=!1,l.WSCurrentReconnectionCount=0,l.setAccidentalDisconnect(!1),l.didMessagesPollingStart()&&l.clearMessagesTimer(),l.WSReconnectionInProgress&&l.clearWSReconnectionTimer(),l.isWSCheckTimerStarted&&l.clearWSCheckTimer();break;case k.READY_STATE.CLOSING:break;case k.READY_STATE.CLOSED:t=l.getConnectionStatus();n.currentConnectionStatus=I.CONNECTION_STATUS.DISCONNECTED,t!==I.CONNECTION_STATUS.DISCONNECTED&&(Q.connectionHandlers.map(function(e){try{e._eventListener&&(T.isFalsy(e._eventListener.onDisconnected)||e._eventListener.onDisconnected())}catch(e){T.Logger.error("connectionHandlers: Disconnected Status",e)}}),l.isLoggedOut||n.tryReconnectingToWSOrStartPolling())}})},l.fetchMessages=function(){var e=this;try{var t={per_page:l.pollingLimit,affix:l.pollingAffix,polling:1};l.pollingMessagesId?t.id=l.pollingMessagesId:t.sentAt=l.pollingMessagesTimestamp,g.makeApiCall("getMessages",{},t).then(function(i){return E(e,void 0,void 0,function(){var t,n,s,o,r;return c(this,function(e){switch(e.label){case 0:if(t=i.data,!(0<(n=i.data.length)))return[3,4];l.pollingMessagesId=t[n-1].id,s=Math.floor(l.pollingInterval/n),o=0,e.label=1;case 1:return o<n?l.isLoggedOut?[3,3]:(t[o]&&t[o][I.MessageConstatnts.KEYS.DATA]&&t[o][I.MessageConstatnts.KEYS.DATA][I.MessageConstatnts.KEYS.RESOURCE]&&t[o][I.MessageConstatnts.KEYS.DATA][I.MessageConstatnts.KEYS.RESOURCE]!==l.getSessionId()&&l.getConnectionStatus()!==I.CONNECTION_STATUS.CONNECTED&&(l.getLastMessageId()<=t[o].id&&l.setLastMessageId(t[o].id),P.MessageListnerMaping.getInstance().set("all",parseInt(t[o].id)),r=q.getCometChatEventFromMessage(t[o]),q.publishMessages(r)),o<n-1?[4,l.timer(s)]:[3,3]):[3,4];case 2:e.sent(),e.label=3;case 3:return o++,[3,1];case 4:return[2]}})})},function(e){T.Logger.error("CometChat: fetchMessages: API Error",e)}).catch(function(e){T.Logger.error("CometChat: fetchMessages: API Error",e)})}catch(e){T.Logger.error("CometChat: fetchMessages",e)}},l.fetchMissedMessages=function(){var e=this;try{var t={per_page:1e3,affix:I.MessageConstatnts.PAGINATION.AFFIX.APPEND,missedMessages:1};0<l.getLastMessageId()?t.id=l.getLastMessageId():0<l.getSuccessfultTimeStamp()?t.sentAt=Math.floor(l.getSuccessfultTimeStamp()/1e3):t.sentAt=Math.floor((new Date).getTime()/1e3),g.makeApiCall("getMessages",{},t).then(function(r){return E(e,void 0,void 0,function(){var t,n,s,o;return c(this,function(e){if(t=r.data,0<(n=r.data.length))for(l.pollingMessagesId=t[n-1].id,s=0;s<n;s++)l.isLoggedOut||t[s]&&t[s][I.MessageConstatnts.KEYS.DATA]&&t[s][I.MessageConstatnts.KEYS.DATA][I.MessageConstatnts.KEYS.RESOURCE]&&t[s][I.MessageConstatnts.KEYS.DATA][I.MessageConstatnts.KEYS.RESOURCE]!==l.getSessionId()&&(l.getLastMessageId()<=t[s].id&&l.setLastMessageId(t[s].id),P.MessageListnerMaping.getInstance().set("all",parseInt(t[s].id)),t[s][I.MessageConstatnts.KEYS.CATEGORY]!==I.MessageConstatnts.CATEGORY.CALL||t[s][I.MessageConstatnts.KEYS.DATA][I.MessageConstatnts.KEYS.ACTION]!==I.CallConstants.CALL_STATUS.INITIATED?(o=q.getCometChatEventFromMessage(t[s]),q.publishMessages(o)):T.Logger.info("CometChat: fetchMissedMessages","Call Initiated Message"));return[2]})})},function(e){T.Logger.error("CometChat: fetchMissedMessages: API Error",e)}).catch(function(e){T.Logger.error("CometChat: fetchMissedMessages: API Error",e)})}catch(e){T.Logger.error("CometChat: fetchMissedMessages",e)}},l.pingAnalytics=function(){var E=this;try{l.keyStore.get("deviceId").then(function(e){var t=I.SDKHeader.platform,n="",s=e,o={version:I.SDKHeader.sdkVersion,apiVersion:I.APPINFO.apiVersion,origin:t,uts:(new Date).getTime()};T.isFalsy(E.resource)||(o.resource=E.resource),T.isFalsy(E.platform)||(o.platform=E.platform),T.isFalsy(E.language)||(o.language=E.language),navigator&&(n=navigator.userAgent);var r={appInfo:o,uid:l.user.getUid(),userAgent:n,deviceId:s,platform:I.SDKHeader.platform};T.isFalsy(l.getSessionId())||(r.wsId=l.getSessionId()),l.analyticsHost||(l.analyticsHost=T.format(I.ANALYTICS.analyticsHost,l.appSettings.getRegion())),l.analyticsVersion||(l.analyticsVersion=I.ANALYTICS.analyticsVersion);var i="https://"+l.analyticsHost+"/"+l.analyticsVersion+"/ping",a={appId:l.appId,sdk:T.format(I.SDKHeader.sdk,I.SDKHeader.platform,I.SDKHeader.sdkVersion),"Content-Type":"application/json"};l.settingsHash&&(a.settingsHash=l.settingsHash),l.settingsHashReceivedAt&&(a.settingsHashReceivedAt=l.settingsHashReceivedAt),l.jwt&&(a.Authorization="Bearer "+l.jwt),l.authToken&&(a.authToken=l.authToken),g.postData(i,"POST",r,a,!1).then(function(e){return e.json()}).then(function(e){if(e.hasOwnProperty(I.ResponseConstants.RESPONSE_KEYS.KEY_DATA))T.Logger.log("Analytics Ping Request Data",e[I.ResponseConstants.RESPONSE_KEYS.KEY_DATA]);else if(e.hasOwnProperty(I.ResponseConstants.RESPONSE_KEYS.KEY_ERROR)){var t=e[I.ResponseConstants.RESPONSE_KEYS.KEY_ERROR];T.Logger.log("Analytics Ping Request Error",new d.CometChatException(t));var n=t.code;if(n===I.Errors.ERR_SETTINGS_HASH_OUTDATED){var s=l.authToken;l.getInstance().restart(s)}n===I.Errors.ERR_NO_AUTH&&E.updateJWT()}}).catch(function(e){T.Logger.error("CometChat: pingAnalytics Fetch Error",e)})})}catch(e){T.Logger.error("CometChat: pingAnalytics",e)}},l.updateJWT=function(){g.makeApiCall("getMyDetails",{},{},!1).then(function(e){var t=e.data,n=t.settings,s=new _.Me(t);if(t.hasOwnProperty("jwt")&&t.jwt&&(l.jwt=t.jwt),h.LocalStorage.getInstance().set("user",s),n&&n[I.APP_SETTINGS.KEYS.SETTINGS_HASH]&&l.settingsHash!==n[I.APP_SETTINGS.KEYS.SETTINGS_HASH]){var o=l.getInstance().getAuthToken();l.getInstance().restart(o)}T.Logger.log("CometChat: updateJWT response",e)},function(e){T.Logger.error("CometChat: updateJWT Fetch Error",e)}).catch(function(e){T.Logger.error("CometChat: updateJWT",e)})},l.startMessagesTimer=function(){var e=this;l.isMessagesPollingStarted=!0,l.messagesTimer=setInterval(function(){try{e.fetchMessages()}catch(e){T.Logger.error("CometChat: startMessagesTimer",e)}},l.pollingInterval)},l.timer=function(t){return new Promise(function(e){return setTimeout(e,t)})},l.startAnalyticsPingTimer=function(){var e=this;l.isAnalyticsPingStarted=!0,l.analyticsPingTimer=setInterval(function(){try{e.pingAnalytics()}catch(e){T.Logger.error("CometChat: startAnalyticsPingTimer",e)}},l.settingsInterval)},l.clearMessagesTimer=function(){try{l.isMessagesPollingStarted=!1,clearInterval(l.messagesTimer)}catch(e){T.Logger.error("CometChat: clearMessagesTimer",e)}},l.clearAnalyticsPingTimer=function(){try{l.isAnalyticsPingStarted=!1,clearInterval(l.analyticsPingTimer)}catch(e){T.Logger.error("CometChat: clearAnalyticsPingTimer",e)}},l.startWSReconnectionTimer=function(){l.WSReconnectionInProgress=!0,l.WSReconnectionTimer=setInterval(function(){try{l.WSLogin(l.user)}catch(e){T.Logger.error("CometChat: startWSReconnectionTimer",e)}},l.WSReconnectionTimerInterval)},l.clearWSReconnectionTimer=function(){l.WSReconnectionInProgress=!1,clearInterval(l.WSReconnectionTimer)},l.startWSCheckTimer=function(){l.isWSCheckTimerStarted=!0,l.wsCheckTimer=setTimeout(function(){try{l.shouldFallBackToPolling&&l.startPolling(!!l.accidentalDisconnect)}catch(e){T.Logger.error("CometChat: startMessagesTimer",e)}},l.wsCheckTimerDuration)},l.clearWSCheckTimer=function(){l.isWSCheckTimerStarted=!1,clearTimeout(l.wsCheckTimer)},l.prototype.getJWT=function(r){return new Promise(function(s,o){try{j.getEndPoint("getJWT").then(function(e){var t={appId:l.appId,Accept:"application/json",authToken:l.authToken,resource:l.getSessionId(),sdk:T.format(I.SDKHeader.sdk,I.SDKHeader.platform,I.SDKHeader.sdkVersion),"Content-Type":"application/json"},n={};n[I.JWT_API.KEYS.PASSTHROUGH]=r,g.postData(e.endpoint,e.method,n,t,!1).then(function(e){return e.json()}).then(function(e){e.hasOwnProperty(I.ResponseConstants.RESPONSE_KEYS.KEY_DATA)?s(e[I.ResponseConstants.RESPONSE_KEYS.KEY_DATA]):o(new d.CometChatException(e.error))}).catch(function(e){var t={error:m.FETCH_ERROR.ERROR_IN_API_CALL};o(new d.CometChatException(t))})},function(e){o(new d.CometChatException(e))})}catch(e){o(new d.CometChatException(e))}})},l.getConnectionStatus=function(){return this.currentConnectionStatus},l.prototype.setConnectionStatus=function(e){l.currentConnectionStatus=e},l.isExtensionEnabled=function(r){return new Promise(function(s,o){try{if(T.isFalsy(r))return o(new d.CometChatException(I.ExtensionErrors.INVALID_EXTENSION));T.getAppSettings().then(function(e){if(e.extensions){var t=e.extensions;if(0<t.length){var n=t.some(function(e){return e.id===r});return s(n)}return s(!1)}return o(new d.CometChatException(I.ExtensionErrors.EXTENSION_NOT_FOUND))},function(e){return o(new d.CometChatException(e))})}catch(e){return o(new d.CometChatException(e))}})},l.getExtensionDetails=function(i){return new Promise(function(o,r){try{if(T.isFalsy(i))return r(new d.CometChatException(I.ExtensionErrors.INVALID_EXTENSION));T.getAppSettings().then(function(e){if(e.extensions){var t=e.extensions;if(0<t.length){var n=t.filter(function(e){return e.id===i});if(0<n.length){var s=new W.CCExtension(n[0]);return o(s)}return r(new d.CometChatException(I.ExtensionErrors.EXTENSION_NOT_FOUND))}return r(new d.CometChatException(I.ExtensionErrors.EXTENSION_NOT_FOUND))}return r(new d.CometChatException(I.ExtensionErrors.EXTENSION_NOT_FOUND))},function(e){return r(new d.CometChatException(e))})}catch(e){return r(new d.CometChatException(e))}})},l.getAppSettings=function(){return new Promise(function(t,n){try{g.makeApiCall("appSettings").then(function(e){h.LocalStorage.getInstance().set(I.LOCAL_STORE.KEY_APP_SETTINGS,e.data),t(e.data)},function(e){n(new d.CometChatException(e.error))})}catch(e){n(new d.CometChatException(e))}})},l.isFeatureEnabled=function(o){return new Promise(function(n,s){try{if(T.isFalsy(o))return s(new d.CometChatException(I.FeatureRestrictionErrors.INVALID_FEATURE));T.getAppSettings().then(function(e){if(e.parameters){var t=e.parameters;return t.hasOwnProperty(o)?n(t[o]):n(!1)}return s(new d.CometChatException(I.FeatureRestrictionErrors.FEATURE_NOT_FOUND))},function(e){return s(new d.CometChatException(e))})}catch(e){return s(new d.CometChatException(e))}})},l.logout=function(){var s=this;return new Promise(function(t,n){try{l.didAnalyticsPingStart()&&l.clearAnalyticsPingTimer(),l.didMessagesPollingStart()&&l.clearMessagesTimer(),l.WSReconnectionInProgress&&l.clearWSReconnectionTimer(),l.isWSCheckTimerStarted&&l.clearWSCheckTimer(),l.isLoggedOut=!0,l.pollingMessagesId=0,l.pollingEnabled=!1,l.pollingInterval=5e3,l.pollingEnabledInternally=!1,l.WSReconnectionStartTime=0,l.WSReconnectionInProgress=!1,l.setLastMessageId(0),l.setAccidentalDisconnect(!1),l.isAnalyticsDisabled=!1,l.shouldFallBackToPolling=!0,g.makeApiCall("userLogout").then(function(e){s.clearCache().then(function(){l.apiKey=void 0,l.user=void 0,l.authToken=void 0,l.cometChat=void 0,l.mode=void 0,q.WSLogout(),l.pushToLoginListener("","Logout_Success"),t(e.data)})},function(e){s.clearCache().then(function(){l.apiKey=void 0,l.user=void 0,l.authToken=void 0,l.cometChat=void 0,l.mode=void 0,q.WSLogout(),l.pushToLoginListener("","Logout_Success"),new d.CometChatException(e.error).code==m.SERVER_ERRORS.AUTH_ERR.code?t({}):n(new d.CometChatException(e.error))})})}catch(e){n(new d.CometChatException(e))}})},l.callExtension=function(o,r,i,a){return void 0===a&&(a={}),new Promise(function(t,n){var e=T.format((new u.EndpointFactory).extensionApi,o,l.appSettings.getRegion(),i),s={appId:l.appId,Accept:"application/json",authToken:l.authToken,resource:l.getSessionId(),sdk:T.format(I.SDKHeader.sdk,I.SDKHeader.platform,I.SDKHeader.sdkVersion),chatApiVersion:I.APPINFO.apiVersion,"Content-Type":"application/json"};g.postData(e,r,a,s,!1).then(function(e){return e.json()}).then(function(e){e.hasOwnProperty(I.ResponseConstants.RESPONSE_KEYS.KEY_DATA)?t(e[I.ResponseConstants.RESPONSE_KEYS.KEY_DATA]):n(new d.CometChatException(e.error))}).catch(function(e){var t={error:m.FETCH_ERROR.ERROR_IN_API_CALL};n(t)})})},l.setSource=function(e,t,n){T.isFalsy(e)||(this.resource=e),T.isFalsy(t)||(this.platform=t),T.isFalsy(n)||(this.language=n)},l.clearCache=function(){return new Promise(function(e,t){try{h.LocalStorage.getInstance().clearStore().then(function(){T.Logger.info("CometChat: clearCache => All store cleared successfully","true"),e(!0)})}catch(e){T.Logger.error("CometChat: clearCache",e),t(e)}})},l.prototype.restart=function(e){l.shouldPushLoginListener=!1,l.logout().then(function(){l.login(e).then(function(){l.shouldPushLoginListener=!0},function(){l.shouldPushLoginListener=!0})})},l.prototype.internalLogout=function(){try{l.didAnalyticsPingStart()&&l.clearAnalyticsPingTimer(),l.didMessagesPollingStart()&&l.clearMessagesTimer(),l.WSReconnectionInProgress&&l.clearWSReconnectionTimer(),l.isWSCheckTimerStarted&&l.clearWSCheckTimer(),l.isLoggedOut=!0,l.pollingMessagesId=0,l.pollingEnabled=!1,l.pollingInterval=5e3,l.pollingEnabledInternally=!1,l.WSReconnectionStartTime=0,l.WSReconnectionInProgress=!1,l.setLastMessageId(0),l.setAccidentalDisconnect(!1),l.isAnalyticsDisabled=!1,l.shouldFallBackToPolling=!0,l.clearCache().then(function(){l.apiKey=void 0,l.user=void 0,l.authToken=void 0,l.cometChat=void 0,l.mode=void 0,q.WSLogout(),l.pushToLoginListener("","Logout_Success")})}catch(e){T.Logger.error("CometChat: internalLogout",e)}},l.initialzed=!1,l.CometChatException=d.CometChatException,l.TextMessage=S.TextMessage,l.MediaMessage=p.MediaMessage,l.CustomMessage=U.CustomMessage,l.Action=s.Action,l.Call=n.Call,l.TypingIndicator=v.TypingIndicator,l.Group=f.Group,l.AppUser=_.User,l.User=_.User,l.GroupMember=Y.GroupMember,l.Conversation=x.Conversation,l.USER_STATUS={ONLINE:I.PresenceConstatnts.STATUS.ONLINE,OFFLINE:I.PresenceConstatnts.STATUS.OFFLINE},l.MessagesRequest=M.DefaultMessagesRequest,l.MessagesRequestBuilder=M.DefaultMessagesRequestBuilder,l.UsersRequest=y.UsersRequest,l.UsersRequestBuilder=y.UsersRequestBuilder,l.ConversationsRequest=L.ConversationsRequest,l.ConversationsRequestBuilder=L.ConversationsRequestBuilder,l.BlockedUsersRequest=w.BlockedUsersRequest,l.BlockedUsersRequestBuilder=w.BlockedUsersRequestBuilder,l.GroupsRequest=o.GroupsRequest,l.GroupsRequestBuilder=o.GroupsRequestBuilder,l.GroupMembersRequest=i.GroupMembersRequest,l.GroupMembersRequestBuilder=i.GroupMembersRequestBuilder,l.BannedMembersRequest=i.GroupMembersRequest,l.BannedMembersRequestBuilder=i.GroupOutCastMembersRequestBuilder,l.CallSettings=B.CallSettings,l.CallSettingsBuilder=B.CallSettingsBuilder,l.AppSettings=G.AppSettings,l.AppSettingsBuilder=G.AppSettingsBuilder,l.CallingComponent=V.CallingComponent,l.MessageListener=e.MessageEventListener,l.UserListener=e.UserEventListener,l.GroupListener=e.GroupEventListener,l.OngoingCallListener=e.UserCallEventListener,l.CallListener=e.CallEventListener,l.ConnectionListener=e.ConnectionEventListener,l.LoginListener=e.LoginEventListener,l.CallController=N.CallController,l.CometChatHelper=K.CometChatHelper,l.Attachment=F.Attachment,l.MESSAGE_TYPE=I.MessageConstatnts.TYPE,l.CATEGORY_MESSAGE=I.MessageConstatnts.CATEGORY.MESSAGE,l.CATEGORY_ACTION=I.MessageConstatnts.CATEGORY.ACTION,l.CATEGORY_CALL=I.MessageConstatnts.CATEGORY.CALL,l.CATEGORY_CUSTOM=I.MessageConstatnts.CATEGORY.CUSTOM,l.ACTION_TYPE=I.ActionConstatnts.ACTIONS,l.CALL_TYPE=I.CallConstants.CALL_TYPE,l.RECEIVER_TYPE=I.MessageConstatnts.RECEIVER_TYPE,l.CALL_STATUS=I.CallConstants.CALL_STATUS,l.GROUP_MEMBER_SCOPE=I.GROUP_MEMBER_SCOPE,l.GROUP_TYPE=I.GROUP_TYPE,l.MESSAGE_REQUEST=I.MessageConstatnts.PAGINATION.CURSOR_FILEDS,l.CONNECTION_STATUS=I.CONNECTION_STATUS,l.CALL_MODE=I.CallConstants.CALL_MODE,l.AUDIO_MODE=I.CallConstants.AUDIO_MODE,l.WSReconnectionStartTime=0,l.WSMaxReconnectionLimit=10,l.WSCurrentReconnectionCount=0,l.WSReconnectionInProgress=!1,l.WSReconnectionPeriod=3e4,l.WSReconnectionTimerInterval=5e3,l.pollingEnabledInternally=!1,l.accidentalDisconnect=!1,l.successfulPingTimeStamp=0,l.currentConnectionStatus=I.CONNECTION_STATUS.DISCONNECTED,l.isWSCheckTimerStarted=!1,l.wsCheckTimerDuration=3e4,l.isConnectingFromInit=!1,l.loginInProgress=!1,l.lastMessageId=0,l.pollingEnabled=!1,l.pollingInterval=5e3,l.pollingLimit=100,l.pollingAffix="append",l.pollingMessagesId=0,l.settingsInterval=6e4,l.isMessagesPollingStarted=!1,l.isAnalyticsPingStarted=!1,l.isLoggedOut=!0,l.isAnalyticsDisabled=!1,l.shouldFallBackToPolling=!0,l.shouldPushLoginListener=!0,l}();z.CometChat=Z}).call(this,$(27))},function(e,t,n){"use strict";var s,o=this&&this.__extends||(s=function(e,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}s(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});t.__esModule=!0;var r=n(2),i=n(13),a=n(1),E=function(){function e(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(this.hasBlockedMe=!1,this.blockedByMe=!1,1===e.length)typeof e[0]===a.COMMON_UTILITY_CONSTANTS.TYPE_CONSTANTS.STRING?this.uid=e[0]:(this.uid=e[0].uid,this.name=e[0].name,e[0].authToken&&(this.authToken=e[0].authToken),e[0].avatar&&(this.avatar=e[0].avatar),e[0].lastActiveAt&&(this.lastActiveAt=e[0].lastActiveAt),e[0].link&&(this.link=e[0].link),e[0].metadata&&(this.metadata=e[0].metadata),e[0].role&&(this.role=e[0].role),e[0].statusMessage&&(this.statusMessage=e[0].statusMessage),e[0].status&&"offline"!==e[0].status?this.status="online":this.status="offline",e[0].tags&&(this.tags=e[0].tags));else{if(2!==e.length)throw new r.CometChatException(i.ERRORS.PARAMETER_MISSING);this.uid=e[0],this.name=e[1]}}return e.prototype.getUid=function(){return this.uid.toString()},e.prototype.setUid=function(e){this.uid=e},e.prototype.getName=function(){return this.name.toString()},e.prototype.setName=function(e){e&&(this.name=e)},e.prototype.getAuthToken=function(){return this.authToken},e.prototype.setAuthToken=function(e){this.authToken=e},e.prototype.getAvatar=function(){return this.avatar},e.prototype.setAvatar=function(e){this.avatar=e},e.prototype.getLastActiveAt=function(){return this.lastActiveAt},e.prototype.setLastActiveAt=function(e){this.lastActiveAt=e},e.prototype.getLink=function(){return this.link},e.prototype.setLink=function(e){return this.link=e},e.prototype.getMetadata=function(){return this.metadata},e.prototype.setMetadata=function(e){this.metadata=e},e.prototype.getRole=function(){return this.role},e.prototype.setRole=function(e){this.role=e},e.prototype.getStatus=function(){return this.status},e.prototype.setStatus=function(e){this.status=e},e.prototype.getStatusMessage=function(){return this.statusMessage},e.prototype.setStatusMessage=function(e){this.statusMessage=e},e.prototype.setBlockedByMe=function(e){this.blockedByMe=e},e.prototype.getBlockedByMe=function(){return this.blockedByMe},e.prototype.setHasBlockedMe=function(e){this.hasBlockedMe=e},e.prototype.getHasBlockedMe=function(){return this.hasBlockedMe},e.prototype.setTags=function(e){this.tags=e},e.prototype.getTags=function(){return this.tags},e}(),c=function(n){function e(e){var t=n.call(this,e)||this;return t.wsChannel=e.wsChannel,e.jwt&&(t.jwt=e.jwt),t}return o(e,n),e.prototype.getWsChannel=function(){return this.wsChannel},e.prototype.getJWT=function(){return this.jwt},e}(t.User=E);t.Me=c},function(e,t,n){"use strict";t.__esModule=!0,t.WS={protocol:"wss://"},t.READY_STATE={CONNECTING:0,OPEN:1,CLOSING:2,CLOSED:3,INVALID_JWT:4},t.LOGOUT_CODE=1e3,t.LOGOUT_REASON="User logged out",t.TYPING_INDICATOR={TYPE:"typing_indicator",ACTION:{STARTED:"started",ENDED:"ended"}},t.RECEIPTS={TYPE:"receipts",ACTION:{READ:"read",DELIVERED:"delivered"},RECEIPT_TYPE:{READ_RECEIPT:"read",DELIVERY_RECEIPT:"delivery"}},t.PRESENCE={TYPE:"presence",ACTION:{ONLINE:"online",AVAILABLE:"available",OFFLINE:"offline"}},t.MESSAGE={TYPE:"message"},t.AUTH={TYPE:"auth"},t.KEYS={TYPE:"type",ACTION:"action",APP_ID:"appId",RECEIVER:"receiver",RECEIVER_TYPE:"receiverType",DEVICE_ID:"deviceId",BODY:"body",USER:"user",METADATA:"metadata",MESSAGE_ID:"messageId",TIMESTAMP:"timestamp",STATUS:"status",CODE:"code",SENDER:"sender",MESSAGE_SENDER:"messageSender",PRESENCE_SUBSCRIPTION:"presenceSubscription",AUTH:"auth",PING:"ping"}},function(e,t,n){"use strict";t.__esModule=!0;var E=n(29),c=n(3),u=n(0),p=n(2),S=n(13),C=n(1);function l(n,e,s,t,o){var r;return void 0===n&&(n=""),void 0===e&&(e="GET"),void 0===s&&(s={}),void 0===t&&(t={}),s=u.isFalsy(s)?void 0:("GET"==e&&(n+="?",Object.keys(s).map(function(e,t){n=t===Object.keys(s).length-1?n+e+"="+s[e]:n+e+"="+s[e]+"&"}),s=void 0),o&&(r=new FormData,Object.keys(s).map(function(e){"data"!=e?"metadata"!=e&&r.append(e,s[e]):r.append(e,JSON.stringify(s[e]))})),JSON.stringify(s)),fetch(n,{method:e,mode:"cors",cache:"no-cache",headers:t,redirect:"follow",referrer:"no-referrer",body:o?r:s})}t.makeApiCall=function(o,e,r,i){void 0===o&&(o=""),void 0===e&&(e={}),void 0===r&&(r={});var a=c.CometChat.getInstance(c.CometChat.getAppId());return new Promise(function(n,s){try{E.getEndPoint(o,e).then(function(e){var t={resource:c.CometChat.getSessionId(),appId:c.CometChat.getAppId(),Accept:"application/json",sdk:u.format(C.SDKHeader.sdk,C.SDKHeader.platform,C.SDKHeader.sdkVersion)};i||(t["Content-Type"]="application/json"),e.hasOwnProperty("isAdminApi")&&e.isAdminApi?a.getApiKey()?t.apiKey=a.getApiKey():s({error:{code:"API_KEY_NOT_SET",message:"An apiKey is needed to use the "+o+" api.",name:"API_KEY_NOT_SET"}}):a.getAuthToken()?t.authToken=a.getAuthToken():s({error:{code:"USER_NOT_LOGED_IN",message:"An authToken is need to use the "+o+" end-point. PS- We are aware of the spelling mistake, but in order to maintain backward compatibility we cannot change it :(",name:"User not logged-in"}}),l(e.endpoint,e.method,r,t,i).then(function(e){return e.json()}).then(function(e){if(e.hasOwnProperty("data"))e.data.hasOwnProperty("authToken")&&c.CometChat.setAuthToken(e.data.authToken),n(e);else{if(e.hasOwnProperty("error")){var t=e.error;t.hasOwnProperty("code")&&t.code===C.API_ERROR_CODES.AUTH_ERR_AUTH_TOKEN_NOT_FOUND&&c.CometChat.getInstance().internalLogout()}s(e)}}).catch(function(e){var t={error:S.FETCH_ERROR.ERROR_IN_API_CALL};s(t)})}).catch(function(e){return s})}catch(e){s(new p.CometChatException(e))}})},t.makeAdminApiCall=function(o,e,r,i){void 0===o&&(o=""),void 0===e&&(e={}),void 0===r&&(r={});var a=c.CometChat.getInstance(c.CometChat.getAppId());return new Promise(function(n,s){E.getEndPoint(o,e).then(function(e){var t={appId:c.CometChat.getAppId(),Accept:"application/json",sdk:u.format(C.SDKHeader.sdk,C.SDKHeader.platform,C.SDKHeader.sdkVersion)};i||(t["Content-Type"]="application/json"),e.hasOwnProperty("isAdminApi")&&e.isAdminApi?a.getApiKey()?t.apiKey=a.getApiKey():s({error:"An apiKey is need to use the "+o+" api."}):a.getAuthToken()?t.authToken=a.getAuthToken():s({error:"An authToken is need to use the "+o+" api."}),l(e.endpoint,e.method,r,t,i).then(function(e){return e.json()}).then(function(e){e.hasOwnProperty("data")?(e.data.hasOwnProperty("authToken")&&c.CometChat.setAuthToken(e.data.authToken),n(e)):s(e)}).catch(function(e){var t={error:S.FETCH_ERROR.ERROR_IN_API_CALL};s(t)})}).catch(function(e){return s})})},t.postData=l},function(e,t,n){"use strict";t.__esModule=!0;var s=n(1),o=function(){function e(e,t,n,s,o,r,i){this.hasJoined=!1,this.membersCount=0,this.guid=e,t&&(this.name=t),n&&(this.type=n),!s&&""!==s||"password"!=n||(this.password=s),(o||""===o)&&(this.icon=o),(r||""===r)&&(this.description=r),i&&(this.hasJoined=i)}return e.prototype.getGuid=function(){return this.guid},e.prototype.setGuid=function(e){this.guid=e},e.prototype.getName=function(){return this.name},e.prototype.setName=function(e){e&&(this.name=e)},e.prototype.getType=function(){return this.type},e.prototype.setType=function(e){this.type=e},e.prototype.setPassword=function(e){this.password=e},e.prototype.getIcon=function(){return this.icon},e.prototype.setIcon=function(e){this.icon=e},e.prototype.getDescription=function(){return this.description},e.prototype.setDescription=function(e){this.description=e},e.prototype.getOwner=function(){return this.owner},e.prototype.setOwner=function(e){this.owner=e},e.prototype.getMetadata=function(){return this.metadata},e.prototype.setMetadata=function(e){this.metadata=e},e.prototype.getCreatedAt=function(){return this.createdAt},e.prototype.setCreatedAt=function(e){this.createdAt=e},e.prototype.getUpdatedAt=function(){return this.updatedAt},e.prototype.setUpdatedAt=function(e){this.updatedAt=e},e.prototype.getHasJoined=function(){return this.hasJoined},e.prototype.setHasJoined=function(e){this.hasJoined=e},e.prototype.getWsChannel=function(){return this.wsChannel},e.prototype.setWsChannel=function(e){this.wsChannel=e},e.prototype.setScope=function(e){this.scope=e},e.prototype.getScope=function(){return this.scope},e.prototype.getJoinedAt=function(){return this.joinedAt},e.prototype.setJoinedAt=function(e){this.joinedAt=e},e.prototype.getMembersCount=function(){return this.membersCount},e.prototype.setMembersCount=function(e){this.membersCount=e},e.prototype.setTags=function(e){this.tags=e},e.prototype.getTags=function(){return this.tags},e.TYPE=s.GroupType,e.Type=e.TYPE,e}();t.Group=o},function(e,t,n){"use strict";t.__esModule=!0;var s=function(){function e(e,t,n,s){this.receiverId=e,this.type=t,this.receiverType=n,this.category=s}return e.prototype.getId=function(){return this.id},e.prototype.setId=function(e){this.id=e},e.prototype.getConversationId=function(){return this.conversationId},e.prototype.setConversationId=function(e){this.conversationId=e},e.prototype.getParentMessageId=function(){return this.parentMessageId},e.prototype.setParentMessageId=function(e){this.parentMessageId=e},e.prototype.getMuid=function(){return this.muid},e.prototype.setMuid=function(e){this.muid=e},e.prototype.getSender=function(){return this.sender},e.prototype.setSender=function(e){this.sender=e},e.prototype.getReceiver=function(){return this.receiver},e.prototype.setReceiver=function(e){this.receiver=e},e.prototype.getReceiverId=function(){return this.receiverId},e.prototype.setReceiverId=function(e){this.receiverId=e},e.prototype.getType=function(){return this.type},e.prototype.setType=function(e){this.type=e},e.prototype.get=function(){return this.id},e.prototype.setReceiverType=function(e){this.receiverType=e},e.prototype.getReceiverType=function(){return this.receiverType},e.prototype.setSentAt=function(e){this.sentAt=e},e.prototype.getSentAt=function(){return this.sentAt},e.prototype.getStatus=function(){return this.status},e.prototype.setStatus=function(e){this.status=e},e.prototype.getDeliveredAt=function(){return this.deliveredAt},e.prototype.setDeliveredAt=function(e){this.deliveredAt=e},e.prototype.getDeliveredToMeAt=function(){return this.deliveredToMeAt},e.prototype.setDeliveredToMeAt=function(e){this.deliveredToMeAt=e},e.prototype.getReadAt=function(){return this.readAt},e.prototype.setReadAt=function(e){this.readAt=e},e.prototype.getReadByMeAt=function(){return this.readByMeAt},e.prototype.setReadByMeAt=function(e){this.readByMeAt=e},e.prototype.getCategory=function(){return this.category},e.prototype.setCategory=function(e){this.category=e},e.prototype.setEditedAt=function(e){this.editedAt=e},e.prototype.getEditedAt=function(){return this.editedAt},e.prototype.setEditedBy=function(e){this.editedBy=e},e.prototype.getEditedBy=function(){return this.editedBy},e.prototype.setDeletedAt=function(e){this.deletedAt=e},e.prototype.getDeletedAt=function(){return this.deletedAt},e.prototype.setDeletedBy=function(e){this.deletedBy=e},e.prototype.getDeletedBy=function(){return this.deletedBy},e.prototype.getReplyCount=function(){return this.replyCount},e.prototype.setReplyCount=function(e){this.replyCount=e},e}();t.BaseMessage=s},function(e,t,n){"use strict";t.__esModule=!0;var r=n(16),i=n(17),a=n(0),E=n(1),c=n(20),u=n(21),p=n(22),S=n(2),C=n(18),l=n(19),T=n(3),d=n(10),s=function(){function e(){}return e.trasformJSONMessge=function(n){try{var e=void 0;switch(n[E.MessageConstatnts.KEYS.CATEGORY]){case E.MessageConstatnts.CATEGORY.ACTION:e=c.Action.actionFromJSON(n);break;case E.MessageConstatnts.CATEGORY.CALL:e=u.Call.callFromJSON(n);break;case E.MessageConstatnts.CATEGORY.MESSAGE:switch(n[E.MessageConstatnts.KEYS.TYPE]){case E.MessageConstatnts.TYPE.TEXT:e=new r.TextMessage(n[E.MessageConstatnts.KEYS.RECEIVER],n[E.MessageConstatnts.KEYS.DATA][E.MessageConstatnts.KEYS.TEXT],n[E.MessageConstatnts.KEYS.RECEIVER_TYPE]);break;case E.MessageConstatnts.TYPE.CUSTOM:e=new l.CustomMessage(n[E.MessageConstatnts.KEYS.RECEIVER],n[E.MessageConstatnts.KEYS.DATA][E.MessageConstatnts.KEYS.CUSTOM_DATA],n[E.MessageConstatnts.KEYS.RECEIVER_TYPE]);break;default:if(e=new i.MediaMessage(n[E.MessageConstatnts.KEYS.RECEIVER],n[E.MessageConstatnts.KEYS.DATA][E.MessageConstatnts.KEYS.URL],n[E.MessageConstatnts.KEYS.TYPE],n[E.MessageConstatnts.KEYS.RECEIVER_TYPE]),n.hasOwnProperty(E.MessageConstatnts.KEYS.DATA)){var t=n[E.MessageConstatnts.KEYS.DATA];if(t.hasOwnProperty(E.MessageConstatnts.KEYS.ATTATCHMENTS)){var s,o=t[E.MessageConstatnts.KEYS.ATTATCHMENTS];new Array;o.map(function(e){s=new C.Attachment(e)}),e.setAttachment(s)}t.hasOwnProperty(E.MessageConstatnts.KEYS.TEXT)&&e.setCaption(t[E.MessageConstatnts.KEYS.TEXT])}e.hasOwnProperty("file")&&delete e.file}break;case E.MessageConstatnts.CATEGORY.CUSTOM:e=new l.CustomMessage(n[E.MessageConstatnts.KEYS.RECEIVER],n[E.MessageConstatnts.KEYS.DATA][E.MessageConstatnts.KEYS.CUSTOM_DATA],n[E.MessageConstatnts.KEYS.RECEIVER_TYPE],n.type)}n[E.MessageConstatnts.KEYS.MY_RECEIPTS]&&(n[E.MessageConstatnts.KEYS.MY_RECEIPTS]=n[E.MessageConstatnts.KEYS.MY_RECEIPTS],Object.keys(n[E.MessageConstatnts.KEYS.MY_RECEIPTS]).map(function(e){var t=new p.MessageReceipt;e==E.DELIVERY_RECEIPTS.DELIVERED_AT&&(t.setReceiptType(t.RECEIPT_TYPE.DELIVERY_RECEIPT),t.setDeliveredAt(n[E.MessageConstatnts.KEYS.MY_RECEIPTS][E.DELIVERY_RECEIPTS.DELIVERED_AT]),a.isFalsy(n[E.MessageConstatnts.KEYS.MY_RECEIPTS][E.DELIVERY_RECEIPTS.RECIPIENT])?n[E.DELIVERY_RECEIPTS.DELIVERED_TO_ME_AT]=n[E.MessageConstatnts.KEYS.MY_RECEIPTS][E.DELIVERY_RECEIPTS.DELIVERED_AT]:t.setSender(n[E.MessageConstatnts.KEYS.MY_RECEIPTS][E.DELIVERY_RECEIPTS.RECIPIENT]),t.setReceiverType(n[E.MessageConstatnts.KEYS.RECEIVER_TYPE]),t.setReceiver(n[E.MessageConstatnts.KEYS.RECEIVER])),n[E.MessageConstatnts.KEYS.MY_RECEIPTS][E.READ_RECEIPTS.READ_AT]&&(t.setReceiptType(t.RECEIPT_TYPE.READ_RECEIPT),t.setReadAt(n[E.MessageConstatnts.KEYS.MY_RECEIPTS][E.READ_RECEIPTS.READ_AT]),a.isFalsy(n[E.MessageConstatnts.KEYS.MY_RECEIPTS][E.READ_RECEIPTS.RECIPIENT])?n[E.READ_RECEIPTS.READ_BY_ME_AT]=n[E.MessageConstatnts.KEYS.MY_RECEIPTS][E.READ_RECEIPTS.READ_AT]:t.setSender(n[E.MessageConstatnts.KEYS.MY_RECEIPTS][E.READ_RECEIPTS.RECIPIENT]),t.setReceiverType(n[E.MessageConstatnts.KEYS.RECEIVER_TYPE]),t.setReceiver(n[E.MessageConstatnts.KEYS.RECEIVER]))}));try{if(Object.assign(e,n),(n=e).parentId&&(n.parentMessageId=n.parentId,delete n.parentId),n instanceof r.TextMessage)n.setSender(n.getSender()),n.setReceiver(n.getReceiver()),n.getData()[E.MessageConstatnts.KEYS.METADATA]&&n.setMetadata(n.getData()[E.MessageConstatnts.KEYS.METADATA]);else if(n instanceof i.MediaMessage)n.getData()[E.MessageConstatnts.KEYS.METADATA]&&n.setMetadata(n.getData()[E.MessageConstatnts.KEYS.METADATA]),n.setSender(n.getSender()),n.setReceiver(n.getReceiver());else if(n instanceof c.Action)n.setSender(n.getSender()),n.setReceiver(n.getActionFor()),n.setActionBy(n.getActionBy()),n.setActionOn(n.getActionOn()),n.setActionFor(n.getActionFor()),n.setMessage(n.getMessage());else if(n instanceof u.Call){try{n.setSender(n.getSender())}catch(e){a.Logger.error("MessageController: trasformJSONMessge: setSender",e)}try{n.setCallInitiator(n.getCallInitiator())}catch(e){a.Logger.error("MessageController: trasformJSONMessge: setCallInitiator",e)}try{n.setReceiver(n.getCallReceiver()),n.setCallReceiver(n.getCallReceiver())}catch(e){a.Logger.error("MessageController: trasformJSONMessge: setCallreceiver",e)}}else n instanceof l.CustomMessage&&(n.getData()[E.MessageConstatnts.KEYS.METADATA]&&n.setMetadata(n.getData()[E.MessageConstatnts.KEYS.METADATA]),n.setSubType(n.getData()[E.MessageConstatnts.KEYS.CUSTOM_SUB_TYPE]),n.setSender(n.getSender()),n.setReceiver(n.getReceiver()))}catch(e){a.Logger.error("MessageController: trasformJSONMessge: Main",e),n=null}return n}catch(e){a.Logger.error("MessageController: trasformJSONMessge",e)}},e.getReceiptsFromJSON=function(o){return new Promise(function(e,t){try{var s=[];T.CometChat.getLoggedInUser().then(function(n){a.isFalsy(o.receipts)?e([]):(o.receipts.data.map(function(e){var t=new p.MessageReceipt;e[E.DELIVERY_RECEIPTS.DELIVERED_AT]&&(t.setReceiptType(t.RECEIPT_TYPE.DELIVERY_RECEIPT),t.setDeliveredAt(e[E.DELIVERY_RECEIPTS.DELIVERED_AT]),t.setTimestamp(e[E.DELIVERY_RECEIPTS.DELIVERED_AT]),a.isFalsy(e[E.DELIVERY_RECEIPTS.RECIPIENT])?t.setSender(n):t.setSender(d.UsersController.trasformJSONUser(e[E.DELIVERY_RECEIPTS.RECIPIENT])),t.setReceiverType(o[E.MessageConstatnts.KEYS.RECEIVER_TYPE]),t.setReceiver(o[E.MessageConstatnts.KEYS.RECEIVER])),e[E.READ_RECEIPTS.READ_AT]&&(t.setReceiptType(t.RECEIPT_TYPE.READ_RECEIPT),t.setReadAt(e[E.READ_RECEIPTS.READ_AT]),t.setTimestamp(e[e[E.READ_RECEIPTS.READ_AT]]),a.isFalsy(e[E.READ_RECEIPTS.RECIPIENT])?t.setSender(n):t.setSender(d.UsersController.trasformJSONUser(e[E.READ_RECEIPTS.RECIPIENT])),t.setReceiverType(o[E.MessageConstatnts.KEYS.RECEIVER_TYPE]),t.setReceiver(o[E.MessageConstatnts.KEYS.RECEIVER])),s.push(t)}),e(s))})}catch(e){t(new S.CometChatException(e))}})},e}();t.MessageController=s},function(e,t,n){"use strict";t.__esModule=!0;var s=n(4),o=n(0),r=function(){function e(){}return e.trasformJSONUser=function(e){var t;try{e.uid=e.uid.toString(),e.name=e.name.toString(),e.status&&"offline"!==e.status?e.status="online":e.status="offline",t=new s.User(e),Object.assign(t,e),e=t}catch(e){o.Logger.error("UsersController:transformJSONUser",e)}return e},e}();t.UsersController=r},function(e,t,n){"use strict";t.__esModule=!0;var i=n(0),s=n(5),o=function(){function e(e,t,n,s,o,r){i.isFalsy(e)||(this.appId=e),i.isFalsy(t)||(this.receiver=t),i.isFalsy(n)||(this.receiverType=n),i.isFalsy(o)||(this.deviceId=o),i.isFalsy(s)||(this.sender=s),i.isFalsy(r)||(this.messageSender=r)}return e.prototype.getAppId=function(){return this.appId},e.prototype.setAppId=function(e){this.appId=e},e.prototype.getReceiver=function(){return this.receiver},e.prototype.setReceiver=function(e){this.receiver=e},e.prototype.getSender=function(){return this.sender},e.prototype.setSender=function(e){this.sender=e},e.prototype.getReceiverType=function(){return this.receiverType},e.prototype.setReceiverType=function(e){this.receiverType=e},e.prototype.getType=function(){return this.type},e.prototype.setType=function(e){this.type=e},e.prototype.getDeviceId=function(){return this.deviceId},e.prototype.setDeviceId=function(e){this.deviceId=e},e.prototype.getMessageSender=function(){return this.messageSender},e.prototype.setMessageSender=function(e){this.messageSender=e},e.prototype.getCometChatEventJSON=function(){var e={};return e[s.KEYS.APP_ID]=this.getAppId(),e[s.KEYS.RECEIVER]=this.getReceiver(),e[s.KEYS.RECEIVER_TYPE]=this.getReceiverType(),e[s.KEYS.DEVICE_ID]=this.getDeviceId(),e[s.KEYS.TYPE]=this.getType(),e[s.KEYS.SENDER]=this.getSender(),i.isFalsy(this.getMessageSender())||(e[s.KEYS.MESSAGE_SENDER]=this.getMessageSender()),e},e}();t.CometChatEvent=o},function(e,t){e.exports=n},function(e,t,n){"use strict";t.__esModule=!0,t.SERVER_ERRORS={AUTH_ERR:{code:"AUTH_ERR_AUTH_TOKEN_NOT_FOUND",message:"The auth token %s% does not exist. Please make sure you are logged in and have a valid auth token or try login again."}},t.ERRORS={PARAMETER_MISSING:{code:"MISSING_PARAMETERS",name:"Invalid or no parameter passed to the method."}},t.INIT_ERROR={NO_APP_ID:{code:t.ERRORS.PARAMETER_MISSING.code,name:t.ERRORS.PARAMETER_MISSING.name,message:"AppID cannot be empty. Please specify a valid appID.",details:{}}},t.GROUP_CREATION_ERRORS={EMPTY_PASSWORD:{code:"ERR_EMPTY_GROUP_PASS",details:void 0,message:"Password is mandatory to join a group.",name:void 0}},t.USERS_REQUEST_ERRORS={EMPTY_USERS_LIST:{code:"EMPTY_USERS_LIST",name:"EMPTY_USERS_LIST",message:"The users list needs to have atleast one UID.",details:{}}},t.MESSAGES_REQUEST_ERRORS={REQUEST_IN_PROGRESS_ERROR:{code:"REQUEST_IN_PROGRESS",name:"REQUEST_IN_PROGRESS",message:"Request in progress.",details:{}},NOT_ENOUGH_PARAMS:{code:"NOT_ENOUGH_PARAMETERS",name:"NOT_ENOUGH_PARAMETERS",message:"`Timestamp`, `MessageId` or `updatedAfter` is required to use the 'fetchNext()' method.",details:{}}},t.MESSAGE_ERRORS={INVALID_CUSTOM_DATA:{code:"-1",name:"%s_CUSTOM_DATA",message:"",details:{}}},t.LOGIN_ERROR={NOT_INITIALIZED:{code:"-1",name:"COMETCHAT_INITIALIZATION_NOT_DONE",message:"please initialize the cometchat before using login method.",details:{}},UNAUTHORISED:{code:401,name:"USER_NOT_AUTHORISED",message:"The `authToken` of the user is not authorised. Please verify again.",details:{}},WS_CONNECTION_FAIL:{code:-1,name:"WS_CONNECTION_FAIL",message:"WS Connection failed. %s",details:{}},WS_CONNECTION_FAIL_PORT_ERROR:{code:-1,name:"WS_CONNECTION_FAIL",message:"WS Connection failed. Trying to connect with port: %s",details:{}},WS_CONNECTION_FALLBACK_FAIL_PORT_ERROR:{code:-1,name:"WS_CONNECTION_FALLBACK_FAIL",message:"WS Connection fallback failed. Trying to connect with port: %s",details:{}},WS_AUTH_FAIL:{code:-1,name:"WS_AUTH_FAIL",message:"WS username/password not correct.",details:{}},NO_INTERNET:{code:-1,name:"NO_INTERNET_CONNECTION",message:"You do not have internet connection.",details:{}},REQUEST_IN_PROGRESS:{code:-1,name:"LOGIN_IN_PROGRESS",message:"Please wait until the previous login request ends.",details:{}}},t.TYPINGNOTIFICATION_CONSTANTS={TOO_MANY_REQUEST:{code:"TOO_MANY_REQUEST",name:"TOO MANY REQUEST",message:"too many request, wait for `%s` seconds before sending next request.",details:{}}},t.FETCH_ERROR={ERROR_IN_API_CALL:{code:"FAILED_TO_FETCH",name:"FAILED_TO_FETCH",message:"There is an unknown issue with the API request. Please check your internet connection and verify the api call.",details:{}}}},function(e,t,n){"use strict";t.__esModule=!0;var r=n(0),i=n(1),a=n(2),s=n(12),o=function(){function e(e){this.store=i.constants.DEFAULT_STORE,r.isFalsy(e)||(this.store=e);try{this.localStore=s.default}catch(e){r.Logger.error("store: constructor",{e:e})}}return e.getInstance=function(){return null==e.localStorage&&(e.localStorage=new e),e.localStorage},e.prototype.set=function(e,t){var n=r.getKeyprefix(i.LOCAL_STORE.COMMON_STORE,e);return this.localStore.setItem(n,JSON.stringify(t))},e.prototype.get=function(e){var s=this,o=r.getKeyprefix(i.LOCAL_STORE.COMMON_STORE,e);return new Promise(function(n,t){try{s.localStore.getItem(o).then(function(t){try{n(JSON.parse(t))}catch(e){n(t)}},function(e){t(e)})}catch(e){t(new a.CometChatException(e))}})},e.prototype.clearStore=function(){var o=this;return new Promise(function(n,t){try{var s=[r.getKeyprefix(i.LOCAL_STORE.COMMON_STORE,i.LOCAL_STORE.KEY_USER),r.getKeyprefix(i.LOCAL_STORE.COMMON_STORE,i.LOCAL_STORE.KEY_APP_SETTINGS)];o.localStore.getAllKeys().then(function(e){if(0<e.length)for(var t=0;t<e.length;t++)-1!==s.indexOf(e[t])&&o.localStore.removeItem(e[t]),t===e.length-1&&n(!0);else n(!0)},function(e){t(e)})}catch(e){t(e)}})},e.prototype.clear=function(e){},e.prototype.selectStore=function(e){this.store=e},e.localStorage=null,e}();t.LocalStorage=o},function(e,t,n){"use strict";t.__esModule=!0;var s=n(7),o=n(1),r=n(0),i=function(){function e(){}return e.trasformJSONGroup=function(e){var t;try{t=new s.Group(e[o.GroupConstants.KEYS.GUID],e[o.GroupConstants.KEYS.NAME],e[o.GroupConstants.KEYS.TYPE]),e.wsChannel&&delete e.wsChannel,Object.assign(t,e),e=t}catch(e){r.Logger.error("GroupsController:transformJSONGroup",e)}return e},e}();t.GroupsController=i},function(e,t,n){"use strict";var s,r=this&&this.__extends||(s=function(e,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}s(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,n=1,s=arguments.length;n<s;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};t.__esModule=!0;var o=n(8),a=n(1),E=n(4),c=n(7),u=n(0),p=function(o){function e(e,t,n){var s=o.call(this,e,"text",n,a.MessageCategory.MESSAGE)||this;return s.type="text",s.data={text:t},s.text=t,s}return r(e,o),e.prototype.getSender=function(){try{return this.getSenderFromData()}catch(e){return this.sender}},e.prototype.getReceiver=function(){try{return this.getReceiverFromData()}catch(e){return this.receiver}},e.prototype.getMetadata=function(){return this.data.metadata&&(this.metadata=this.data.metadata),this.metadata},e.prototype.setMetadata=function(e){this.metadata=e,this.data=i({},this.data,{metadata:e})},e.prototype.getData=function(){return this.data},e.prototype.setData=function(e){this.data=e},e.prototype.getText=function(){return this.text},e.prototype.setText=function(e){this.text=e,this.data.text=e},e.prototype.setProcessedText=function(e){this.processedText=e},e.prototype.getProcessedText=function(){return this.processedText},e.prototype.getSenderFromData=function(){try{var e=this.getData();if(e[a.ResponseConstants.RESPONSE_KEYS.KEY_ENTITIES][a.MessageConstatnts.KEYS.SENDER][a.ResponseConstants.RESPONSE_KEYS.KEY_ENTITITY])return new E.User(e[a.ResponseConstants.RESPONSE_KEYS.KEY_ENTITIES][a.MessageConstatnts.KEYS.SENDER][a.ResponseConstants.RESPONSE_KEYS.KEY_ENTITITY])}catch(e){u.Logger.error("TextMessageModel: getSenderFromData",e)}},e.prototype.getReceiverFromData=function(){try{var e=this.getData(),t=e[a.ResponseConstants.RESPONSE_KEYS.KEY_ENTITIES][a.MessageConstatnts.KEYS.RECEIVER][a.ResponseConstants.RESPONSE_KEYS.KEY_ENTITITY];if(e[a.ResponseConstants.RESPONSE_KEYS.KEY_ENTITIES][a.MessageConstatnts.KEYS.RECEIVER][a.ResponseConstants.RESPONSE_KEYS.KEY_ENTITYTYPE]==[a.ResponseConstants.RESPONSE_KEYS.KEY_ENTITY_TYPE.USER])return new E.User(t);var n=new c.Group(t[a.GroupConstants.KEYS.GUID],t[a.GroupConstants.KEYS.NAME],t[a.MessageConstatnts.KEYS.TYPE]);return Object.assign(n,t)}catch(e){u.Logger.error("TextMessageModel: getReceiverFromData",e)}},e.TYPE=a.MessageConstatnts.TYPE.TEXT,e.RECEIVER_TYPE=a.MessageConstatnts.RECEIVER_TYPE,e.CATEGORY=a.MessageConstatnts.CATEGORY.MESSAGE,e}(o.BaseMessage);t.TextMessage=p},function(e,t,n){"use strict";var s,o=this&&this.__extends||(s=function(e,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}s(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,n=1,s=arguments.length;n<s;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};t.__esModule=!0;var r=n(8),a=n(1),E=n(4),c=n(18),u=n(7),p=n(0),S=function(r){function e(e,t,n,s){var o=r.call(this,e,n,s,a.MessageCategory.MESSAGE)||this;return o.data={},"object"!=typeof t?o.data={url:t}:o.file=t,o}return o(e,r),e.prototype.setCaption=function(e){this.caption=e,this.data[a.MessageConstatnts.KEYS.TEXT]=e},e.prototype.getCaption=function(){return this.data[a.MessageConstatnts.KEYS.TEXT]},e.prototype.getSender=function(){try{return this.getSenderFromData()}catch(e){return this.sender}},e.prototype.getReceiver=function(){try{return this.getReceiverFromData()}catch(e){return this.receiver}},e.prototype.getMetadata=function(){return this.data.metadata&&(this.metadata=this.data.metadata),this.metadata},e.prototype.setMetadata=function(e){this.metadata=e,this.data=i({},this.data,{metadata:e})},e.prototype.getData=function(){return this.data},e.prototype.setData=function(e){this.data=e},e.prototype.getAttachment=function(){return new c.Attachment(this.data.attachments[0])},e.prototype.setAttachment=function(e){this.data.attachments=[e.toJSON(e)]},e.prototype.getURL=function(){try{var e=this.getData();if(e[a.MessageConstatnts.KEYS.URL])return e[a.MessageConstatnts.KEYS.URL]}catch(e){p.Logger.error("MediaMessageModel: getURL",e)}},e.prototype.getSenderFromData=function(){try{var e=this.getData();if(e[a.ResponseConstants.RESPONSE_KEYS.KEY_ENTITIES][a.MessageConstatnts.KEYS.SENDER][a.ResponseConstants.RESPONSE_KEYS.KEY_ENTITITY])return new E.User(e[a.ResponseConstants.RESPONSE_KEYS.KEY_ENTITIES][a.MessageConstatnts.KEYS.SENDER][a.ResponseConstants.RESPONSE_KEYS.KEY_ENTITITY])}catch(e){p.Logger.error("MediaMessageModel: getSenderFromData",e)}},e.prototype.getReceiverFromData=function(){try{var e=this.getData(),t=e[a.ResponseConstants.RESPONSE_KEYS.KEY_ENTITIES][a.MessageConstatnts.KEYS.RECEIVER][a.ResponseConstants.RESPONSE_KEYS.KEY_ENTITITY];if(e[a.ResponseConstants.RESPONSE_KEYS.KEY_ENTITIES][a.MessageConstatnts.KEYS.RECEIVER][a.ResponseConstants.RESPONSE_KEYS.KEY_ENTITYTYPE]==[a.ResponseConstants.RESPONSE_KEYS.KEY_ENTITY_TYPE.USER])return new E.User(t);var n=new u.Group(t[a.GroupConstants.KEYS.GUID],t[a.GroupConstants.KEYS.NAME],t[a.MessageConstatnts.KEYS.TYPE]);return Object.assign(n,t)}catch(e){p.Logger.error("MediaMessageModel: getReceiverFromData",e)}},e.TYPE=a.MessageConstatnts.TYPE,e.RECEIVER_TYPE=a.MessageConstatnts.RECEIVER_TYPE,e.CATEGORY=a.MessageConstatnts.CATEGORY,e}(r.BaseMessage);t.MediaMessage=S},function(e,t,n){"use strict";t.__esModule=!0;var s=n(1),o=function(){function t(e){e.hasOwnProperty(s.ATTACHMENTS_CONSTANTS.KEYS.EXTENSION)&&(this.extension=e[s.ATTACHMENTS_CONSTANTS.KEYS.EXTENSION]),e.hasOwnProperty(s.ATTACHMENTS_CONSTANTS.KEYS.MIME_TYPE)&&(this.mimeType=e[s.ATTACHMENTS_CONSTANTS.KEYS.MIME_TYPE]),e.hasOwnProperty(s.ATTACHMENTS_CONSTANTS.KEYS.NAME)&&(this.name=e[s.ATTACHMENTS_CONSTANTS.KEYS.NAME]),e.hasOwnProperty(s.ATTACHMENTS_CONSTANTS.KEYS.SIZE)&&(this.size=e[s.ATTACHMENTS_CONSTANTS.KEYS.SIZE]),e.hasOwnProperty(s.ATTACHMENTS_CONSTANTS.KEYS.URL)&&(this.url=e[s.ATTACHMENTS_CONSTANTS.KEYS.URL])}return t.prototype.createFileFromJSON=function(e){return new t(e)},t.prototype.toJSON=function(e){return{extension:e.getExtension(),mimeType:e.getMimeType(),name:e.getName(),url:e.getUrl(),size:e.getSize()}},t.prototype.getExtension=function(){return this.extension},t.prototype.setExtension=function(e){this.extension=e},t.prototype.getMimeType=function(){return this.mimeType},t.prototype.setMimeType=function(e){this.mimeType=e},t.prototype.getName=function(){return this.name},t.prototype.setName=function(e){this.name=e},t.prototype.getSize=function(){return this.size},t.prototype.setSize=function(e){this.size=e},t.prototype.getUrl=function(){return this.url},t.prototype.setUrl=function(e){this.url=e},t}();t.Attachment=o},function(e,t,n){"use strict";var s,o=this&&this.__extends||(s=function(e,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}s(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,s=arguments.length;n<s;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};t.__esModule=!0;var i=n(8),E=n(1),c=n(4),u=n(0),p=n(7),a=function(a){function e(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=this;if(3==e.length){var s=e[0],o=e[1],r=e[2];n=a.call(this,s,E.MessageConstatnts.TYPE.CUSTOM,o,E.MessageCategory.MESSAGE)||this,("object"!=typeof r||Array.isArray(r))&&(r={}),n.customData=r,u.isFalsy(n.data)&&(n.data={}),n.data[E.MessageConstatnts.KEYS.CUSTOM_DATA]=r}if(4==e.length){s=e[0],o=e[1];var i=e[2];r=e[3];n=a.call(this,s,i,o,E.MessageCategory.CUSTOM)||this,("object"!=typeof r||Array.isArray(r))&&(r={}),n.customData=r,u.isFalsy(n.data)&&(n.data={}),n.data[E.MessageConstatnts.KEYS.CUSTOM_DATA]=r}return n}return o(e,a),e.prototype.getCustomData=function(){return this.customData},e.prototype.setCustomData=function(e){this.customData=e,this.data[E.MessageConstatnts.KEYS.CUSTOM_DATA]=e},e.prototype.getSender=function(){try{return this.getSenderFromData()}catch(e){return this.sender}},e.prototype.getReceiver=function(){try{return this.getReceiverFromData()}catch(e){return this.receiver}},e.prototype.getSubType=function(){return this.subType},e.prototype.setSubType=function(e){this.subType=e,this.data=r({},this.data,{subType:e})},e.prototype.getMetadata=function(){return this.metadata},e.prototype.setMetadata=function(e){this.metadata=e,this.data=r({},this.data,{metadata:e})},e.prototype.getData=function(){return this.data},e.prototype.getSenderFromData=function(){try{var e=this.getData();if(e[E.ResponseConstants.RESPONSE_KEYS.KEY_ENTITIES][E.MessageConstatnts.KEYS.SENDER][E.ResponseConstants.RESPONSE_KEYS.KEY_ENTITITY])return new c.User(e[E.ResponseConstants.RESPONSE_KEYS.KEY_ENTITIES][E.MessageConstatnts.KEYS.SENDER][E.ResponseConstants.RESPONSE_KEYS.KEY_ENTITITY])}catch(e){u.Logger.error("CustomMessageModel: getSenderFromData",e)}},e.prototype.getReceiverFromData=function(){try{var e=this.getData(),t=e[E.ResponseConstants.RESPONSE_KEYS.KEY_ENTITIES][E.MessageConstatnts.KEYS.RECEIVER][E.ResponseConstants.RESPONSE_KEYS.KEY_ENTITITY];if(e[E.ResponseConstants.RESPONSE_KEYS.KEY_ENTITIES][E.MessageConstatnts.KEYS.RECEIVER][E.ResponseConstants.RESPONSE_KEYS.KEY_ENTITYTYPE]==[E.ResponseConstants.RESPONSE_KEYS.KEY_ENTITY_TYPE.USER])return new c.User(t);var n=new p.Group(t[E.GroupConstants.KEYS.GUID],t[E.GroupConstants.KEYS.NAME],t[E.MessageConstatnts.KEYS.TYPE]);return Object.assign(n,t)}catch(e){u.Logger.error("CustomMessageModel: getReceiverFromData",e)}},e}(i.BaseMessage);t.CustomMessage=a},function(e,t,n){"use strict";var s,o=this&&this.__extends||(s=function(e,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}s(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,s=arguments.length;n<s;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};t.__esModule=!0;var i=n(8),c=n(7),u=n(4),p=n(1),a=n(0),S=n(9),E=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.actionFromJSON=function(e){var t=new this(e[p.MessageConstatnts.KEYS.RECEIVER],e[p.MessageConstatnts.KEYS.TYPE],e[p.MessageConstatnts.KEYS.RECEIVER_TYPE],p.MessageCategory.ACTION),n=e[p.MessageConstatnts.KEYS.DATA];if(t.data=n,t.setAction(n[p.MessageConstatnts.KEYS.ACTION]),n[p.ActionConstatnts.ACTION_KEYS.EXTRAS]){var s=n[p.ActionConstatnts.ACTION_KEYS.EXTRAS];if(s[p.ActionConstatnts.ACTION_KEYS.SCOPE]){var o=s[p.ActionConstatnts.ACTION_KEYS.SCOPE];o[p.ActionConstatnts.ACTION_KEYS.NEW]&&o[p.ActionConstatnts.ACTION_KEYS.OLD]&&(t.setOldScope(o[p.ActionConstatnts.ACTION_KEYS.OLD]),t.setNewScope(o[p.ActionConstatnts.ACTION_KEYS.NEW]))}}n[p.MessageConstatnts.KEYS.METADATA]&&t.setMetadata(n[p.MessageConstatnts.KEYS.METADATA]);var r=n[p.ActionConstatnts.ACTION_KEYS.ENTITIES];if(r[p.ActionConstatnts.ACTION_SUBJECTS.ACTION_BY])if(r[p.ActionConstatnts.ACTION_SUBJECTS.ACTION_BY][p.ActionConstatnts.ACTION_KEYS.ENTITY_TYPE]==p.ActionConstatnts.ACTION_ENTITY_TYPE.USER){var i=new u.User(r[p.ActionConstatnts.ACTION_SUBJECTS.ACTION_BY][p.ActionConstatnts.ACTION_KEYS.ENTITY]);Object.assign(i,r[p.ActionConstatnts.ACTION_SUBJECTS.ACTION_BY][p.ActionConstatnts.ACTION_KEYS.ENTITY]),t.actionBy=i,t.setSender(i)}else{var a=new c.Group("","","");Object.assign(a,r[p.ActionConstatnts.ACTION_SUBJECTS.ACTION_BY][p.ActionConstatnts.ACTION_KEYS.ENTITY]),t.actionBy=a}if(r[p.ActionConstatnts.ACTION_SUBJECTS.ACTION_FOR])if(r[p.ActionConstatnts.ACTION_SUBJECTS.ACTION_FOR][p.ActionConstatnts.ACTION_KEYS.ENTITY_TYPE]==p.ActionConstatnts.ACTION_ENTITY_TYPE.USER){i=new u.User(r[p.ActionConstatnts.ACTION_SUBJECTS.ACTION_FOR][p.ActionConstatnts.ACTION_KEYS.ENTITY]);Object.assign(i,r[p.ActionConstatnts.ACTION_SUBJECTS.ACTION_FOR][p.ActionConstatnts.ACTION_KEYS.ENTITY]),t.actionFor=i}else{a=new c.Group("","","");Object.assign(a,r[p.ActionConstatnts.ACTION_SUBJECTS.ACTION_FOR][p.ActionConstatnts.ACTION_KEYS.ENTITY]),t.actionFor=a}if(r[p.ActionConstatnts.ACTION_SUBJECTS.ACTION_ON])if(r[p.ActionConstatnts.ACTION_SUBJECTS.ACTION_ON][p.ActionConstatnts.ACTION_KEYS.ENTITY_TYPE]==p.ActionConstatnts.ACTION_ENTITY_TYPE.USER){i=new u.User(r[p.ActionConstatnts.ACTION_SUBJECTS.ACTION_ON][p.ActionConstatnts.ACTION_KEYS.ENTITY]);Object.assign(i,r[p.ActionConstatnts.ACTION_SUBJECTS.ACTION_ON][p.ActionConstatnts.ACTION_KEYS.ENTITY]),t.actionOn=i}else if(r[p.ActionConstatnts.ACTION_SUBJECTS.ACTION_ON][p.ActionConstatnts.ACTION_KEYS.ENTITY_TYPE]==p.ActionConstatnts.ACTION_ENTITY_TYPE.GROUP){a=new c.Group("","","");Object.assign(a,r[p.ActionConstatnts.ACTION_SUBJECTS.ACTION_ON][p.ActionConstatnts.ACTION_KEYS.ENTITY]),t.actionOn=a}else if(r[p.ActionConstatnts.ACTION_SUBJECTS.ACTION_ON][p.ActionConstatnts.ACTION_KEYS.ENTITY_TYPE]==p.ActionConstatnts.ACTION_ENTITY_TYPE.MESSAGE){var E=S.MessageController.trasformJSONMessge(r[p.ActionConstatnts.ACTION_SUBJECTS.ACTION_ON][p.ActionConstatnts.ACTION_KEYS.ENTITY]);t.actionOn=E}return t.setMessage(t.getActionMessage(t)),t},t.prototype.getOldScope=function(){return this.oldScope},t.prototype.getNewScope=function(){return this.newScope},t.prototype.setNewScope=function(e){this.newScope=e},t.prototype.setOldScope=function(e){this.oldScope=e},t.prototype.setRawData=function(e){this.rawData=e},t.prototype.getRawData=function(){return this.rawData},t.prototype.setMessage=function(e){this.message=e},t.prototype.getMessage=function(){return this.message},t.prototype.setAction=function(e){this.action=e},t.prototype.getAction=function(){return this.action},t.prototype.getSender=function(){try{return this.getSenderFromData()}catch(e){return this.sender}},t.prototype.setActionBy=function(e){this.actionBy=e},t.prototype.getActionBy=function(){return this.actionBy},t.prototype.setActionOn=function(e){this.actionOn=e},t.prototype.getActionOn=function(){return this.actionOn},t.prototype.setActionFor=function(e){this.actionFor=e},t.prototype.getActionFor=function(){return this.actionFor},t.prototype.getMetadata=function(){return this.data.metadata&&(this.metadata=this.data.metadata),this.metadata},t.prototype.setMetadata=function(e){this.metadata=e,this.data=r({},this.data,{metadata:e})},t.prototype.getActionMessage=function(e){var t="";switch(e.getType()){case p.ActionConstatnts.ACTION_KEYS.ACTION_TYPE_USER:case p.ActionConstatnts.ACTION_KEYS.ACTION_TYPE_GROUP:switch(e.getAction()){case p.ActionConstatnts.ACTION_KEYS.ACTION_CREATED:case p.ActionConstatnts.ACTION_KEYS.ACTION_UPDATED:case p.ActionConstatnts.ACTION_KEYS.ACTION_DELETED:}break;case p.ActionConstatnts.ACTION_KEYS.ACTION_TYPE_GROUP_MEMBER:switch(e.getAction()){case p.ActionConstatnts.ACTION_KEYS.TYPE_MEMBER_JOINED:var n=e.getActionBy();t=a.format(p.ActionConstatnts.ActionMessages.ACTION_GROUP_JOINED_MESSAGE,n.getName());break;case p.ActionConstatnts.ACTION_KEYS.TYPE_MEMBER_LEFT:n=e.getActionBy();t=a.format(p.ActionConstatnts.ActionMessages.ACTION_GROUP_LEFT_MESSAGE,n.getName());break;case p.ActionConstatnts.ACTION_KEYS.TYPE_MEMBER_KICKED:n=e.getActionBy();var s=e.getActionOn();t=a.format(p.ActionConstatnts.ActionMessages.ACTION_MEMBER_KICKED_MESSAGE,n.getName(),s.getName());break;case p.ActionConstatnts.ACTION_KEYS.TYPE_MEMBER_BANNED:n=e.getActionBy(),s=e.getActionOn();t=a.format(p.ActionConstatnts.ActionMessages.ACTION_MEMBER_BANNED_MESSAGE,n.getName(),s.getName());break;case p.ActionConstatnts.ACTION_KEYS.TYPE_MEMBER_UNBANNED:n=e.getActionBy(),s=e.getActionOn();t=a.format(p.ActionConstatnts.ActionMessages.ACTION_MEMBER_UNBANNED_MESSAGE,n.getName(),s.getName());break;case p.ActionConstatnts.ACTION_KEYS.ACTION_SCOPE_CHANGED:n=e.getActionBy(),s=e.getActionOn();var o=e.getNewScope();t=a.format(p.ActionConstatnts.ActionMessages.ACTION_MEMBER_SCOPE_CHANGED,n.getName(),s.getName(),o);break;case p.ActionConstatnts.ACTION_KEYS.TYPE_MEMBER_ADDED:n=e.getActionBy(),s=e.getActionOn();t=a.format(p.ActionConstatnts.ActionMessages.ACTION_MEMBER_ADDED_TO_GROUP,n.getName(),s.getName());break;case p.ActionConstatnts.ACTION_KEYS.TYPE_MESSAGE_EDITED:t=a.format(p.ActionConstatnts.ActionMessages.ACTION_MESSAGE_EDITED_MESSAGE,"");break;case p.ActionConstatnts.ACTION_KEYS.TYPE_MESSAGE_DELETED:t=a.format(p.ActionConstatnts.ActionMessages.ACTION_MESSAGE_DELETED_MESSAGE,"")}}return t},t.prototype.getSenderFromData=function(){var e=this.data[p.ActionConstatnts.ACTION_KEYS.ENTITIES];if(e[p.ActionConstatnts.ACTION_SUBJECTS.ACTION_BY]&&e[p.ActionConstatnts.ACTION_SUBJECTS.ACTION_BY][p.ActionConstatnts.ACTION_KEYS.ENTITY_TYPE]==p.ActionConstatnts.ACTION_ENTITY_TYPE.USER){var t=new u.User(e[p.ActionConstatnts.ACTION_SUBJECTS.ACTION_BY][p.ActionConstatnts.ACTION_KEYS.ENTITY]);return Object.assign(t,e[p.ActionConstatnts.ACTION_SUBJECTS.ACTION_BY][p.ActionConstatnts.ACTION_KEYS.ENTITY]),t}},t.TYPE=p.MessageConstatnts.TYPE,t.RECEIVER_TYPE=p.MessageConstatnts.RECEIVER_TYPE,t.CATEGORY=p.MessageConstatnts.CATEGORY,t.ACTION_TYPE=p.ActionConstatnts.ACTION_TYPE,t}(i.BaseMessage);t.Action=E},function(e,t,n){"use strict";var s,r=this&&this.__extends||(s=function(e,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}s(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,n=1,s=arguments.length;n<s;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};t.__esModule=!0;var o=n(8),a=n(7),E=n(1),c=n(0),u=n(4),p=function(o){function e(e,t,n,s){return c.isFalsy(s)?o.call(this,e,t,n,E.MessageCategory.CALL)||this:o.call(this,e,t,n,s)||this}return r(e,o),e.prototype.getCallInitiator=function(){return this.getCallInitiatedByFromData()},e.prototype.getCallReceiver=function(){return this.getCallReceivedByFromData()},e.prototype.setCallInitiator=function(e){this.callInitiator=e},e.prototype.setCallReceiver=function(e){this.callReceiver=e},e.prototype.getData=function(){return this.data},e.prototype.setData=function(e){this.data=e},e.prototype.getSessionId=function(){return this.sessionId},e.prototype.setSessionId=function(e){this.sessionId=e},e.prototype.getMetadata=function(){return this.data.metadata&&(this.metadata=this.data.metadata),this.metadata},e.prototype.getSender=function(){try{return this.getSenderFromData()}catch(e){return this.sender}},e.prototype.setMetadata=function(e){this.metadata=e,this.data=i({},this.data,{metadata:e})},e.prototype.getAction=function(){return this.action},e.prototype.setAction=function(e){this.action=e},e.prototype.getInitiatedAt=function(){return this.initiatedAt},e.prototype.setInitiatedAt=function(e){this.initiatedAt=e},e.prototype.getJoinedAt=function(){return this.joinedAt},e.prototype.setJoinedAt=function(e){this.joinedAt=e},e.prototype.setRawData=function(e){this.rawData=e},e.prototype.getRawData=function(){return this.rawData},e.prototype.setSender=function(e){this.sender=e},e.prototype.setReceiver=function(e){this.receiver=e},e.callFromJSON=function(e){try{var t=new this(e[E.MessageConstatnts.KEYS.RECEIVER],e[E.MessageConstatnts.KEYS.TYPE],e[E.MessageConstatnts.KEYS.RECEIVER_TYPE],E.MessageCategory.CALL),n=e[E.MessageConstatnts.KEYS.DATA];t.setAction(n[E.MessageConstatnts.KEYS.ACTION]),n[E.MessageConstatnts.KEYS.METADATA]&&t.setMetadata(n[E.MessageConstatnts.KEYS.METADATA]);var s=n[E.ActionConstatnts.ACTION_KEYS.ENTITIES];if(s[E.ActionConstatnts.ACTION_SUBJECTS.ACTION_BY])s[E.ActionConstatnts.ACTION_SUBJECTS.ACTION_BY];if(s[E.ActionConstatnts.ACTION_SUBJECTS.ACTION_ON]){var o=s[E.ActionConstatnts.ACTION_SUBJECTS.ACTION_ON];if(o[E.CallConstants.CALL_KEYS.CALL_ENTITY]){var r=o[E.CallConstants.CALL_KEYS.CALL_ENTITY];if(r[E.CallConstants.CALL_KEYS.CALL_SESSION_ID]&&(t.sessionId=r[E.CallConstants.CALL_KEYS.CALL_SESSION_ID]),r[E.CallConstants.CALL_KEYS.CALL_STATUS]&&(t.status=r[E.CallConstants.CALL_KEYS.CALL_STATUS]),r[E.CallConstants.CALL_KEYS.CALL_DATA]){var i=r[E.CallConstants.CALL_KEYS.CALL_DATA];if(i[E.CallConstants.CALL_KEYS.CALL_METADATA]&&(t.metadata=i[E.CallConstants.CALL_KEYS.CALL_METADATA]),i[E.ResponseConstants.RESPONSE_KEYS.KEY_ENTITIES])i[E.ResponseConstants.RESPONSE_KEYS.KEY_ENTITIES]}r[E.CallConstants.CALL_KEYS.CALL_INITIATED_AT]&&(t.initiatedAt=r[E.CallConstants.CALL_KEYS.CALL_INITIATED_AT]),r[E.CallConstants.CALL_KEYS.CALL_JOINED_AT]&&(t.joinedAt=r[E.CallConstants.CALL_KEYS.CALL_JOINED_AT]),r[E.CallConstants.CALL_KEYS.CALL_LEFT_AT]&&(t.joinedAt=r[E.CallConstants.CALL_KEYS.CALL_LEFT_AT])}}return t}catch(e){c.Logger.error("CallModel: callFromJSON",e)}},e.prototype.getSenderFromData=function(){try{var e=this.getData();if((e=e[E.ActionConstatnts.ACTION_KEYS.ENTITIES])[E.ActionConstatnts.ACTION_SUBJECTS.ACTION_BY][E.CallConstants.CALL_KEYS.CALL_ENTITY])return new u.User(e[E.ActionConstatnts.ACTION_SUBJECTS.ACTION_BY][E.CallConstants.CALL_KEYS.CALL_ENTITY])}catch(e){c.Logger.error("CallModel:getSenderFromData",e)}},e.prototype.getCallInitiatedByFromData=function(){try{var e=this.getData();if((e=e[E.ActionConstatnts.ACTION_KEYS.ENTITIES])[E.ActionConstatnts.ACTION_SUBJECTS.ACTION_ON][E.CallConstants.CALL_KEYS.CALL_ENTITY][E.CallConstants.CALL_KEYS.CALL_DATA][E.ActionConstatnts.ACTION_KEYS.ENTITIES][E.CallConstants.CALL_KEYS.CALL_SENDER])return new u.User(e[E.ActionConstatnts.ACTION_SUBJECTS.ACTION_ON][E.CallConstants.CALL_KEYS.CALL_ENTITY][E.CallConstants.CALL_KEYS.CALL_DATA][E.ActionConstatnts.ACTION_KEYS.ENTITIES][E.CallConstants.CALL_KEYS.CALL_SENDER][E.CallConstants.CALL_KEYS.CALL_ENTITY])}catch(e){c.Logger.error("CallModel:getCallInitiatedByFromData",e)}},e.prototype.getCallReceivedByFromData=function(){try{var e=this.getData();if((e=e[E.ActionConstatnts.ACTION_KEYS.ENTITIES])[E.ActionConstatnts.ACTION_SUBJECTS.ACTION_FOR][E.CallConstants.CALL_KEYS.CALL_ENTITY]){if(e[E.ActionConstatnts.ACTION_SUBJECTS.ACTION_FOR][E.CallConstants.CALL_KEYS.CALL_ENTITY_TYPE]==E.CallConstants.CALL_KEYS.CALL_ENTITY_USER)return new u.User(e[E.ActionConstatnts.ACTION_SUBJECTS.ACTION_FOR][E.CallConstants.CALL_KEYS.CALL_ENTITY]);var t=new a.Group(e[E.ActionConstatnts.ACTION_SUBJECTS.ACTION_FOR][E.CallConstants.CALL_KEYS.CALL_ENTITY][E.GroupConstants.KEYS.GUID],e[E.ActionConstatnts.ACTION_SUBJECTS.ACTION_FOR][E.CallConstants.CALL_KEYS.CALL_ENTITY][E.GroupConstants.KEYS.NAME],e[E.ActionConstatnts.ACTION_SUBJECTS.ACTION_FOR][E.CallConstants.CALL_KEYS.CALL_ENTITY][E.GroupConstants.KEYS.TYPE]);return Object.assign(t,e[E.ActionConstatnts.ACTION_SUBJECTS.ACTION_FOR][E.CallConstants.CALL_KEYS.CALL_ENTITY])}}catch(e){c.Logger.error("CallModel:getCallReceivedByFromData",e)}},e.TYPE=E.MessageConstatnts.TYPE,e.RECEIVER_TYPE=E.MessageConstatnts.RECEIVER_TYPE,e.CATEGORY=E.MessageConstatnts.CATEGORY,e.ACTION_TYPE=E.ActionConstatnts.ACTION_TYPE,e}(o.BaseMessage);t.Call=p},function(e,t,n){"use strict";t.__esModule=!0;var s=function(){function e(){this.RECEIPT_TYPE={READ_RECEIPT:"read",DELIVERY_RECEIPT:"delivery"},this.receiptType=this.RECEIPT_TYPE.DELIVERY_RECEIPT}return e.prototype.getReceiverType=function(){return this.receiverType},e.prototype.setReceiverType=function(e){this.receiverType=e},e.prototype.getSender=function(){return this.sender},e.prototype.setSender=function(e){this.sender=e},e.prototype.getReceiver=function(){return this.receiver},e.prototype.setReceiver=function(e){this.receiver=e},e.prototype.getTimestamp=function(){return this.timestamp},e.prototype.setTimestamp=function(e){this.timestamp=e},e.prototype.setReadAt=function(e){this.readAt=e},e.prototype.getReadAt=function(){return this.readAt},e.prototype.setDeliveredAt=function(e){this.deliveredAt=e},e.prototype.getDeliveredAt=function(){return this.deliveredAt},e.prototype.getMessageId=function(){return this.messageId},e.prototype.setMessageId=function(e){this.messageId=e},e.prototype.getReceiptType=function(){return this.receiptType},e.prototype.setReceiptType=function(e){void 0===e&&(e=this.RECEIPT_TYPE.DELIVERY_RECEIPT),this.receiptType=e},e}();t.MessageReceipt=s},function(e,t,n){"use strict";var s,i=this&&this.__extends||(s=function(e,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}s(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});t.__esModule=!0;var o=n(0),r=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.onAction=void 0,this.onTextMessageReceived=void 0,this.onMediaMessageReceived=void 0,this.onCustomMessageReceived=void 0,this.onCall=void 0,this.onTypingStarted=void 0,this.onTypingEnded=void 0,this.onMessagesDelivered=void 0,this.onMessagesRead=void 0,this.onMessageEdited=void 0,this.onMessageDeleted=void 0,o.isFalsy(e[0].onAction)||(this.onAction=e[0].onAction),o.isFalsy(e[0].onTextMessageReceived)||(this.onTextMessageReceived=e[0].onTextMessageReceived),o.isFalsy(e[0].onMediaMessageReceived)||(this.onMediaMessageReceived=e[0].onMediaMessageReceived),o.isFalsy(e[0].onCall)||(this.onCall=e[0].onCall),o.isFalsy(e[0].onTypingStarted)||(this.onTypingStarted=e[0].onTypingStarted),o.isFalsy(e[0].onTypingEnded)||(this.onTypingEnded=e[0].onTypingEnded),o.isFalsy(e[0].onMessagesDelivered)||(this.onMessagesDelivered=e[0].onMessagesDelivered),o.isFalsy(e[0].onMessagesRead)||(this.onMessagesRead=e[0].onMessagesRead),o.isFalsy(e[0].onCustomMessageReceived)||(this.onCustomMessageReceived=e[0].onCustomMessageReceived),o.isFalsy(e[0].onMessageEdited)||(this.onMessageEdited=e[0].onMessageEdited),o.isFalsy(e[0].onMessageDeleted)||(this.onMessageDeleted=e[0].onMessageDeleted)};t.MessageEventListener=r;var a=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.onIncomingCallReceived=void 0,this.onOutgoingCallAccepted=void 0,this.onOutgoingCallRejected=void 0,this.onIncomingCallCancelled=void 0,o.isFalsy(e[0].onIncomingCallReceived)||(this.onIncomingCallReceived=e[0].onIncomingCallReceived),o.isFalsy(e[0].onOutgoingCallAccepted)||(this.onOutgoingCallAccepted=e[0].onOutgoingCallAccepted),o.isFalsy(e[0].onOutgoingCallRejected)||(this.onOutgoingCallRejected=e[0].onOutgoingCallRejected),o.isFalsy(e[0].onIncomingCallCancelled)||(this.onIncomingCallCancelled=e[0].onIncomingCallCancelled)};t.CallEventListener=a;var E=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];o.isFalsy(e[0].onUserOnline)||(this.onUserOnline=e[0].onUserOnline),o.isFalsy(e[0].onUserOffline)||(this.onUserOffline=e[0].onUserOffline)};t.UserEventListener=E;var c=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];o.isFalsy(e[0].onGroupMemberJoined)||(this.onUserJoined=e[0].onGroupMemberJoined),o.isFalsy(e[0].onGroupMemberLeft)||(this.onUserLeft=e[0].onGroupMemberLeft),o.isFalsy(e[0].onGroupMemberKicked)||(this.onUserKicked=e[0].onGroupMemberKicked),o.isFalsy(e[0].onGroupMemberBanned)||(this.onUserBanned=e[0].onGroupMemberBanned),o.isFalsy(e[0].onGroupMemberUnbanned)||(this.onUserUnbanned=e[0].onGroupMemberUnbanned),o.isFalsy(e[0].onGroupMemberScopeChanged)||(this.onMemberScopeChanged=e[0].onGroupMemberScopeChanged),o.isFalsy(e[0].onMemberAddedToGroup)||(this.onMemberAddedToGroup=e[0].onMemberAddedToGroup)};t.GroupEventListener=c;var u=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];o.isFalsy(e[0].onYouLeft)||(this.onYouLeft=e[0].onYouLeft),o.isFalsy(e[0].onYouJoined)||(this.onYouJoined=e[0].onYouJoined),o.isFalsy(e[0].onUserJoined)||(this.onUserJoined=e[0].onUserJoined),o.isFalsy(e[0].onUserLeft)||(this.onUserLeft=e[0].onUserLeft),o.isFalsy(e[0].onUserListUpdated)||(this.onUserListUpdated=e[0].onUserListUpdated),o.isFalsy(e[0].onAudioModesUpdated)||(this.onAudioModesUpdated=e[0].onAudioModesUpdated),o.isFalsy(e[0].onCallEnded)||(this.onCallEnded=e[0].onCallEnded),o.isFalsy(e[0].onError)||(this.onError=e[0].onError)};t.UserCallEventListener=u;var p=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];o.isFalsy(e[0].loginSuccess)||(this.loginSuccess=e[0].loginSuccess),o.isFalsy(e[0].loginFailure)||(this.loginFailure=e[0].loginFailure),o.isFalsy(e[0].logoutSuccess)||(this.logoutSuccess=e[0].logoutSuccess),o.isFalsy(e[0].logoutFailure)||(this.logoutFailure=e[0].logoutFailure)};t.LoginEventListener=p;var S=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.onConnected=void 0,this.inConnecting=void 0,this.onDisconnected=void 0,this.onFeatureThrottled=void 0,o.isFalsy(e[0].onConnected)||(this.onConnected=e[0].onConnected),o.isFalsy(e[0].inConnecting)||(this.inConnecting=e[0].inConnecting),o.isFalsy(e[0].onDisconnected)||(this.onDisconnected=e[0].onDisconnected),o.isFalsy(e[0].onFeatureThrottled)||(this.onFeatureThrottled=e[0].onFeatureThrottled)};t.ConnectionEventListener=S;var C=function(e,t){this._name=e,this._callback=t},l=function(r){function e(e,t,n,s){var o=r.call(this,e,s)||this;return o._eventListener=t,n&&(o._cursor=n),o}return i(e,r),e}(t.Listener=C);t.MessageListener=l;var T=function(r){function e(e,t,n,s){var o=r.call(this,e,s)||this;return o._eventListener=t,n&&(o._cursor=n),o}return i(e,r),e}(C);t.UserListener=T;var d=function(r){function e(e,t,n,s){var o=r.call(this,e,s)||this;return o._eventListener=t,n&&(o._cursor=n),o}return i(e,r),e}(C);t.GroupListener=d;var g=function(o){function e(e,t,n){var s=o.call(this,"callListner",n)||this;return s._eventListener=e,s}return i(e,o),e}(C);t.UserCallListener=g;var _=function(r){function e(e,t,n,s){var o=r.call(this,e,s)||this;return o._eventListener=t,o}return i(e,r),e}(C);t.CallListener=_;var h=function(r){function e(e,t,n,s){var o=r.call(this,e,s)||this;return o._eventListener=t,n&&(o._cursor=n),o}return i(e,r),e}(C);t.LoginListener=h;var A=function(r){function e(e,t,n,s){var o=r.call(this,e,s)||this;return o._eventListener=t,n&&(o._cursor=n),o}return i(e,r),e}(C);t.ConnectionListener=A},function(e,t,n){"use strict";t.__esModule=!0;var o=n(1),r=n(0),s=n(3),i=n(2),a=n(23),E=n(30),c=function(){function e(){this.TAG="calling Log",this.callListner=void 0,this.CALL_NO_ANSWER_INTERVAL=45e3}return e.prototype.getCallListner=function(){return this.callListner},e.prototype.setCallListner=function(e){this.callListner=new a.UserCallListener(e)},e.getInstance=function(){try{return null!=this.callController&&null!=this.callController||(this.callController=new e),this.callController}catch(e){r.Logger.error("CallController: getInstance",e)}},e.prototype.getActiveCall=function(){try{return r.isFalsy(this.call)?null:this.call}catch(e){r.Logger.error("CallController: getActiveCall",e)}},e.prototype.initiateCall=function(n){var s=this;return new Promise(function(e,t){try{r.isFalsy(s.call)?null!=n&&null!=n?(s.call=n,s.startCallTimer(),e(n)):t(new i.CometChatException(o.CALL_ERROR.ERROR_IN_CALLING)):t(new i.CometChatException(o.CALL_ERROR.CALL_ALREADY_INITIATED))}catch(e){t(new i.CometChatException(e))}})},e.prototype.endCall=function(e){try{this.endCallSession()}catch(e){r.Logger.error("CallController: endCall",e)}},e.prototype.onCallStarted=function(n){var s=this;return new Promise(function(e,t){try{r.isFalsy(s.call)?null!=n&&null!=n?e(s.call=n):t(new i.CometChatException(o.CALL_ERROR.ERROR_IN_CALLING)):t(new i.CometChatException(o.CALL_ERROR.CALL_ALREADY_INITIATED))}catch(e){t(new i.CometChatException(e))}})},e.prototype.endCallSession=function(){try{this.call=void 0,e.callController=void 0,this.timer&&this.stopCallTimer()}catch(e){r.Logger.error("CallController:EndCallSession",{e:e})}},e.prototype.startCallTimer=function(){var t=this;try{this.timer=setTimeout(function(){t.call?s.CometChat.sendUnansweredResponse(t.call.getSessionId()).then(function(e){t.endCallSession()},function(e){t.endCallSession()}):t.endCallSession()},this.CALL_NO_ANSWER_INTERVAL)}catch(e){r.Logger.error("CallController: startCallTimer",e)}},e.prototype.stopCallTimer=function(){try{clearTimeout(this.timer)}catch(e){r.Logger.error("CallController: stopCallTimer",e)}},e.prototype.callStarted=function(){this.timer&&this.stopCallTimer()},e.prototype.muteAudio=function(e){E.CallingComponent.muteAudio(e)},e.prototype.pauseVideo=function(e){E.CallingComponent.pauseVideo(e)},e.prototype.endSession=function(){E.CallingComponent.endCall()},e.prototype.setAudioMode=function(e){E.CallingComponent.setAudioMode(e)},e.prototype.switchCamera=function(){E.CallingComponent.switchCamera()},e.prototype.getAudioOutputModes=function(){return new Promise(function(t,n){E.CallingComponent.getAudioOutputModes().then(function(e){t(e)},function(e){n(e)})})},e.callController=void 0,e}();t.CallController=c},function(e,t,n){"use strict";t.__esModule=!0;var i=n(34),a=n(0),s=function(){function e(){}return e.trasformJSONConversation=function(e,t,n,s,o){var r;try{r=new i.Conversation(e,t,n,s,o)}catch(e){a.Logger.error("ConversationController:transformJSONConversation",e)}return r},e}();t.ConversationController=s},function(e,t,n){"use strict";t.__esModule=!0;var s=function(){function e(e,t,n){this.receiverId=e,this.receiverType=t,this.metadata=n}return e.prototype.getReceiverType=function(){return this.receiverType},e.prototype.setReceiverType=function(e){this.receiverType=e},e.prototype.getReceiverId=function(){return this.receiverId},e.prototype.setReceiverId=function(e){this.receiverId=e},e.prototype.getMetadata=function(){return this.metadata},e.prototype.setMetadata=function(e){this.metadata=e},e.prototype.getSender=function(){return this.sender},e.prototype.setSender=function(e){this.sender=e},e}();t.TypingIndicator=s},function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){"use strict";t.__esModule=!0;var i=n(0),a=n(1),E=n(14),c=n(3),u=n(2),s=function(){function r(){this.baseUrl="https://apiclient-%s.cometchat.io/",this.apiVersion=a.APPINFO.apiVersion,this.apiBaseUrl=this.baseUrl+this.apiVersion+"/",this.adminApiUrl="https://api-%s.cometchat.io/",this.adminApiVersion=a.APPINFO.apiVersion,this.extensionApi="https://%s-%s.cometchat.io/%s",this.prosodyApi="https://%s.%s/%s",this.uriEndpoints={authToken:{endpoint:"users/{{uid}}/auth_tokens",method:"POST",data:{uid:"string|max:100"},isAdminApi:!0},appSettings:{endpoint:"settings",method:"GET"},login:{endpoint:"admin/users/auth",method:"POST",data:{uid:"string|max:100"}},logout:{endpoint:"admin/users/auth/{{authToken}}",method:"DELETE"},getMyDetails:{endpoint:"me",method:"GET"},updateMyDetails:{endpoint:"me",method:"PUT"},getJWT:{endpoint:"me/jwt",method:"POST"},users:{endpoint:"users",method:"GET"},user:{endpoint:"users/{{uid}}",method:"GET"},blockUsers:{endpoint:"blockedusers",method:"POST"},blockedUsersList:{endpoint:"blockedusers",method:"GET"},unblockUsers:{endpoint:"blockedusers",method:"DELETE"},userLogout:{endpoint:"me",method:"DELETE"},createUser:{endpoint:"users",method:"POST",isAdminApi:!0},updateUser:{endpoint:"users/{{uid}}",method:"PUT",isAdminApi:!0},sendFriendRequests:{endpoint:"user/friends",method:"POST",data:{uids:"array<string|max:100>"}},getFriends:{endpoint:"user/friends",method:"GET"},unfriend:{endpoint:"user/friends/{{uid}}/{{gid}}",method:"DELETE",data:{uids:"array<string|max:100>"}},acceptFriendRequest:{endpoint:"user/friends/{{uid}}/accept",method:"PUT",data:{uids:"array<string|max:100>"}},rejectFriendRequest:{endpoint:"user/friends/{{uid}}/reject",method:"DELETE",data:{uids:"array<string|max:100>"}},createGroup:{endpoint:"groups",method:"POST",data:{guid:"required|string|max:100",name:"required|string|max:100",type:"enum|public,protected,password",password:"filled|string|max:100"}},getGroups:{endpoint:"groups",method:"GET"},getGroup:{endpoint:"groups/{{guid}}",method:"GET"},updateGroup:{endpoint:"groups/{{guid}}",method:"PUT"},deleteGroup:{endpoint:"groups/{{guid}}",method:"DELETE"},addGroupMembers:{endpoint:"groups/{{guid}}/members",method:"POST",data:{uids:"array<string|max:100>"}},getGroupMembers:{endpoint:"groups/{{guid}}/members",method:"GET"},joinGroup:{endpoint:"groups/{{guid}}/members",method:"POST"},leaveGroup:{endpoint:"groups/{{guid}}/members",method:"DELETE"},kickGroupMembers:{endpoint:"groups/{{guid}}/members/{{uid}}",method:"DELETE",data:{uids:"array<string|max:100>"}},changeScopeOfMember:{endpoint:"groups/{{guid}}/members/{{uid}}",method:"PUT",data:{uids:"array<string|max:100>"}},banGroupMember:{endpoint:"groups/{{guid}}/bannedusers/{{uid}}",method:"POST",data:{uids:"array<string|max:100>"}},unbanGroupMember:{endpoint:"groups/{{guid}}/bannedusers/{{uid}}",method:"DELETE",data:{uids:"array<string|max:100>"}},addMemebersToGroup:{endpoint:"groups/{{guid}}/members",method:"PUT"},getBannedGroupMembers:{endpoint:"groups/{{guid}}/bannedusers",method:"GET"},promotemoteGroupMember:{endpoint:"groups/{{guid}}/promote",method:"PUT",data:{uids:"array<string|max:100>"}},demoteGroupMember:{endpoint:"groups/{{guid}}/demote",method:"DELETE",data:{uids:"array<string|max:100>"}},transferOwnership:{endpoint:"groups/{{guid}}/owner",method:"PATCH"},sendMessage:{endpoint:"messages",method:"POST",data:{sender:"array:string:max:100>",isGroupMember:"filled|boolean|bail",data:"required|json"}},sendMessageInThread:{endpoint:"messages/{{parentId}}/thread",method:"POST",data:{sender:"array:string:max:100>",isGroupMember:"filled|boolean|bail",data:"required|json"}},getMessages:{endpoint:"messages",method:"GET"},getMessageDetails:{endpoint:"messages/{{messageId}}",method:"GET"},getUserMessages:{endpoint:"users/{{listId}}/messages",method:"GET"},getGroupMessages:{endpoint:"groups/{{listId}}/messages",method:"GET"},getThreadMessages:{endpoint:"messages/{{listId}}/thread",method:"GET"},getMessage:{endpoint:"user/messages/{{muid}}",method:"GET"},updateMessage:{endpoint:"messages/{{messageId}}",method:"PUT"},deleteMessage:{endpoint:"messages/{{messageId}}",method:"DELETE"},createCallSession:{endpoint:"calls",method:"POST",data:{}},updateCallSession:{endpoint:"calls/{{sessionid}}",method:"put",data:{}},getConversations:{endpoint:"conversations",method:"GET"},getUserConversation:{endpoint:"users/{{uid}}/conversation",method:"GET"},getGroupConversation:{endpoint:"groups/{{guid}}/conversation",method:"GET"},deleteUserConversation:{endpoint:"users/{{uid}}/conversation",method:"DELETE"},deleteGroupConversation:{endpoint:"groups/{{guid}}/conversation",method:"DELETE"}}}return r.prototype.getEndpointData=function(o){return new Promise(function(s,t){try{E.LocalStorage.getInstance().get(a.LOCAL_STORE.KEY_APP_SETTINGS).then(function(e){if(i.isFalsy(e)){var t={};if((new r).uriEndpoints.hasOwnProperty(o))if((t=(new r).uriEndpoints[o]).hasOwnProperty("isAdminApi")){var n=i.format((new r).adminApiUrl,c.CometChat.appSettings.getRegion())+(new r).adminApiVersion+"/"+t.endpoint;t.endpoint=n}else{n=i.format((new r).baseUrl,c.CometChat.appSettings.getRegion())+(new r).apiVersion+"/"+t.endpoint;t.endpoint=n}s(t)}else{t={};if((new r).uriEndpoints.hasOwnProperty(o))if((t=(new r).uriEndpoints[o]).hasOwnProperty("isAdminApi"))t.endpoint="https://"+e[a.APP_SETTINGS.KEYS.ADMIN_API_HOST]+"/"+(new r).adminApiVersion+"/"+t.endpoint;else{n="https://"+e[a.APP_SETTINGS.KEYS.CLIENT_API_HOST]+"/"+(new r).apiVersion+"/"+t.endpoint;t.endpoint=n}s(t)}},function(e){var t;(new r).uriEndpoints.hasOwnProperty(o)&&((t=(new r).uriEndpoints[o]).hasOwnProperty(["isAdminApi"])?t.endpoint=i.format((new r).adminApiUrl,c.CometChat.appSettings.getRegion())+(new r).adminApiVersion+"/"+t.endpoint:t.endpoint=i.format((new r).baseUrl,c.CometChat.appSettings.getRegion())+(new r).apiVersion+"/"+t.endpoint),s(t)})}catch(e){t(new u.CometChatException(e))}})},r}();t.EndpointFactory=s},function(e,t,n){"use strict";t.__esModule=!0;var s=n(28),i=n(2);t.getEndPoint=function(e,r){void 0===e&&(e=""),void 0===r&&(r={});var t=new s.EndpointFactory;return new Promise(function(s,o){try{t.getEndpointData(e).then(function(e){var t=e;if(t){for(var n in r)t.endpoint=t.endpoint.replace("{{"+n+"}}",r[n]);s(t)}else o({error:"Unknown endPoint name."})})}catch(e){o(new i.CometChatException(e))}})}},function(e,t,n){"use strict";var s,o=this&&this.__extends||(s=function(e,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}s(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});t.__esModule=!0;var g,_,h,A,R,I,f,O,r=n(42),i=n(43),N=n(3),a=n(31),E=n(31),m=n(44),c=n(4),y=n(32),L=n(1),M=n(24),P=n(2),v=n(0),u=n(45),D={},p=function(t){function e(e){var s=t.call(this,e)||this;s.state={shouldLoad:!1},A=e.callsettings,h=N.CometChat.getActiveCall(),I=N.CometChat.user,D={};var o,r,i,a,E,c,u,p,S,C,l,T,d=!0;return N.CometChat.getAppSettings().then(function(e){if(O=e[L.APP_SETTINGS.KEYS.WEBRTC_HOST],e.hasOwnProperty(L.APP_SETTINGS.KEYS.ANALYTICS_HOST)?D[L.APP_SETTINGS.KEYS.ANALYTICS_HOST]=e[L.APP_SETTINGS.KEYS.ANALYTICS_HOST]:D[L.APP_SETTINGS.KEYS.ANALYTICS_HOST]=v.format(L.ANALYTICS.analyticsHost,N.CometChat.appSettings.getRegion()),e.hasOwnProperty(L.APP_SETTINGS.KEYS.ANALYTICS_VERSION)?D[L.APP_SETTINGS.KEYS.ANALYTICS_VERSION]=e[L.APP_SETTINGS.KEYS.ANALYTICS_VERSION]:D[L.APP_SETTINGS.KEYS.ANALYTICS_VERSION]=L.ANALYTICS.analyticsVersion,e.hasOwnProperty(L.APP_SETTINGS.KEYS.ANALYTICS_PING_DISABLED)?D[L.APP_SETTINGS.KEYS.ANALYTICS_PING_DISABLED]=e[L.APP_SETTINGS.KEYS.ANALYTICS_PING_DISABLED]:D[L.APP_SETTINGS.KEYS.ANALYTICS_PING_DISABLED]=!1,e.hasOwnProperty(L.APP_SETTINGS.KEYS.ANALYTICS_USE_SSL)?D[L.APP_SETTINGS.KEYS.ANALYTICS_USE_SSL]=e[L.APP_SETTINGS.KEYS.ANALYTICS_USE_SSL]:D[L.APP_SETTINGS.KEYS.ANALYTICS_USE_SSL]=!0,A.getCallEventListener()&&M.CallController.getInstance().setCallListner(A.getCallEventListener()),v.isFalsy(N.CometChat.appSettings))M.CallController.getInstance().getCallListner()&&M.CallController.getInstance().getCallListner()._eventListener.onError(new P.CometChatException(L.CALL_ERROR.NOT_INITIALIZED));else{if(!(g=N.CometChat.appSettings.getRegion().toLowerCase()))return d=!1,void(M.CallController.getInstance().getCallListner()&&M.CallController.getInstance().getCallListner()._eventListener.onError(new P.CometChatException(L.CALL_ERROR.NOT_INITIALIZED)));if(N.CometChat.getAppId()){if(_=N.CometChat.getAppId(),!I)return d=!1,void(M.CallController.getInstance().getCallListner()&&M.CallController.getInstance().getCallListner()._eventListener.onError(new P.CometChatException(L.CALL_ERROR.NOT_LOGGED_IN)));if(h){var t=h.getType();o=t===L.CallConstants.CALL_TYPE.AUDIO,r=h.getSessionId()}else{if(o=A.isAudioOnlyCall(),v.isFalsy(A.getSessionId()))return void(M.CallController.getInstance().getCallListner()&&M.CallController.getInstance().getCallListner()._eventListener.onError(new P.CometChatException(L.CALL_ERROR.SESSION_ID_REQUIRED)));r=("v1."+g+"."+N.CometChat.getAppId()+"."+A.getSessionId()).toLowerCase()}if(!r)return d=!1,void(M.CallController.getInstance().getCallListner()&&M.CallController.getInstance().getCallListner()._eventListener.onError(new P.CometChatException(L.CALL_ERROR.SESSION_ID_REQUIRED)));if(i=A.isDefaultLayoutEnabled(),a=A.isAudioModeButtonEnabled(),E=A.isPauseVideoButtonEnabled(),c=A.isMuteAudioButtonEnabled(),u=A.isSwitchCameraButtonEnabled(),p=A.isEndCallButtonEnabled(),S=A.getMode(),C=A.getStartWithAudioMuted(),l=A.getStartWithVideoMuted(),(T=A.getDefaultAudioMode())||(T=o?L.CallConstants.AUDIO_MODE.EARPIECE:L.CallConstants.AUDIO_MODE.SPEAKER),d){var n={uid:I.getUid(),sessionId:r};N.CometChat.getInstance().getJWT(n).then(function(e){e.hasOwnProperty("token")?((f=new m.RTCUser(I.getUid())).setName(I.getName()),f.setAvatar(I.getAvatar()),f.setResource(N.CometChat.getSessionId()),f.setJWT(e.token),R=(new y.CallSettingsBuilder).setSessionID(r).enableDefaultLayout(i).setIsAudioOnlyCall(o).setUser(f).setRegion(g).setAppId(_).setDomain(O).showAudioModeButton(a).showEndCallButton(p).showMuteAudioButton(c).showPauseVideoButton(E).showSwitchCameraButton(u).setMode(S).setAnalyticsSettings(D).startWithAudioMuted(C).startWithVideoMuted(l).setDefaultAudioMode(T).build(),M.CallController.getInstance().callStarted(),s.setState({shouldLoad:!0})):M.CallController.getInstance().getCallListner()&&M.CallController.getInstance().getCallListner()._eventListener.onError(new P.CometChatException(L.CALL_ERROR.JWT_NOT_FOUND))},function(e){M.CallController.getInstance().getCallListner()&&M.CallController.getInstance().getCallListner()._eventListener.onError(new P.CometChatException(e))})}}else M.CallController.getInstance().getCallListner()&&M.CallController.getInstance().getCallListner()._eventListener.onError(new P.CometChatException(L.CALL_ERROR.NOT_INITIALIZED))}}),s}return o(e,t),e.prototype.render=function(){return this.state.shouldLoad?r.createElement(i.View,{style:{flex:1,backgroundColor:"#000"}},r.createElement(a.default,{style:{flex:1,backgroundColor:"#000"},callsettings:R,onCallEnded:function(){},onCallEndButtonPressed:function(){h?setTimeout(function(){N.CometChat.endCall(A.getSessionId(),!0)},1e3):M.CallController.getInstance().getCallListner()&&M.CallController.getInstance().getCallListner()._eventListener.onCallEnded(null),E.CometChatRTC.endCall()},onUserJoined:function(e){if(e){var t=void 0;v.isFalsy(e.uid)||v.isFalsy(e.name)||((t=new c.User(e)).setStatus("online"),N.CometChat.user.getUid().toLowerCase()!=t.getUid().toLowerCase()&&M.CallController.getInstance().getCallListner()&&(v.isFalsy(M.CallController.getInstance().getCallListner()._eventListener.onUserJoined)||M.CallController.getInstance().getCallListner()._eventListener.onUserJoined(t)))}},onUserLeft:function(e){if(e){var t=void 0;v.isFalsy(e.uid)||v.isFalsy(e.name)||((t=new c.User(e)).setStatus("online"),N.CometChat.user.getUid().toLowerCase()!=t.getUid().toLowerCase()&&M.CallController.getInstance().getCallListner()&&(v.isFalsy(M.CallController.getInstance().getCallListner()._eventListener.onUserLeft)||M.CallController.getInstance().getCallListner()._eventListener.onUserLeft(t)))}},onUserListChanged:function(e){var n=[];e&&0<e.length&&(e.map(function(e){if(!v.isFalsy(e.uid)&&!v.isFalsy(e.name)){var t=new c.User(e);t.setStatus("online"),n.push(t)}}),M.CallController.getInstance().getCallListner()&&(v.isFalsy(M.CallController.getInstance().getCallListner()._eventListener.onUserListUpdated)||M.CallController.getInstance().getCallListner()._eventListener.onUserListUpdated(n)))},onAudioModeChanged:function(e){var s=[];e&&0<e.length&&(e.map(function(e){var t="",n=!1;e.hasOwnProperty("mode")&&(t=e.mode),e.hasOwnProperty("isSelected")&&(n=e.isSelected),e.hasOwnProperty("type")&&(t=e.type),e.hasOwnProperty("selected")&&(n=e.selected),s.push(new u.AudioMode(t,n))}),M.CallController.getInstance().getCallListner()&&(v.isFalsy(M.CallController.getInstance().getCallListner()._eventListener.onAudioModesUpdated)||M.CallController.getInstance().getCallListner()._eventListener.onAudioModesUpdated(s)))}})):null},e.switchCamera=function(){E.CometChatRTC.switchCamera()},e.endCall=function(){E.CometChatRTC.endCall()},e.muteAudio=function(e){e?E.CometChatRTC.muteAudio():E.CometChatRTC.unMuteAudio()},e.pauseVideo=function(e){e?E.CometChatRTC.pauseVideo():E.CometChatRTC.unPauseVideo()},e.setAudioMode=function(e){e=e.toUpperCase(),-1<Object.keys(L.CallConstants.AUDIO_MODE).indexOf(e)&&E.CometChatRTC.setAudioMode(e)},e.getAudioOutputModes=function(){return new Promise(function(t,n){var s=[];E.CometChatRTC.getAudioModes().then(function(e){e.hasOwnProperty("modes")&&e.modes.map(function(e){var t="",n=!1;e.hasOwnProperty("mode")&&(t=e.mode),e.hasOwnProperty("isSelected")&&(n=e.isSelected),e.hasOwnProperty("type")&&(t=e.type),e.hasOwnProperty("selected")&&(n=e.selected),s.push(new u.AudioMode(t,n))}),t(s)},function(e){n(e)})})},e}(r.Component);t.CallingComponent=p},function(e,t){e.exports=s},function(e,t,n){"use strict";t.__esModule=!0;var s=n(1),o=function(){function e(e){this.sessionID=e.sessionID,this.defaultLayout=e.defaultLayout,this.isAudioOnly=e.isAudioOnly,this.region=e.region,this.domain=e.domain,this.user=e.user,this.listener=e.listener,this.mode=e.mode,this.ShowEndCallButton=e.ShowEndCallButton,this.ShowSwitchCameraButton=e.ShowSwitchCameraButton,this.ShowMuteAudioButton=e.ShowMuteAudioButton,this.ShowPauseVideoButton=e.ShowPauseVideoButton,this.ShowAudioModeButton=e.ShowAudioModeButton,this.StartAudioMuted=e.StartAudioMuted,this.StartVideoMuted=e.StartVideoMuted,this.analyticsSettings=e.analyticsSettings,this.appId=e.appId,this.defaultAudioMode=e.defaultAudioMode}return e.prototype.getSessionId=function(){return this.sessionID},e.prototype.isAudioOnlyCall=function(){return this.isAudioOnly},e.prototype.getUser=function(){return this.user},e.prototype.getRegion=function(){return this.region},e.prototype.getAppId=function(){return this.appId},e.prototype.getDomain=function(){return this.domain},e.prototype.isDefaultLayoutEnabled=function(){return this.defaultLayout},e.prototype.getCallEventListener=function(){return this.listener},e.prototype.getMode=function(){return this.mode},e.prototype.isEndCallButtonEnabled=function(){return this.ShowEndCallButton},e.prototype.isSwitchCameraButtonEnabled=function(){return this.ShowSwitchCameraButton},e.prototype.isMuteAudioButtonEnabled=function(){return this.ShowMuteAudioButton},e.prototype.isPauseVideoButtonEnabled=function(){return this.ShowPauseVideoButton},e.prototype.isAudioModeButtonEnabled=function(){return this.ShowAudioModeButton},e.prototype.getStartWithAudioMuted=function(){return this.StartAudioMuted},e.prototype.getStartWithVideoMuted=function(){return this.StartVideoMuted},e.prototype.getAnalyticsSettings=function(){return this.analyticsSettings},e.prototype.getDefaultAudioMode=function(){return this.defaultAudioMode},e}();t.CallSettings=o;var r=function(){function e(){this.defaultLayout=!0,this.isAudioOnly=!1,this.mode=s.CallConstants.CALL_MODE.DEFAULT,this.ShowEndCallButton=!0,this.ShowSwitchCameraButton=!0,this.ShowMuteAudioButton=!0,this.ShowPauseVideoButton=!0,this.ShowAudioModeButton=!0,this.StartAudioMuted=!1,this.StartVideoMuted=!1,this.analyticsSettings={}}return e.prototype.setSessionID=function(e){return this.sessionID=e,this},e.prototype.enableDefaultLayout=function(e){return this.defaultLayout=e,this},e.prototype.setIsAudioOnlyCall=function(e){return this.isAudioOnly=e,this},e.prototype.setRegion=function(e){return this.region=e,this},e.prototype.setDomain=function(e){return this.domain=e,this},e.prototype.setUser=function(e){return this.user=e,this},e.prototype.setCallEventListener=function(e){return this.listener=e,this},e.prototype.setMode=function(e){return this.mode=e,this},e.prototype.showEndCallButton=function(e){return this.ShowEndCallButton=e,this},e.prototype.showSwitchCameraButton=function(e){return this.ShowSwitchCameraButton=e,this},e.prototype.showMuteAudioButton=function(e){return this.ShowMuteAudioButton=e,this},e.prototype.showPauseVideoButton=function(e){return this.ShowPauseVideoButton=e,this},e.prototype.showAudioModeButton=function(e){return this.ShowAudioModeButton=e,this},e.prototype.startWithAudioMuted=function(e){return this.StartAudioMuted=e,this},e.prototype.startWithVideoMuted=function(e){return this.StartVideoMuted=e,this},e.prototype.setAnalyticsSettings=function(e){return this.analyticsSettings=e,this},e.prototype.setAppId=function(e){return this.appId=e,this},e.prototype.setDefaultAudioMode=function(e){return this.defaultAudioMode=e,this},e.prototype.build=function(){return new o(this)},e}();t.CallSettingsBuilder=r},function(e,t,n){"use strict";t.__esModule=!0;var s=n(1),o=function(){function e(e,t){this.joinedAt=0,this.isBanned=0,this.uid=e,t&&(this.scope=t)}return e.prototype.getName=function(){return this.name},e.prototype.setName=function(e){this.name=e},e.prototype.getAvatar=function(){return this.avatar},e.prototype.setAvatar=function(e){this.avatar=e},e.prototype.getLastActiveAt=function(){return this.lastActiveAt},e.prototype.setLastActiveAt=function(e){this.lastActiveAt=e},e.prototype.getLink=function(){return this.link},e.prototype.setLink=function(e){this.link=e},e.prototype.getMetadata=function(){return this.metadata},e.prototype.setMetadata=function(e){this.metadata=e},e.prototype.getRole=function(){return this.role},e.prototype.setRole=function(e){this.role=e},e.prototype.getStatus=function(){return this.status},e.prototype.setStatus=function(e){this.status=e},e.prototype.getStatusMessage=function(){return this.statusMessage},e.prototype.setStatusMessage=function(e){this.statusMessage=e},e.prototype.setGuid=function(e){this.guid=e},e.prototype.setUid=function(e){this.uid=e},e.prototype.setScope=function(e){this.scope=e},e.prototype.setJoinedAt=function(e){this.joinedAt=e},e.prototype.setIsBanned=function(e){this.isBanned=e},e.prototype.setUser=function(e){this.user=e},e.prototype.getGuid=function(){return this.guid},e.prototype.getUid=function(){return this.uid},e.prototype.getuser=function(){return this.user},e.prototype.getScope=function(){return this.scope},e.prototype.getJoinedAt=function(){return this.joinedAt},e.prototype.getIsBanned=function(){return this.isBanned},e.GroupMemberScope=s.GroupMemberScope,e}();t.GroupMember=o},function(e,t,n){"use strict";t.__esModule=!0;var r=n(9),i=n(1),a=n(10),E=n(15),s=function(){function e(e,t,n,s,o){this.conversationId=e,this.conversationType=t,void 0!==n&&void 0!==(this.lastMessage=n).id&&(this.lastMessage=r.MessageController.trasformJSONMessge(n)),this.conversationType==i.MessageConstatnts.RECEIVER_TYPE.USER?this.conversationWith=a.UsersController.trasformJSONUser(s):this.conversationWith=E.GroupsController.trasformJSONGroup(s),this.unreadMessageCount=void 0!==o?parseInt(o):0}return e.prototype.setConversationId=function(e){this.conversationId=e},e.prototype.setConversationType=function(e){this.conversationType=e},e.prototype.setLastMessage=function(e){this.lastMessage=e},e.prototype.setConversationWith=function(e){this.conversationWith=e},e.prototype.setUnreadMessageCount=function(e){this.unreadMessageCount=e},e.prototype.getConversationId=function(){return this.conversationId},e.prototype.getConversationType=function(){return this.conversationType},e.prototype.getLastMessage=function(){return this.lastMessage},e.prototype.getConversationWith=function(){return this.conversationWith},e.prototype.getUnreadMessageCount=function(){return this.unreadMessageCount},e}();t.Conversation=s},function(e,t,n){"use strict";t.__esModule=!0;var r=n(0),i=n(1),a=n(2),s=n(12),o=function(){function e(e){this.store=i.constants.DEFAULT_STORE,r.isFalsy(e)||(this.store=e);try{this.settingsStore=s.default}catch(e){r.Logger.error("MessageListnerEventMaping: constructor",{e:e})}}return e.getInstance=function(){return null==e.settingsStore&&(e.settingsStore=new e),e.settingsStore},e.prototype.set=function(e,t){var n=r.getKeyprefix(i.LOCAL_STORE.MESSAGE_LISTENERS_LIST,e);return this.settingsStore.setItem(n,JSON.stringify(t))},e.prototype.get=function(e){var s=this,o=r.getKeyprefix(i.LOCAL_STORE.MESSAGE_LISTENERS_LIST,e);return new Promise(function(n,t){try{s.settingsStore.getItem(o).then(function(t){try{n(JSON.parse(t))}catch(e){n(t)}},function(e){t(e)})}catch(e){t(new a.CometChatException(e))}})},e.prototype.selectStore=function(e){this.store=e},e.settingsStore=null,e}();t.MessageListnerMaping=o},function(e,t,n){"use strict";t.__esModule=!0;var c=n(3),u=n(1),s=n(24),o=n(37),p=n(0),r=n(38),i=n(20),a=n(21),E=n(54),S=n(55),C=n(56),l=n(57),T=n(58),d=n(59),g=n(22),_=n(26),h=n(5),A=n(60),R=r.ListenerHandlers.getInstance(),I=function(){function e(){}return e.getInstance=function(){return null!=this.wsConnectionHelper&&null!=this.wsConnectionHelper||(this.wsConnectionHelper=new e),this.wsConnectionHelper},e.prototype.WSLogin=function(t,n){var s=this;A.getWSURL().then(function(e){s.connection=new WebSocket(e),n&&s.connection&&s.connection.readyState==h.READY_STATE.CONNECTING&&n(s.connection.readyState),s.connection.onopen=function(e){s.onOpen(e,n),s.authenticateUser(t)},s.connection.onclose=function(e){s.onClose(e,n)},s.connection.onerror=function(e){s.onError(e,n)},s.connection.onmessage=function(e){s.onMessage(e)}},function(e){p.Logger.error("WSConnectionHelper :: WSLogin",e)})},e.prototype.onOpen=function(e,t){t&&t(this.connection.readyState)},e.prototype.onClose=function(e,t){t&&t(this.connection.readyState)},e.prototype.onError=function(e,t){t&&t(this.connection.readyState)},e.prototype.onMessage=function(e){if(e.data&&"string"==typeof e.data)try{var t=this.getCometChatEventFromMessage(JSON.parse(e.data));if(t.getDeviceId()===c.CometChat.getSessionId()&&t.getType()!==h.AUTH.TYPE)return;switch(t.getType()){case h.TYPING_INDICATOR.TYPE:this.publishTypingIndicator(t);break;case h.RECEIPTS.TYPE:this.publishReceipts(t);break;case h.PRESENCE.TYPE:this.publishPresence(t);break;case h.AUTH.TYPE:this.authResponseReceived(t);break;case h.MESSAGE.TYPE:this.publishMessages(t);break;default:p.Logger.log("WSHelper: onMessage :: unknown type",e.data)}}catch(e){p.Logger.error("WSHelper: onMessage",e)}else p.Logger.log("WSHelper: onMessage :: object data",e.data)},e.prototype.authenticateUser=function(s){var o=this;try{c.CometChat.didMessagesPollingStart()||c.CometChat.getLoggedinUser().then(function(e){if(e){var t=new E.CometChatAuthEvent(c.CometChat.getAppId(),"","",e.getUid(),c.CometChat.getSessionId());if(t.setAuth(s),t.setPresenceSubscription(c.CometChat.appSettings.getSubscriptionType()),t.setDeviceId(c.CometChat.getSessionId()),A.checkConnection(o.connection)){var n=t.getAsString();o.connection.send(n)}}else p.Logger.log("no logged-in user","null")},function(e){p.Logger.log("error in fetching logged-in user",e)})}catch(e){p.Logger.error("WSConnectionHelper: startTypingIndicator",e)}},e.prototype.authResponseReceived=function(e){"200"===e.getCode()&&"OK"===e.getStatus()&&this.startPingingWS()},e.prototype.WSLogout=function(){A.checkConnection(this.connection)&&(this.pingInterval&&clearInterval(this.pingInterval),this.connection.close(h.LOGOUT_CODE,h.LOGOUT_REASON))},e.prototype.startPingingWS=function(){var t=this;this.pingInterval||(this.pingInterval=setInterval(function(){if(A.checkConnection(t.connection)){var e=new C.CometChatPingEvent("","","","","").getAsString();t.connection.send(e)}},15e3))},e.prototype.sendOnlineEvent=function(){var s=this;A.checkConnection(this.connection)&&c.CometChat.getLoggedinUser().then(function(e){if(e){var t={appId:c.CometChat.getAppId(),deviceId:c.CometChat.getSessionId(),type:h.PRESENCE.TYPE,body:{action:h.PRESENCE.ACTION.ONLINE,timestamp:Math.floor((new Date).getTime()/1e3),user:e}};if(A.checkConnection(s.connection)){var n=A.stringifyMessage(t);s.connection.send(n)}}else p.Logger.log("no logged-in user","null")},function(e){p.Logger.log("error in fetching logged-in user",e)})},e.prototype.sendOfflineEvent=function(){var s=this;A.checkConnection(this.connection)&&c.CometChat.getLoggedinUser().then(function(e){if(e){var t={appId:c.CometChat.getAppId(),deviceId:c.CometChat.getSessionId(),type:h.PRESENCE.TYPE,body:{action:h.PRESENCE.ACTION.OFFLINE,timestamp:Math.floor((new Date).getTime()/1e3),user:e}};if(A.checkConnection(s.connection)){var n=A.stringifyMessage(t);s.connection.send(n)}}else p.Logger.log("no logged-in user","null")},function(e){p.Logger.log("error in fetching logged-in user",e)})},e.prototype.startTypingIndicator=function(o,r,i){var a=this;try{c.CometChat.didMessagesPollingStart()||c.CometChat.getLoggedinUser().then(function(e){if(e){var t=new _.TypingIndicator(o,r);t.setSender(e),i&&t.setMetadata(i);var n=new d.CometChatTypingEvent(c.CometChat.getAppId(),o,r,e.getUid(),c.CometChat.getSessionId());if(n.setAction(h.TYPING_INDICATOR.ACTION.STARTED),n.setTypingIndicator(t),A.checkConnection(a.connection)){var s=n.getAsString();a.connection.send(s)}}else p.Logger.log("no logged-in user","null")},function(e){p.Logger.log("error in fetching logged-in user",e)})}catch(e){p.Logger.error("WSConnectionHelper: startTypingIndicator",e)}},e.prototype.pauseTypingIndicator=function(o,r,i){var a=this;try{c.CometChat.didMessagesPollingStart()||c.CometChat.getLoggedinUser().then(function(e){if(e){var t=new _.TypingIndicator(o,r);t.setSender(e),i&&t.setMetadata(i);var n=new d.CometChatTypingEvent(c.CometChat.getAppId(),o,r,e.getUid(),c.CometChat.getSessionId());if(n.setAction(h.TYPING_INDICATOR.ACTION.ENDED),n.setTypingIndicator(t),A.checkConnection(a.connection)){var s=n.getAsString();a.connection.send(s)}}else p.Logger.log("no logged-in user","null")},function(e){p.Logger.log("error in fetching logged-in user",e)})}catch(e){p.Logger.error("WSConnectionHelper: pauseTypingIndicator",e)}},e.prototype.markAsRead=function(o,r,i,a){var E=this;try{var e=c.CometChat.getMode();!c.CometChat.didMessagesPollingStart()&&(p.isFalsy(e)||e&&e===u.APP_SETTINGS.KEYS.DEFAULT_MODE)&&c.CometChat.getLoggedinUser().then(function(e){if(e){var t=new T.CometChatReceiptEvent(c.CometChat.getAppId(),o,r,e.getUid(),c.CometChat.getSessionId(),a);t.setAction(h.RECEIPTS.ACTION.READ);var n=new g.MessageReceipt;if(n.setSender(e),n.setReceiverType(r),n.setReceiver(o),n.setReceiptType(h.RECEIPTS.RECEIPT_TYPE.READ_RECEIPT),n.setMessageId(i),n.setTimestamp(Math.floor((new Date).getTime()/1e3).toString()),t.setMessageReceipt(n),A.checkConnection(E.connection)){var s=t.getAsString();E.connection.send(s)}}else p.Logger.log("no logged-in user","null")},function(e){p.Logger.log("error in fetching logged-in user",e)})}catch(e){p.Logger.error("WSConnectionHelper: markAsRead",e)}},e.prototype.markAsDelivered=function(o,r,i,a){var E=this;try{var e=c.CometChat.getMode();!c.CometChat.didMessagesPollingStart()&&(p.isFalsy(e)||e&&e===u.APP_SETTINGS.KEYS.DEFAULT_MODE)&&c.CometChat.getLoggedinUser().then(function(e){if(e){var t=new T.CometChatReceiptEvent(c.CometChat.getAppId(),o,r,e.getUid(),c.CometChat.getSessionId(),a);t.setAction(h.RECEIPTS.ACTION.DELIVERED);var n=new g.MessageReceipt;if(n.setSender(e),n.setReceiverType(r),n.setReceiver(o),n.setReceiptType(h.RECEIPTS.RECEIPT_TYPE.DELIVERY_RECEIPT),n.setMessageId(i),n.setTimestamp(Math.floor((new Date).getTime()/1e3).toString()),t.setMessageReceipt(n),A.checkConnection(E.connection)){var s=t.getAsString();E.connection.send(s)}}else p.Logger.log("no logged-in user","null")},function(e){p.Logger.log("error in fetching logged-in user",e)})}catch(e){p.Logger.error("WSConnectionHelper: markAsDelivered",e)}},e.prototype.publishTypingIndicator=function(e){try{var t=e.getTypingIndicator();switch(e.getAction()){case h.TYPING_INDICATOR.ACTION.STARTED:R.messageHandlers.map(function(e){e._eventListener.onTypingStarted&&e._eventListener.onTypingStarted(t)}),o.TypingNotificationController.addIncomingTypingStarted(t);break;case h.TYPING_INDICATOR.ACTION.ENDED:R.messageHandlers.map(function(e){e._eventListener.onTypingEnded&&e._eventListener.onTypingEnded(t)}),o.TypingNotificationController.removeIncomingTypingStarted(t)}}catch(e){p.Logger.error("WSHelper: publishTypingIndicator",e)}},e.prototype.publishReceipts=function(e){try{var t=e.getMessageReceipt();switch(e.getAction()){case h.RECEIPTS.ACTION.DELIVERED:R.messageHandlers.map(function(e){e._eventListener.onMessagesDelivered&&e._eventListener.onMessagesDelivered(t)});break;case h.RECEIPTS.ACTION.READ:R.messageHandlers.map(function(e){e._eventListener.onMessagesRead&&e._eventListener.onMessagesRead(t)})}}catch(e){p.Logger.error("WSHelper: publishReceipts",e)}},e.prototype.publishPresence=function(e){try{var t=e.getUser();switch(t.setLastActiveAt(e.getTimestamp()),e.getAction()){case h.PRESENCE.ACTION.ONLINE:case h.PRESENCE.ACTION.AVAILABLE:t.setStatus(u.PresenceConstatnts.STATUS.ONLINE),R.userHandlers.map(function(e){p.isFalsy(e._eventListener.onUserOnline)||e._eventListener.onUserOnline(t)});break;case h.PRESENCE.ACTION.OFFLINE:t.setStatus(u.PresenceConstatnts.STATUS.OFFLINE),R.userHandlers.map(function(e){p.isFalsy(e._eventListener.onUserOffline)||e._eventListener.onUserOffline(t)})}}catch(e){p.Logger.error("WSHelper: publishPresence",e)}},e.prototype.publishMessages=function(e){var t=e.getMessage();t.getReceiverType()==u.MessageConstatnts.RECEIVER_TYPE.GROUP?this.markAsDelivered(t.getReceiverId(),u.MessageConstatnts.RECEIVER_TYPE.GROUP,t.getId().toString(),t.getSender().getUid()):this.markAsDelivered(t.getSender().getUid(),u.MessageConstatnts.RECEIVER_TYPE.USER,t.getId().toString(),t.getSender().getUid()),t instanceof a.Call?this.publishCallMessage(t):t instanceof i.Action?this.publishActionMessage(t):this.publishMessage(t)},e.prototype.publishMessage=function(n){R.messageHandlers.map(function(e){if(e._eventListener){var t=n;switch(t.getType()){case u.MessageConstatnts.TYPE.TEXT:p.isFalsy(e._eventListener.onTextMessageReceived)||e._eventListener.onTextMessageReceived(n);break;case u.MessageConstatnts.TYPE.CUSTOM:p.isFalsy(e._eventListener.onCustomMessageReceived)||e._eventListener.onCustomMessageReceived(n);break;default:t.getCategory()==u.MessageCategory.CUSTOM?p.isFalsy(e._eventListener.onCustomMessageReceived)||e._eventListener.onCustomMessageReceived(n):p.isFalsy(e._eventListener.onMediaMessageReceived)||e._eventListener.onMediaMessageReceived(n)}}})},e.prototype.publishCallMessage=function(t){var n=s.CallController.getInstance().getActiveCall();switch(t.getStatus()){case u.CallConstants.CALL_STATUS.INITIATED:t.getReceiverType()==u.CallConstants.RECEIVER_TYPE_GROUP?R.callHandlers.map(function(e){t.getCallInitiator().getUid().toLocaleLowerCase()!=c.CometChat.user.getUid().toLocaleLowerCase()&&(p.isFalsy(e._eventListener.onIncomingCallReceived)||e._eventListener.onIncomingCallReceived(t))}):R.callHandlers.map(function(e){p.isFalsy(e._eventListener.onIncomingCallReceived)||e._eventListener.onIncomingCallReceived(t)});break;case u.CallConstants.CALL_STATUS.ONGOING:t.getReceiverType()==u.CallConstants.RECEIVER_TYPE_GROUP?t.getCallInitiator().getUid().toLocaleLowerCase()==c.CometChat.user.getUid().toLocaleLowerCase()&&R.callHandlers.map(function(e){p.isFalsy(e._eventListener.onOutgoingCallAccepted)||e._eventListener.onOutgoingCallAccepted(t)}):R.callHandlers.map(function(e){p.isFalsy(e._eventListener.onOutgoingCallAccepted)||e._eventListener.onOutgoingCallAccepted(t)});break;case u.CallConstants.CALL_STATUS.UNANSWERED:if(t.getCallInitiator().getUid().toLocaleLowerCase()==c.CometChat.user.getUid().toLocaleLowerCase())R.callHandlers.map(function(e){p.isFalsy(e._eventListener.onOutgoingCallRejected)||e._eventListener.onOutgoingCallRejected(t)});else{if(null!==n&&n.getSessionId()===t.getSessionId())try{s.CallController.getInstance().endCall()}catch(e){p.Logger.error("CallError",e)}R.callHandlers.map(function(e){p.isFalsy(e._eventListener.onIncomingCallCancelled)||e._eventListener.onIncomingCallCancelled(t)})}break;case u.CallConstants.CALL_STATUS.REJECTED:if(t.getReceiverType()==u.CallConstants.RECEIVER_TYPE_GROUP)t.getCallInitiator().getUid().toLocaleLowerCase()==c.CometChat.user.getUid().toLocaleLowerCase()&&R.callHandlers.map(function(e){p.isFalsy(e._eventListener.onOutgoingCallRejected)||e._eventListener.onOutgoingCallRejected(t)});else{if(null!==n&&n.getSessionId()===t.getSessionId())try{s.CallController.getInstance().endCall()}catch(e){p.Logger.error("CallError",e)}R.callHandlers.map(function(e){p.isFalsy(e._eventListener.onOutgoingCallRejected)||e._eventListener.onOutgoingCallRejected(t)})}break;case u.CallConstants.CALL_STATUS.BUSY:t.getReceiverType()==u.CallConstants.RECEIVER_TYPE_GROUP?t.getCallInitiator().getUid().toLocaleLowerCase()==c.CometChat.user.getUid().toLocaleLowerCase()&&R.callHandlers.map(function(e){p.isFalsy(e._eventListener.onOutgoingCallRejected)||e._eventListener.onOutgoingCallRejected(t)}):R.callHandlers.map(function(e){if(null!==n&&n.getSessionId()===t.getSessionId())try{s.CallController.getInstance().endCall()}catch(e){p.Logger.error("CallError",e)}p.isFalsy(e._eventListener.onOutgoingCallRejected)||e._eventListener.onOutgoingCallRejected(t)});break;case u.CallConstants.CALL_STATUS.CANCELLED:if(R.callHandlers.map(function(e){p.isFalsy(e._eventListener.onIncomingCallCancelled)||e._eventListener.onIncomingCallCancelled(t)}),null!==n&&n.getSessionId()===t.getSessionId())try{s.CallController.getInstance().endCall()}catch(e){p.Logger.error("CallError",e)}break;case u.CallConstants.CALL_STATUS.ENDED:if(s.CallController.getInstance().getCallListner()&&s.CallController.getInstance().getCallListner()._eventListener.onCallEnded(t),null!==n&&n.getSessionId()===t.getSessionId())try{s.CallController.getInstance().endCall()}catch(e){p.Logger.error("CallError",e)}break;default:p.Logger.log("WSHelper: publishCallMessage :: unknown status",t)}},e.prototype.publishActionMessage=function(t){var n=this;switch(t.getAction()){case u.ActionConstatnts.ACTION_TYPE.TYPE_MEMBER_JOINED:R.groupHandlers.map(function(e){p.isFalsy(e._eventListener.onUserJoined)||e._eventListener.onUserJoined(t,t.getActionBy(),t.getActionFor())});break;case u.ActionConstatnts.ACTION_TYPE.TYPE_MEMBER_INVITED:R.groupHandlers.map(function(e){p.isFalsy(e._eventListener.onUserJoined)||e._eventListener.onUserJoined(t,t.getActionBy(),t.getActionFor())});break;case u.ActionConstatnts.ACTION_TYPE.TYPE_MEMBER_LEFT:R.groupHandlers.map(function(e){p.isFalsy(e._eventListener.onUserLeft)||e._eventListener.onUserLeft(t,t.getActionBy(),t.getActionFor())});break;case u.ActionConstatnts.ACTION_TYPE.TYPE_MEMBER_BANNED:R.groupHandlers.map(function(e){p.isFalsy(e._eventListener.onUserBanned)||e._eventListener.onUserBanned(t,t.getActionOn(),t.getActionBy(),t.getActionFor())});break;case u.ActionConstatnts.ACTION_TYPE.TYPE_MEMBER_KICKED:R.groupHandlers.map(function(e){p.isFalsy(e._eventListener.onUserKicked)||e._eventListener.onUserKicked(t,t.getActionOn(),t.getActionBy(),t.getActionFor())});break;case u.ActionConstatnts.ACTION_TYPE.TYPE_MEMBER_UNBANNED:R.groupHandlers.map(function(e){p.isFalsy(e._eventListener.onUserUnbanned)||e._eventListener.onUserUnbanned(t,t.getActionOn(),t.getActionBy(),t.getActionFor())});break;case u.ActionConstatnts.ACTION_TYPE.TYPE_MEMBER_SCOPE_CHANGED:R.groupHandlers.map(function(e){p.isFalsy(e._eventListener.onMemberScopeChanged)||e._eventListener.onMemberScopeChanged(t,t.getActionOn(),t.getNewScope(),t.getOldScope(),t.getActionFor())});break;case u.ActionConstatnts.ACTION_TYPE.TYPE_MESSAGE_EDITED:R.messageHandlers.map(function(e){p.isFalsy(e._eventListener.onMessageEdited)||e._eventListener.onMessageEdited(t.getActionOn())});break;case u.ActionConstatnts.ACTION_TYPE.TYPE_MESSAGE_DELETED:R.messageHandlers.map(function(e){p.isFalsy(e._eventListener.onMessageDeleted)||e._eventListener.onMessageDeleted(t.getActionOn())});break;case u.ActionConstatnts.ACTION_TYPE.TYPE_MEMBER_ADDED:var s=t.getActionOn();c.CometChat.getLoggedinUser().then(function(e){e?e.getUid().toLowerCase()===s.getUid().toLowerCase()&&n.markAsDelivered(t.getActionFor().guid,t.getReceiverType(),t.getId().toString(),t.getSender().getUid()):p.Logger.log("WSHelper: publishActionMessage :: no logged-in user",null)},function(e){p.Logger.log("WSHelper: publishActionMessage :: error in getting logged-in user",e)}),R.groupHandlers.map(function(e){p.isFalsy(e._eventListener.onMemberAddedToGroup)||e._eventListener.onMemberAddedToGroup(t,t.getActionOn(),t.getActionBy(),t.getActionFor())});break;default:p.Logger.log("WSHelper: publishActionMessage :: unknown action",t)}},e.prototype.getCometChatEventFromMessage=function(e){if(e.hasOwnProperty(h.KEYS.TYPE))switch(e.type){case h.TYPING_INDICATOR.TYPE:return d.CometChatTypingEvent.getTypingEventFromJSON(e);case h.RECEIPTS.TYPE:return T.CometChatReceiptEvent.getReceiptEventFromJSON(e);case h.PRESENCE.TYPE:return l.CometChatPresenceEvent.getPresenceEventFromJSON(e);case h.MESSAGE.TYPE:return S.CometChatMessageEvent.getMessageEventFromJSON(e);case h.AUTH.TYPE:return E.CometChatAuthEvent.getAuthEventFromJSON(e)}},e.pingMessage={action:"ping"},e.wsConnectionHelper=new e,e}();t.WSConnectionHelper=I},function(e,t,n){"use strict";t.__esModule=!0;var s=n(0),o=function(){function e(){}return e.addTypingStarted=function(e){this.TYPING_STARTED_MAP[e]=s.getCurrentTime()},e.removeTypingStarted=function(e){delete this.TYPING_STARTED_MAP[e]},e.getTypingStartedMap=function(e){if(e)return this.TYPING_STARTED_MAP[e]},e.addTypingEnded=function(e){this.TYPING_ENDED_MAP[e]=s.getCurrentTime()},e.removeTypingEnded=function(e){delete this.TYPING_ENDED_MAP[e]},e.getTypingEndedMap=function(e){if(e)return this.TYPING_ENDED_MAP[e]},e.addIncomingTypingStarted=function(e){this.INCOMING_TYPING_STARTED_MAP[e.getReceiverId()]={typingNotification:e,timestamp:s.getCurrentTime()}},e.removeIncomingTypingStarted=function(e){delete this.INCOMING_TYPING_STARTED_MAP[e.getReceiverId()]},e.TYPING_STARTED_MAP={},e.TYPING_ENDED_MAP={},e.INCOMING_TYPING_STARTED_MAP={},e}();t.TypingNotificationController=o},function(e,t,n){"use strict";t.__esModule=!0;var s=n(0),o=n(23),r=function(){function e(){this.connectionHandlers=[],this.loginHandlers=[],this.messageHandlers=[],this.userHandlers=[],this.groupHandlers=[],this.callHandlers=[]}return e.getInstance=function(){return null!=this.listenerHandlers&&null!=this.listenerHandlers||(this.listenerHandlers=new e),this.listenerHandlers},e.prototype.addConnectionEventListener=function(t,e){try{this.connectionHandlers=this.connectionHandlers.filter(function(e){return e._name!=t}),this.connectionHandlers=this.connectionHandlers.concat([new o.ConnectionListener(t,e)])}catch(e){s.Logger.error("ListenerHandlers: addWSConnectionEventListener",e)}},e.prototype.removeConnectionEventListener=function(t){try{this.connectionHandlers=this.connectionHandlers.filter(function(e){return e._name!==t})}catch(e){s.Logger.error("ListenerHandlers: removeWSConnectionEventListener",e)}},e.prototype.addLoginEventListener=function(t,e){try{this.loginHandlers=this.loginHandlers.filter(function(e){return e._name!=t}),this.loginHandlers=this.loginHandlers.concat([new o.LoginListener(t,e)])}catch(e){s.Logger.error("ListenerHandlers: addLoginEventListener",e)}},e.prototype.removeLoginEventListener=function(t){try{this.loginHandlers=this.loginHandlers.filter(function(e){return e._name!==t})}catch(e){s.Logger.error("ListenerHandlers: removeLoginEventListener",e)}},e.prototype.addMessageEventListener=function(t,e){try{this.messageHandlers=this.messageHandlers.filter(function(e){return e._name!=t}),this.messageHandlers=this.messageHandlers.concat([new o.MessageListener(t,e)])}catch(e){s.Logger.error("ListenerHandlers: addMessageEventListener",e)}},e.prototype.removeMessageEventListener=function(t){try{this.messageHandlers=this.messageHandlers.filter(function(e){return e._name!==t})}catch(e){s.Logger.error("ListenerHandlers: removeMessageEventListener",e)}},e.prototype.addUserEventListener=function(t,e){try{this.userHandlers=this.userHandlers.filter(function(e){return e._name!=t}),this.userHandlers=this.userHandlers.concat([new o.UserListener(t,e)])}catch(e){s.Logger.error("ListenerHandlers: addUserEventListener",e)}},e.prototype.removeUserEventListener=function(t){try{this.userHandlers=this.userHandlers.filter(function(e){return e._name!==t})}catch(e){s.Logger.error("ListenerHandlers: removeUserEventListener",e)}},e.prototype.addGroupEventListener=function(t,e){try{this.groupHandlers=this.groupHandlers.filter(function(e){return e._name!=t}),this.groupHandlers=this.groupHandlers.concat([new o.GroupListener(t,e)])}catch(e){s.Logger.error("ListenerHandlers: addGroupEventListener",e)}},e.prototype.removeGroupEventListener=function(t){try{this.groupHandlers=this.groupHandlers.filter(function(e){return e._name!==t})}catch(e){s.Logger.error("ListenerHandlers: removeGroupEventListener",e)}},e.prototype.addCallEventListener=function(t,e){try{this.callHandlers=this.callHandlers.filter(function(e){return e._name!=t}),this.callHandlers=this.callHandlers.concat([new o.CallListener(t,e)])}catch(e){s.Logger.error("ListenerHandlers: addCallEventListener",e)}},e.prototype.removeCallEventListener=function(t){try{this.callHandlers=this.callHandlers.filter(function(e){return e._name!==t})}catch(e){s.Logger.error("ListenerHandlers: removeCallEventListener",e)}},e.listenerHandlers=new e,e}();t.ListenerHandlers=r},function(e,t){function r(e,t){for(var n in e)t[n]=e[n]}function n(e,t){var n=e.prototype;if(Object.create){var s=Object.create(t.prototype);n.__proto__=s}if(!(n instanceof t)){function o(){}o.prototype=t.prototype,r(n,o=new o),e.prototype=n=o}n.constructor!=e&&(n.constructor=e)}var g="http://www.w3.org/1999/xhtml",s={},_=s.ELEMENT_NODE=1,h=s.ATTRIBUTE_NODE=2,A=s.TEXT_NODE=3,R=s.CDATA_SECTION_NODE=4,I=s.ENTITY_REFERENCE_NODE=5,o=s.ENTITY_NODE=6,f=s.PROCESSING_INSTRUCTION_NODE=7,O=s.COMMENT_NODE=8,N=s.DOCUMENT_NODE=9,m=s.DOCUMENT_TYPE_NODE=10,y=s.DOCUMENT_FRAGMENT_NODE=11,i=s.NOTATION_NODE=12,a={},E={},c=(a.INDEX_SIZE_ERR=(E[1]="Index size error",1),a.DOMSTRING_SIZE_ERR=(E[2]="DOMString size error",2),a.HIERARCHY_REQUEST_ERR=(E[3]="Hierarchy request error",3)),u=(a.WRONG_DOCUMENT_ERR=(E[4]="Wrong document",4),a.INVALID_CHARACTER_ERR=(E[5]="Invalid character",5),a.NO_DATA_ALLOWED_ERR=(E[6]="No data allowed",6),a.NO_MODIFICATION_ALLOWED_ERR=(E[7]="No modification allowed",7),a.NOT_FOUND_ERR=(E[8]="Not found",8)),p=(a.NOT_SUPPORTED_ERR=(E[9]="Not supported",9),a.INUSE_ATTRIBUTE_ERR=(E[10]="Attribute in use",10));a.INVALID_STATE_ERR=(E[11]="Invalid state",11),a.SYNTAX_ERR=(E[12]="Syntax error",12),a.INVALID_MODIFICATION_ERR=(E[13]="Invalid modification",13),a.NAMESPACE_ERR=(E[14]="Invalid namespace",14),a.INVALID_ACCESS_ERR=(E[15]="Invalid access",15);function S(e,t){if(t instanceof Error)var n=t;else n=this,Error.call(this,E[e]),this.message=E[e],Error.captureStackTrace&&Error.captureStackTrace(this,S);return n.code=e,t&&(this.message=this.message+": "+t),n}function C(){}function l(e,t){this._node=e,this._refresh=t,T(this)}function T(e){var t=e._node._inc||e._node.ownerDocument._inc;if(e._inc!=t){var n=e._refresh(e._node);ne(e,"length",n.length),r(n,e),e._inc=t}}function d(){}function L(e,t){for(var n=e.length;n--;)if(e[n]===t)return n}function M(e,t,n,s){if(s?t[L(t,s)]=n:t[t.length++]=n,e){var o=(n.ownerElement=e).ownerDocument;o&&(s&&G(o,e,s),i=e,a=n,(r=o)&&r._inc++,"http://www.w3.org/2000/xmlns/"==a.namespaceURI&&(i._nsMap[a.prefix?a.localName:""]=a.value))}var r,i,a}function P(e,t,n){var s=L(t,n);if(!(0<=s))throw S(u,new Error(e.tagName+"@"+n));for(var o=t.length-1;s<o;)t[s]=t[++s];if(t.length=o,e){var r=e.ownerDocument;r&&(G(r,e,n),n.ownerElement=null)}}function v(e){if(this._features={},e)for(var t in e)this._features=e[t]}function D(){}function U(e){return("<"==e?"&lt;":">"==e&&"&gt;")||"&"==e&&"&amp;"||'"'==e&&"&quot;"||"&#"+e.charCodeAt()+";"}function Y(e,t){if(t(e))return!0;if(e=e.firstChild)do{if(Y(e,t))return!0}while(e=e.nextSibling)}function w(){}function G(e,t,n,s){e&&e._inc++,"http://www.w3.org/2000/xmlns/"==n.namespaceURI&&delete t._nsMap[n.prefix?n.localName:""]}function K(e,t,n){if(e&&e._inc){e._inc++;var s=t.childNodes;if(n)s[s.length++]=n;else{for(var o=t.firstChild,r=0;o;)o=(s[r++]=o).nextSibling;s.length=r}}}function x(e,t){var n=t.previousSibling,s=t.nextSibling;return n?n.nextSibling=s:e.firstChild=s,s?s.previousSibling=n:e.lastChild=n,K(e.ownerDocument,e),t}function b(e,t,n){var s=t.parentNode;if(s&&s.removeChild(t),t.nodeType===y){var o=t.firstChild;if(null==o)return t;var r=t.lastChild}else o=r=t;var i=n?n.previousSibling:e.lastChild;for(o.previousSibling=i,r.nextSibling=n,i?i.nextSibling=o:e.firstChild=o,null==n?e.lastChild=r:n.previousSibling=r;o.parentNode=e,o!==r&&(o=o.nextSibling););return K(e.ownerDocument||e,e),t.nodeType==y&&(t.firstChild=t.lastChild=null),t}function F(){this._nsMap={}}function B(){}function V(){}function J(){}function k(){}function H(){}function W(){}function j(){}function X(){}function q(){}function Q(){}function Z(){}function z(){}function $(e,t){var n=[],s=9==this.nodeType?this.documentElement:this,o=s.prefix,r=s.namespaceURI;if(r&&null==o&&null==(o=s.lookupPrefix(r)))var i=[{namespace:r,prefix:null}];return te(this,n,e,t,i),n.join("")}function ee(e,t,n){var s=e.prefix||"",o=e.namespaceURI;if(!s&&!o)return!1;if("xml"===s&&"http://www.w3.org/XML/1998/namespace"===o||"http://www.w3.org/2000/xmlns/"==o)return!1;for(var r=n.length;r--;){var i=n[r];if(i.prefix==s)return i.namespace!=o}return!0}function te(e,t,n,s,o){if(s){if(!(e=s(e)))return;if("string"==typeof e)return void t.push(e)}switch(e.nodeType){case _:o||(o=[]);o.length;var r=e.attributes,i=r.length,a=e.firstChild,E=e.tagName;n=g===e.namespaceURI||n,t.push("<",E);for(var c=0;c<i;c++){"xmlns"==(u=r.item(c)).prefix?o.push({prefix:u.localName,namespace:u.value}):"xmlns"==u.nodeName&&o.push({prefix:"",namespace:u.value})}for(c=0;c<i;c++){var u;if(ee(u=r.item(c),0,o)){var p=u.prefix||"",S=u.namespaceURI,C=p?" xmlns:"+p:" xmlns";t.push(C,'="',S,'"'),o.push({prefix:p,namespace:S})}te(u,t,n,s,o)}if(ee(e,0,o)){p=e.prefix||"",S=e.namespaceURI,C=p?" xmlns:"+p:" xmlns";t.push(C,'="',S,'"'),o.push({prefix:p,namespace:S})}if(a||n&&!/^(?:meta|link|img|br|hr|input)$/i.test(E)){if(t.push(">"),n&&/^script$/i.test(E))for(;a;)a.data?t.push(a.data):te(a,t,n,s,o),a=a.nextSibling;else for(;a;)te(a,t,n,s,o),a=a.nextSibling;t.push("</",E,">")}else t.push("/>");return;case N:case y:for(a=e.firstChild;a;)te(a,t,n,s,o),a=a.nextSibling;return;case h:return t.push(" ",e.name,'="',e.value.replace(/[<&"]/g,U),'"');case A:return t.push(e.data.replace(/[<&]/g,U));case R:return t.push("<![CDATA[",e.data,"]]>");case O:return t.push("\x3c!--",e.data,"--\x3e");case m:var l=e.publicId,T=e.systemId;if(t.push("<!DOCTYPE ",e.name),l)t.push(' PUBLIC "',l),T&&"."!=T&&t.push('" "',T),t.push('">');else if(T&&"."!=T)t.push(' SYSTEM "',T,'">');else{var d=e.internalSubset;d&&t.push(" [",d,"]"),t.push(">")}return;case f:return t.push("<?",e.target," ",e.data,"?>");case I:return t.push("&",e.nodeName,";");default:t.push("??",e.nodeName)}}function ne(e,t,n){e[t]=n}S.prototype=Error.prototype,r(a,S),C.prototype={length:0,item:function(e){return this[e]||null},toString:function(e,t){for(var n=[],s=0;s<this.length;s++)te(this[s],n,e,t);return n.join("")}},l.prototype.item=function(e){return T(this),this[e]},n(l,C),d.prototype={length:0,item:C.prototype.item,getNamedItem:function(e){for(var t=this.length;t--;){var n=this[t];if(n.nodeName==e)return n}},setNamedItem:function(e){var t=e.ownerElement;if(t&&t!=this._ownerElement)throw new S(p);var n=this.getNamedItem(e.nodeName);return M(this._ownerElement,this,e,n),n},setNamedItemNS:function(e){var t,n=e.ownerElement;if(n&&n!=this._ownerElement)throw new S(p);return t=this.getNamedItemNS(e.namespaceURI,e.localName),M(this._ownerElement,this,e,t),t},removeNamedItem:function(e){var t=this.getNamedItem(e);return P(this._ownerElement,this,t),t},removeNamedItemNS:function(e,t){var n=this.getNamedItemNS(e,t);return P(this._ownerElement,this,n),n},getNamedItemNS:function(e,t){for(var n=this.length;n--;){var s=this[n];if(s.localName==t&&s.namespaceURI==e)return s}return null}},v.prototype={hasFeature:function(e,t){var n=this._features[e.toLowerCase()];return!(!n||t&&!(t in n))},createDocument:function(e,t,n){var s=new w;if(s.implementation=this,s.childNodes=new C,(s.doctype=n)&&s.appendChild(n),t){var o=s.createElementNS(e,t);s.appendChild(o)}return s},createDocumentType:function(e,t,n){var s=new W;return s.name=e,s.nodeName=e,s.publicId=t,s.systemId=n,s}},D.prototype={firstChild:null,lastChild:null,previousSibling:null,nextSibling:null,attributes:null,parentNode:null,childNodes:null,ownerDocument:null,nodeValue:null,namespaceURI:null,prefix:null,localName:null,insertBefore:function(e,t){return b(this,e,t)},replaceChild:function(e,t){this.insertBefore(e,t),t&&this.removeChild(t)},removeChild:function(e){return x(this,e)},appendChild:function(e){return this.insertBefore(e,null)},hasChildNodes:function(){return null!=this.firstChild},cloneNode:function(e){return function e(t,n,s){var o=new n.constructor;for(var r in n){var i=n[r];"object"!=typeof i&&i!=o[r]&&(o[r]=i)}n.childNodes&&(o.childNodes=new C);o.ownerDocument=t;switch(o.nodeType){case _:var a=n.attributes,E=o.attributes=new d,c=a.length;E._ownerElement=o;for(var u=0;u<c;u++)o.setAttributeNode(e(t,a.item(u),!0));break;case h:s=!0}if(s)for(var p=n.firstChild;p;)o.appendChild(e(t,p,s)),p=p.nextSibling;return o}(this.ownerDocument||this,this,e)},normalize:function(){for(var e=this.firstChild;e;){var t=e.nextSibling;t&&t.nodeType==A&&e.nodeType==A?(this.removeChild(t),e.appendData(t.data)):(e.normalize(),e=t)}},isSupported:function(e,t){return this.ownerDocument.implementation.hasFeature(e,t)},hasAttributes:function(){return 0<this.attributes.length},lookupPrefix:function(e){for(var t=this;t;){var n=t._nsMap;if(n)for(var s in n)if(n[s]==e)return s;t=t.nodeType==h?t.ownerDocument:t.parentNode}return null},lookupNamespaceURI:function(e){for(var t=this;t;){var n=t._nsMap;if(n&&e in n)return n[e];t=t.nodeType==h?t.ownerDocument:t.parentNode}return null},isDefaultNamespace:function(e){return null==this.lookupPrefix(e)}},r(s,D),r(s,D.prototype),w.prototype={nodeName:"#document",nodeType:N,doctype:null,documentElement:null,_inc:1,insertBefore:function(e,t){if(e.nodeType!=y)return null==this.documentElement&&e.nodeType==_&&(this.documentElement=e),b(this,e,t),e.ownerDocument=this,e;for(var n=e.firstChild;n;){var s=n.nextSibling;this.insertBefore(n,t),n=s}return e},removeChild:function(e){return this.documentElement==e&&(this.documentElement=null),x(this,e)},importNode:function(e,t){return function e(t,n,s){var o;switch(n.nodeType){case _:(o=n.cloneNode(!1)).ownerDocument=t;case y:break;case h:s=!0}o||(o=n.cloneNode(!1));o.ownerDocument=t;o.parentNode=null;if(s)for(var r=n.firstChild;r;)o.appendChild(e(t,r,s)),r=r.nextSibling;return o}(this,e,t)},getElementById:function(t){var n=null;return Y(this.documentElement,function(e){if(e.nodeType==_&&e.getAttribute("id")==t)return n=e,!0}),n},createElement:function(e){var t=new F;return t.ownerDocument=this,t.nodeName=e,t.tagName=e,t.childNodes=new C,(t.attributes=new d)._ownerElement=t},createDocumentFragment:function(){var e=new Q;return e.ownerDocument=this,e.childNodes=new C,e},createTextNode:function(e){var t=new J;return t.ownerDocument=this,t.appendData(e),t},createComment:function(e){var t=new k;return t.ownerDocument=this,t.appendData(e),t},createCDATASection:function(e){var t=new H;return t.ownerDocument=this,t.appendData(e),t},createProcessingInstruction:function(e,t){var n=new Z;return n.ownerDocument=this,n.tagName=n.target=e,n.nodeValue=n.data=t,n},createAttribute:function(e){var t=new B;return t.ownerDocument=this,t.name=e,t.nodeName=e,t.localName=e,t.specified=!0,t},createEntityReference:function(e){var t=new q;return t.ownerDocument=this,t.nodeName=e,t},createElementNS:function(e,t){var n=new F,s=t.split(":"),o=n.attributes=new d;return n.childNodes=new C,n.ownerDocument=this,n.nodeName=t,n.tagName=t,n.namespaceURI=e,2==s.length?(n.prefix=s[0],n.localName=s[1]):n.localName=t,o._ownerElement=n},createAttributeNS:function(e,t){var n=new B,s=t.split(":");return n.ownerDocument=this,n.nodeName=t,n.name=t,n.namespaceURI=e,n.specified=!0,2==s.length?(n.prefix=s[0],n.localName=s[1]):n.localName=t,n}},n(w,D),w.prototype.getElementsByTagName=(F.prototype={nodeType:_,hasAttribute:function(e){return null!=this.getAttributeNode(e)},getAttribute:function(e){var t=this.getAttributeNode(e);return t&&t.value||""},getAttributeNode:function(e){return this.attributes.getNamedItem(e)},setAttribute:function(e,t){var n=this.ownerDocument.createAttribute(e);n.value=n.nodeValue=""+t,this.setAttributeNode(n)},removeAttribute:function(e){var t=this.getAttributeNode(e);t&&this.removeAttributeNode(t)},appendChild:function(e){return e.nodeType===y?this.insertBefore(e,null):function(e,t){var n=t.parentNode;if(n){var s=e.lastChild;n.removeChild(t),s=e.lastChild}return s=e.lastChild,t.parentNode=e,t.previousSibling=s,t.nextSibling=null,s?s.nextSibling=t:e.firstChild=t,e.lastChild=t,K(e.ownerDocument,e,t),t}(this,e)},setAttributeNode:function(e){return this.attributes.setNamedItem(e)},setAttributeNodeNS:function(e){return this.attributes.setNamedItemNS(e)},removeAttributeNode:function(e){return this.attributes.removeNamedItem(e.nodeName)},removeAttributeNS:function(e,t){var n=this.getAttributeNodeNS(e,t);n&&this.removeAttributeNode(n)},hasAttributeNS:function(e,t){return null!=this.getAttributeNodeNS(e,t)},getAttributeNS:function(e,t){var n=this.getAttributeNodeNS(e,t);return n&&n.value||""},setAttributeNS:function(e,t,n){var s=this.ownerDocument.createAttributeNS(e,t);s.value=s.nodeValue=""+n,this.setAttributeNode(s)},getAttributeNodeNS:function(e,t){return this.attributes.getNamedItemNS(e,t)},getElementsByTagName:function(s){return new l(this,function(t){var n=[];return Y(t,function(e){e===t||e.nodeType!=_||"*"!==s&&e.tagName!=s||n.push(e)}),n})},getElementsByTagNameNS:function(s,o){return new l(this,function(t){var n=[];return Y(t,function(e){e===t||e.nodeType!==_||"*"!==s&&e.namespaceURI!==s||"*"!==o&&e.localName!=o||n.push(e)}),n})}}).getElementsByTagName,w.prototype.getElementsByTagNameNS=F.prototype.getElementsByTagNameNS,n(F,D),B.prototype.nodeType=h,n(B,D),V.prototype={data:"",substringData:function(e,t){return this.data.substring(e,e+t)},appendData:function(e){e=this.data+e,this.nodeValue=this.data=e,this.length=e.length},insertData:function(e,t){this.replaceData(e,0,t)},appendChild:function(e){throw new Error(E[c])},deleteData:function(e,t){this.replaceData(e,t,"")},replaceData:function(e,t,n){n=this.data.substring(0,e)+n+this.data.substring(e+t),this.nodeValue=this.data=n,this.length=n.length}},n(V,D),J.prototype={nodeName:"#text",nodeType:A,splitText:function(e){var t=this.data,n=t.substring(e);t=t.substring(0,e),this.data=this.nodeValue=t,this.length=t.length;var s=this.ownerDocument.createTextNode(n);return this.parentNode&&this.parentNode.insertBefore(s,this.nextSibling),s}},n(J,V),k.prototype={nodeName:"#comment",nodeType:O},n(k,V),H.prototype={nodeName:"#cdata-section",nodeType:R},n(H,V),W.prototype.nodeType=m,n(W,D),j.prototype.nodeType=i,n(j,D),X.prototype.nodeType=o,n(X,D),q.prototype.nodeType=I,n(q,D),Q.prototype.nodeName="#document-fragment",Q.prototype.nodeType=y,n(Q,D),Z.prototype.nodeType=f,n(Z,D),z.prototype.serializeToString=function(e,t,n){return $.call(e,t,n)},D.prototype.toString=$;try{if(Object.defineProperty){Object.defineProperty(l.prototype,"length",{get:function(){return T(this),this.$$length}}),Object.defineProperty(D.prototype,"textContent",{get:function(){return function e(t){switch(t.nodeType){case _:case y:var n=[];for(t=t.firstChild;t;)7!==t.nodeType&&8!==t.nodeType&&n.push(e(t)),t=t.nextSibling;return n.join("");default:return t.nodeValue}}(this)},set:function(e){switch(this.nodeType){case _:case y:for(;this.firstChild;)this.removeChild(this.firstChild);(e||String(e))&&this.appendChild(this.ownerDocument.createTextNode(e));break;default:this.data=e,this.value=e,this.nodeValue=e}}}),ne=function(e,t,n){e["$$"+t]=n}}}catch(e){}t.DOMImplementation=v,t.XMLSerializer=z},function(e,t,n){"use strict";t.__esModule=!0;var s=n(3);t.init=function(e){return s.CometChat.getInstance(e)},t.CometChat=s.CometChat},function(e,t,n){"use strict";t.__esModule=!0;var r=n(0),i=n(1),a=n(2),s=n(12),o=function(){function e(e){this.store=i.constants.DEFAULT_STORE,r.isFalsy(e)||(this.store=e);try{this.keyStore=s.default}catch(e){r.Logger.error("KeyStore: constructor",{e:e})}}return e.getInstance=function(){return null==e.KeyStore&&(e.KeyStore=new e),e.KeyStore},e.prototype.set=function(e,t){var n=r.getKeyprefix(i.LOCAL_STORE.KEYS_STORE,e);return this.keyStore.setItem(n,JSON.stringify(t))},e.prototype.get=function(e){var s=this,o=r.getKeyprefix(i.LOCAL_STORE.KEYS_STORE,e);return new Promise(function(n,t){try{s.keyStore.getItem(o).then(function(t){try{n(JSON.parse(t))}catch(e){n(t)}},function(e){t(e)})}catch(e){t(new a.CometChatException(e))}})},e}();t.KeyStore=o},function(e,t){e.exports=o},function(e,t){e.exports=r},function(e,t,n){"use strict";t.__esModule=!0;var s=n(0),o=function(){function e(e){this.avatar="",s.isFalsy(e)||(this.uid=e.toString())}return e.prototype.setUID=function(e){this.uid=e?e.toString():""},e.prototype.getUID=function(){return this.uid.toString()},e.prototype.setName=function(e){this.name=e?e.toString():""},e.prototype.getName=function(){return this.name.toString()},e.prototype.setAvatar=function(e){this.avatar=e?e.toString():""},e.prototype.getAvatar=function(){return this.avatar.toString()},e.prototype.setJWT=function(e){this.jwt=e?e.toString():""},e.prototype.getJWT=function(){return this.jwt.toString()},e.prototype.setResource=function(e){this.resource=e?e.toString():""},e.prototype.getResource=function(){return this.resource.toString()},e}();t.RTCUser=o},function(e,t,n){"use strict";t.__esModule=!0;var s=n(0),o=function(){function e(e,t){this.isSelected=!1,this.mode="",s.isFalsy(e)||(this.mode=e.toString()),this.isSelected=t||!1}return e.prototype.setMode=function(e){this.mode=e?e.toString():""},e.prototype.getMode=function(){return this.mode.toString()},e.prototype.setIsSelected=function(e){this.isSelected=e||!1},e.prototype.getIsSelected=function(){return this.isSelected},e}();t.AudioMode=o},function(e,t,n){"use strict";t.__esModule=!0;var o=n(6),s=n(0),r=n(2),i=n(15),a=n(1),E=function(){function e(e){this.cursor=-1,this.total=-1,this.next_page=1,this.last_page=-1,this.current_page=1,this.total_pages=-1,this.hasJoined=0,this.withTags=!1,this.pagination={total:0,count:0,per_page:0,current_page:0,total_pages:0,links:[]},s.isFalsy(e)||(s.isFalsy(e.limit)||(this.limit=e.limit),s.isFalsy(e.searchKeyword)||(this.searchKeyword=e.searchKeyword),s.isFalsy(e.hasJoined)||(this.hasJoined=1),s.isFalsy(e.tags)||(this.tags=e.tags),s.isFalsy(e.showTags)||(this.withTags=e.showTags))}return e.prototype.validateGroupBuilder=function(){if(void 0===this.limit)return new r.CometChatException(JSON.parse(s.format(JSON.stringify(a.GENERAL_ERROR.METHOD_COMPULSORY),"SET_LIMIT","SET_LIMIT","Set Limit")));if(isNaN(this.limit))return new r.CometChatException(JSON.parse(s.format(JSON.stringify(a.GENERAL_ERROR.PARAMETER_MUST_BE_A_NUMBER),"SET_LIMIT","SET_LIMIT","setLimit()")));if(this.limit>a.DEFAULT_VALUES.GROUPS_MAX_LIMIT)return new r.CometChatException(JSON.parse(s.format(JSON.stringify(a.GENERAL_ERROR.LIMIT_EXCEEDED),"SET_LIMIT","SET_LIMIT",a.DEFAULT_VALUES.GROUPS_MAX_LIMIT)));if(this.limit<a.DEFAULT_VALUES.ZERO)return new r.CometChatException(JSON.parse(s.format(JSON.stringify(a.GENERAL_ERROR.PARAMETER_MUST_BE_A_POSITIVE_NUMBER),"SET_LIMIT","SET_LIMIT","setLimit()")));if(void 0!==this.searchKeyword){if(typeof this.searchKeyword!==a.COMMON_UTILITY_CONSTANTS.TYPE_CONSTANTS.STRING)return new r.CometChatException(JSON.parse(s.format(JSON.stringify(a.GENERAL_ERROR.PARAMETER_MUST_BE_A_STRING),"SET_SEARCH_KEYWORD","SET_SEARCH_KEYWORD","setSearchKeyword()")));if(s.isFalsy(this.searchKeyword.trim()))return new r.CometChatException(JSON.parse(s.format(JSON.stringify(a.GENERAL_ERROR.INVALID),"SET_SEARCH_KEYWORD","SET_SEARCH_KEYWORD","search keyword","search keyword")));this.searchKeyword=this.searchKeyword.trim()}if(void 0!==this.withTags){if(typeof this.withTags!==a.COMMON_UTILITY_CONSTANTS.TYPE_CONSTANTS.BOOLEAN)return new r.CometChatException(JSON.parse(s.format(JSON.stringify(a.GENERAL_ERROR.PARAMETER_MUST_BE_A_BOOLEAN),"WITH_TAGS","WITH_TAGS","withTags()")));1==this.withTags?this.withTags=!0:this.withTags=!1}return void 0===this.tags||Array.isArray(this.tags)?void 0:new r.CometChatException(JSON.parse(s.format(JSON.stringify(a.GENERAL_ERROR.PARAMETER_MUST_BE_AN_ARRAY),"TAGS","TAGS","setTags()")))},e.prototype.fetchPrevious=function(){var s=this;return new Promise(function(t,n){try{0==s.next_page&&t([]);var e=s.validateGroupBuilder();return e instanceof r.CometChatException?void n(e):o.makeApiCall("groups",{},s.getPreData()).then(function(e){if(e.meta&&(s.total_pages=e.meta.pagination.total_pages),0<e.data.length){s.pagination=e.meta.pagination;var n=[];e.data.map(function(e,t){n.push(i.GroupsController.trasformJSONGroup(e))}),t(n)}t([])},function(e){n(new r.CometChatException(e.error))})}catch(e){n(new r.CometChatException(e))}})},e.prototype.fetchNext=function(){var s=this;return new Promise(function(t,n){try{var e=s.validateGroupBuilder();if(e instanceof r.CometChatException)return void n(e);o.makeApiCall("getGroups",{},s.getNextData()).then(function(e){if(e.meta&&(s.total_pages=e.meta.pagination.total_pages),0<e.data.length){s.pagination=e.meta.pagination;var n=[];e.data.map(function(e,t){n.push(i.GroupsController.trasformJSONGroup(e))}),t(n)}t([])},function(e){n(new r.CometChatException(e.error))})}catch(e){n(new r.CometChatException(e))}})},e.prototype.getNextData=function(){var e={};if(e.per_page=this.limit,s.isFalsy(this.searchKeyword)||(e.searchKey=this.searchKeyword),s.isFalsy(this.hasJoined)||(e.hasJoined=1),s.isFalsy(this.tags)||(e.tags=this.tags),s.isFalsy(this.withTags)||(e.withTags=1),1==this.current_page)e.page=this.next_page,this.next_page++,this.current_page++;else{if(this.next_page>this.total_pages)return e.page=this.next_page,e;e.page=this.next_page++}return e},e.prototype.getPreData=function(){var e={};return e.per_page=this.limit,0<=this.next_page&&0<this.next_page&&(e.page=--this.next_page),e},e.MAX_LIMIT=100,e.DEFAULT_LIMIT=30,e}();t.GroupsRequest=E;var c=function(){function e(){}return e.prototype.setLimit=function(e){return this.limit=e,this},e.prototype.setSearchKeyword=function(e){return this.searchKeyword=e,this},e.prototype.joinedOnly=function(e){return this.hasJoined=e,this},e.prototype.setTags=function(e){return this.tags=e,this},e.prototype.withTags=function(e){return this.showTags=e,this},e.prototype.build=function(){return new E(this)},e}();t.GroupsRequestBuilder=c},function(e,t,n){"use strict";var s,o=this&&this.__extends||(s=function(e,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}s(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});t.__esModule=!0;var r=n(6),i=n(0),a=n(14),E=n(2),c=n(48),u=n(1),p=function(){function e(e){this.cursor=-1,this.total=-1,this.next_page=1,this.last_page=-1,this.current_page=1,this.total_pages=-1,this.isOutCastReq=!1,this.pagination={total:0,count:0,per_page:0,current_page:0,total_pages:0,links:[]},this.store=a.LocalStorage.getInstance(),i.isFalsy(e)||(this.limit=e.limit,this.guid=e.guid,i.isFalsy(e.searchKeyword)||(this.searchKeyword=e.searchKeyword),i.isFalsy(e.scopes)||(this.scopes=e.scopes),e instanceof C&&(this.isOutCastReq=e.isOutCastReq))}return e.prototype.validateGroupMembersBuilder=function(){if(void 0===this.limit)return new E.CometChatException(JSON.parse(i.format(JSON.stringify(u.GENERAL_ERROR.METHOD_COMPULSORY),"SET_LIMIT","SET_LIMIT","Set Limit")));if(isNaN(this.limit))return new E.CometChatException(JSON.parse(i.format(JSON.stringify(u.GENERAL_ERROR.PARAMETER_MUST_BE_A_NUMBER),"SET_LIMIT","SET_LIMIT","setLimit()")));if(this.limit>u.DEFAULT_VALUES.USERS_MAX_LIMIT)return new E.CometChatException(JSON.parse(i.format(JSON.stringify(u.GENERAL_ERROR.LIMIT_EXCEEDED),"SET_LIMIT","SET_LIMIT",u.DEFAULT_VALUES.USERS_MAX_LIMIT)));if(this.limit<u.DEFAULT_VALUES.ZERO)return new E.CometChatException(JSON.parse(i.format(JSON.stringify(u.GENERAL_ERROR.PARAMETER_MUST_BE_A_POSITIVE_NUMBER),"SET_LIMIT","SET_LIMIT","setLimit()")));if(void 0!==this.searchKeyword){if(typeof this.searchKeyword!==u.COMMON_UTILITY_CONSTANTS.TYPE_CONSTANTS.STRING)return new E.CometChatException(JSON.parse(i.format(JSON.stringify(u.GENERAL_ERROR.PARAMETER_MUST_BE_A_STRING),"SET_SEARCH_KEYWORD","SET_SEARCH_KEYWORD","setSearchKeyword()")));if(i.isFalsy(this.searchKeyword.trim()))return new E.CometChatException(JSON.parse(i.format(JSON.stringify(u.GENERAL_ERROR.INVALID),"SET_SEARCH_KEYWORD","SET_SEARCH_KEYWORD","search keyword","search keyword")));this.searchKeyword=this.searchKeyword.trim()}if(void 0!==this.guid){if(typeof this.guid!==u.COMMON_UTILITY_CONSTANTS.TYPE_CONSTANTS.STRING)return new E.CometChatException(JSON.parse(i.format(JSON.stringify(u.GENERAL_ERROR.PARAMETER_MUST_BE_A_STRING),"GUID","GUID","GroupMembersRequestBuilder()")));if(i.isFalsy(this.guid))return new E.CometChatException(JSON.parse(i.format(JSON.stringify(u.GENERAL_ERROR.INVALID),"GUID","GUID","GUID","GUID")))}return void 0===this.scopes||Array.isArray(this.scopes)?void 0:new E.CometChatException(JSON.parse(i.format(JSON.stringify(u.GENERAL_ERROR.PARAMETER_MUST_BE_AN_ARRAY),"SET_SCOPES","SET_SCOPES","setScopes()")))},e.prototype.fetchPrevious=function(){var s=this;return new Promise(function(n,t){try{0==s.next_page&&n([]);var e=s.validateGroupMembersBuilder();return e instanceof E.CometChatException?void t(e):r.makeApiCall(s.isOutCastReq?"getBannedGroupMembers":"getGroupMembers",{guid:s.guid},s.getPreData()).then(function(e){if(e.meta&&(s.total_pages=e.meta.pagination.total_pages),0<e.data.length){s.pagination=e.meta.pagination;var t=[];e.data.map(function(e){e.guid=s.guid,t.push(c.GroupMembersController.trasformJSONGroupMember(e))}),n(t)}n([])},function(e){t(new E.CometChatException(e.error))})}catch(e){t(new E.CometChatException(e))}})},e.prototype.fetchNext=function(){var s=this;return new Promise(function(n,t){try{var e=s.validateGroupMembersBuilder();if(e instanceof E.CometChatException)return void t(e);r.makeApiCall(s.isOutCastReq?"getBannedGroupMembers":"getGroupMembers",{guid:s.guid},s.getNextData()).then(function(e){if(e.meta&&(s.total_pages=e.meta.pagination.total_pages),0<e.data.length){s.pagination=e.meta.pagination;var t=[];e.data.map(function(e){e.guid=s.guid,t.push(c.GroupMembersController.trasformJSONGroupMember(e))}),n(t)}else n([])},function(e){t(new E.CometChatException(e.error))})}catch(e){t(new E.CometChatException(e))}})},e.prototype.getNextData=function(){var e={};if(e.per_page=this.limit,i.isFalsy(this.searchKeyword)||(e.searchKey=this.searchKeyword),i.isFalsy(this.scopes)||(e.scopes=this.scopes),1==this.current_page)e.page=this.next_page,this.next_page++,this.current_page++;else{if(this.next_page>this.total_pages)return e.page=this.next_page,e;e.page=this.next_page++}return e},e.prototype.getPreData=function(){var e={};return e.per_page=this.limit,0<=this.next_page&&0<this.next_page&&(e.page=--this.next_page),e},e.MAX_LIMIT=2,e.DEFAULT_LIMIT=1,e}();t.GroupMembersRequest=p;var S=function(){function e(e){this.guid=e}return e.prototype.setLimit=function(e){return this.limit=e,this},e.prototype.setSearchKeyword=function(e){return this.searchKeyword=e,this},e.prototype.setScopes=function(e){return this.scopes=e,this},e.prototype.build=function(){return new p(this)},e}(),C=function(n){function e(e){var t=n.call(this,e)||this;return t.isOutCastReq=!0,t}return o(e,n),e.prototype.build=function(){return new p(this)},e}(t.GroupMembersRequestBuilder=S);t.GroupOutCastMembersRequestBuilder=C},function(e,t,n){"use strict";t.__esModule=!0;var s=n(33),o=n(1),r=n(0),i=function(){function e(){}return e.trasformJSONGroupMember=function(t){var e;try{return t.status&&"offline"!==t.status?t.status="online":t.status="offline",e=new s.GroupMember(t[o.GroupMemersConstans.KEYS.UID]),Object.assign(e,t),e}catch(e){return r.Logger.error("GroupMembersController:trasformJSONGroupMember",{e:e,groupMember:t}),t}},e}();t.GroupMembersController=i},function(e,t,n){"use strict";t.__esModule=!0;var r=n(6),s=n(0),i=n(10),a=n(2),E=n(50),c=n(1),o=function(){function o(e){this.next_page=1,this.current_page=1,this.total_pages=-1,this.hideBlockedUsers=!1,this.friendsOnly=!1,this.fetchingInProgress=!1,this.withTags=!1,this.pagination={total:0,count:0,per_page:0,current_page:0,total_pages:0,links:[]},o.userStore=E.UserStore.getInstance(),s.isFalsy(e)||(this.limit=e.limit,s.isFalsy(e.searchKeyword)||(this.searchKeyword=e.searchKeyword),s.isFalsy(e.status)||(e.status==o.USER_STATUS.ONLINE?this.status=c.PresenceConstatnts.STATUS.AVAILABLE:this.status=e.status),s.isFalsy(e.shouldHideBlockedUsers)||(this.hideBlockedUsers=e.shouldHideBlockedUsers),s.isFalsy(e.showFriendsOnly)||(this.friendsOnly=e.showFriendsOnly),s.isFalsy(e.showTags)||(this.withTags=e.showTags),s.isFalsy(e.role)||(this.role=e.role),s.isFalsy(e.roles)||(this.roles=e.roles),s.isFalsy(e.tags)||(this.tags=e.tags))}return o.prototype.validateUserBuilder=function(){if(void 0===this.limit)return new a.CometChatException(JSON.parse(s.format(JSON.stringify(c.GENERAL_ERROR.METHOD_COMPULSORY),"SET_LIMIT","SET_LIMIT","Set Limit")));if(isNaN(this.limit))return new a.CometChatException(JSON.parse(s.format(JSON.stringify(c.GENERAL_ERROR.PARAMETER_MUST_BE_A_NUMBER),"SET_LIMIT","SET_LIMIT","setLimit()")));if(this.limit>c.DEFAULT_VALUES.USERS_MAX_LIMIT)return new a.CometChatException(JSON.parse(s.format(JSON.stringify(c.GENERAL_ERROR.LIMIT_EXCEEDED),"SET_LIMIT","SET_LIMIT",c.DEFAULT_VALUES.USERS_MAX_LIMIT)));if(this.limit<c.DEFAULT_VALUES.ZERO)return new a.CometChatException(JSON.parse(s.format(JSON.stringify(c.GENERAL_ERROR.PARAMETER_MUST_BE_A_POSITIVE_NUMBER),"SET_LIMIT","SET_LIMIT","setLimit()")));if(void 0!==this.searchKeyword){if(typeof this.searchKeyword!==c.COMMON_UTILITY_CONSTANTS.TYPE_CONSTANTS.STRING)return new a.CometChatException(JSON.parse(s.format(JSON.stringify(c.GENERAL_ERROR.PARAMETER_MUST_BE_A_STRING),"SET_SEARCH_KEYWORD","SET_SEARCH_KEYWORD","setSearchKeyword()")));if(s.isFalsy(this.searchKeyword.trim()))return new a.CometChatException(JSON.parse(s.format(JSON.stringify(c.GENERAL_ERROR.INVALID),"SET_SEARCH_KEYWORD","SET_SEARCH_KEYWORD","search keyword","search keyword")));this.searchKeyword=this.searchKeyword.trim()}if(this.status){if(typeof this.status!==c.COMMON_UTILITY_CONSTANTS.TYPE_CONSTANTS.STRING)return new a.CometChatException(JSON.parse(s.format(JSON.stringify(c.GENERAL_ERROR.PARAMETER_MUST_BE_A_STRING),"SET_STATUS","SET_STATUS","setStatus()")));if("available"!=this.status.toLowerCase()&&"offline"!=this.status.toLowerCase())return new a.CometChatException(c.UserErrors.INVALID_STATUS)}if(void 0!==this.hideBlockedUsers){if(typeof this.hideBlockedUsers!==c.COMMON_UTILITY_CONSTANTS.TYPE_CONSTANTS.BOOLEAN)return new a.CometChatException(JSON.parse(s.format(JSON.stringify(c.GENERAL_ERROR.PARAMETER_MUST_BE_A_BOOLEAN),"HIDE_BLOCKED_USERS","HIDE_BLOCKED_USERS","hideBlockedUsers()")));1==this.hideBlockedUsers?this.hideBlockedUsers=!0:this.hideBlockedUsers=!1}if(void 0!==this.friendsOnly){if(typeof this.friendsOnly!==c.COMMON_UTILITY_CONSTANTS.TYPE_CONSTANTS.BOOLEAN)return new a.CometChatException(JSON.parse(s.format(JSON.stringify(c.GENERAL_ERROR.PARAMETER_MUST_BE_A_BOOLEAN),"FRIENDS_ONLY","FRIENDS_ONLY","friendsOnly()")));1==this.friendsOnly?this.friendsOnly=!0:this.friendsOnly=!1}if(void 0!==this.withTags){if(typeof this.withTags!==c.COMMON_UTILITY_CONSTANTS.TYPE_CONSTANTS.BOOLEAN)return new a.CometChatException(JSON.parse(s.format(JSON.stringify(c.GENERAL_ERROR.MUST_BE_A_BOOLEAN),"WITH_TAGS","WITH_TAGS","withTags()")));1==this.withTags?this.withTags=!0:this.withTags=!1}return void 0===this.roles||Array.isArray(this.roles)?void 0===this.tags||Array.isArray(this.tags)?void 0:new a.CometChatException(JSON.parse(s.format(JSON.stringify(c.GENERAL_ERROR.PARAMETER_MUST_BE_AN_ARRAY),"TAGS","TAGS","setTags()"))):new a.CometChatException(JSON.parse(s.format(JSON.stringify(c.GENERAL_ERROR.PARAMETER_MUST_BE_AN_ARRAY),"ROLES","ROLES","setRoles()")))},o.prototype.fetchPrevious=function(){var s=this;return this.fetchingInProgress=!0,new Promise(function(t,n){try{0==s.next_page&&(t([]),s.fetchingInProgress=!1);var e=s.validateUserBuilder();if(e instanceof a.CometChatException)return void n(e);if(!s.fetchingInProgress)return r.makeApiCall("users",{},s.getPreData()).then(function(e){if(e.meta&&(s.total_pages=e.meta.pagination.total_pages),0<e.data.length){s.pagination=e.meta.pagination;var n=[];e.data.map(function(e,t){n.push(i.UsersController.trasformJSONUser(e))}),o.userStore.storeUsers(n),t(n),s.fetchingInProgress=!1}t([]),s.fetchingInProgress=!1},function(e){n(new a.CometChatException(e.error)),s.fetchingInProgress=!1});t([])}catch(e){s.fetchingInProgress=!1,n(new a.CometChatException(e))}})},o.prototype.fetchNext=function(){var s=this;return new Promise(function(n,t){try{if(s.fetchingInProgress)s.fetchingInProgress=!1,n([]);else{s.fetchingInProgress=!0;var e=s.validateUserBuilder();if(e instanceof a.CometChatException)return void t(e);r.makeApiCall("users",{},s.getNextData()).then(function(e){if(e.meta&&(s.total_pages=e.meta.pagination.total_pages),0<e.data.length){s.pagination=e.meta.pagination;var t=[];e.data.map(function(e){t.push(i.UsersController.trasformJSONUser(e))}),n(t)}else n([]);s.fetchingInProgress=!1},function(e){s.fetchingInProgress=!1,t(new a.CometChatException(e.error))})}}catch(e){s.fetchingInProgress=!1,t(new a.CometChatException(e))}})},o.prototype.getNextData=function(){var e={};if(e.per_page=this.limit,s.isFalsy(this.searchKeyword)||(e.searchKey=this.searchKeyword),s.isFalsy(this.status)||(e.status=this.status),s.isFalsy(this.hideBlockedUsers)||(e.hideBlockedUsers=1),s.isFalsy(this.role)||(e.roles=this.role),s.isFalsy(this.roles)||(e.roles=this.roles),s.isFalsy(this.tags)||(e.tags=this.tags),s.isFalsy(this.friendsOnly)||(e.friendsOnly=1),s.isFalsy(this.withTags)||(e.withTags=1),1==this.current_page)e.page=this.next_page,this.next_page++,this.current_page++;else{if(this.next_page>this.total_pages)return e.page=this.next_page,e;e.page=this.next_page++}return e},o.prototype.getPreData=function(){var e={};return e.per_page=this.limit,0<=this.next_page&&0<this.next_page&&(e.page=--this.next_page),e},o.USER_STATUS={ONLINE:c.PresenceConstatnts.STATUS.ONLINE,OFFLINE:c.PresenceConstatnts.STATUS.OFFLINE},o}();t.UsersRequest=o;var u=function(){function e(){this.shouldHideBlockedUsers=!1}return e.prototype.setLimit=function(e){return this.limit=e,this},e.prototype.setStatus=function(e){return this.status=e,this},e.prototype.setSearchKeyword=function(e){return this.searchKeyword=e,this},e.prototype.hideBlockedUsers=function(e){return this.shouldHideBlockedUsers=e,this},e.prototype.setRole=function(e){return this.role=e,this},e.prototype.setRoles=function(e){return this.roles=e,this},e.prototype.friendsOnly=function(e){return this.showFriendsOnly=e,this},e.prototype.setTags=function(e){return this.tags=e,this},e.prototype.withTags=function(e){return this.showTags=e,this},e.prototype.build=function(){return this.role&&this.roles&&this.roles.push(this.role),new o(this)},e}();t.UsersRequestBuilder=u},function(e,t,n){"use strict";t.__esModule=!0;var r=n(0),i=n(1),a=n(2),s=n(12),o=function(){function e(e){this.store=i.constants.DEFAULT_STORE,r.isFalsy(e)||(this.store=e);try{this.userStore=s.default}catch(e){r.Logger.error("UserStore: constructor",{e:e})}}return e.getInstance=function(){return null==e.UserStore&&(e.UserStore=new e),e.UserStore},e.prototype.set=function(e,t){var n=r.getKeyprefix(i.LOCAL_STORE.USERS_STORE,e);return this.userStore.setItem(n,JSON.stringify(t))},e.prototype.get=function(e){var s=this,o=r.getKeyprefix(i.LOCAL_STORE.USERS_STORE,e);return new Promise(function(n,t){try{s.userStore.getItem(o).then(function(t){try{n(JSON.parse(t))}catch(e){n(t)}},function(e){t(e)})}catch(e){t(new a.CometChatException(e))}})},e.prototype.clear=function(e){},e.prototype.selectStore=function(e){this.store=e},e.prototype.storeUsers=function(e){var t=this;return e.map(function(e){t.set(e.getUid(),e)}),!0},e.prototype.storeUser=function(e){return this.set(e.getUid(),e),!0},e}();t.UserStore=o},function(e,t,n){"use strict";t.__esModule=!0;var o=n(6),s=n(0),r=n(2),i=n(25),a=n(1),E=function(){function e(e){this.limit=100,this.next_page=1,this.current_page=1,this.total_pages=-1,this.fetchingInProgress=!1,this.pagination={total:0,count:0,per_page:0,current_page:0,total_pages:0,links:[]},s.isFalsy(e)||(this.limit=e.limit,s.isFalsy(e.conversationType)||(this.conversationType=e.conversationType))}return e.prototype.validateConversationBuilder=function(){return void 0===this.limit?new r.CometChatException(JSON.parse(s.format(JSON.stringify(a.GENERAL_ERROR.METHOD_COMPULSORY),"SET_LIMIT","SET_LIMIT","Set Limit"))):isNaN(this.limit)?new r.CometChatException(JSON.parse(s.format(JSON.stringify(a.GENERAL_ERROR.PARAMETER_MUST_BE_A_NUMBER),"SET_LIMIT","SET_LIMIT","setLimit()"))):this.limit>a.DEFAULT_VALUES.CONVERSATION_MAX_LIMIT?new r.CometChatException(JSON.parse(s.format(JSON.stringify(a.GENERAL_ERROR.LIMIT_EXCEEDED),"SET_LIMIT","SET_LIMIT",a.DEFAULT_VALUES.CONVERSATION_MAX_LIMIT))):this.limit<a.DEFAULT_VALUES.ZERO?new r.CometChatException(JSON.parse(s.format(JSON.stringify(a.GENERAL_ERROR.PARAMETER_MUST_BE_A_POSITIVE_NUMBER),"SET_LIMIT","SET_LIMIT","setLimit()"))):void 0},e.prototype.fetchNext=function(){var s=this;return new Promise(function(n,t){try{if(s.fetchingInProgress)s.fetchingInProgress=!1,n([]);else{s.fetchingInProgress=!0;var e=s.validateConversationBuilder();if(e instanceof r.CometChatException)return void t(e);o.makeApiCall("getConversations",{},s.getNextData()).then(function(e){if(e.meta&&(s.total_pages=e.meta.pagination.total_pages),0<e.data.length){s.pagination=e.meta.pagination;var t=[];e.data.map(function(e){t.push(i.ConversationController.trasformJSONConversation(e.conversationId,e.conversationType,e.lastMessage,e.conversationWith,e.unreadMessageCount))}),n(t)}else n([]);s.fetchingInProgress=!1},function(e){s.fetchingInProgress=!1,t(new r.CometChatException(e.error))})}}catch(e){s.fetchingInProgress=!1,t(new r.CometChatException(e))}})},e.prototype.getNextData=function(){var e={};if(e.per_page=this.limit,s.isFalsy(this.conversationType)||(e.conversationType=this.conversationType),1==this.current_page)e.page=this.next_page,this.next_page++,this.current_page++;else{if(this.next_page>this.total_pages)return e.page=this.next_page,e;e.page=this.next_page++}return e},e}();t.ConversationsRequest=E;var c=function(){function e(){}return e.prototype.setLimit=function(e){return this.limit=e,this},e.prototype.setConversationType=function(e){return this.conversationType=e,this},e.prototype.build=function(){return new E(this)},e}();t.ConversationsRequestBuilder=c},function(e,t,n){"use strict";var d=this&&this.__awaiter||function(r,i,a,E){return new(a||(a=Promise))(function(e,t){function n(e){try{o(E.next(e))}catch(e){t(e)}}function s(e){try{o(E.throw(e))}catch(e){t(e)}}function o(t){t.done?e(t.value):new a(function(e){e(t.value)}).then(n,s)}o((E=E.apply(r,i||[])).next())})},g=this&&this.__generator||function(n,s){var o,r,i,e,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return e={next:t(0),throw:t(1),return:t(2)},"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return function(t){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,r&&(i=2&t[0]?r.return:t[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,t[1])).done)return i;switch(r=0,i&&(t=[2&t[0],i.value]),t[0]){case 0:case 1:i=t;break;case 4:return a.label++,{value:t[1],done:!1};case 5:a.label++,r=t[1],t=[0];continue;case 7:t=a.ops.pop(),a.trys.pop();continue;default:if(!(i=0<(i=a.trys).length&&i[i.length-1])&&(6===t[0]||2===t[0])){a=0;continue}if(3===t[0]&&(!i||t[1]>i[0]&&t[1]<i[3])){a.label=t[1];break}if(6===t[0]&&a.label<i[1]){a.label=i[1],i=t;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(t);break}i[2]&&a.ops.pop(),a.trys.pop();continue}t=s.call(n,a)}catch(e){t=[6,e],r=0}finally{o=i=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([t,e])}}};t.__esModule=!0;var _=n(2),h=n(6),A=n(9),R=n(0),o=n(53),I=n(1),i=n(13),f=n(3),O=n(35),N=n(36),s=function(){function e(e){this.limit=I.DEFAULT_VALUES.MSGS_LIMIT,this.timestamp=0,this.id=I.DEFAULT_VALUES.DEFAULT_MSG_ID,this.messageStore=o.MessagesStore.getInstance(),this.endpointName="getUserMessages",this.listId="",this.totalPages=0,this.unread=!1,this.inProgress=!1,this.hideMessagesFromBlockedUsers=!1,this.updatedAt=0,this.onlyUpdates=0,this.paginationMeta={},this.limit=e.limit,this.paginationMeta[I.MessageConstatnts.PAGINATION.KEYS.PER_PAGE]=this.limit,this.uid=e.uid,this.guid=e.guid,this.parentMessageId=e.parentMessageId,this.timestamp=e.timestamp,this.timestamp&&(this.paginationMeta[I.MessageConstatnts.PAGINATION.KEYS.SENT_AT]=this.timestamp),this.id=e.id,this.id!=I.DEFAULT_VALUES.DEFAULT_MSG_ID&&(this.paginationMeta[I.MessageConstatnts.PAGINATION.KEYS.ID]=this.id),this.hideMessagesFromBlockedUsers=e.HideMessagesFromBlockedUsers,this.hideMessagesFromBlockedUsers&&(this.paginationMeta[I.MessageConstatnts.PAGINATION.KEYS.HIDE_MESSAGES_FROM_BLOCKED_USER]=this.hideMessagesFromBlockedUsers),this.unread=e.unread,this.unread&&(this.paginationMeta[I.MessageConstatnts.PAGINATION.KEYS.UNREAD]=this.unread),e.searchKey&&(this.searchKey=e.searchKey,this.paginationMeta[I.MessageConstatnts.PAGINATION.KEYS.SEARCH_KEY]=this.searchKey),e.onlyUpdate&&(this.onlyUpdates=e.onlyUpdate,this.paginationMeta[I.MessageConstatnts.PAGINATION.KEYS.ONLY_UPDATES]=this.onlyUpdates),e.updatedAt&&(this.updatedAt=e.updatedAt,this.paginationMeta[I.MessageConstatnts.PAGINATION.KEYS.UPDATED_AT]=this.updatedAt),e.category&&(this.category=e.category),e.categories&&(this.categories=e.categories),e.type&&(this.type=e.type),e.types&&(this.types=e.types),e.HideReplies&&(this.hideReplies=e.HideReplies,this.paginationMeta[I.MessageConstatnts.PAGINATION.KEYS.HIDE_REPLIES]=this.hideReplies)}return e.prototype.fetchNext=function(){var e=this;return new Promise(function(o,r){return d(e,void 0,void 0,function(){var t,n,s;return g(this,function(e){switch(e.label){case 0:if(e.trys.push([0,5,,6]),this.inProgress)return this.inProgress=!1,r(new _.CometChatException(i.MESSAGES_REQUEST_ERRORS.REQUEST_IN_PROGRESS_ERROR)),[2];if(this.inProgress=!0,this.onlyUpdates){if(0==this.updatedAt)return this.inProgress=!1,r(new _.CometChatException(i.MESSAGES_REQUEST_ERRORS.NOT_ENOUGH_PARAMS)),[2]}else if(0==this.timestamp&&0==this.id&&0==this.updatedAt)return this.inProgress=!1,r(new _.CometChatException(i.MESSAGES_REQUEST_ERRORS.NOT_ENOUGH_PARAMS)),[2];this.affix=I.MessageConstatnts.PAGINATION.AFFIX.APPEND,this.paginationMeta[I.MessageConstatnts.PAGINATION.KEYS.AFFIX]=this.affix,this.currentMethod=I.MessageConstatnts.PAGINATION.AFFIX.APPEND,e.label=1;case 1:return e.trys.push([1,3,,4]),[4,this.makeAPICall()];case 2:return t=e.sent(),o(t),this.inProgress=!1,[3,4];case 3:return n=e.sent(),this.inProgress=!1,r(new _.CometChatException(n)),[3,4];case 4:return[3,6];case 5:return s=e.sent(),this.inProgress=!1,r(new _.CometChatException(s)),[3,6];case 6:return[2]}})})})},e.prototype.fetchPrevious=function(){var e=this;return new Promise(function(o,r){return d(e,void 0,void 0,function(){var t,n,s;return g(this,function(e){switch(e.label){case 0:if(e.trys.push([0,5,,6]),this.inProgress)return r(new _.CometChatException(i.MESSAGES_REQUEST_ERRORS.REQUEST_IN_PROGRESS_ERROR)),this.inProgress=!1,[2];if(this.inProgress=!0,this.onlyUpdates&&0==this.updatedAt)return this.inProgress=!1,r(new _.CometChatException(i.MESSAGES_REQUEST_ERRORS.NOT_ENOUGH_PARAMS)),[2];this.affix=I.MessageConstatnts.PAGINATION.AFFIX.PREPEND,this.paginationMeta[I.MessageConstatnts.PAGINATION.KEYS.AFFIX]=this.affix,this.currentMethod=I.MessageConstatnts.PAGINATION.AFFIX.PREPEND,e.label=1;case 1:return e.trys.push([1,3,,4]),[4,this.makeAPICall()];case 2:return t=e.sent(),o(t),this.inProgress=!1,[3,4];case 3:return n=e.sent(),this.inProgress=!1,r(new _.CometChatException(n)),[3,4];case 4:return[3,6];case 5:return s=e.sent(),this.inProgress=!1,r(new _.CometChatException(s)),[3,6];case 6:return[2]}})})})},e.prototype.makeAPICall=function(){var T=this;return new Promise(function(E,t){try{var e=T.uid;if(void 0!==e){if(typeof e!==I.COMMON_UTILITY_CONSTANTS.TYPE_CONSTANTS.STRING)return void t(new _.CometChatException(JSON.parse(R.format(JSON.stringify(I.GENERAL_ERROR.PARAMETER_MUST_BE_A_STRING),"UID","UID","setUID()"))));if(R.isFalsy(e.trim()))return void t(new _.CometChatException(JSON.parse(R.format(JSON.stringify(I.GENERAL_ERROR.INVALID),"UID","UID","UID","UID"))));T.uid=e.trim()}var n=T.guid;if(void 0!==n){if(typeof n!==I.COMMON_UTILITY_CONSTANTS.TYPE_CONSTANTS.STRING)return void t(new _.CometChatException(JSON.parse(R.format(JSON.stringify(I.GENERAL_ERROR.PARAMETER_MUST_BE_A_STRING),"GUID","GUID","setGUID()"))));if(R.isFalsy(n.trim()))return void t(new _.CometChatException(JSON.parse(R.format(JSON.stringify(I.GENERAL_ERROR.INVALID),"GUID","GUID","GUID","GUID"))));T.guid=n.trim()}var s=T.parentMessageId;if(void 0!==s){if(isNaN(s))return void t(new _.CometChatException(JSON.parse(R.format(JSON.stringify(I.GENERAL_ERROR.PARAMETER_MUST_BE_A_NUMBER),"PARENT_MESSAGE_ID","PARENT_MESSAGE_ID","setParentMessageId()"))));if(s<I.DEFAULT_VALUES.ZERO)return void t(new _.CometChatException(JSON.parse(R.format(JSON.stringify(I.GENERAL_ERROR.PARAMETER_MUST_BE_A_POSITIVE_NUMBER),"PARENT_MESSAGE_ID","PARENT_MESSAGE_ID","setParentMessageId()"))))}var o=T.paginationMeta[I.MessageConstatnts.PAGINATION.KEYS.PER_PAGE];if(void 0===o)return void t(new _.CometChatException(JSON.parse(R.format(JSON.stringify(I.GENERAL_ERROR.METHOD_COMPULSORY),"SET_LIMIT","SET_LIMIT","Set Limit"))));if(isNaN(o))return void t(new _.CometChatException(JSON.parse(R.format(JSON.stringify(I.GENERAL_ERROR.PARAMETER_MUST_BE_A_NUMBER),"SET_LIMIT","SET_LIMIT","setLimit()"))));if(o>I.DEFAULT_VALUES.MSGS_MAX_LIMIT)return void t(new _.CometChatException(JSON.parse(R.format(JSON.stringify(I.GENERAL_ERROR.LIMIT_EXCEEDED),"SET_LIMIT","SET_LIMIT",I.DEFAULT_VALUES.MSGS_MAX_LIMIT))));if(o<I.DEFAULT_VALUES.ZERO)return void t(new _.CometChatException(JSON.parse(R.format(JSON.stringify(I.GENERAL_ERROR.PARAMETER_MUST_BE_A_POSITIVE_NUMBER),"SET_LIMIT","SET_LIMIT","setLimit()"))));var r=T.paginationMeta[I.MessageConstatnts.PAGINATION.KEYS.SEARCH_KEY];if(void 0!==r){if(typeof r!==I.COMMON_UTILITY_CONSTANTS.TYPE_CONSTANTS.STRING)return void t(new _.CometChatException(JSON.parse(R.format(JSON.stringify(I.GENERAL_ERROR.PARAMETER_MUST_BE_A_STRING),"SET_SEARCH_KEYWORD","SET_SEARCH_KEYWORD","setSearchKeyword()"))));if(R.isFalsy(r.trim()))return void t(new _.CometChatException(JSON.parse(R.format(JSON.stringify(I.GENERAL_ERROR.INVALID),"SET_SEARCH_KEYWORD","SET_SEARCH_KEYWORD","search keyword","search keyword"))));T.paginationMeta[I.MessageConstatnts.PAGINATION.KEYS.SEARCH_KEY]=r.trim()}var i=T.paginationMeta[I.MessageConstatnts.PAGINATION.KEYS.ID];if(void 0!==i){if(isNaN(i))return void t(new _.CometChatException(JSON.parse(R.format(JSON.stringify(I.GENERAL_ERROR.PARAMETER_MUST_BE_A_NUMBER),"MESSAGE_ID","MESSAGE_ID","setMessageId()"))));if(i<I.DEFAULT_VALUES.ZERO)return void t(new _.CometChatException(JSON.parse(R.format(JSON.stringify(I.GENERAL_ERROR.PARAMETER_MUST_BE_A_POSITIVE_NUMBER),"MESSAGE_ID","MESSAGE_ID","setMessageId()"))))}var a=T.paginationMeta[I.MessageConstatnts.PAGINATION.KEYS.SENT_AT];if(void 0!==a){if(isNaN(a))return void t(new _.CometChatException(JSON.parse(R.format(JSON.stringify(I.GENERAL_ERROR.PARAMETER_MUST_BE_A_NUMBER),"TIMESTAMP","TIMESTAMP","setTimestamp()"))));if(a<I.DEFAULT_VALUES.ZERO)return void t(new _.CometChatException(JSON.parse(R.format(JSON.stringify(I.GENERAL_ERROR.PARAMETER_MUST_BE_A_POSITIVE_NUMBER),"TIMESTAMP","TIMESTAMP","setTimestamp()"))))}var c=T.paginationMeta[I.MessageConstatnts.PAGINATION.KEYS.HIDE_MESSAGES_FROM_BLOCKED_USER];if(void 0!==c){if(typeof c!==I.COMMON_UTILITY_CONSTANTS.TYPE_CONSTANTS.BOOLEAN)return void t(new _.CometChatException(JSON.parse(R.format(JSON.stringify(I.GENERAL_ERROR.PARAMETER_MUST_BE_A_BOOLEAN),"HIDE_MESSAGES_FROM_BLOCKED_USERS","HIDE_MESSAGES_FROM_BLOCKED_USERS","hideMessagesFromBlockedUsers()"))));T.paginationMeta[I.MessageConstatnts.PAGINATION.KEYS.HIDE_MESSAGES_FROM_BLOCKED_USER]=1==c?1:0}var u=T.paginationMeta[I.MessageConstatnts.PAGINATION.KEYS.UNREAD];if(void 0!==u){if(typeof u!==I.COMMON_UTILITY_CONSTANTS.TYPE_CONSTANTS.BOOLEAN)return void t(new _.CometChatException(JSON.parse(R.format(JSON.stringify(I.GENERAL_ERROR.PARAMETER_MUST_BE_A_BOOLEAN),"UNREAD","UNREAD","setUnread()"))));T.paginationMeta[I.MessageConstatnts.PAGINATION.KEYS.UNREAD]=1==u?1:0}var p=T.category;if(void 0!==p){if(typeof p!==I.COMMON_UTILITY_CONSTANTS.TYPE_CONSTANTS.STRING)return void t(new _.CometChatException(JSON.parse(R.format(JSON.stringify(I.GENERAL_ERROR.PARAMETER_MUST_BE_A_STRING),"SET_CATEGORY","SET_CATEGORY","setCategory()"))));if(R.isFalsy(p.trim()))return void t(new _.CometChatException(JSON.parse(R.format(JSON.stringify(I.GENERAL_ERROR.INVALID),"SET_CATEGORY","SET_CATEGORY","category","category"))));T.paginationMeta[I.MessageConstatnts.PAGINATION.KEYS.CATEGORIES]=p.trim()}var S=T.categories;if(void 0!==S){if(!Array.isArray(S))return void t(new _.CometChatException(JSON.parse(R.format(JSON.stringify(I.GENERAL_ERROR.PARAMETER_MUST_BE_AN_ARRAY),"SET_CATEGORIES","SET_CATEGORIES","setCategories()"))));0<S.length&&(T.paginationMeta[I.MessageConstatnts.PAGINATION.KEYS.CATEGORIES]=S)}var C=T.type;if(void 0!==C){if(typeof C!==I.COMMON_UTILITY_CONSTANTS.TYPE_CONSTANTS.STRING)return void t(new _.CometChatException(JSON.parse(R.format(JSON.stringify(I.GENERAL_ERROR.PARAMETER_MUST_BE_A_STRING),"SET_TYPE","SET_TYPE","setType()"))));if(R.isFalsy(C.trim()))return void t(new _.CometChatException(JSON.parse(R.format(JSON.stringify(I.GENERAL_ERROR.INVALID),"SET_TYPE","SET_TYPE","type","type"))));T.paginationMeta[I.MessageConstatnts.PAGINATION.KEYS.TYPES]=C.trim()}var l=T.types;if(void 0!==l){if(!Array.isArray(l))return void t(new _.CometChatException(JSON.parse(R.format(JSON.stringify(I.GENERAL_ERROR.PARAMETER_MUST_BE_AN_ARRAY),"SET_TYPES","SET_TYPES","setTypes()"))));0<l.length&&(T.paginationMeta[I.MessageConstatnts.PAGINATION.KEYS.TYPES]=l)}if(T.createEndpoint(),T.totalPages)if(1!=T.totalPages);else if(T.lastAffix==T.affix)return void E([]);h.makeApiCall(T.endpointName,{listId:T.listId},T.paginationMeta).then(function(a){return d(T,void 0,void 0,function(){var s,t,o,n,r,i=this;return g(this,function(e){switch(e.label){case 0:return s=[],a[I.ResponseConstants.RESPONSE_KEYS.KEY_META][I.ResponseConstants.RESPONSE_KEYS.KEY_CURSOR].hasOwnProperty(I.MessageConstatnts.PAGINATION.KEYS.ID)&&0==this.id&&(this.id=parseInt(a.meta.cursor[I.MessageConstatnts.PAGINATION.KEYS.ID])),a[I.ResponseConstants.RESPONSE_KEYS.KEY_META][I.ResponseConstants.RESPONSE_KEYS.KEY_CURSOR].hasOwnProperty(I.MessageConstatnts.PAGINATION.KEYS.SENT_AT)&&0==this.timestamp&&(this.timestamp=a.meta.cursor[I.MessageConstatnts.PAGINATION.KEYS.SENT_AT]),a.meta.pagination.hasOwnProperty("total_pages")&&(this.totalPages=a.meta.pagination.total_pages),a.meta.cursor.hasOwnProperty("affix")&&(this.lastAffix=a.meta.cursor.affix),a.data[0]?(0<this.id&&(this.id=parseInt(a.data[0].id)),0<this.timestamp&&(this.timestamp=a.data[0].sentAt),t=a.data[a.data.length-1],[4,f.CometChat.getLoggedinUser()]):[3,2];case 1:return o=e.sent(),f.CometChat.didMessagesPollingStart()||f.CometChat.getConnectionStatus()!=I.CONNECTION_STATUS.CONNECTED||void 0===this.guid&&void 0===this.uid&&void 0===this.parentMessageId||void 0===t||(n=t.receiverType,r=f.CometChat.getMode(),(R.isFalsy(r)||r&&r===I.APP_SETTINGS.KEYS.DEFAULT_MODE)&&o&&t.sender.toLowerCase()!=o.getUid().toLowerCase()&&(n==I.MessageConstatnts.RECEIVER_TYPE.USER?N.WSConnectionHelper.getInstance().markAsDelivered(t.sender,t.receiverType,t.id,t.sender):N.WSConnectionHelper.getInstance().markAsDelivered(t.receiverId,t.receiverType,t.id,t.sender))),a.data.map(function(t){if(!f.CometChat.didMessagesPollingStart()&&f.CometChat.getConnectionStatus()==I.CONNECTION_STATUS.CONNECTED&&void 0===i.guid&&void 0===i.uid&&void 0===i.parentMessageId&&void 0!==t){var e=t.receiverType,n=f.CometChat.getMode();(R.isFalsy(n)||n&&n===I.APP_SETTINGS.KEYS.DEFAULT_MODE)&&o&&t.sender.toLowerCase()!=o.getUid().toLowerCase()&&(e==I.MessageConstatnts.RECEIVER_TYPE.USER?N.WSConnectionHelper.getInstance().markAsDelivered(t.sender,t.receiverType,t.id,t.sender):N.WSConnectionHelper.getInstance().markAsDelivered(t.receiverId,t.receiverType,t.id,t.sender))}O.MessageListnerMaping.getInstance().get(I.LOCAL_STORE.KEY_MESSAGE_LISTENER_LIST).then(function(e){parseInt(t.id)>e&&O.MessageListnerMaping.getInstance().set(I.LOCAL_STORE.KEY_MESSAGE_LISTENER_LIST,parseInt(t.id))},function(e){O.MessageListnerMaping.getInstance().set(I.LOCAL_STORE.KEY_MESSAGE_LISTENER_LIST,parseInt(t.id))}),i.affix==I.MessageConstatnts.PAGINATION.AFFIX.APPEND?(i.id<parseInt(t.id)&&0<i.id&&(i.id=parseInt(t.id)),i.timestamp<t.sentAt&&0<i.timestamp&&(i.timestamp=t.sentAt),i.updatedAt<t.updatedAt&&0<i.updatedAt&&(i.updatedAt=t.updatedAt)):(i.id>parseInt(t.id)&&(i.id=parseInt(t.id)),i.timestamp>t.sentAt&&(i.timestamp=t.sentAt),i.updatedAt>t.updatedAt&&(i.updatedAt=t.updatedAt)),i.id&&(i.paginationMeta[I.MessageConstatnts.PAGINATION.KEYS.ID]=i.id),i.timestamp&&(i.paginationMeta[I.MessageConstatnts.PAGINATION.KEYS.SENT_AT]=i.timestamp),i.updatedAt&&(i.paginationMeta[I.MessageConstatnts.PAGINATION.KEYS.UPDATED_AT]=i.updatedAt),s.push(A.MessageController.trasformJSONMessge(t))}),[3,3];case 2:s=[],e.label=3;case 3:return E(s),[2]}})})},function(e){t(new _.CometChatException(e.error))})}catch(e){t(new _.CometChatException(e))}})},e.prototype.createEndpoint=function(){this.parentMessageId?(this.endpointName="getThreadMessages",this.listId=this.parentMessageId.toString(),this.hideReplies&&(this.hideReplies=!1,delete this.paginationMeta[I.MessageConstatnts.PAGINATION.KEYS.HIDE_REPLIES])):(R.isFalsy(this.guid)||R.isFalsy(this.uid))&&R.isFalsy(this.guid)?(R.isFalsy(this.uid)?this.endpointName="getMessages":this.endpointName="getUserMessages",this.listId=this.uid):(this.endpointName="getGroupMessages",this.listId=this.guid)},e.prototype.makeData=function(){var e={};e[I.MessageConstatnts.PAGINATION.KEYS.PER_PAGE]=this.limit,e[I.MessageConstatnts.PAGINATION.KEYS.AFFIX]=this.affix,(R.isFalsy(this.guid)||R.isFalsy(this.uid))&&R.isFalsy(this.guid)&&R.isFalsy(this.uid)},e.prototype.getFilteredPreviousDataByReceiverId=function(t){return d(this,void 0,void 0,function(){var n,s=this;return g(this,function(e){switch(e.label){case 0:switch(n=[],t){case"user":return[3,1];case"group":return[3,3];case"both":return[3,5]}return[3,7];case 1:return[4,o.MessagesStore.getInstance().get(this.uid).then(function(t){Object.keys(t).filter(function(e){return parseInt(e)>s.id}).map(function(e){n=n.concat([t[e]])})})];case 2:return e.sent(),[3,9];case 3:return[4,o.MessagesStore.getInstance().get(this.guid).then(function(t){Object.keys(t).filter(function(e){return parseInt(e)>s.id}).map(function(e){n=n.concat([t[e]])})})];case 4:e.sent(),e.label=5;case 5:return[4,o.MessagesStore.getInstance().get(this.guid).then(function(t){Object.keys(t).filter(function(e){return parseInt(e)>s.id}).filter(function(e){return t[e].sender.uid==s.uid}).map(function(e){n=n.concat([t[e]])})})];case 6:return e.sent(),[3,9];case 7:return[4,o.MessagesStore.getInstance().getAllMessages().then(function(t){Object.keys(t).filter(function(e){return parseInt(e)>s.id}).map(function(e){n=n.concat([t[e]])})})];case 8:return e.sent(),[3,9];case 9:return[2,n]}})})},e.prototype.getFilteredNextDataByReceiverId=function(t){return d(this,void 0,void 0,function(){var n,s=this;return g(this,function(e){switch(e.label){case 0:switch(n=[],t){case"user":return[3,1];case"group":return[3,3];case"both":return[3,5]}return[3,7];case 1:return[4,o.MessagesStore.getInstance().get(this.uid).then(function(t){Object.keys(t).filter(function(e){return parseInt(e)>s.id}).map(function(e){n=n.concat([t[e]])})})];case 2:return e.sent(),[3,9];case 3:return[4,o.MessagesStore.getInstance().get(this.guid).then(function(t){Object.keys(t).filter(function(e){return parseInt(e)>s.id}).map(function(e){n=n.concat([t[e]])})})];case 4:e.sent(),e.label=5;case 5:return[4,o.MessagesStore.getInstance().get(this.guid).then(function(t){Object.keys(t).filter(function(e){return parseInt(e)>s.id}).filter(function(e){return t[e].sender.uid==s.uid}).map(function(e){n=n.concat([t[e]])})})];case 6:return e.sent(),[3,9];case 7:return[4,o.MessagesStore.getInstance().getAllMessages().then(function(t){Object.keys(t).filter(function(e){return parseInt(e)>s.id}).map(function(e){n=n.concat([t[e]])})})];case 8:return e.sent(),[3,9];case 9:return[2,n]}})})},e}();t.DefaultMessagesRequest=s;var r=function(){function e(){this.maxLimit=I.DEFAULT_VALUES.MSGS_MAX_LIMIT,this.timestamp=0,this.id=I.DEFAULT_VALUES.DEFAULT_MSG_ID,this.unread=!1,this.HideMessagesFromBlockedUsers=!1,this.onlyUpdate=0}return e.prototype.setLimit=function(e){return this.limit=e,this},e.prototype.setGUID=function(e){return this.guid=e,this},e.prototype.setUID=function(e){return this.uid=e,this},e.prototype.setParentMessageId=function(e){return this.parentMessageId=e,this},e.prototype.setTimestamp=function(e){return void 0===e&&(e=R.getCurrentTime()),this.timestamp=e,this},e.prototype.setMessageId=function(e){return void 0===e&&(e=I.DEFAULT_VALUES.DEFAULT_MSG_ID),this.id=e,this},e.prototype.setUnread=function(e){return void 0===e&&(e=!1),this.unread=e,this},e.prototype.hideMessagesFromBlockedUsers=function(e){return void 0===e&&(e=!1),this.HideMessagesFromBlockedUsers=e,this},e.prototype.setSearchKeyword=function(e){return this.searchKey=e,this},e.prototype.setUpdatedAfter=function(e){return this.updatedAt=e,this},e.prototype.updatesOnly=function(e){return e&&(this.onlyUpdate=1),this},e.prototype.setCategory=function(e){return this.category=e,this},e.prototype.setCategories=function(e){return this.categories=e,this},e.prototype.setType=function(e){return this.type=e,this},e.prototype.setTypes=function(e){return this.types=e,this},e.prototype.hideReplies=function(e){return this.HideReplies=e,this},e.prototype.build=function(){return this.category&&this.categories&&this.categories.push(this.category),this.type&&this.types&&this.types.push(this.type),new s(this)},e}();t.DefaultMessagesRequestBuilder=r},function(e,t,n){"use strict";var a=this&&this.__assign||function(){return(a=Object.assign||function(e){for(var t,n=1,s=arguments.length;n<s;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};t.__esModule=!0;var s=n(3),E=n(0),c=n(1),r=n(2),o=n(12),i=function(){function e(e){this.store=c.constants.DEFAULT_STORE,E.isFalsy(e)||(this.store=e);try{this.messagesStore=o.default}catch(e){E.Logger.error("MessageStore: constructor",{e:e})}}return e.getInstance=function(){return null==e.MessagesStore&&(e.MessagesStore=new e),e.MessagesStore},e.prototype.set=function(e,t){var n=E.getKeyprefix(c.LOCAL_STORE.MESSAGES_STORE,e);return this.messagesStore.setItem(n,JSON.stringify(t))},e.prototype.get=function(e){var s=this,o=E.getKeyprefix(c.LOCAL_STORE.MESSAGES_STORE,e);return new Promise(function(n,t){try{s.messagesStore.getItem(o).then(function(t){try{n(JSON.parse(t))}catch(e){n(t)}},function(e){t(e)})}catch(e){t(new r.CometChatException(e))}})},e.prototype.getAllMessages=function(){var n=this,s={};return new Promise(function(e,t){n.messagesStore.iterate(function(e,t,n){t!=c.constants.MSG_VER_POST&&t!=c.constants.MSG_VER_POST&&(s=a({},s,e))}).then(function(){e(s)})})},e.prototype.clear=function(e){},e.prototype.selectStore=function(e){this.store=e},e.prototype.storeMessages=function(e){var n=this;if(s.CometChat.user.getUid()){var o=s.CometChat.user.getUid(),r={},i=0;return this.get(c.constants.MSG_VER_POST).then(function(s){e.map(function(e){var t;if(!E.isFalsy(e)){0==i&&(i=parseInt(e.getId().toString())),i>e.getId()&&(i=parseInt(e.getId().toString())),s<e.getId()&&(s=parseInt(e.getId().toString()));var n=void 0;n=e.getSender()instanceof Object?e.getSender().getUid():e.getSender(),e.getReceiverType()==c.MessageConstatnts.RECEIVER_TYPE.GROUP&&(n=e.getReceiver()),e.getSender()instanceof Object?e.getSender().getUid()==o&&(n=e.getReceiver()):e.getSender()==o&&(n=e.getReceiver()),r[n]||(r[n]={}),r[n]=a({},r[n],((t={})[e.getId()]=e,t))}}),n.get(c.constants.MSG_VER_PRE).then(function(e){(0<i&&i<e||null==e)&&n.set(c.constants.MSG_VER_PRE,i)})&&0<s&&n.set(c.constants.MSG_VER_POST,s),Object.keys(r).map(function(t){n.get(t).then(function(e){null==e&&(e={}),n.set(t,a({},r[t],e))})})}),!0}},e}();t.MessagesStore=i},function(e,t,n){"use strict";var s,o=this&&this.__extends||(s=function(e,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}s(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});t.__esModule=!0;var p=n(5),r=function(i){function u(e,t,n,s,o){var r=i.call(this,e,t,n,s,o)||this;return r.setType(p.AUTH.TYPE),r}return o(u,i),u.prototype.getStatus=function(){return this.status},u.prototype.setStatus=function(e){this.status=e},u.prototype.getCode=function(){return this.code},u.prototype.setCode=function(e){this.code=e},u.prototype.setAuth=function(e){this.auth=e},u.prototype.getAuth=function(){return this.auth},u.prototype.setPresenceSubscription=function(e){this.presenceSubscription=e},u.prototype.getPresenceSubscription=function(){return this.presenceSubscription},u.prototype.setDeviceId=function(e){this.deviceId=e},u.prototype.getdeviceId=function(){return this.deviceId},u.prototype.getAsString=function(){return JSON.stringify(this.getAsJSONObject())},u.prototype.getAsJSONObject=function(){var e=this.getCometChatEventJSON(),t={};return t[p.KEYS.AUTH]=this.auth,t[p.KEYS.DEVICE_ID]=this.deviceId,t[p.KEYS.PRESENCE_SUBSCRIPTION]=this.presenceSubscription,e[p.KEYS.BODY]=t,e},u.getAuthEventFromJSON=function(e){var t=e[p.KEYS.APP_ID],n=e[p.KEYS.RECEIVER],s=e[p.KEYS.RECEIVER_TYPE],o=e[p.KEYS.DEVICE_ID],r=e[p.KEYS.SENDER],i=e[p.KEYS.BODY],a=i[p.KEYS.STATUS],E=i[p.KEYS.CODE],c=new u(t,n,s,r,o);return c.setStatus(a),c.setCode(E),c},u}(n(11).CometChatEvent);t.CometChatAuthEvent=r},function(e,t,n){"use strict";var s,o=this&&this.__extends||(s=function(e,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}s(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});t.__esModule=!0;var u=n(9),p=n(5),r=function(i){function c(e,t,n,s,o){var r=i.call(this,e,t,n,s,o)||this;return r.setType(p.MESSAGE.TYPE),r}return o(c,i),c.prototype.getMessage=function(){return this.message},c.prototype.setMessage=function(e){this.message=e},c.getMessageEventFromJSON=function(e){var t=e[p.KEYS.APP_ID],n=e[p.KEYS.RECEIVER],s=e[p.KEYS.RECEIVER_TYPE],o=e[p.KEYS.DEVICE_ID],r=e[p.KEYS.SENDER],i=e[p.KEYS.BODY],a=new c(t,n,s,r,o),E=u.MessageController.trasformJSONMessge(i);return a.setMessage(E),a},c}(n(11).CometChatEvent);t.CometChatMessageEvent=r},function(e,t,n){"use strict";var s,o=this&&this.__extends||(s=function(e,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}s(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});t.__esModule=!0;var i=n(5),r=function(r){function e(e,t,n,s,o){return r.call(this,e,t,n,s,o)||this}return o(e,r),e.prototype.getAsString=function(){return JSON.stringify(this.getAsJSONObject())},e.prototype.getAsJSONObject=function(){var e={};return e[i.KEYS.ACTION]=i.KEYS.PING,e},e}(n(11).CometChatEvent);t.CometChatPingEvent=r},function(e,t,n){"use strict";var s,o=this&&this.__extends||(s=function(e,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}s(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});t.__esModule=!0;var u=n(5),r=n(11),p=n(4),i=function(i){function c(e,t,n,s,o){var r=i.call(this,e,t,n,s,o)||this;return r.setType(u.PRESENCE.TYPE),r}return o(c,i),c.prototype.getAction=function(){return this.action},c.prototype.setAction=function(e){this.action=e},c.prototype.getUser=function(){return this.user},c.prototype.setUser=function(e){this.user=e},c.prototype.getTimestamp=function(){return this.timestamp},c.prototype.setTimestamp=function(e){this.timestamp=e},c.getPresenceEventFromJSON=function(e){var t=e[u.KEYS.APP_ID],n=e[u.KEYS.DEVICE_ID],s=e[u.KEYS.SENDER],o=e[u.KEYS.BODY],r=o[u.KEYS.ACTION],i=o[u.KEYS.USER],a=o[u.KEYS.TIMESTAMP],E=new c(t,"","",s,n);return E.setAction(r),E.setUser(new p.User(i)),E.setTimestamp(a),E},c}(r.CometChatEvent);t.CometChatPresenceEvent=i},function(e,t,n){"use strict";var s,o=this&&this.__extends||(s=function(e,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}s(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});t.__esModule=!0;var l=n(5),r=n(11),T=n(22),d=n(4),i=function(a){function C(e,t,n,s,o,r){var i=a.call(this,e,t,n,s,o,r)||this;return i.setType(l.RECEIPTS.TYPE),i}return o(C,a),C.prototype.getAction=function(){return this.action},C.prototype.setAction=function(e){this.action=e},C.prototype.getMessageReceipt=function(){return this.receipt},C.prototype.setMessageReceipt=function(e){this.receipt=e},C.prototype.getAsString=function(){return JSON.stringify(this.getAsJSONObject())},C.prototype.getAsJSONObject=function(){var e=this.getCometChatEventJSON(),t={};return t[l.KEYS.ACTION]=this.action,t[l.KEYS.MESSAGE_ID]=this.receipt.getMessageId(),t[l.KEYS.USER]=this.receipt.getSender(),e[l.KEYS.BODY]=t,e},C.getReceiptEventFromJSON=function(e){var t=e[l.KEYS.APP_ID],n=e[l.KEYS.RECEIVER],s=e[l.KEYS.RECEIVER_TYPE],o=e[l.KEYS.DEVICE_ID],r=e[l.KEYS.SENDER],i=e[l.KEYS.BODY],a=i[l.KEYS.ACTION],E=i[l.KEYS.USER],c=i[l.KEYS.MESSAGE_ID],u=i[l.KEYS.TIMESTAMP],p=new C(t,n,s,r,o);p.setAction(a);var S=new T.MessageReceipt;return S.setSender(new d.User(E)),S.setReceiverType(s),S.setReceiver(n),a===l.RECEIPTS.ACTION.DELIVERED&&(S.setReceiptType(l.RECEIPTS.RECEIPT_TYPE.DELIVERY_RECEIPT),S.setDeliveredAt(u)),a===l.RECEIPTS.ACTION.READ&&(S.setReceiptType(l.RECEIPTS.RECEIPT_TYPE.READ_RECEIPT),S.setReadAt(u)),S.setMessageId(c),S.setTimestamp(u),p.setMessageReceipt(S),p},C}(r.CometChatEvent);t.CometChatReceiptEvent=i},function(e,t,n){"use strict";var s,o=this&&this.__extends||(s=function(e,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}s(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});t.__esModule=!0;var C=n(5),r=n(11),l=n(26),T=n(4),i=function(i){function S(e,t,n,s,o){var r=i.call(this,e,t,n,s,o)||this;return r.setType(C.TYPING_INDICATOR.TYPE),r}return o(S,i),S.prototype.getAction=function(){return this.action},S.prototype.setAction=function(e){this.action=e},S.prototype.getTypingIndicator=function(){return this.typingIndicator},S.prototype.setTypingIndicator=function(e){this.typingIndicator=e},S.prototype.getAsString=function(){return JSON.stringify(this.getAsJSONObject())},S.prototype.getAsJSONObject=function(){var e=this.getCometChatEventJSON(),t={};return t[C.KEYS.ACTION]=this.action,t[C.KEYS.USER]=this.typingIndicator.getSender(),this.typingIndicator.getMetadata()&&(t[C.KEYS.METADATA]=this.typingIndicator.getMetadata()),e[C.KEYS.BODY]=t,e},S.getTypingEventFromJSON=function(e){var t=e[C.KEYS.APP_ID],n=e[C.KEYS.RECEIVER],s=e[C.KEYS.RECEIVER_TYPE],o=e[C.KEYS.DEVICE_ID],r=e[C.KEYS.SENDER],i=e[C.KEYS.BODY],a=i[C.KEYS.ACTION],E=i[C.KEYS.USER],c=i[C.KEYS.METADATA],u=new S(t,n,s,r,o);u.setAction(a);var p=new l.TypingIndicator(n,s);return p.setSender(new T.User(E)),i.hasOwnProperty(C.KEYS.METADATA)&&i[C.KEYS.METADATA]&&p.setMetadata(c),u.setTypingIndicator(p),u},S}(r.CometChatEvent);t.CometChatTypingEvent=i},function(e,t,n){"use strict";t.__esModule=!0;var s=n(1),o=n(0),r=n(5);t.checkConnection=function(e){return e&&e.readyState===r.READY_STATE.OPEN},t.stringifyMessage=function(e){return JSON.stringify(e)},t.getWSURL=function(){return new Promise(function(n,e){o.getAppSettings().then(function(e){var t=r.WS.protocol+o.getChatHost(e)+":"+e[s.APP_SETTINGS.KEYS.CHAT_WSS_PORT];n(t)},function(e){o.Logger.error("WSHelper :: getWSURL",e)})})}},function(e,t,n){"use strict";t.__esModule=!0;var o=n(6),s=n(0),r=n(10),i=n(2),a=n(1),E=function(){function e(e){this.next_page=1,this.current_page=1,this.total_pages=-1,this.fetchingInProgress=!1,this.pagination={total:0,count:0,per_page:0,current_page:0,total_pages:0,links:[]},s.isFalsy(e)||(this.limit=e.limit,s.isFalsy(e.searchKeyword)||(this.searchKeyword=e.searchKeyword),s.isFalsy(e.direction)||(this.direction=e.direction))}return e.prototype.validateBlockedUsersBuilder=function(){if(void 0===this.limit)return new i.CometChatException(JSON.parse(s.format(JSON.stringify(a.GENERAL_ERROR.METHOD_COMPULSORY),"SET_LIMIT","SET_LIMIT","Set Limit")));if(isNaN(this.limit))return new i.CometChatException(JSON.parse(s.format(JSON.stringify(a.GENERAL_ERROR.PARAMETER_MUST_BE_A_NUMBER),"SET_LIMIT","SET_LIMIT","setLimit()")));if(this.limit>a.DEFAULT_VALUES.USERS_MAX_LIMIT)return new i.CometChatException(JSON.parse(s.format(JSON.stringify(a.GENERAL_ERROR.LIMIT_EXCEEDED),"SET_LIMIT","SET_LIMIT",a.DEFAULT_VALUES.USERS_MAX_LIMIT)));if(this.limit<a.DEFAULT_VALUES.ZERO)return new i.CometChatException(JSON.parse(s.format(JSON.stringify(a.GENERAL_ERROR.PARAMETER_MUST_BE_A_POSITIVE_NUMBER),"SET_LIMIT","SET_LIMIT","setLimit()")));if(void 0!==this.searchKeyword){if(typeof this.searchKeyword!==a.COMMON_UTILITY_CONSTANTS.TYPE_CONSTANTS.STRING)return new i.CometChatException(JSON.parse(s.format(JSON.stringify(a.GENERAL_ERROR.PARAMETER_MUST_BE_A_STRING),"SET_SEARCH_KEYWORD","SET_SEARCH_KEYWORD","setSearchKeyword()")));if(s.isFalsy(this.searchKeyword.trim()))return new i.CometChatException(JSON.parse(s.format(JSON.stringify(a.GENERAL_ERROR.INVALID),"SET_SEARCH_KEYWORD","SET_SEARCH_KEYWORD","search keyword","search keyword")));this.searchKeyword=this.searchKeyword.trim()}if(void 0!==this.direction){if(typeof this.direction!==a.COMMON_UTILITY_CONSTANTS.TYPE_CONSTANTS.STRING)return new i.CometChatException(JSON.parse(s.format(JSON.stringify(a.GENERAL_ERROR.PARAMETER_MUST_BE_A_STRING),"SET_DIRECTION","SET_DIRECTION","setDirection()")));if(this.direction!=a.BlockedUsersConstants.REQUEST_KEYS.DIRECTIONS.BOTH&&this.direction!=a.BlockedUsersConstants.REQUEST_KEYS.DIRECTIONS.BLOCKED_BY_ME&&this.direction!=a.BlockedUsersConstants.REQUEST_KEYS.DIRECTIONS.HAS_BLOCKED_ME)return new i.CometChatException(a.UserErrors.INVALID_DIRECTION)}},e.prototype.fetchPrevious=function(){var s=this;return this.fetchingInProgress=!0,new Promise(function(t,n){try{0==s.next_page&&(t([]),s.fetchingInProgress=!1);var e=s.validateBlockedUsersBuilder();if(e instanceof i.CometChatException)return void n(e);if(!s.fetchingInProgress)return o.makeApiCall("blockedUsersList",{},s.getPreData()).then(function(e){if(e.meta&&(s.total_pages=e.meta.pagination.total_pages),0<e.data.length){s.pagination=e.meta.pagination;var n=[];e.data.map(function(e,t){n.push(r.UsersController.trasformJSONUser(e))}),t(n),s.fetchingInProgress=!1}t([]),s.fetchingInProgress=!1},function(e){n(new i.CometChatException(e.error)),s.fetchingInProgress=!1});t([])}catch(e){s.fetchingInProgress=!1,n(new i.CometChatException(e))}})},e.prototype.fetchNext=function(){var s=this;return new Promise(function(n,t){try{if(s.fetchingInProgress)s.fetchingInProgress=!1,n([]);else{s.fetchingInProgress=!0;var e=s.validateBlockedUsersBuilder();if(e instanceof i.CometChatException)return void t(e);o.makeApiCall("blockedUsersList",{},s.getNextData()).then(function(e){if(e.meta&&(s.total_pages=e.meta.pagination.total_pages),0<e.data.length){s.pagination=e.meta.pagination;var t=[];e.data.map(function(e){t.push(r.UsersController.trasformJSONUser(e))}),n(t)}else n([]);s.fetchingInProgress=!1},function(e){s.fetchingInProgress=!1,t(new i.CometChatException(e.error))})}}catch(e){s.fetchingInProgress=!1,t(new i.CometChatException(e))}})},e.prototype.getNextData=function(){var e={};if(e.per_page=this.limit,s.isFalsy(this.direction)||(e.direction=this.direction),s.isFalsy(this.searchKeyword)||(e.searchKey=this.searchKeyword),1==this.current_page)e.page=this.next_page,this.next_page++,this.current_page++;else{if(this.next_page>this.total_pages)return e.page=this.next_page,e;e.page=this.next_page++}return e},e.prototype.getPreData=function(){var e={};return e.per_page=this.limit,0<=this.next_page&&0<this.next_page&&(e.page=--this.next_page),e},e.MAX_LIMIT=2,e.DEFAULT_LIMIT=1,e.directions=a.BlockedUsersConstants.REQUEST_KEYS.DIRECTIONS,e}();t.BlockedUsersRequest=E;var c=function(){function e(){}return e.prototype.setLimit=function(e){return this.limit=e,this},e.prototype.setSearchKeyword=function(e){return this.searchKeyword=e,this},e.prototype.setDirection=function(e){return this.direction=e,this},e.prototype.blockedByMe=function(){return this.direction=a.BlockedUsersConstants.REQUEST_KEYS.DIRECTIONS.BLOCKED_BY_ME,this},e.prototype.hasBlockedMe=function(){return this.direction=a.BlockedUsersConstants.REQUEST_KEYS.DIRECTIONS.HAS_BLOCKED_ME,this},e.prototype.build=function(){return new E(this)},e}();t.BlockedUsersRequestBuilder=c},function(e,t,n){"use strict";t.__esModule=!0;var s=n(1),o=function(){function t(e){this.subscriptionType=t.SUBSCRIPTION_TYPE_NONE,this.roles=null,this.region=s.DEFAULT_VALUES.REGION_DEFAULT,this.autoJoinGroup=!0,this.subscriptionType=e.subscriptionType,this.roles=e.roles,this.region=e.region,this.autoJoinGroup=e.autoJoinGroup}return t.prototype.getSubscriptionType=function(){return this.subscriptionType},t.prototype.getRoles=function(){return this.roles},t.prototype.getRegion=function(){return this.region},t.prototype.getIsAutoJoinEnabled=function(){return this.autoJoinGroup},t.SUBSCRIPTION_TYPE_NONE="NONE",t.SUBSCRIPTION_TYPE_ALL_USERS="ALL_USERS",t.SUBSCRIPTION_TYPE_ROLES="ROLES",t.SUBSCRIPTION_TYPE_FRIENDS="FRIENDS",t.REGION_EU=s.DEFAULT_VALUES.REGION_DEFAULT_EU,t.REGION_US=s.DEFAULT_VALUES.REGION_DEFAULT_US,t.REGION_IN=s.DEFAULT_VALUES.REGION_DEFAULT_IN,t.REGION_PRIVATE=s.DEFAULT_VALUES.REGION_DEFAULT_PRIVATE,t}();t.AppSettings=o;var r=function(){function e(){this.subscriptionType=o.SUBSCRIPTION_TYPE_NONE,this.roles=null,this.region=s.DEFAULT_VALUES.REGION_DEFAULT,this.autoJoinGroup=!0}return e.prototype.subscribePresenceForAllUsers=function(){return this.subscriptionType=o.SUBSCRIPTION_TYPE_ALL_USERS,this},e.prototype.subscribePresenceForRoles=function(e){return this.subscriptionType=o.SUBSCRIPTION_TYPE_ROLES,this.roles=e,this},e.prototype.subscribePresenceForFriends=function(){return this.subscriptionType=o.SUBSCRIPTION_TYPE_FRIENDS,this},e.prototype.setRegion=function(e){return void 0===e&&(e=s.DEFAULT_VALUES.REGION_DEFAULT),this.region=e.toLowerCase(),this},e.prototype.enableAutoJoinForGroups=function(e){return void 0===e&&(e=!0),this.autoJoinGroup=e,this},e.prototype.build=function(){return new o(this)},e}();t.AppSettingsBuilder=r},function(e,t,n){"use strict";t.__esModule=!0;var p=n(9),S=n(1),C=n(10),l=n(15),T=n(25),s=n(3),o=n(2),r=n(0),i=function(){function e(){}return e.processMessage=function(e){try{return p.MessageController.trasformJSONMessge(e)}catch(e){r.Logger.error("CometChatHelper: processMessage",e)}},e.getConversationFromMessage=function(u){return new Promise(function(E,c){try{s.CometChat.getLoggedinUser().then(function(e){if(null!==e){var t=p.MessageController.trasformJSONMessge(u),n=t.receiverType,s=t.conversationId,o=void 0,r=p.MessageController.trasformJSONMessge(u);if(n==S.MessageConstatnts.RECEIVER_TYPE.USER){var i=C.UsersController.trasformJSONUser(t[S.MessageConstatnts.KEYS.SENDER]);o=i.getUid()==e.getUid()?C.UsersController.trasformJSONUser(t[S.MessageConstatnts.KEYS.RECEIVER]):i}else o=l.GroupsController.trasformJSONGroup(t[S.MessageConstatnts.KEYS.RECEIVER]);var a=T.ConversationController.trasformJSONConversation(s,n,r,o,0);E(a)}else c(S.UserErrors.USER_NOT_LOGGED_IN)},function(e){c(new o.CometChatException(e.error))})}catch(e){c(new o.CometChatException(e))}})},e}();t.CometChatHelper=i},function(e,p,S){(function(r,i){var E;!function(e){var t=p,n=(r&&r.exports,"object"==typeof i&&i);n.global!==n&&n.window;var s=function(e){this.message=e};(s.prototype=new Error).name="InvalidCharacterError";var c=function(e){throw new s(e)},u="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a=/[\t\n\f\r ]/g,o={encode:function(e){e=String(e),/[^\0-\xFF]/.test(e)&&c("The string to be encoded contains characters outside of the Latin1 range.");for(var t,n,s,o,r=e.length%3,i="",a=-1,E=e.length-r;++a<E;)t=e.charCodeAt(a)<<16,n=e.charCodeAt(++a)<<8,s=e.charCodeAt(++a),i+=u.charAt((o=t+n+s)>>18&63)+u.charAt(o>>12&63)+u.charAt(o>>6&63)+u.charAt(63&o);return 2==r?(t=e.charCodeAt(a)<<8,n=e.charCodeAt(++a),i+=u.charAt((o=t+n)>>10)+u.charAt(o>>4&63)+u.charAt(o<<2&63)+"="):1==r&&(o=e.charCodeAt(a),i+=u.charAt(o>>2)+u.charAt(o<<4&63)+"=="),i},decode:function(e){var t=(e=String(e).replace(a,"")).length;t%4==0&&(t=(e=e.replace(/==?$/,"")).length),(t%4==1||/[^+a-zA-Z0-9/]/.test(e))&&c("Invalid character: the string to be decoded is not correctly encoded.");for(var n,s,o=0,r="",i=-1;++i<t;)s=u.indexOf(e.charAt(i)),n=o%4?64*n+s:s,o++%4&&(r+=String.fromCharCode(255&n>>(-2*o&6)));return r},version:"0.1.0"};void 0===(E=function(){return o}.call(p,S,p,r))||(r.exports=E)}()}).call(this,S(65)(e),S(27))},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},function(e,t,n){"use strict";t.__esModule=!0;var s=n(0),o=function(){function e(e){this.id="",this.name="",e&&(s.isFalsy(e.id)||(this.id=e.id),s.isFalsy(e.name)||(this.name=e.name))}return e.prototype.getId=function(){return this.id},e.prototype.getName=function(){return this.name},e}();t.CCExtension=o},function(e,t,n){var i=n(68),a=n(69);e.exports=function(e,t,n){var s=t&&n||0;"string"==typeof e&&(t="binary"===e?new Array(16):null,e=null);var o=(e=e||{}).random||(e.rng||i)();if(o[6]=15&o[6]|64,o[8]=63&o[8]|128,t)for(var r=0;r<16;++r)t[s+r]=o[r];return t||a(o)}},function(e,t){var n="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(n){var s=new Uint8Array(16);e.exports=function(){return n(s),s}}else{var o=new Array(16);e.exports=function(){for(var e,t=0;t<16;t++)0==(3&t)&&(e=4294967296*Math.random()),o[t]=e>>>((3&t)<<3)&255;return o}}},function(e,t){for(var o=[],n=0;n<256;++n)o[n]=(n+256).toString(16).substr(1);e.exports=function(e,t){var n=t||0,s=o;return[s[e[n++]],s[e[n++]],s[e[n++]],s[e[n++]],"-",s[e[n++]],s[e[n++]],"-",s[e[n++]],s[e[n++]],"-",s[e[n++]],s[e[n++]],"-",s[e[n++]],s[e[n++]],s[e[n++]],s[e[n++]],s[e[n++]],s[e[n++]]].join("")}},function(e,t,n){function s(e){this.options=e||{locator:{}}}function c(){this.cdata=!1}function u(e,t){t.lineNumber=e.lineNumber,t.columnNumber=e.columnNumber}function p(e){if(e)return"\n@"+(e.systemId||"")+"#[line:"+e.lineNumber+",col:"+e.columnNumber+"]"}function o(e,t,n){return"string"==typeof e?e.substr(t,n):e.length>=t+n||t?new java.lang.String(e,t,n)+"":e}function S(e,t){e.currentElement?e.currentElement.appendChild(t):e.doc.appendChild(t)}s.prototype.parseFromString=function(e,t){var n=this.options,s=new C,o=n.domBuilder||new c,r=n.errorHandler,i=n.locator,a=n.xmlns||{},E={lt:"<",gt:">",amp:"&",quot:'"',apos:"'"};return i&&o.setDocumentLocator(i),s.errorHandler=function(s,e,o){if(!s){if(e instanceof c)return e;s=e}var r={},i=s instanceof Function;function t(t){var n=s[t];!n&&i&&(n=2==s.length?function(e){s(t,e)}:s),r[t]=n&&function(e){n("[xmldom "+t+"]\t"+e+p(o))}||function(){}}return o=o||{},t("warning"),t("error"),t("fatalError"),r}(r,o,i),s.domBuilder=n.domBuilder||o,/\/x?html?$/.test(t)&&(E.nbsp="",E.copy="",a[""]="http://www.w3.org/1999/xhtml"),a.xml=a.xml||"http://www.w3.org/XML/1998/namespace",e?s.parse(e,a,E):s.errorHandler.error("invalid doc source"),o.doc},c.prototype={startDocument:function(){this.doc=(new r).createDocument(null,null,null),this.locator&&(this.doc.documentURI=this.locator.systemId)},startElement:function(e,t,n,s){var o=this.doc,r=o.createElementNS(e,n||t),i=s.length;S(this,r),this.currentElement=r,this.locator&&u(this.locator,r);for(var a=0;a<i;a++){e=s.getURI(a);var E=s.getValue(a),c=(n=s.getQName(a),o.createAttributeNS(e,n));this.locator&&u(s.getLocator(a),c),c.value=c.nodeValue=E,r.setAttributeNode(c)}},endElement:function(e,t,n){var s=this.currentElement;s.tagName;this.currentElement=s.parentNode},startPrefixMapping:function(e,t){},endPrefixMapping:function(e){},processingInstruction:function(e,t){var n=this.doc.createProcessingInstruction(e,t);this.locator&&u(this.locator,n),S(this,n)},ignorableWhitespace:function(e,t,n){},characters:function(e,t,n){if(e=o.apply(this,arguments)){if(this.cdata)var s=this.doc.createCDATASection(e);else s=this.doc.createTextNode(e);this.currentElement?this.currentElement.appendChild(s):/^\s*$/.test(e)&&this.doc.appendChild(s),this.locator&&u(this.locator,s)}},skippedEntity:function(e){},endDocument:function(){this.doc.normalize()},setDocumentLocator:function(e){(this.locator=e)&&(e.lineNumber=0)},comment:function(e,t,n){e=o.apply(this,arguments);var s=this.doc.createComment(e);this.locator&&u(this.locator,s),S(this,s)},startCDATA:function(){this.cdata=!0},endCDATA:function(){this.cdata=!1},startDTD:function(e,t,n){var s=this.doc.implementation;if(s&&s.createDocumentType){var o=s.createDocumentType(e,t,n);this.locator&&u(this.locator,o),S(this,o)}},warning:function(e){},error:function(e){},fatalError:function(e){throw e}},"endDTD,startEntity,endEntity,attributeDecl,elementDecl,externalEntityDecl,internalEntityDecl,resolveEntity,getExternalSubset,notationDecl,unparsedEntityDecl".replace(/\w+/g,function(e){c.prototype[e]=function(){return null}});var C=n(71).XMLReader,r=t.DOMImplementation=n(39).DOMImplementation;t.XMLSerializer=n(39).XMLSerializer,t.DOMParser=s},function(e,t){var n=/[A-Z_a-z\xC0-\xD6\xD8-\xF6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,s=new RegExp("[\\-\\.0-9"+n.source.slice(1,-1)+"\\u00B7\\u0300-\\u036F\\u203F-\\u2040]"),o=new RegExp("^"+n.source+s.source+"*(?::"+n.source+s.source+"*)?$"),p=0,S=1,C=2,l=3,T=4,d=5,g=6,_=7;function r(){}function v(e,t){return t.lineNumber=e.lineNumber,t.columnNumber=e.columnNumber,t}function D(e,t,n,s,o,r){for(var i,a=++t,E=p;;){var c=e.charAt(a);switch(c){case"=":if(E===S)i=e.slice(t,a),E=l;else{if(E!==C)throw new Error("attribute equal must after attrName");E=l}break;case"'":case'"':if(E===l||E===S){if(E===S&&(r.warning('attribute value must after "="'),i=e.slice(t,a)),t=a+1,!(0<(a=e.indexOf(c,t))))throw new Error("attribute value no end '"+c+"' match");u=e.slice(t,a).replace(/&#?\w+;/g,o),n.add(i,u,t-1),E=d}else{if(E!=T)throw new Error('attribute value must after "="');u=e.slice(t,a).replace(/&#?\w+;/g,o),n.add(i,u,t),r.warning('attribute "'+i+'" missed start quot('+c+")!!"),t=a+1,E=d}break;case"/":switch(E){case p:n.setTagName(e.slice(t,a));case d:case g:case _:E=_,n.closed=!0;case T:case S:case C:break;default:throw new Error("attribute invalid close char('/')")}break;case"":return r.error("unexpected end of input"),E==p&&n.setTagName(e.slice(t,a)),a;case">":switch(E){case p:n.setTagName(e.slice(t,a));case d:case g:case _:break;case T:case S:"/"===(u=e.slice(t,a)).slice(-1)&&(n.closed=!0,u=u.slice(0,-1));case C:E===C&&(u=i),E==T?(r.warning('attribute "'+u+'" missed quot(")!!'),n.add(i,u.replace(/&#?\w+;/g,o),t)):("http://www.w3.org/1999/xhtml"===s[""]&&u.match(/^(?:disabled|checked|selected)$/i)||r.warning('attribute "'+u+'" missed value!! "'+u+'" instead!!'),n.add(u,u,t));break;case l:throw new Error("attribute value missed!!")}return a;case"":c=" ";default:if(c<=" ")switch(E){case p:n.setTagName(e.slice(t,a)),E=g;break;case S:i=e.slice(t,a),E=C;break;case T:var u=e.slice(t,a).replace(/&#?\w+;/g,o);r.warning('attribute "'+u+'" missed quot(")!!'),n.add(i,u,t);case d:E=g}else switch(E){case C:n.tagName;"http://www.w3.org/1999/xhtml"===s[""]&&i.match(/^(?:disabled|checked|selected)$/i)||r.warning('attribute "'+i+'" missed value!! "'+i+'" instead2!!'),n.add(i,i,t),t=a,E=S;break;case d:r.warning('attribute space is required"'+i+'"!!');case g:E=S,t=a;break;case l:E=T,t=a;break;case _:throw new Error("elements closed character '/' and '>' must be connected to")}}a++}}function U(e,t,n){for(var s=e.tagName,o=null,r=e.length;r--;){var i=e[r],a=i.qName,E=i.value;if(0<(S=a.indexOf(":")))var c=i.prefix=a.slice(0,S),u=a.slice(S+1),p="xmlns"===c&&u;else c=null,p="xmlns"===(u=a)&&"";i.localName=u,!1!==p&&(null==o&&(o={},h(n,n={})),n[p]=o[p]=E,i.uri="http://www.w3.org/2000/xmlns/",t.startPrefixMapping(p,E))}for(r=e.length;r--;){(c=(i=e[r]).prefix)&&("xml"===c&&(i.uri="http://www.w3.org/XML/1998/namespace"),"xmlns"!==c&&(i.uri=n[c||""]))}var S=s.indexOf(":");u=e.localName=0<S?(c=e.prefix=s.slice(0,S),s.slice(S+1)):(c=null,s);var C=e.uri=n[c||""];if(t.startElement(C,u,s,e),!e.closed)return e.currentNSMap=n,e.localNSMap=o,!0;if(t.endElement(C,u,s),o)for(c in o)t.endPrefixMapping(c)}function Y(e,t,n,s,o){if(/^(?:script|textarea)$/i.test(n)){var r=e.indexOf("</"+n+">",t),i=e.substring(t+1,r);if(/[&<]/.test(i))return/^script$/i.test(n)||(i=i.replace(/&#?\w+;/g,s)),o.characters(i,0,i.length),r}return t+1}function w(e,t,n,s){var o=s[n];return null==o&&((o=e.lastIndexOf("</"+n+">"))<t&&(o=e.lastIndexOf("</"+n)),s[n]=o),o<t}function h(e,t){for(var n in e)t[n]=e[n]}function G(e,t,n,s){switch(e.charAt(t+2)){case"-":return"-"!==e.charAt(t+3)?-1:t<(o=e.indexOf("--\x3e",t+4))?(n.comment(e,t+4,o-t-4),o+3):(s.error("Unclosed comment"),-1);default:if("CDATA["==e.substr(t+3,6)){var o=e.indexOf("]]>",t+9);return n.startCDATA(),n.characters(e,t+9,o-t-9),n.endCDATA(),o+3}var r=function(e,t){var n,s=[],o=/'[^']+'|"[^"]+"|[^\s<>\/=]+=?|(\/?\s*>|<)/g;o.lastIndex=t,o.exec(e);for(;n=o.exec(e);)if(s.push(n),n[1])return s}(e,t),i=r.length;if(1<i&&/!doctype/i.test(r[0][0])){var a=r[1][0],E=3<i&&/^public$/i.test(r[2][0])&&r[3][0],c=4<i&&r[4][0],u=r[i-1];return n.startDTD(a,E&&E.replace(/^(['"])(.*?)\1$/,"$2"),c&&c.replace(/^(['"])(.*?)\1$/,"$2")),n.endDTD(),u.index+u[0].length}}return-1}function K(e,t,n){var s=e.indexOf("?>",t);if(s){var o=e.substring(t,s).match(/^<\?(\S*)\s*([\s\S]*?)\s*$/);if(o){o[0].length;return n.processingInstruction(o[1],o[2]),s+2}return-1}return-1}function x(e){}function i(e,t){return e.__proto__=t,e}r.prototype={parse:function(e,t,n){var s=this.domBuilder;s.startDocument(),h(t,t={}),function(n,e,s,o,r){function i(e){var t=e.slice(1,-1);return t in s?s[t]:"#"===t.charAt(0)?function(e){{if(65535<e){var t=55296+((e-=65536)>>10),n=56320+(1023&e);return String.fromCharCode(t,n)}return String.fromCharCode(e)}}(parseInt(t.substr(1).replace("x","0x"))):(r.error("entity not found:"+e),e)}function t(e){if(l<e){var t=n.substring(l,e).replace(/&#?\w+;/g,i);p&&a(l),o.characters(t,0,e-l),l=e}}function a(e,t){for(;c<=e&&(t=u.exec(n));)E=t.index,c=E+t[0].length,p.lineNumber++;p.columnNumber=e-E+1}var E=0,c=0,u=/.*(?:\r\n?|\n)|.*$/g,p=o.locator,S=[{currentNSMap:e}],C={},l=0;for(;;){try{var T=n.indexOf("<",l);if(T<0){if(!n.substr(l).match(/^\s*$/)){var d=o.doc,g=d.createTextNode(n.substr(l));d.appendChild(g),o.currentElement=g}return}switch(l<T&&t(T),n.charAt(T+1)){case"/":var _=n.indexOf(">",T+3),h=n.substring(T+2,_),A=S.pop();_<0?(h=n.substring(T+2).replace(/[\s<].*/,""),r.error("end tag name: "+h+" is not complete:"+A.tagName),_=T+1+h.length):h.match(/\s</)&&(h=h.replace(/[\s<].*/,""),r.error("end tag name: "+h+" maybe not complete"),_=T+1+h.length);var R=A.localNSMap,I=A.tagName==h,f=I||A.tagName&&A.tagName.toLowerCase()==h.toLowerCase();if(f){if(o.endElement(A.uri,A.localName,h),R)for(var O in R)o.endPrefixMapping(O);I||r.fatalError("end tag name: "+h+" is not match the current start tagName:"+A.tagName)}else S.push(A);_++;break;case"?":p&&a(T),_=K(n,T,o);break;case"!":p&&a(T),_=G(n,T,o,r);break;default:p&&a(T);var N=new x,m=S[S.length-1].currentNSMap,_=D(n,T,N,m,i,r),y=N.length;if(!N.closed&&w(n,_,N.tagName,C)&&(N.closed=!0,s.nbsp||r.warning("unclosed xml attribute")),p&&y){for(var L=v(p,{}),M=0;M<y;M++){var P=N[M];a(P.offset),P.locator=v(p,{})}o.locator=L,U(N,o,m)&&S.push(N),o.locator=p}else U(N,o,m)&&S.push(N);"http://www.w3.org/1999/xhtml"!==N.uri||N.closed?_++:_=Y(n,_,N.tagName,i,o)}}catch(e){r.error("element parse error: "+e),_=-1}l<_?l=_:t(Math.max(T,l)+1)}}(e,t,n,s,this.errorHandler),s.endDocument()}},x.prototype={setTagName:function(e){if(!o.test(e))throw new Error("invalid tagName:"+e);this.tagName=e},add:function(e,t,n){if(!o.test(e))throw new Error("invalid attribute:"+e);this[this.length++]={qName:e,value:t,offset:n}},length:0,getLocalName:function(e){return this[e].localName},getLocator:function(e){return this[e].locator},getQName:function(e){return this[e].qName},getURI:function(e){return this[e].uri},getValue:function(e){return this[e].value}},i({},i.prototype)instanceof i||(i=function(e,t){function n(){}for(t in n.prototype=t,n=new n,e)n[t]=e[t];return n}),t.XMLReader=r}])});